<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aurora OS • MysticSoft</title>
    <style>
        :root {
            --vinho: #3e0a29;
            --verde: #b2d1b1;
            --azul: #0b1836;
            --dourado: #f0aa53;
            --pergaminho: #f2eaff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--azul);
            color: var(--pergaminho);
            height: 100vh;
            overflow: hidden;
        }

        /* === TELA DE BOOT === */
        .boot-screen {
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%),
                linear-gradient(135deg, var(--azul) 0%, #1a2a4a 50%, #2a1a4a 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            cursor: pointer;
            overflow: hidden;
            animation: bootGlow 4s ease-in-out infinite alternate, tvStatic 0.1s infinite;
        }

        @keyframes bootGlow {
            0% { filter: brightness(1) saturate(1); }
            100% { filter: brightness(1.1) saturate(1.2); }
        }

        @keyframes tvStatic {
            0% { filter: brightness(1) contrast(1); }
            25% { filter: brightness(1.02) contrast(1.01); }
            50% { filter: brightness(0.98) contrast(0.99); }
            75% { filter: brightness(1.01) contrast(1.02); }
            100% { filter: brightness(1) contrast(1); }
        }

        .boot-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 70%, rgba(255, 215, 0, 0.1) 0%, transparent 30%),
                radial-gradient(circle at 70% 30%, rgba(138, 43, 226, 0.1) 0%, transparent 30%);
            animation: mysticalAura 6s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes mysticalAura {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.05); }
        }

        .boot-screen::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, rgba(255, 215, 0, 0.4), transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255, 255, 255, 0.3), transparent),
                radial-gradient(1px 1px at 90px 40px, rgba(138, 43, 226, 0.4), transparent),
                radial-gradient(1px 1px at 130px 80px, rgba(255, 215, 0, 0.3), transparent),
                radial-gradient(2px 2px at 160px 30px, rgba(255, 255, 255, 0.2), transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: sparkle 8s linear infinite, tvScanlines 0.05s infinite;
            pointer-events: none;
        }

        @keyframes sparkle {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-100px); }
        }

        @keyframes tvScanlines {
            0% { opacity: 0.8; }
            50% { opacity: 0.9; }
            100% { opacity: 0.8; }
        }

        .boot-logo {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            animation: logoFloat 3s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .boot-title {
            font-size: 48px;
            color: var(--dourado);
            margin-bottom: 5px;
            text-shadow: 
                2px 2px 4px rgba(0, 0, 0, 0.8),
                0 0 10px var(--dourado);
            font-weight: bold;
            letter-spacing: 3px;
            font-family: 'MS Sans Serif', sans-serif;
        }

        .boot-version {
            font-size: 24px;
            color: #c0c0c0;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            font-weight: normal;
            letter-spacing: 1px;
            font-family: 'MS Sans Serif', sans-serif;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .boot-subtitle {
            font-size: 18px;
            color: #c0c0c0;
            margin-bottom: 40px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            font-family: 'MS Sans Serif', sans-serif;
        }

        .boot-progress-container {
            margin-bottom: 30px;
        }

        .boot-progress {
            width: 400px;
            height: 20px;
            background: #000080;
            border: 2px inset #c0c0c0;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .boot-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0000ff 0%, #4040ff 50%, #8080ff 100%);
            width: 0%;
            transition: width 0.5s ease;
            position: relative;
        }

        .boot-status {
            font-size: 14px;
            color: #c0c0c0;
            text-align: left;
            margin: 0;
            font-family: 'MS Sans Serif', sans-serif;
        }

        .boot-hint {
            font-size: 14px;
            color: #c0c0c0;
            margin-bottom: 20px;
            font-family: 'MS Sans Serif', sans-serif;
        }

        .boot-copyright {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }

        .boot-copyright p {
            font-size: 12px;
            color: #808080;
            margin: 2px 0;
            font-family: 'MS Sans Serif', sans-serif;
        }

        .boot-orbs {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .boot-orb {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.8) 0%, transparent 70%);
            border-radius: 50%;
            animation: orbFloat 8s linear infinite;
        }

        @keyframes orbFloat {
            0% { transform: translateY(100vh) translateX(0px); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-10vh) translateX(50px); opacity: 0; }
        }

        /* === DESKTOP === */
        .desktop {
            display: none;
            position: relative;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, var(--azul) 0%, var(--vinho) 50%, var(--azul) 100%);
        }

        .desktop.active {
            display: block;
        }

        /* === BARRA DE TAREFAS === */
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(180deg, #c0c0c0 0%, #808080 100%);
            border-top: 2px solid #ffffff;
            display: flex;
            align-items: center;
            padding: 0 10px;
            z-index: 1000;
            font-family: 'MS Sans Serif', sans-serif;
            font-size: 14px;
        .start-button {
            background: linear-gradient(180deg, #c0c0c0 0%, #808080 100%);
            border: 2px outset #c0c0c0;
            padding: 10px 20px;
            font-weight: bold;
            color: #000;
            cursor: pointer;
            margin-right: 10px;
            font-size: 14px;
            height: 32px;
            display: flex;
            align-items: center;
        }

        .start-button:active {
            border: 2px inset #c0c0c0;
        }

        .clock {
            margin-left: auto;
            background: linear-gradient(180deg, #c0c0c0 0%, #808080 100%);
            border: 1px inset #c0c0c0;
            padding: 8px 12px;
            font-size: 12px;
            color: #000;
            cursor: pointer;
        }

        /* === ÍCONES DO DESKTOP === */
        .desktop-icons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, 80px);
            gap: 20px;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .desktop-icon:hover {
            background: rgba(255,255,255,0.1);
        }

        .icon-image {
            width: 48px;
            height: 48px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            image-rendering: pixelated;
            object-fit: contain;
        }

        .icon-image img {
            width: 100%;
            height: 100%;
            image-rendering: pixelated;
            object-fit: contain;
        }

        .icon-label {
            font-size: 12px;
            text-align: center;
            color: var(--pergaminho);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        /* === JANELAS === */
        .window {
            position: absolute;
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            min-width: 300px;
            min-height: 200px;
            display: none;
            z-index: 1000;
        }

        .window.active {
            display: block;
        }

        .window-header {
            background: linear-gradient(90deg, #0000ff, #000080);
            color: white;
            padding: 4px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
        }

        .window-title {
            font-weight: bold;
            font-size: 12px;
        }

        .window-controls {
            display: flex;
            gap: 2px;
        }

        .window-btn {
            width: 16px;
            height: 14px;
            background: #c0c0c0;
            border: 1px outset #c0c0c0;
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .window-btn:active {
            border: 1px inset #c0c0c0;
        }

        .window-content {
            padding: 15px;
            background: #c0c0c0;
            color: #000;
        }

        /* === WIDGET ASTROMÁGICK === */
        .astromagick-widget {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 300px;
            background: rgba(11, 24, 54, 0.9);
            border: 2px solid var(--dourado);
            border-radius: 12px;
            padding: 15px;
            color: var(--pergaminho);
            backdrop-filter: blur(10px);
        }

        .widget-header {
            text-align: center;
            margin-bottom: 15px;
            color: var(--dourado);
            font-weight: bold;
        }

        .astro-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 12px;
        }

        .astro-item {
            background: rgba(240, 170, 83, 0.1);
            padding: 8px;
            border-radius: 6px;
            border: 1px solid rgba(240, 170, 83, 0.3);
        }

        .astro-label {
            color: var(--verde);
            font-weight: bold;
            margin-bottom: 4px;
        }

        .astro-value {
            color: var(--pergaminho);
        }

        /* === AURORA PLAYER === */
        .aurora-player {
            width: 500px;
            height: 400px;
        }

        .player-header {
            background: linear-gradient(135deg, var(--vinho), var(--azul));
            color: var(--pergaminho);
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }

        .player-content {
            background: #c0c0c0;
            padding: 0;
            height: calc(100% - 40px);
            display: flex;
            flex-direction: column;
        }

        .player-display {
            background: #000;
            color: var(--dourado);
            padding: 15px;
            text-align: center;
            font-family: 'Courier New', monospace;
            border-bottom: 2px inset #c0c0c0;
        }

        .track-info {
            font-size: 14px;
            margin-bottom: 5px;
        }

        .time-info {
            font-size: 12px;
            opacity: 0.8;
        }

        .player-controls {
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
            border-bottom: 2px inset #c0c0c0;
        }

        .control-btn {
            width: 40px;
            height: 30px;
            background: linear-gradient(180deg, #c0c0c0 0%, #808080 100%);
            border: 2px outset #c0c0c0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .control-btn:active {
            border: 2px inset #c0c0c0;
        }

        .volume-section {
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px inset #c0c0c0;
        }

        .volume-slider {
            flex: 1;
            height: 20px;
        }

        .playlist-section {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
        }

        .playlist-item {
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 3px;
            margin-bottom: 2px;
            font-size: 12px;
        }

        .playlist-item:hover {
            background: #e0e0e0;
        }

        .playlist-item.active {
            background: var(--azul);
            color: white;
        }

        .admin-section {
            padding: 10px;
            border-top: 2px inset #c0c0c0;
        }

        .admin-btn {
            background: linear-gradient(180deg, #c0c0c0 0%, #808080 100%);
            border: 2px outset #c0c0c0;
            padding: 5px 10px;
            cursor: pointer;
            margin-right: 5px;
            font-size: 11px;
        }

        .admin-btn:active {
            border: 2px inset #c0c0c0;
        }

        /* === WITCH.TV === */
        .witch-tv {
            width: 600px;
            height: 450px;
        }

        .tv-screen {
            background: #000;
            height: 250px;
            border: 3px inset #c0c0c0;
            margin: 10px;
            position: relative;
            overflow: hidden;
        }

        .tv-static {
            position: absolute;
            inset: 0;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(255,255,255,0.1) 2px,
                rgba(255,255,255,0.1) 4px
            );
            animation: static 0.1s infinite;
        }

        @keyframes static {
            0% { opacity: 0.8; }
            50% { opacity: 0.4; }
            100% { opacity: 0.8; }
        }

        .tv-content {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--pergaminho);
            font-size: 18px;
            text-align: center;
        }

        .channel-list {
            padding: 10px;
            max-height: 120px;
            overflow-y: auto;
        }

        .channel-item {
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 3px;
            margin-bottom: 2px;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
        }

        .channel-item:hover {
            background: #e0e0e0;
        }

        .channel-item.active {
            background: var(--vinho);
            color: white;
        }

        /* === TARÔ === */
        .tarot-app {
            width: 500px;
            height: 400px;
        }

        .tarot-spread {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding: 20px;
            height: 200px;
        }

        .tarot-card {
            background: linear-gradient(135deg, var(--vinho), var(--azul));
            border: 2px solid var(--dourado);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--pergaminho);
            font-size: 24px;
            transition: transform 0.3s;
        }

        .tarot-card:hover {
            transform: scale(1.05);
        }

        .tarot-card.revealed {
            background: linear-gradient(135deg, var(--dourado), #ffd700);
            color: var(--azul);
        }

        .tarot-reading {
            padding: 15px;
            background: rgba(11, 24, 54, 0.1);
            border-radius: 8px;
            margin: 10px;
            font-size: 12px;
        }

        /* === LIVROS INTERATIVOS === */
        .books-app {
            width: 550px;
            height: 450px;
        }

        .book-shelf {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 15px;
            height: 200px;
        }

        .book-spine {
            background: linear-gradient(180deg, var(--vinho), var(--azul));
            border: 1px solid var(--dourado);
            border-radius: 4px;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            padding: 10px 5px;
            cursor: pointer;
            color: var(--pergaminho);
            font-size: 10px;
            text-align: center;
            transition: transform 0.2s;
        }

        .book-spine:hover {
            transform: translateY(-5px);
        }

        .book-content {
            padding: 15px;
            background: var(--pergaminho);
            color: var(--azul);
            border-radius: 8px;
            margin: 10px;
            height: 150px;
            overflow-y: auto;
            font-size: 12px;
            line-height: 1.4;
        }

        /* === AFAST! === */
        .afast-app {
            width: 450px;
            height: 350px;
        }

        .speech-area {
            background: #000;
            color: var(--verde);
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            height: 150px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-y: auto;
        }

        .speech-controls {
            padding: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .speech-btn {
            background: linear-gradient(180deg, #c0c0c0 0%, #808080 100%);
            border: 2px outset #c0c0c0;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 12px;
        }

        .speech-btn:active {
            border: 2px inset #c0c0c0;
        }

        .speech-btn.recording {
            background: linear-gradient(180deg, #ff4444 0%, #cc0000 100%);
            color: white;
        }

        /* Estilos AstroMágick Expandido */
        .astro-tabs {
            display: flex;
            border-bottom: 2px solid var(--dourado);
            margin-bottom: 15px;
            background: linear-gradient(180deg, #f0f0f0 0%, #d0d0d0 100%);
            border-radius: 5px 5px 0 0;
        }

        .astro-tab {
            flex: 1;
            padding: 10px 15px;
            border: none;
            background: linear-gradient(180deg, #e0e0e0 0%, #c0c0c0 100%);
            border-right: 1px solid #999;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .astro-tab:last-child {
            border-right: none;
        }

        .astro-tab:hover {
            background: linear-gradient(180deg, #f0f0f0 0%, #d0d0d0 100%);
        }

        .astro-tab.active {
            background: linear-gradient(180deg, var(--dourado) 0%, #e6a000 100%);
            color: white;
            border-bottom: 2px solid var(--verde-salvia);
        }

        .astro-tab-content {
            min-height: 300px;
            max-height: 400px;
            overflow-y: auto;
        }

        .astro-tab-panel {
            display: none;
            padding: 15px;
            background: rgba(255,255,255,0.9);
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .astro-tab-panel.active {
            display: block;
        }

        .planets-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .planet-item {
            padding: 8px;
            background: linear-gradient(180deg, #f8f8f8 0%, #e8e8e8 100%);
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }

        .lunar-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        .lunar-phase, .lunar-calendar, .lunar-energy {
            padding: 10px;
            background: linear-gradient(180deg, #f0f8ff 0%, #e0f0ff 100%);
            border: 1px solid var(--azul-marinho);
            border-radius: 5px;
        }

        .phase-display {
            font-size: 18px;
            text-align: center;
            margin: 10px 0;
        }

        .illumination {
            text-align: center;
            font-weight: bold;
            color: var(--dourado);
        }

        .phase-item {
            margin: 5px 0;
            padding: 5px;
            background: rgba(255,255,255,0.5);
            border-radius: 3px;
        }

        .transits-list, .aspects-list, .alerts-section {
            margin-top: 10px;
        }

        .transit-item, .aspect-item, .alert-item {
            padding: 10px;
            margin: 8px 0;
            border-radius: 5px;
            border-left: 4px solid;
        }

        .transit-item.favorable, .aspect-item.harmonious, .alert-item.favorable {
            background: linear-gradient(180deg, #f0fff0 0%, #e0ffe0 100%);
            border-left-color: #00aa00;
        }

        .transit-item.attention, .aspect-item.neutral {
            background: linear-gradient(180deg, #fffaf0 0%, #fff0e0 100%);
            border-left-color: #ffaa00;
        }

        .aspect-item.tense, .alert-item.attention {
            background: linear-gradient(180deg, #fff8f0 0%, #ffe8e0 100%);
            border-left-color: #ff6600;
        }

        .alert-item.critical {
            background: linear-gradient(180deg, #fff0f0 0%, #ffe0e0 100%);
            border-left-color: #ff0000;
        }

        .alert-settings {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(180deg, #f8f8f8 0%, #e8e8e8 100%);
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .setting-item {
            margin: 8px 0;
            padding: 5px;
        }

        .setting-item label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .setting-item input[type="checkbox"] {
            margin-right: 8px;
        }

        .astro-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ccc;
        }

        .astro-btn {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .astro-btn.primary {
            background: linear-gradient(180deg, var(--dourado) 0%, #e6a000 100%);
            color: white;
        }

        .astro-btn.secondary {
            background: linear-gradient(180deg, var(--verde-salvia) 0%, #a0c0a0 100%);
            color: white;
        }

        .astro-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* === NOTIFICAÇÕES ESTILO MSN === */
        .msn-notification {
            position: fixed;
            bottom: 50px;
            right: 20px;
            width: 300px;
            background: linear-gradient(180deg, #e6e6fa 0%, #d8bfd8 100%);
            border: 2px outset #c0c0c0;
            border-radius: 8px;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
            z-index: 9999;
            font-family: 'MS Sans Serif', sans-serif;
            transform: translateY(100%);
            opacity: 0;
            transition: all 0.5s ease-out;
        }

        .msn-notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .msn-notification.hide {
            transform: translateY(100%);
            opacity: 0;
        }

        .msn-header {
            background: linear-gradient(180deg, #4169e1 0%, #0000cd 100%);
            color: white;
            padding: 4px 8px;
            font-size: 11px;
            font-weight: bold;
            border-radius: 6px 6px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .msn-close {
            background: none;
            border: none;
            color: white;
            font-size: 14px;
            cursor: pointer;
            padding: 0;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .msn-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .msn-content {
            padding: 12px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .msn-icon {
            width: 32px;
            height: 32px;
            background: var(--azul);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        .msn-text {
            flex: 1;
        }

        .msn-title {
            font-weight: bold;
            font-size: 12px;
            color: #000080;
            margin-bottom: 4px;
        }

        .msn-message {
            font-size: 11px;
            color: #000;
            line-height: 1.3;
        }

        .msn-time {
            font-size: 10px;
            color: #666;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <!-- Container de Notificações MSN -->
    <div id="msn-notifications-container"></div>
    <!-- Tela de Boot -->
    <div class="boot-screen" id="boot-screen">
        <div class="boot-orbs" id="boot-orbs"></div>
        <div class="boot-content">
            <div class="boot-logo">
                <img src="icons/MysticSoft.png" alt="MysticSoft" style="width: 120px; height: 120px; image-rendering: pixelated; filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.5));">
            </div>
            <h1 class="boot-title">MysticSoft</h1>
            <h2 class="boot-version">Millennium Edition</h2>
            <p class="boot-subtitle">Sistema Operacional Místico</p>
            <div class="boot-progress-container">
                <div class="boot-progress">
                    <div class="boot-progress-fill" id="boot-progress"></div>
                </div>
                <p class="boot-status" id="boot-status">Inicializando sistema...</p>
            </div>
            <p class="boot-hint">Clique para iniciar</p>
            <div class="boot-copyright">
                <p>Copyright © 2025 MysticSoft Corporation</p>
                <p>Todos os direitos reservados</p>
            </div>
        </div>
    </div>

    <!-- Desktop -->
    <div class="desktop" id="desktop">
        <!-- Ícones do Desktop -->
        <div class="desktop-icons">
            <div class="desktop-icon" data-app="astromagick">
                <img src="icons/astromagick.png" alt="AstroMágick" class="icon-image">
                <div class="icon-label">AstroMágick</div>
            </div>
            <div class="desktop-icon" data-app="aurora-player">
                <div class="icon-image">🎵</div>
                <div class="icon-label">Aurora Player</div>
            </div>
            <div class="desktop-icon" data-app="witch-tv">
                <img src="icons/witch-tv.png" alt="Witch.TV" class="icon-image">
                <div class="icon-label">Witch.TV</div>
            </div>
            <div class="desktop-icon" data-app="afast">
                <img src="icons/afast.png" alt="AFAST!" class="icon-image">
                <div class="icon-label">AFAST!</div>
            </div>
            <div class="desktop-icon" data-app="tarot">
                <div class="icon-image">🔮</div>
                <div class="icon-label">Tarô</div>
            </div>
            <div class="desktop-icon" data-app="books">
                <img src="icons/livros-interativos.png" alt="Livros Interativos" class="icon-image">
                <div class="icon-label">Livros Interativos</div>
            </div>
        </div>



        <!-- Barra de Tarefas -->
        <div class="taskbar">
            <div class="start-button" id="start-button">Iniciar</div>
            <div class="clock" id="clock">00:00</div>
        </div>
    </div>

    <!-- Janela AstroMágick Expandida -->
    <div class="window" id="astromagick-window">
        <div class="window-header">
            <span class="window-title">🌙 AstroMágick - Portal Astrológico Completo</span>
            <div class="window-controls">
                <button class="window-btn" onclick="minimizeWindow('astromagick-window')">_</button>
                <button class="window-btn" onclick="closeWindow('astromagick-window')">×</button>
            </div>
        </div>
        <div class="window-content">
            <!-- Sistema de Abas -->
            <div class="astro-tabs">
                <button class="astro-tab active" onclick="switchAstroTab('positions')">📊 Posições</button>
                <button class="astro-tab" onclick="switchAstroTab('lunar')">🌙 Lunar</button>
                <button class="astro-tab" onclick="switchAstroTab('transits')">⚡ Trânsitos</button>
                <button class="astro-tab" onclick="switchAstroTab('aspects')">🔮 Aspectos</button>
                <button class="astro-tab" onclick="switchAstroTab('alerts')">🚨 Alertas</button>
            </div>

            <!-- Conteúdo das Abas -->
            <div class="astro-tab-content">
                <!-- Aba Posições -->
                <div id="positions-tab" class="astro-tab-panel active">
                    <h3>📊 Posições Planetárias</h3>
                    <div class="planets-grid">
                        <div class="planet-item">☉ <strong>Sol:</strong> Virgem 18°23'</div>
                        <div class="planet-item">☽ <strong>Lua:</strong> Peixes 12°45'</div>
                        <div class="planet-item">☿ <strong>Mercúrio:</strong> Virgem 25°12'</div>
                        <div class="planet-item">♀ <strong>Vênus:</strong> Libra 3°08'</div>
                        <div class="planet-item">♂ <strong>Marte:</strong> Câncer 28°33'</div>
                        <div class="planet-item">♃ <strong>Júpiter:</strong> Gêmeos 15°27'</div>
                        <div class="planet-item">♄ <strong>Saturno:</strong> Peixes 19°41'</div>
                        <div class="planet-item">♅ <strong>Urano:</strong> Touro 27°15'</div>
                        <div class="planet-item">♆ <strong>Netuno:</strong> Peixes 29°52'</div>
                        <div class="planet-item">♇ <strong>Plutão:</strong> Capricórnio 29°38'</div>
                    </div>
                </div>

                <!-- Aba Lunar -->
                <div id="lunar-tab" class="astro-tab-panel">
                    <h3>🌙 Informações Lunares</h3>
                    <div class="lunar-info">
                        <div class="lunar-phase">
                            <h4>Fase Atual</h4>
                            <div class="phase-display">🌖 <strong>Gibosa Minguante</strong></div>
                            <div class="illumination">87% iluminada</div>
                        </div>
                        <div class="lunar-calendar">
                            <h4>Próximas Fases</h4>
                            <div class="phase-item">🌗 <strong>Quarto Minguante:</strong> 15/09 às 22:33</div>
                            <div class="phase-item">🌑 <strong>Lua Nova:</strong> 28/09 às 20:53</div>
                            <div class="phase-item">🌓 <strong>Quarto Crescente:</strong> 06/10 às 15:47</div>
                            <div class="phase-item">🌕 <strong>Lua Cheia:</strong> 14/10 às 18:08</div>
                        </div>
                        <div class="lunar-energy">
                            <h4>Energia Lunar</h4>
                            <p><strong>"Liberação e Purificação"</strong></p>
                            <p>Momento ideal para soltar o que não serve mais e fazer limpezas energéticas.</p>
                        </div>
                    </div>
                </div>

                <!-- Aba Trânsitos -->
                <div id="transits-tab" class="astro-tab-panel">
                    <h3>⚡ Trânsitos Importantes</h3>
                    <div class="transits-list">
                        <div class="transit-item favorable">☿ <strong>Mercúrio em Virgem</strong> - Comunicação precisa e detalhista (até 26/09)</div>
                        <div class="transit-item attention">♀ <strong>Vênus entrando em Libra</strong> - Harmonia nos relacionamentos (11/09 a 07/10)</div>
                        <div class="transit-item favorable">♂ <strong>Marte em Câncer</strong> - Energia emocional e proteção familiar</div>
                        <div class="transit-item attention">♃ <strong>Júpiter em Gêmeos</strong> - Expansão através do conhecimento</div>
                        <div class="transit-item favorable">♄ <strong>Saturno em Peixes</strong> - Estruturação da espiritualidade</div>
                    </div>
                </div>

                <!-- Aba Aspectos -->
                <div id="aspects-tab" class="astro-tab-panel">
                    <h3>🔮 Aspectos Astrológicos</h3>
                    <div class="aspects-list">
                        <div class="aspect-item harmonious">△ <strong>Sol trígono Júpiter</strong> - Otimismo e expansão, energia positiva para crescimento</div>
                        <div class="aspect-item tense">□ <strong>Marte quadratura Saturno</strong> - Tensão entre ação e disciplina, paciência necessária</div>
                        <div class="aspect-item harmonious">△ <strong>Lua trígono Urano</strong> - Intuição e inovação, insights revolucionários</div>
                        <div class="aspect-item tense">☍ <strong>Mercúrio oposição Netuno</strong> - Confusão mental possível, clareza necessária</div>
                        <div class="aspect-item neutral">⚹ <strong>Vênus sextil Netuno</strong> - Inspiração artística e romântica, criatividade elevada</div>
                    </div>
                </div>

                <!-- Aba Alertas -->
                <div id="alerts-tab" class="astro-tab-panel">
                    <h3>🚨 Sistema de Alertas Astrológicos</h3>
                    <div class="alerts-section">
                        <div class="alert-item critical">🌑 <strong>ECLIPSE LUNAR</strong> - Próximo eclipse em 28/09, prepare-se para mudanças importantes</div>
                        <div class="alert-item attention">☿ <strong>MERCÚRIO RETRÓGRADO</strong> - Aproximando-se em 04/10, cuidado com comunicações e tecnologia</div>
                        <div class="alert-item attention">♀ <strong>VÊNUS RETRÓGRADA</strong> - Revisão de relacionamentos e valores (12/10 a 21/11)</div>
                        <div class="alert-item favorable">🌕 <strong>LUA CHEIA FAVORÁVEL</strong> - 14/10 em Áries, energia poderosa para novos projetos</div>
                    </div>
                    
                    <div class="alert-settings">
                        <h4>⚙️ Configurações de Alerta AFAST!</h4>
                        <div class="setting-item">
                            <label><input type="checkbox" checked> Notificações AFAST!</label>
                        </div>
                        <div class="setting-item">
                            <label><input type="checkbox" checked> Alertas de Retrogradação</label>
                        </div>
                        <div class="setting-item">
                            <label><input type="checkbox" checked> Eclipses e Eventos Raros</label>
                        </div>
                        <div class="setting-item">
                            <label><input type="checkbox"> Aspectos Diários</label>
                        </div>
                        <div class="setting-item">
                            <label><input type="checkbox"> Mudanças de Signo</label>
                        </div>
                        <div class="setting-item">
                            <label><input type="checkbox"> Fases Lunares</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Botões de Ação -->
            <div class="astro-actions">
                <button class="astro-btn primary" onclick="openCompleteApp()">🔮 Abrir Aplicação Completa</button>
                <button class="astro-btn secondary" onclick="updateAstroData()">🔄 Atualizar Dados</button>
            </div>
        </div>
    </div>

    <!-- Janela Aurora Player -->
    <div class="window aurora-player" id="aurora-player-window">
        <div class="window-header">
            <span class="window-title">🎵 Aurora Player - Reprodutor Místico</span>
            <div class="window-controls">
                <button class="window-btn" onclick="minimizeWindow('aurora-player-window')">_</button>
                <button class="window-btn" onclick="closeWindow('aurora-player-window')">×</button>
            </div>
        </div>
        <div class="player-content">
            <!-- Display do Player -->
            <div class="player-display">
                <div class="track-info" id="current-track">♪ Aurora Sagrada - Moonlight Serenade ♪</div>
                <div class="time-info" id="track-time">00:00 / 03:45</div>
            </div>

            <!-- Controles -->
            <div class="player-controls">
                <button class="control-btn" id="prev-btn" onclick="auroraPlayer.previousTrack()">⏮</button>
                <button class="control-btn" id="play-btn" onclick="auroraPlayer.togglePlay()">▶</button>
                <button class="control-btn" id="next-btn" onclick="auroraPlayer.nextTrack()">⏭</button>
                <button class="control-btn" id="shuffle-btn" onclick="auroraPlayer.toggleShuffle()">🔀</button>
                <button class="control-btn" id="repeat-btn" onclick="auroraPlayer.toggleRepeat()">🔁</button>
            </div>

            <!-- Volume -->
            <div class="volume-section">
                <span>🔊</span>
                <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="75">
                <span id="volume-display">75%</span>
            </div>

            <!-- Playlist -->
            <div class="playlist-section">
                <h4 style="margin: 0 0 10px 0; font-size: 12px;">📜 Playlist Mística</h4>
                <div id="playlist-container">
                    <div class="playlist-item active" data-track="0">🌙 Moonlight Serenade - Aurora Sagrada</div>
                    <div class="playlist-item" data-track="1">⭐ Stellar Dreams - Aurora Sagrada</div>
                    <div class="playlist-item" data-track="2">💎 Crystal Meditation - Aurora Sagrada</div>
                    <div class="playlist-item" data-track="3">🌲 Forest Whispers - Aurora Sagrada</div>
                    <div class="playlist-item" data-track="4">🌌 Cosmic Dance - Aurora Sagrada</div>
                    <div class="playlist-item" data-track="5">🔥 Phoenix Rising - Aurora Sagrada</div>
                </div>
            </div>

            <!-- Painel Administrativo -->
            <div class="admin-section">
                <h4 style="margin: 0 0 10px 0; font-size: 12px;">🔧 Painel Administrativo</h4>
                <button class="admin-btn" onclick="auroraPlayer.addTrack()">➕ Adicionar</button>
                <button class="admin-btn" onclick="auroraPlayer.removeTrack()">➖ Remover</button>
                <button class="admin-btn" onclick="auroraPlayer.editPlaylist()">✏️ Editar</button>
                <button class="admin-btn" onclick="auroraPlayer.savePlaylist()">💾 Salvar</button>
            </div>
        </div>
    </div>

    <!-- Janela Witch.TV -->
    <div class="window witch-tv" id="witch-tv-window">
        <div class="window-header">
            <span class="window-title">📺 Witch.TV - Streaming Místico</span>
            <div class="window-controls">
                <button class="window-btn" onclick="minimizeWindow('witch-tv-window')">_</button>
                <button class="window-btn" onclick="closeWindow('witch-tv-window')">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="tv-screen" id="tv-screen">
                <div class="tv-static"></div>
                <div class="tv-content" id="tv-content">
                    🌙 Canal Lunar - Meditações Noturnas 🌙
                </div>
            </div>
            <div class="channel-list">
                <h4 style="margin: 0 0 10px 0; font-size: 12px;">📡 Canais Místicos</h4>
                <div class="channel-item active" data-channel="0">
                    <span>🌙 Canal Lunar</span>
                    <span>AO VIVO</span>
                </div>
                <div class="channel-item" data-channel="1">
                    <span>🔮 Oráculos & Profecias</span>
                    <span>24h</span>
                </div>
                <div class="channel-item" data-channel="2">
                    <span>🌿 Herbalismo Sagrado</span>
                    <span>HD</span>
                </div>
                <div class="channel-item" data-channel="3">
                    <span>⭐ Astrologia Avançada</span>
                    <span>PREMIUM</span>
                </div>
                <div class="channel-item" data-channel="4">
                    <span>🧙‍♀️ Escola de Magia</span>
                    <span>NOVO</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Janela Tarô -->
    <div class="window tarot-app" id="tarot-window">
        <div class="window-header">
            <span class="window-title">🔮 Tarô Místico - Consulta das Cartas</span>
            <div class="window-controls">
                <button class="window-btn" onclick="minimizeWindow('tarot-window')">_</button>
                <button class="window-btn" onclick="closeWindow('tarot-window')">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="tarot-spread" id="tarot-spread">
                <div class="tarot-card" data-card="0">🂠</div>
                <div class="tarot-card" data-card="1">🂠</div>
                <div class="tarot-card" data-card="2">🂠</div>
            </div>
            <div class="tarot-reading" id="tarot-reading">
                <h4>🔮 Consulta de Três Cartas</h4>
                <p>Clique nas cartas para revelar sua leitura sobre Passado, Presente e Futuro.</p>
                <p><strong>Concentre-se em sua pergunta...</strong></p>
            </div>
        </div>
    </div>

    <!-- Janela Livros Interativos -->
    <div class="window books-app" id="books-window">
        <div class="window-header">
            <span class="window-title">📚 Biblioteca Mística - Livros Interativos</span>
            <div class="window-controls">
                <button class="window-btn" onclick="minimizeWindow('books-window')">_</button>
                <button class="window-btn" onclick="closeWindow('books-window')">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="book-shelf">
                <div class="book-spine" data-book="0">Grimório das Sombras</div>
                <div class="book-spine" data-book="1">Herbário Sagrado</div>
                <div class="book-spine" data-book="2">Cristais & Energias</div>
                <div class="book-spine" data-book="3">Rituais Lunares</div>
                <div class="book-spine" data-book="4">Alquimia Moderna</div>
                <div class="book-spine" data-book="5">Runas Antigas</div>
                <div class="book-spine" data-book="6">Chakras & Auras</div>
                <div class="book-spine" data-book="7">Magia Elemental</div>
            </div>
            <div class="book-content" id="book-content">
                <h4>📖 Biblioteca Mística</h4>
                <p>Bem-vindo à biblioteca de conhecimentos esotéricos!</p>
                <p>Clique em qualquer livro da estante para começar sua jornada de aprendizado místico.</p>
                <p><em>Cada livro contém sabedoria ancestral e práticas modernas.</em></p>
            </div>
        </div>
    </div>

    <!-- Janela AFAST! -->
    <div class="window afast-app" id="afast-window">
        <div class="window-header">
            <span class="window-title">🗣️ AFAST! - Assistente de Fala Avançado</span>
            <div class="window-controls">
                <button class="window-btn" onclick="minimizeWindow('afast-window')">_</button>
                <button class="window-btn" onclick="closeWindow('afast-window')">×</button>
            </div>
        </div>
        <div class="window-content">
            <div class="speech-area" id="speech-area">
                > AFÁSTE v2.0 - Sistema de Reconhecimento de Voz Iniciado
                > Bem vindo ao AFÁSTE
                > Aguardando comando de voz...
                > Digite 'help' para ver comandos disponíveis
            </div>
            <div class="speech-controls">
                <button class="speech-btn" id="record-btn" onclick="afastApp.toggleRecording()">🎤 Gravar</button>
                <button class="speech-btn" onclick="afastApp.playback()">🔊 Reproduzir</button>
                <button class="speech-btn" onclick="afastApp.clearLog()">🗑️ Limpar</button>
                <button class="speech-btn" onclick="afastApp.showHelp()">❓ Ajuda</button>
            </div>
        </div>
    </div>

    <script>
        // === SISTEMA PRINCIPAL ===
        class AuroraOS {
            constructor() {
                this.windows = new Map();
                this.zIndex = 1000;
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateClock();
                this.updateAstroInfo();
                setInterval(() => this.updateClock(), 1000);
            }

            setupEventListeners() {
                // Boot screen
                document.getElementById('boot-screen').addEventListener('click', () => this.startBoot());
                
                // Desktop icons
                document.querySelectorAll('.desktop-icon').forEach(icon => {
                    icon.addEventListener('dblclick', (e) => {
                        const app = e.currentTarget.dataset.app;
                        this.openApp(app);
                    });
                });
            }

            startBoot() {
                const bootScreen = document.getElementById('boot-screen');
                const desktop = document.getElementById('desktop');
                const progressFill = document.getElementById('boot-progress');
                const statusText = document.getElementById('boot-status');
                
                // Iniciar sons nostálgicos
                this.playBootSounds();
                
                // Mensagens de status do Windows ME
                const bootMessages = [
                    'Inicializando sistema...',
                    'Carregando drivers de dispositivo...',
                    'Verificando memória...',
                    'Inicializando serviços místicos...',
                    'Carregando interface gráfica...',
                    'Conectando com planos astrais...',
                    'Ativando proteções mágicas...',
                    'Sistema pronto!'
                ];
                
                let progress = 0;
                let messageIndex = 0;
                
                const bootInterval = setInterval(() => {
                    progress += Math.random() * 12 + 3; // Progresso mais realista
                    progressFill.style.width = Math.min(progress, 100) + '%';
                    
                    // Atualizar mensagem de status
                    if (messageIndex < bootMessages.length && progress > (messageIndex + 1) * 12.5) {
                        statusText.textContent = bootMessages[messageIndex];
                        messageIndex++;
                    }
                    
                    // Adicionar ruídos de TV antiga ocasionalmente
                    if (Math.random() < 0.2) {
                        this.playTVStatic();
                    }
                    
                    if (progress >= 100) {
                        clearInterval(bootInterval);
                        statusText.textContent = 'Sistema pronto!';
                        setTimeout(() => {
                            bootScreen.style.display = 'none';
                            desktop.classList.add('active');
                            // Som de conclusão
                            this.playBootComplete();
                            // Inicializar sistema de notificações MSN
                            initializeMSNSystem();
                        }, 1500);
                    }
                }, 300);
            }
            
            // Função para reproduzir sons de boot nostálgicos
            playBootSounds() {
                // Som de dial-up da internet
                this.playDialUpSound();
                
                // Ruído de TV antiga
                setTimeout(() => this.playTVStatic(), 500);
                setTimeout(() => this.playTVStatic(), 1500);
                setTimeout(() => this.playTVStatic(), 2500);
            }
            
            // Som de dial-up sintetizado
            playDialUpSound() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    
                    // Sequência de tons do dial-up
                    const dialUpSequence = [
                        { freq: 2100, duration: 0.3 },
                        { freq: 1800, duration: 0.2 },
                        { freq: 1200, duration: 0.4 },
                        { freq: 2400, duration: 0.3 },
                        { freq: 1650, duration: 0.5 },
                        { freq: 300, duration: 0.2 },
                        { freq: 3000, duration: 0.3 }
                    ];
                    
                    let currentTime = audioContext.currentTime;
                    
                    dialUpSequence.forEach((tone, index) => {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        oscillator.frequency.setValueAtTime(tone.freq, currentTime);
                        oscillator.type = 'square';
                        
                        gainNode.gain.setValueAtTime(0, currentTime);
                        gainNode.gain.linearRampToValueAtTime(0.1, currentTime + 0.01);
                        gainNode.gain.linearRampToValueAtTime(0, currentTime + tone.duration);
                        
                        oscillator.start(currentTime);
                        oscillator.stop(currentTime + tone.duration);
                        
                        currentTime += tone.duration + 0.1;
                    });
                } catch (e) {
                    console.log('Áudio não suportado:', e);
                }
            }
            
            // Som de TV antiga com ruído
            playTVStatic() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const bufferSize = audioContext.sampleRate * 0.1; // 0.1 segundos
                    const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
                    const data = buffer.getChannelData(0);
                    
                    // Gerar ruído branco
                    for (let i = 0; i < bufferSize; i++) {
                        data[i] = (Math.random() * 2 - 1) * 0.05; // Volume baixo
                    }
                    
                    const source = audioContext.createBufferSource();
                    const gainNode = audioContext.createGain();
                    
                    source.buffer = buffer;
                    source.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    gainNode.gain.setValueAtTime(0.02, audioContext.currentTime);
                    
                    source.start();
                } catch (e) {
                    console.log('Áudio não suportado:', e);
                }
            }
            
            // Som de conclusão do boot
            playBootComplete() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    
                    // Acorde de conclusão (estilo Windows)
                    const notes = [523.25, 659.25, 783.99, 1046.50]; // C5, E5, G5, C6
                    
                    notes.forEach((freq, index) => {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                        oscillator.type = 'sine';
                        
                        const startTime = audioContext.currentTime + (index * 0.1);
                        
                        gainNode.gain.setValueAtTime(0, startTime);
                        gainNode.gain.linearRampToValueAtTime(0.1, startTime + 0.01);
                        gainNode.gain.exponentialRampToValueAtTime(0.001, startTime + 1);
                        
                        oscillator.start(startTime);
                        oscillator.stop(startTime + 1);
                    });
                } catch (e) {
                    console.log('Áudio não suportado:', e);
                }
            }

            updateClock() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                document.getElementById('clock').textContent = timeString;
            }

            updateAstroInfo() {
                const now = new Date();
                
                // Data atual
                const currentDateEl = document.getElementById('current-date');
                if (currentDateEl) {
                    currentDateEl.textContent = now.toLocaleDateString('pt-BR');
                }
                
                // Signo solar (simplificado)
                const solarSign = this.getSolarSign(now);
                const solarSignEl = document.getElementById('solar-sign');
                if (solarSignEl) {
                    solarSignEl.textContent = solarSign;
                }
                
                // Fase lunar (simplificada)
                const lunarPhase = this.getLunarPhase(now);
                const lunarPhaseEl = document.getElementById('lunar-phase');
                if (lunarPhaseEl) {
                    lunarPhaseEl.textContent = lunarPhase;
                }
                
                // Deusa do dia
                const goddess = this.getGoddessOfDay(now);
                const goddessEl = document.getElementById('goddess-day');
                if (goddessEl) {
                    goddessEl.textContent = goddess;
                }
            }

            getSolarSign(date) {
                const month = date.getMonth() + 1;
                const day = date.getDate();
                
                const signs = [
                    'Capricórnio', 'Aquário', 'Peixes', 'Áries', 'Touro', 'Gêmeos',
                    'Câncer', 'Leão', 'Virgem', 'Libra', 'Escorpião', 'Sagitário'
                ];
                
                // Simplificado - baseado no mês
                return signs[month - 1];
            }

            getLunarPhase(date) {
                // Cálculo mais preciso da fase lunar
                // Baseado no ciclo lunar de 29.53 dias
                const lunarCycle = 29.53058867; // dias
                
                // Data de referência para lua nova conhecida (1 de janeiro de 2000)
                const referenceDate = new Date(2000, 0, 6, 18, 14); // 6 de janeiro de 2000, 18:14 UTC
                
                // Diferença em milissegundos
                const diffMs = date.getTime() - referenceDate.getTime();
                const diffDays = diffMs / (1000 * 60 * 60 * 24);
                
                // Posição no ciclo lunar (0-1)
                const lunarAge = (diffDays % lunarCycle) / lunarCycle;
                
                // Determinar fase baseada na idade lunar
                if (lunarAge < 0.0625) return 'Nova';
                else if (lunarAge < 0.1875) return 'Crescente';
                else if (lunarAge < 0.3125) return 'Quarto Crescente';
                else if (lunarAge < 0.4375) return 'Gibosa Crescente';
                else if (lunarAge < 0.5625) return 'Cheia';
                else if (lunarAge < 0.6875) return 'Gibosa Minguante';
                else if (lunarAge < 0.8125) return 'Quarto Minguante';
                else if (lunarAge < 0.9375) return 'Minguante';
                else return 'Nova';
            }

            getGoddessOfDay(date) {
                const goddesses = [
                    'Brigid', 'Ísis', 'Hécate', 'Atena', 'Artemis', 'Afrodite',
                    'Perséfone', 'Deméter', 'Freya', 'Diana', 'Cerridwen', 'Kali'
                ];
                const month = date.getMonth();
                return goddesses[month];
            }

            openApp(appName) {
                switch(appName) {
                    case 'astromagick':
                        this.openWindow('astromagick-window');
                        this.loadDetailedAstroInfo();
                        break;
                    case 'aurora-player':
                        this.openWindow('aurora-player-window');
                        if (!window.auroraPlayer) {
                            window.auroraPlayer = new AuroraPlayer();
                        }
                        break;
                    case 'witch-tv':
                        this.openWindow('witch-tv-window');
                        if (!window.witchTV) {
                            window.witchTV = new WitchTV();
                        }
                        break;
                    case 'afast':
                        this.openWindow('afast-window');
                        if (!window.afastApp) {
                            window.afastApp = new AFASTApp();
                        }
                        break;
                    case 'tarot':
                        this.openWindow('tarot-window');
                        if (!window.tarotApp) {
                            window.tarotApp = new TarotApp();
                        }
                        break;
                    case 'books':
                        this.openWindow('books-window');
                        if (!window.booksApp) {
                            window.booksApp = new BooksApp();
                        }
                        break;
                }
            }

            openWindow(windowId) {
                const window = document.getElementById(windowId);
                window.classList.add('active');
                window.style.zIndex = ++this.zIndex;
                
                // Posicionar janela
                window.style.left = '100px';
                window.style.top = '100px';
            }

            loadDetailedAstroInfo() {
                const content = document.getElementById('detailed-content');
                if (!content) {
                    console.log('Elemento detailed-content não encontrado');
                    return;
                }
                
                const now = new Date();
                
                content.innerHTML = `
                    <p><strong>Data:</strong> ${now.toLocaleDateString('pt-BR')}</p>
                    <p><strong>Signo Solar:</strong> ${this.getSolarSign(now)}</p>
                    <p><strong>Fase Lunar:</strong> ${this.getLunarPhase(now)}</p>
                    <p><strong>Deusa do Dia:</strong> ${this.getGoddessOfDay(now)}</p>
                    <br>
                    <p><strong>Energia do Dia:</strong> Transformação e renovação espiritual</p>
                    <p><strong>Cristais Recomendados:</strong> Ametista, Quartzo Rosa, Selenita</p>
                    <p><strong>Cores Místicas:</strong> Roxo, Dourado, Prateado</p>
                `;
            }
        }

        // === AURORA PLAYER ===
        class AuroraPlayer {
            constructor() {
                this.playlist = [
                    { title: "Moonlight Serenade", artist: "Aurora Sagrada", duration: "03:45" },
                    { title: "Stellar Dreams", artist: "Aurora Sagrada", duration: "04:12" },
                    { title: "Crystal Meditation", artist: "Aurora Sagrada", duration: "05:30" },
                    { title: "Forest Whispers", artist: "Aurora Sagrada", duration: "03:58" },
                    { title: "Cosmic Dance", artist: "Aurora Sagrada", duration: "04:25" },
                    { title: "Phoenix Rising", artist: "Aurora Sagrada", duration: "06:15" }
                ];
                this.currentTrack = 0;
                this.isPlaying = false;
                this.isShuffled = false;
                this.isRepeating = false;
                this.volume = 75;
                this.currentTime = 0;
                this.init();
            }

            init() {
                this.updateDisplay();
                this.setupEventListeners();
                this.startTimeSimulation();
            }

            setupEventListeners() {
                // Volume slider
                const volumeSlider = document.getElementById('volume-slider');
                if (volumeSlider) {
                    volumeSlider.addEventListener('input', (e) => {
                        this.volume = e.target.value;
                        document.getElementById('volume-display').textContent = this.volume + '%';
                    });
                }

                // Playlist items
                document.querySelectorAll('.playlist-item').forEach((item, index) => {
                    item.addEventListener('click', () => {
                        this.selectTrack(index);
                    });
                });
            }

            togglePlay() {
                this.isPlaying = !this.isPlaying;
                const playBtn = document.getElementById('play-btn');
                playBtn.textContent = this.isPlaying ? '⏸' : '▶';
                
                if (this.isPlaying) {
                    console.log('🎵 Reproduzindo:', this.playlist[this.currentTrack].title);
                } else {
                    console.log('⏸ Pausado');
                }
            }

            previousTrack() {
                this.currentTrack = this.currentTrack > 0 ? this.currentTrack - 1 : this.playlist.length - 1;
                this.updateDisplay();
                this.resetTime();
            }

            nextTrack() {
                if (this.isShuffled) {
                    this.currentTrack = Math.floor(Math.random() * this.playlist.length);
                } else {
                    this.currentTrack = (this.currentTrack + 1) % this.playlist.length;
                }
                this.updateDisplay();
                this.resetTime();
            }

            selectTrack(index) {
                this.currentTrack = index;
                this.updateDisplay();
                this.resetTime();
                
                // Atualizar playlist visual
                document.querySelectorAll('.playlist-item').forEach((item, i) => {
                    item.classList.toggle('active', i === index);
                });
            }

            toggleShuffle() {
                this.isShuffled = !this.isShuffled;
                const shuffleBtn = document.getElementById('shuffle-btn');
                shuffleBtn.style.background = this.isShuffled ? 
                    'linear-gradient(180deg, #ffff00 0%, #ffa500 100%)' : 
                    'linear-gradient(180deg, #c0c0c0 0%, #808080 100%)';
                console.log('🔀 Shuffle:', this.isShuffled ? 'Ativado' : 'Desativado');
            }

            toggleRepeat() {
                this.isRepeating = !this.isRepeating;
                const repeatBtn = document.getElementById('repeat-btn');
                repeatBtn.style.background = this.isRepeating ? 
                    'linear-gradient(180deg, #ffff00 0%, #ffa500 100%)' : 
                    'linear-gradient(180deg, #c0c0c0 0%, #808080 100%)';
                console.log('🔁 Repeat:', this.isRepeating ? 'Ativado' : 'Desativado');
            }

            updateDisplay() {
                const track = this.playlist[this.currentTrack];
                document.getElementById('current-track').textContent = 
                    `♪ ${track.artist} - ${track.title} ♪`;
            }

            resetTime() {
                this.currentTime = 0;
                this.updateTimeDisplay();
            }

            updateTimeDisplay() {
                const track = this.playlist[this.currentTrack];
                const currentMin = Math.floor(this.currentTime / 60);
                const currentSec = Math.floor(this.currentTime % 60);
                const timeString = `${currentMin.toString().padStart(2, '0')}:${currentSec.toString().padStart(2, '0')} / ${track.duration}`;
                document.getElementById('track-time').textContent = timeString;
            }

            startTimeSimulation() {
                setInterval(() => {
                    if (this.isPlaying) {
                        this.currentTime += 1;
                        this.updateTimeDisplay();
                        
                        // Simular fim da música
                        const trackDuration = this.playlist[this.currentTrack].duration.split(':');
                        const totalSeconds = parseInt(trackDuration[0]) * 60 + parseInt(trackDuration[1]);
                        
                        if (this.currentTime >= totalSeconds) {
                            if (this.isRepeating) {
                                this.resetTime();
                            } else {
                                this.nextTrack();
                            }
                        }
                    }
                }, 1000);
            }

            // Funções administrativas
            addTrack() {
                const title = prompt('Nome da música:');
                const artist = prompt('Artista:') || 'Aurora Sagrada';
                const duration = prompt('Duração (mm:ss):') || '04:00';
                
                if (title) {
                    this.playlist.push({ title, artist, duration });
                    this.refreshPlaylist();
                    alert('🎵 Música adicionada com sucesso!');
                }
            }

            removeTrack() {
                if (this.playlist.length > 1) {
                    const index = prompt(`Remover música (0-${this.playlist.length - 1}):`);
                    if (index !== null && index >= 0 && index < this.playlist.length) {
                        this.playlist.splice(index, 1);
                        if (this.currentTrack >= this.playlist.length) {
                            this.currentTrack = 0;
                        }
                        this.refreshPlaylist();
                        this.updateDisplay();
                        alert('🗑️ Música removida!');
                    }
                } else {
                    alert('❌ Não é possível remover a última música!');
                }
            }

            editPlaylist() {
                alert('✏️ Editor de playlist - Funcionalidade em desenvolvimento!');
            }

            savePlaylist() {
                const playlistData = JSON.stringify(this.playlist, null, 2);
                console.log('💾 Playlist salva:', playlistData);
                alert('💾 Playlist salva com sucesso!');
            }

            refreshPlaylist() {
                const container = document.getElementById('playlist-container');
                container.innerHTML = '';
                
                this.playlist.forEach((track, index) => {
                    const item = document.createElement('div');
                    item.className = 'playlist-item';
                    if (index === this.currentTrack) item.classList.add('active');
                    item.dataset.track = index;
                    item.textContent = `🎵 ${track.title} - ${track.artist}`;
                    item.addEventListener('click', () => this.selectTrack(index));
                    container.appendChild(item);
                });
            }
        }

        // === WITCH.TV ===
        class WitchTV {
            constructor() {
                this.channels = [
                    { name: "🌙 Canal Lunar", content: "Meditações Noturnas", status: "AO VIVO" },
                    { name: "🔮 Oráculos & Profecias", content: "Consultas Místicas", status: "24h" },
                    { name: "🌿 Herbalismo Sagrado", content: "Plantas Medicinais", status: "HD" },
                    { name: "⭐ Astrologia Avançada", content: "Mapas Astrais", status: "PREMIUM" },
                    { name: "🧙‍♀️ Escola de Magia", content: "Curso Básico", status: "NOVO" }
                ];
                this.currentChannel = 0;
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateChannel();
            }

            setupEventListeners() {
                document.querySelectorAll('.channel-item').forEach((item, index) => {
                    item.addEventListener('click', () => {
                        this.switchChannel(index);
                    });
                });
            }

            switchChannel(channelIndex) {
                this.currentChannel = channelIndex;
                this.updateChannel();
                
                // Atualizar lista visual
                document.querySelectorAll('.channel-item').forEach((item, i) => {
                    item.classList.toggle('active', i === channelIndex);
                });
            }

            updateChannel() {
                const channel = this.channels[this.currentChannel];
                const tvContent = document.getElementById('tv-content');
                tvContent.textContent = `${channel.name} - ${channel.content}`;
                console.log('📺 Mudando para:', channel.name);
            }
        }

        // === TARÔ APP ===
        class TarotApp {
            constructor() {
                this.cards = [
                    { name: "O Mago", meaning: "Poder pessoal, manifestação, recursos disponíveis" },
                    { name: "A Sacerdotisa", meaning: "Intuição, mistério, conhecimento oculto" },
                    { name: "A Imperatriz", meaning: "Fertilidade, criatividade, abundância" },
                    { name: "O Imperador", meaning: "Autoridade, estrutura, controle" },
                    { name: "O Hierofante", meaning: "Tradição, conformidade, moralidade" },
                    { name: "Os Amantes", meaning: "Amor, harmonia, relacionamentos" },
                    { name: "O Carro", meaning: "Controle, determinação, direção" },
                    { name: "A Força", meaning: "Força interior, bravura, compaixão" },
                    { name: "O Eremita", meaning: "Busca interior, introspecção, orientação" },
                    { name: "A Roda da Fortuna", meaning: "Boa sorte, karma, ciclos de vida" }
                ];
                this.selectedCards = [];
                this.init();
            }

            init() {
                this.setupEventListeners();
            }

            setupEventListeners() {
                document.querySelectorAll('.tarot-card').forEach((card, index) => {
                    card.addEventListener('click', () => {
                        this.revealCard(index);
                    });
                });
            }

            revealCard(cardIndex) {
                if (this.selectedCards[cardIndex]) return;

                const randomCard = this.cards[Math.floor(Math.random() * this.cards.length)];
                this.selectedCards[cardIndex] = randomCard;

                const cardElement = document.querySelector(`[data-card="${cardIndex}"]`);
                cardElement.classList.add('revealed');
                cardElement.textContent = randomCard.name;

                this.updateReading();
            }

            updateReading() {
                const positions = ['Passado', 'Presente', 'Futuro'];
                const reading = document.getElementById('tarot-reading');
                
                let content = '<h4>🔮 Sua Leitura</h4>';
                
                this.selectedCards.forEach((card, index) => {
                    if (card) {
                        content += `<p><strong>${positions[index]}:</strong> ${card.name}</p>`;
                        content += `<p><em>${card.meaning}</em></p>`;
                    }
                });

                if (this.selectedCards.filter(c => c).length === 0) {
                    content += '<p>Clique nas cartas para revelar sua leitura sobre Passado, Presente e Futuro.</p>';
                }

                reading.innerHTML = content;
            }
        }

        // === LIVROS APP ===
        class BooksApp {
            constructor() {
                this.books = [
                    {
                        title: "Grimório das Sombras",
                        content: "Este antigo grimório contém feitiços e rituais das tradições sombrias. Aprenda sobre proteção, banimento e trabalho com energias densas de forma segura e responsável."
                    },
                    {
                        title: "Herbário Sagrado",
                        content: "Guia completo das plantas sagradas e suas propriedades mágicas. Descubra como usar ervas para cura, proteção, amor e prosperidade em seus rituais."
                    },
                    {
                        title: "Cristais & Energias",
                        content: "Manual prático sobre cristais e pedras preciosas. Aprenda a programar, limpar e usar cristais para amplificar suas intenções e equilibrar chakras."
                    },
                    {
                        title: "Rituais Lunares",
                        content: "Conecte-se com os ciclos lunares através de rituais poderosos. Cada fase da lua oferece oportunidades únicas para manifestação e transformação."
                    },
                    {
                        title: "Alquimia Moderna",
                        content: "A arte da transformação aplicada à vida moderna. Descubra como os princípios alquímicos podem ser usados para crescimento pessoal e espiritual."
                    },
                    {
                        title: "Runas Antigas",
                        content: "Sistema divinatório nórdico com 24 runas. Aprenda o significado de cada símbolo e como usar as runas para orientação e autoconhecimento."
                    },
                    {
                        title: "Chakras & Auras",
                        content: "Guia completo do sistema energético humano. Técnicas para equilibrar chakras, limpar a aura e desenvolver sensibilidade energética."
                    },
                    {
                        title: "Magia Elemental",
                        content: "Trabalhe com os quatro elementos: Terra, Água, Fogo e Ar. Aprenda rituais elementais e como invocar as energias da natureza."
                    }
                ];
                this.init();
            }

            init() {
                this.setupEventListeners();
            }

            setupEventListeners() {
                document.querySelectorAll('.book-spine').forEach((spine, index) => {
                    spine.addEventListener('click', () => {
                        this.openBook(index);
                    });
                });
            }

            openBook(bookIndex) {
                const book = this.books[bookIndex];
                const content = document.getElementById('book-content');
                
                content.innerHTML = `
                    <h4>📖 ${book.title}</h4>
                    <p>${book.content}</p>
                    <br>
                    <p><em>Este é apenas um resumo. O livro completo contém exercícios práticos, rituais detalhados e muito mais conhecimento esotérico.</em></p>
                    <br>
                    <p><strong>Clique em outro livro para continuar explorando a biblioteca!</strong></p>
                `;
                
                console.log('📚 Abrindo livro:', book.title);
            }
        }

        // === AFAST! APP ===
        class AFASTApp {
            constructor() {
                this.isRecording = false;
                this.speechLog = [];
                this.init();
            }

            init() {
                this.addToLog('> AFÁSTE v2.0 - Sistema de Reconhecimento de Voz Iniciado');
                this.addToLog('> Bem vindo ao AFÁSTE');
                this.addToLog('> Aguardando comando de voz...');
                this.addToLog('> Digite "help" para ver comandos disponíveis');
            }

            toggleRecording() {
                this.isRecording = !this.isRecording;
                const recordBtn = document.getElementById('record-btn');
                
                if (this.isRecording) {
                    recordBtn.classList.add('recording');
                    recordBtn.textContent = '⏹️ Parar';
                    this.addToLog('> 🎤 GRAVANDO... Fale agora!');
                    
                    // Simular reconhecimento de voz
                    setTimeout(() => {
                        if (this.isRecording) {
                            this.addToLog('> Reconhecido: "Olá, AFAST!"');
                            this.addToLog('> Resposta: Olá! Como posso ajudá-lo hoje?');
                        }
                    }, 3000);
                } else {
                    recordBtn.classList.remove('recording');
                    recordBtn.textContent = '🎤 Gravar';
                    this.addToLog('> ⏹️ Gravação finalizada');
                }
            }

            playback() {
                this.addToLog('> 🔊 Reproduzindo última gravação...');
                this.addToLog('> "Olá, AFAST! Como você está?"');
            }

            clearLog() {
                const speechArea = document.getElementById('speech-area');
                speechArea.textContent = '';
                this.speechLog = [];
                this.addToLog('> Log limpo - Sistema pronto');
            }

            showHelp() {
                this.addToLog('> === COMANDOS DISPONÍVEIS ===');
                this.addToLog('> 🎤 Gravar - Iniciar/parar gravação de voz');
                this.addToLog('> 🔊 Reproduzir - Tocar última gravação');
                this.addToLog('> 🗑️ Limpar - Limpar histórico');
                this.addToLog('> ❓ Ajuda - Mostrar esta ajuda');
                this.addToLog('> ========================');
            }

            addToLog(message) {
                const speechArea = document.getElementById('speech-area');
                this.speechLog.push(message);
                speechArea.textContent = this.speechLog.join('\n');
                speechArea.scrollTop = speechArea.scrollHeight;
                
                // Reproduzir áudio para mensagens específicas
                this.playAudioForMessage(message);
            }
            
            playAudioForMessage(message) {
                // Tentar reproduzir áudio específico primeiro
                let audioFile = null;
                
                if (message.includes('Bem vindo ao AFÁSTE')) {
                    audioFile = 'audio/bem-vindo-afast.wav';
                } else if (message.includes('Uma ameaça foi detectada')) {
                    audioFile = 'audio/ameaca-detectada.wav';
                }
                
                if (audioFile) {
                    const audio = new Audio(audioFile);
                    audio.volume = 0.7;
                    audio.play().catch(e => {
                        console.log('Erro ao reproduzir áudio específico:', e);
                        // Fallback para síntese de voz
                        this.synthesizeVoice(message);
                    });
                } else {
                    // Usar síntese de voz para outras mensagens
                    this.synthesizeVoice(message);
                }
            }
            
            synthesizeVoice(message) {
                try {
                    // Usar Web Speech API para síntese de voz
                    if ('speechSynthesis' in window) {
                        const utterance = new SpeechSynthesisUtterance();
                        
                        // Limpar texto para síntese
                        let cleanText = message.replace(/[>🎤🔊🗑️❓⏹️]/g, '').trim();
                        
                        // Traduzir algumas mensagens específicas
                        if (cleanText.includes('AFÁSTE')) {
                            cleanText = cleanText.replace('AFÁSTE', 'A-F-A-S-T-E');
                        }
                        
                        utterance.text = cleanText;
                        utterance.lang = 'pt-BR';
                        utterance.rate = 0.9;
                        utterance.pitch = 1.1;
                        utterance.volume = 0.8;
                        
                        // Tentar encontrar voz em português
                        const voices = speechSynthesis.getVoices();
                        const ptVoice = voices.find(voice => 
                            voice.lang.includes('pt') || voice.lang.includes('BR')
                        );
                        
                        if (ptVoice) {
                            utterance.voice = ptVoice;
                        }
                        
                        speechSynthesis.speak(utterance);
                    } else {
                        // Fallback para beep sintético
                        this.playNotificationBeep();
                    }
                } catch (e) {
                    console.log('Erro na síntese de voz:', e);
                    this.playNotificationBeep();
                }
            }
            
            playNotificationBeep() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                } catch (e) {
                    console.log('Erro ao reproduzir beep:', e);
                }
            }
        }

        // Funções globais para janelas
        function closeWindow(windowId) {
            document.getElementById(windowId).classList.remove('active');
        }

        function minimizeWindow(windowId) {
            document.getElementById(windowId).classList.remove('active');
        }

        // Funções AstroMágick Expandido
        function switchAstroTab(tabName) {
            // Remover classe active de todas as abas
            document.querySelectorAll('.astro-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.astro-tab-panel').forEach(panel => {
                panel.classList.remove('active');
            });

            // Ativar aba selecionada
            document.querySelector(`[onclick="switchAstroTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');

            // Mostrar notificação
            showNotification(`🌟 Navegando para aba: ${getTabTitle(tabName)}`);
        }

        function getTabTitle(tabName) {
            const titles = {
                'positions': 'Posições Planetárias',
                'lunar': 'Informações Lunares',
                'transits': 'Trânsitos Importantes',
                'aspects': 'Aspectos Astrológicos',
                'alerts': 'Sistema de Alertas'
            };
            return titles[tabName] || tabName;
        }

        function openCompleteApp() {
            if (confirm('🔮 Deseja abrir a aplicação AstroMágick completa em uma nova janela?')) {
                // Aqui você pode colocar o link para sua ferramenta completa
                showNotification('🔮 Redirecionando para aplicação completa...');
                // window.open('https://seu-site.com/astromagick-completo', '_blank');
            }
        }

        function updateAstroData() {
            showNotification('🔄 Atualizando dados astrológicos...');
            
            // Simular atualização
            setTimeout(() => {
                showNotification('✅ Dados astrológicos atualizados com sucesso!');
                
                // Simular detecção de ameaça astrológica (30% de chance)
                const threatDetected = Math.random() < 0.3;
                
                // Enviar notificação para AFÁSTE se estiver ativo
                if (window.afastApp) {
                    window.afastApp.addToLog('🌟 ALERTA ASTROLÓGICO: Dados atualizados!');
                    window.afastApp.addToLog('🔮 Novas informações planetárias disponíveis.');
                    
                    if (threatDetected) {
                        setTimeout(() => {
                            window.afastApp.addToLog('🚨 Uma ameaça foi detectada');
                            window.afastApp.addToLog('⚠️ Eclipse lunar aproximando-se em 18 dias');
                            window.afastApp.addToLog('🔴 Recomenda-se cautela e preparação espiritual');
                            showNotification('🚨 AFÁSTE: Uma ameaça foi detectada!');
                        }, 2000);
                    }
                }
            }, 1500);
        }

        function detectAstronomicalThreat() {
            if (window.afastApp) {
                window.afastApp.addToLog('🚨 Uma ameaça foi detectada');
                window.afastApp.addToLog('⚠️ Mercúrio retrógrado iniciando em 24 dias');
                window.afastApp.addToLog('🔴 Cuidado com comunicações e tecnologia');
                showNotification('🚨 AFÁSTE: Uma ameaça foi detectada!');
            }
        }

        function showNotification(message) {
            // Criar elemento de notificação
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(180deg, var(--dourado) 0%, #e6a000 100%);
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                font-weight: bold;
                border: 2px outset #f0aa53;
                animation: slideIn 0.3s ease-out;
            `;

            // Adicionar animação CSS
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }

            document.body.appendChild(notification);

            // Remover após 3 segundos
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            window.auroraOS = new AuroraOS();
            
            // Criar orbes flutuantes na tela de boot
            createBootOrbs();
            
            // Inicializar AFÁSTE para notificações (mesmo sem janela aberta)
            if (!window.afastApp) {
                window.afastApp = new AFASTApp();
            }
            
            // Configurar botão Iniciar
            const startButton = document.getElementById('start-button');
            if (startButton) {
                startButton.addEventListener('click', () => {
                    showStartMenu();
                });
            }
            
            // Configurar clique no relógio para abrir calendário astrológico
            const clock = document.getElementById('clock');
            if (clock) {
                clock.addEventListener('click', () => {
                    openAstrologicalCalendar();
                });
                clock.style.cursor = 'pointer';
            }
            
            console.log('🌟 Aurora OS inicializado com sucesso!');
        });
        
        // Função para mostrar menu Iniciar
        function showStartMenu() {
            const apps = [
                { name: 'AstroMágick', id: 'astromagick', icon: '🌙' },
                { name: 'Aurora Player', id: 'aurora-player', icon: '🎵' },
                { name: 'Witch.TV', id: 'witch-tv', icon: '📺' },
                { name: 'AFÁSTE', id: 'afast', icon: '🗣️' },
                { name: 'Tarô Místico', id: 'tarot', icon: '🔮' },
                { name: 'Livros Interativos', id: 'books', icon: '📚' }
            ];
            
            let menuHTML = '<div style="position: fixed; bottom: 60px; left: 10px; background: #c0c0c0; border: 2px outset #c0c0c0; padding: 10px; z-index: 10000; min-width: 200px;">';
            menuHTML += '<div style="font-weight: bold; margin-bottom: 10px; border-bottom: 1px solid #808080; padding-bottom: 5px;">🌟 Aplicações Místicas</div>';
            
            apps.forEach(app => {
                menuHTML += `<div style="padding: 5px; cursor: pointer; hover: background: #0000ff; color: white;" onclick="window.auroraOS.openApp('${app.id}'); closeStartMenu();">${app.icon} ${app.name}</div>`;
            });
            
            menuHTML += '<div style="border-top: 1px solid #808080; margin-top: 10px; padding-top: 5px;">';
            menuHTML += '<div style="padding: 5px; cursor: pointer;" onclick="closeStartMenu();">❌ Fechar</div>';
            menuHTML += '</div></div>';
            
            // Remover menu existente se houver
            const existingMenu = document.getElementById('start-menu');
            if (existingMenu) {
                existingMenu.remove();
            }
            
            // Adicionar novo menu
            const menuDiv = document.createElement('div');
            menuDiv.id = 'start-menu';
            menuDiv.innerHTML = menuHTML;
            document.body.appendChild(menuDiv);
        }
        
        // Função para fechar menu Iniciar
        function closeStartMenu() {
            const menu = document.getElementById('start-menu');
            if (menu) {
                menu.remove();
            }
        }
        
        // Função para abrir calendário astrológico
        function openAstrologicalCalendar() {
            // Remover calendário existente se houver
            const existingCalendar = document.getElementById('astrological-calendar');
            if (existingCalendar) {
                existingCalendar.remove();
                return;
            }
            
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            createCalendarWindow(currentMonth, currentYear);
        }
        
        // Função para criar janela do calendário
        function createCalendarWindow(month, year) {
            const monthNames = [
                'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            
            const calendarHTML = `
                <div id="astrological-calendar" style="
                    position: fixed;
                    top: 50px;
                    right: 50px;
                    width: 600px;
                    height: 500px;
                    background: #c0c0c0;
                    border: 2px outset #c0c0c0;
                    z-index: 10000;
                    font-family: 'MS Sans Serif', sans-serif;
                ">
                    <div style="
                        background: linear-gradient(90deg, #0000ff, #000080);
                        color: white;
                        padding: 8px;
                        font-weight: bold;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    ">
                        <span>🌙 Calendário Astrológico - ${monthNames[month]} ${year}</span>
                        <button onclick="closeAstrologicalCalendar()" style="
                            background: #c0c0c0;
                            border: 1px outset #c0c0c0;
                            width: 20px;
                            height: 20px;
                            cursor: pointer;
                        ">×</button>
                    </div>
                    <div style="padding: 10px; height: calc(100% - 40px); overflow-y: auto;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <button onclick="changeMonth(${month - 1}, ${year})" style="
                                background: #c0c0c0;
                                border: 1px outset #c0c0c0;
                                padding: 5px 10px;
                                cursor: pointer;
                            ">◀ Anterior</button>
                            <span style="font-weight: bold; font-size: 16px;">${monthNames[month]} ${year}</span>
                            <button onclick="changeMonth(${month + 1}, ${year})" style="
                                background: #c0c0c0;
                                border: 1px outset #c0c0c0;
                                padding: 5px 10px;
                                cursor: pointer;
                            ">Próximo ▶</button>
                        </div>
                        ${generateCalendarGrid(month, year)}
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', calendarHTML);
        }
        
        // Função para gerar grade do calendário
        function generateCalendarGrid(month, year) {
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            
            let html = `
                <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; margin-bottom: 10px;">
                    <div style="text-align: center; font-weight: bold; background: #808080; color: white; padding: 5px;">Dom</div>
                    <div style="text-align: center; font-weight: bold; background: #808080; color: white; padding: 5px;">Seg</div>
                    <div style="text-align: center; font-weight: bold; background: #808080; color: white; padding: 5px;">Ter</div>
                    <div style="text-align: center; font-weight: bold; background: #808080; color: white; padding: 5px;">Qua</div>
                    <div style="text-align: center; font-weight: bold; background: #808080; color: white; padding: 5px;">Qui</div>
                    <div style="text-align: center; font-weight: bold; background: #808080; color: white; padding: 5px;">Sex</div>
                    <div style="text-align: center; font-weight: bold; background: #808080; color: white; padding: 5px;">Sáb</div>
            `;
            
            // Células vazias antes do primeiro dia
            for (let i = 0; i < firstDay; i++) {
                html += '<div style="padding: 10px;"></div>';
            }
            
            // Dias do mês
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = today.getDate() === day && today.getMonth() === month && today.getFullYear() === year;
                const dayData = getAstrologicalDataForDay(year, month, day);
                
                html += `
                    <div onclick="showDayDetails(${year}, ${month}, ${day})" style="
                        padding: 8px;
                        text-align: center;
                        cursor: pointer;
                        background: ${isToday ? '#ffff00' : '#ffffff'};
                        border: 1px solid #808080;
                        min-height: 40px;
                        position: relative;
                    ">
                        <div style="font-weight: bold;">${day}</div>
                        <div style="font-size: 10px; color: #666;">${dayData.moonPhase}</div>
                        <div style="font-size: 8px; color: #333;">${dayData.energy}</div>
                    </div>
                `;
            }
            
            html += '</div>';
            return html;
        }
        
        // Função para obter dados astrológicos do dia
        function getAstrologicalDataForDay(year, month, day) {
            const date = new Date(year, month, day);
            const dayOfYear = Math.floor((date - new Date(year, 0, 0)) / 86400000);
            
            // Cálculo simplificado da fase lunar
            const lunarCycle = 29.53;
            const knownNewMoon = new Date(2024, 0, 11); // 11 de janeiro de 2024
            const daysSinceNewMoon = Math.floor((date - knownNewMoon) / 86400000);
            const lunarPhase = (daysSinceNewMoon % lunarCycle) / lunarCycle;
            
            let moonPhase, energy;
            if (lunarPhase < 0.125) {
                moonPhase = '🌑';
                energy = 'Novo';
            } else if (lunarPhase < 0.375) {
                moonPhase = '🌓';
                energy = 'Cresc';
            } else if (lunarPhase < 0.625) {
                moonPhase = '🌕';
                energy = 'Cheia';
            } else if (lunarPhase < 0.875) {
                moonPhase = '🌗';
                energy = 'Ming';
            } else {
                moonPhase = '🌑';
                energy = 'Novo';
            }
            
            return { moonPhase, energy };
        }
        
        // Função para mostrar detalhes do dia
        function showDayDetails(year, month, day) {
            const date = new Date(year, month, day);
            const dayData = getDetailedAstrologicalData(date);
            
            const detailsHTML = `
                <div id="day-details" style="
                    position: fixed;
                    top: 100px;
                    left: 100px;
                    width: 500px;
                    max-height: 600px;
                    background: #c0c0c0;
                    border: 2px outset #c0c0c0;
                    z-index: 10001;
                    overflow-y: auto;
                ">
                    <div style="
                        background: linear-gradient(90deg, #800080, #400040);
                        color: white;
                        padding: 8px;
                        font-weight: bold;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    ">
                        <span>🔮 ${day}/${month + 1}/${year} - Informações Místicas</span>
                        <button onclick="closeDayDetails()" style="
                            background: #c0c0c0;
                            border: 1px outset #c0c0c0;
                            width: 20px;
                            height: 20px;
                            cursor: pointer;
                        ">×</button>
                    </div>
                    <div style="padding: 15px; font-size: 12px;">
                        <h3 style="margin: 0 0 10px 0; color: #800080;">🌙 Informações Lunares</h3>
                        <p><strong>Fase:</strong> ${dayData.moonPhase} ${dayData.moonPhaseName}</p>
                        <p><strong>Mansão Lunar:</strong> ${dayData.lunarMansion}</p>
                        <p><strong>Energia:</strong> ${dayData.lunarEnergy}</p>
                        
                        <h3 style="margin: 15px 0 10px 0; color: #800080;">⚡ Trânsitos Planetários</h3>
                        <p>${dayData.transits}</p>
                        
                        <h3 style="margin: 15px 0 10px 0; color: #800080;">🔮 Correspondências Místicas</h3>
                        <p><strong>Invocação:</strong> ${dayData.invocation}</p>
                        <p><strong>Mantra:</strong> ${dayData.mantra}</p>
                        <p><strong>Runa:</strong> ${dayData.rune}</p>
                        <p><strong>Carta de Tarô:</strong> ${dayData.tarotCard}</p>
                        
                        <h3 style="margin: 15px 0 10px 0; color: #800080;">🌿 Correspondências Naturais</h3>
                        <p><strong>Ervas:</strong> ${dayData.herbs}</p>
                        <p><strong>Cristais:</strong> ${dayData.crystals}</p>
                        
                        <h3 style="margin: 15px 0 10px 0; color: #800080;">✨ Uso Mágico</h3>
                        <p><strong>Favorável:</strong> ${dayData.favorableMagic}</p>
                        <p><strong>Desfavorável:</strong> ${dayData.unfavorableMagic}</p>
                    </div>
                </div>
            `;
            
            // Remover detalhes existentes
            const existing = document.getElementById('day-details');
            if (existing) existing.remove();
            
            document.body.insertAdjacentHTML('beforeend', detailsHTML);
        }
        
        // Função para obter dados astrológicos detalhados
        function getDetailedAstrologicalData(date) {
            const day = date.getDate();
            const month = date.getMonth();
            
            // Arrays de correspondências místicas
            const lunarMansions = [
                "Al-Sharatain (O Signo)", "Al-Butain (O Ventre)", "Al-Thurayya (As Plêiades)",
                "Al-Dabaran (O Seguidor)", "Al-Haq'ah (A Marca Branca)", "Al-Han'ah (A Marca)",
                "Al-Dhira (O Braço)", "Al-Nathrah (A Ponta do Nariz)", "Al-Tarf (O Olhar)",
                "Al-Jabhah (A Testa)", "Al-Zubrah (A Juba)", "Al-Sarfah (O Mudador)",
                "Al-Awwa (O Ladrador)", "Al-Simak (O Desarmado)", "Al-Ghafr (A Cobertura)",
                "Al-Zubana (As Garras)", "Al-Iklil (A Coroa)", "Al-Qalb (O Coração)",
                "Al-Shaulah (O Ferrão)", "Al-Na'am (As Avestruzes)", "Al-Baldah (A Cidade)",
                "Sa'd al-Dhabih (A Sorte do Matador)", "Sa'd Bula (A Sorte do Engolidor)",
                "Sa'd al-Su'ud (A Sorte das Sortes)", "Sa'd al-Akhbiyah (A Sorte das Tendas)",
                "Al-Fargh al-Mukdim (O Primeiro Balde)", "Al-Fargh al-Thani (O Segundo Balde)",
                "Batn al-Hut (O Ventre do Peixe)"
            ];
            
            const invocations = [
                "Que a luz da Lua ilumine meu caminho",
                "Pelos poderes dos elementos, eu invoco proteção",
                "Que as estrelas guiem minha jornada",
                "Pela sabedoria ancestral, eu busco conhecimento",
                "Que a energia cósmica flua através de mim"
            ];
            
            const mantras = [
                "Om Mani Padme Hum", "So Hum", "Om Gam Ganapataye Namaha",
                "Om Shanti Shanti Shanti", "Gate Gate Paragate Parasamgate Bodhi Svaha"
            ];
            
            const runes = [
                "ᚠ Fehu (Riqueza)", "ᚢ Uruz (Força)", "ᚦ Thurisaz (Gigante)",
                "ᚨ Ansuz (Deus)", "ᚱ Raidho (Jornada)", "ᚲ Kenaz (Tocha)",
                "ᚷ Gebo (Presente)", "ᚹ Wunjo (Alegria)", "ᚺ Hagalaz (Granizo)"
            ];
            
            const tarotCards = [
                "O Louco", "O Mago", "A Sacerdotisa", "A Imperatriz", "O Imperador",
                "O Hierofante", "Os Amantes", "A Carruagem", "A Força", "O Eremita"
            ];
            
            const herbs = [
                "Lavanda, Alecrim, Sálvia", "Manjericão, Hortelã, Tomilho",
                "Camomila, Melissa, Erva-cidreira", "Artemísia, Arruda, Guiné",
                "Rosa, Jasmim, Ylang-ylang"
            ];
            
            const crystals = [
                "Quartzo Rosa, Ametista, Cristal", "Obsidiana, Hematita, Turmalina Negra",
                "Citrino, Pirita, Olho de Tigre", "Sodalita, Lápis Lazúli, Amazonita",
                "Selenita, Moonstone, Labradorita"
            ];
            
            // Cálculos baseados na data
            const dayIndex = day % 5;
            const monthIndex = month % 28;
            
            // Determinar fase lunar
            const lunarCycle = 29.53;
            const knownNewMoon = new Date(2024, 0, 11);
            const daysSinceNewMoon = Math.floor((date - knownNewMoon) / 86400000);
            const lunarPhase = (daysSinceNewMoon % lunarCycle) / lunarCycle;
            
            let moonPhase, moonPhaseName, lunarEnergy;
            if (lunarPhase < 0.125) {
                moonPhase = '🌑';
                moonPhaseName = 'Lua Nova';
                lunarEnergy = 'Novos começos, intenções, plantio de sementes';
            } else if (lunarPhase < 0.375) {
                moonPhase = '🌓';
                moonPhaseName = 'Lua Crescente';
                lunarEnergy = 'Crescimento, expansão, manifestação';
            } else if (lunarPhase < 0.625) {
                moonPhase = '🌕';
                moonPhaseName = 'Lua Cheia';
                lunarEnergy = 'Plenitude, poder máximo, realização';
            } else if (lunarPhase < 0.875) {
                moonPhase = '🌗';
                moonPhaseName = 'Lua Minguante';
                lunarEnergy = 'Liberação, limpeza, banimento';
            } else {
                moonPhase = '🌑';
                moonPhaseName = 'Lua Nova';
                lunarEnergy = 'Novos começos, intenções, plantio de sementes';
            }
            
            return {
                moonPhase,
                moonPhaseName,
                lunarMansion: lunarMansions[monthIndex],
                lunarEnergy,
                transits: "Sol em trânsito harmonioso com Júpiter, Vênus em aspecto favorável com Lua",
                invocation: invocations[dayIndex],
                mantra: mantras[dayIndex],
                rune: runes[dayIndex],
                tarotCard: tarotCards[dayIndex],
                herbs: herbs[dayIndex],
                crystals: crystals[dayIndex],
                favorableMagic: "Rituais de amor, prosperidade, proteção, cura espiritual",
                unfavorableMagic: "Maldições, trabalhos destrutivos, magia negra"
            };
        }
        
        // Função para mudar mês
        function changeMonth(newMonth, newYear) {
            if (newMonth < 0) {
                newMonth = 11;
                newYear--;
            } else if (newMonth > 11) {
                newMonth = 0;
                newYear++;
            }
            
            closeAstrologicalCalendar();
            createCalendarWindow(newMonth, newYear);
        }
        
        // Função para fechar calendário
        function closeAstrologicalCalendar() {
            const calendar = document.getElementById('astrological-calendar');
            if (calendar) calendar.remove();
        }
        
        // Função para fechar detalhes do dia
        function closeDayDetails() {
            const details = document.getElementById('day-details');
            if (details) details.remove();
        }
        
        // Função para criar orbes flutuantes na tela de boot
        function createBootOrbs() {
            const orbsContainer = document.getElementById('boot-orbs');
            if (!orbsContainer) return;
            
            // Criar 15 orbes com posições e delays aleatórios
            for (let i = 0; i < 15; i++) {
                const orb = document.createElement('div');
                orb.className = 'boot-orb';
                
                // Posição horizontal aleatória
                orb.style.left = Math.random() * 100 + '%';
                
                // Delay aleatório para animação
                orb.style.animationDelay = Math.random() * 8 + 's';
                
                // Tamanho ligeiramente variado
                const size = 3 + Math.random() * 3;
                orb.style.width = size + 'px';
                orb.style.height = size + 'px';
                
                // Cores variadas (dourado, branco, roxo)
                const colors = [
                    'rgba(255, 215, 0, 0.8)',
                    'rgba(255, 255, 255, 0.6)',
                    'rgba(138, 43, 226, 0.7)'
                ];
                const color = colors[Math.floor(Math.random() * colors.length)];
                orb.style.background = `radial-gradient(circle, ${color} 0%, transparent 70%)`;
                
                orbsContainer.appendChild(orb);
            }
        }

        // === SISTEMA DE NOTIFICAÇÕES MSN ===
        class MSNNotificationSystem {
            constructor() {
                this.container = document.getElementById('msn-notifications-container');
                this.notifications = [];
                this.notificationId = 0;
            }

            showNotification(title, message, icon = '🔮', type = 'astrological') {
                const notification = this.createNotification(title, message, icon, type);
                this.container.appendChild(notification);
                
                // Animar entrada
                setTimeout(() => {
                    notification.classList.add('show');
                }, 100);
                
                // Reproduzir voz feminina robótica
                this.speakNotification(title, message, type);
                
                // Auto-remover após 8 segundos
                setTimeout(() => {
                    this.hideNotification(notification);
                }, 8000);
                
                return notification;
            }

            createNotification(title, message, icon, type) {
                const notification = document.createElement('div');
                notification.className = 'msn-notification';
                notification.id = `msn-notification-${this.notificationId++}`;
                
                const now = new Date();
                const timeStr = now.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                notification.innerHTML = `
                    <div class="msn-header">
                        <span>AFÁSTE - Sistema de Alertas</span>
                        <button class="msn-close" onclick="msnSystem.hideNotification(this.closest('.msn-notification'))">×</button>
                    </div>
                    <div class="msn-content">
                        <div class="msn-icon">${icon}</div>
                        <div class="msn-text">
                            <div class="msn-title">${title}</div>
                            <div class="msn-message">${message}</div>
                            <div class="msn-time">${timeStr}</div>
                        </div>
                    </div>
                `;
                
                return notification;
            }

            hideNotification(notification) {
                notification.classList.add('hide');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 500);
            }

            speakNotification(title, message, type) {
                try {
                    if ('speechSynthesis' in window) {
                        // Cancelar qualquer fala anterior
                        speechSynthesis.cancel();
                        
                        const utterance = new SpeechSynthesisUtterance();
                        
                        // Texto robótico estilo AVAST
                        let roboticText = '';
                        
                        switch(type) {
                            case 'astrological':
                                roboticText = `Alerta astrológico detectado. ${title}. ${message}`;
                                break;
                            case 'threat':
                                roboticText = `Ameaça cósmica identificada. ${title}. Ação recomendada: ${message}`;
                                break;
                            case 'lunar':
                                roboticText = `Evento lunar detectado. ${title}. ${message}`;
                                break;
                            case 'planetary':
                                roboticText = `Movimento planetário significativo. ${title}. ${message}`;
                                break;
                            default:
                                roboticText = `Notificação do sistema. ${title}. ${message}`;
                        }
                        
                        utterance.text = roboticText;
                        utterance.lang = 'pt-BR';
                        utterance.rate = 0.8; // Mais lento, robótico
                        utterance.pitch = 1.2; // Mais agudo, feminino
                        utterance.volume = 0.9;
                        
                        // Tentar encontrar voz feminina
                        const voices = speechSynthesis.getVoices();
                        const femaleVoice = voices.find(voice => 
                            (voice.lang.includes('pt') || voice.lang.includes('BR')) &&
                            (voice.name.toLowerCase().includes('female') || 
                             voice.name.toLowerCase().includes('feminina') ||
                             voice.name.toLowerCase().includes('woman'))
                        );
                        
                        if (femaleVoice) {
                            utterance.voice = femaleVoice;
                        } else {
                            // Fallback para qualquer voz portuguesa
                            const ptVoice = voices.find(voice => 
                                voice.lang.includes('pt') || voice.lang.includes('BR')
                            );
                            if (ptVoice) {
                                utterance.voice = ptVoice;
                            }
                        }
                        
                        speechSynthesis.speak(utterance);
                    } else {
                        // Fallback para beep robótico
                        this.playRoboticBeep();
                    }
                } catch (e) {
                    console.log('Erro na síntese de voz:', e);
                    this.playRoboticBeep();
                }
            }

            playRoboticBeep() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    
                    // Sequência de beeps robóticos
                    const beepSequence = [
                        { freq: 800, duration: 0.1 },
                        { freq: 1000, duration: 0.1 },
                        { freq: 800, duration: 0.1 }
                    ];
                    
                    let currentTime = audioContext.currentTime;
                    
                    beepSequence.forEach((beep, index) => {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        oscillator.frequency.setValueAtTime(beep.freq, currentTime);
                        oscillator.type = 'square'; // Som mais robótico
                        
                        gainNode.gain.setValueAtTime(0, currentTime);
                        gainNode.gain.linearRampToValueAtTime(0.1, currentTime + 0.01);
                        gainNode.gain.linearRampToValueAtTime(0, currentTime + beep.duration);
                        
                        oscillator.start(currentTime);
                        oscillator.stop(currentTime + beep.duration);
                        
                        currentTime += beep.duration + 0.05;
                    });
                } catch (e) {
                    console.log('Erro ao reproduzir beep robótico:', e);
                }
            }

            // Métodos para diferentes tipos de alertas astrológicos
            showAstrologicalAlert(title, message) {
                return this.showNotification(title, message, '⚠️', 'astrological');
            }

            showLunarAlert(title, message) {
                return this.showNotification(title, message, '🌙', 'lunar');
            }

            showPlanetaryAlert(title, message) {
                return this.showNotification(title, message, '🪐', 'planetary');
            }

            showThreatAlert(title, message) {
                return this.showNotification(title, message, '🚨', 'threat');
            }
        }

        // Inicializar sistema de notificações
        let msnSystem;
        
        // Aguardar carregamento das vozes
        if ('speechSynthesis' in window) {
            speechSynthesis.onvoiceschanged = function() {
                console.log('Vozes carregadas:', speechSynthesis.getVoices().length);
            };
        }
        
        // Inicializar sistema MSN quando desktop estiver ativo
        function initializeMSNSystem() {
            if (!msnSystem) {
                msnSystem = new MSNNotificationSystem();
                
                // Notificação de boas-vindas
                setTimeout(() => {
                    msnSystem.showNotification(
                        'Sistema AFÁSTE Ativado',
                        'Monitoramento astrológico iniciado com sucesso.',
                        '🛡️',
                        'astrological'
                    );
                }, 2000);
                
                // Simular alertas astrológicos periódicos
                setInterval(() => {
                    const alerts = [
                        {
                            title: 'Mercúrio Retrógrado Detectado',
                            message: 'Cuidado com comunicações e tecnologia.',
                            type: 'planetary'
                        },
                        {
                            title: 'Lua Cheia Aproximando',
                            message: 'Energia intensa nas próximas 48 horas.',
                            type: 'lunar'
                        },
                        {
                            title: 'Aspecto Tenso Marte-Saturno',
                            message: 'Evite conflitos e seja paciente.',
                            type: 'threat'
                        },
                        {
                            title: 'Vênus em Trígono com Júpiter',
                            message: 'Momento favorável para relacionamentos.',
                            type: 'astrological'
                        }
                    ];
                    
                    if (Math.random() < 0.4) { // 40% de chance a cada intervalo
                        const alert = alerts[Math.floor(Math.random() * alerts.length)];
                        
                        switch(alert.type) {
                            case 'planetary':
                                msnSystem.showPlanetaryAlert(alert.title, alert.message);
                                break;
                            case 'lunar':
                                msnSystem.showLunarAlert(alert.title, alert.message);
                                break;
                            case 'threat':
                                msnSystem.showThreatAlert(alert.title, alert.message);
                                break;
                            default:
                                msnSystem.showAstrologicalAlert(alert.title, alert.message);
                        }
                    }
                }, 25000); // A cada 25 segundos
            }
        }
    </script>
</body>
</html>

