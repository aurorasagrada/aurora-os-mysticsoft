<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aurora OS ‚Ä¢ MysticSoft</title>
    <link href="https://fonts.googleapis.com/css2?family=Alice&family=VT323&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        :root {
            /* Tema Aurora Sagrada */
            --vinho: #3e0a29;
            --verde-claro: #b2d1b1;
            --azul-escuro: #0b1836;
            --dourado: #f0aa53;
            --pergaminho: #f2eaff;
            
            /* Vari√°veis de tema din√¢micas */
            --theme-bg: linear-gradient(135deg, var(--azul-escuro) 0%, var(--vinho) 100%);
            --theme-taskbar: var(--vinho);
            --theme-start-btn: var(--vinho);
            --theme-start-text: var(--dourado);
            --theme-clock: var(--dourado);
            --theme-window-header: var(--azul-escuro);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'MS Sans Serif', sans-serif;
            font-size: 11px;
            background: var(--theme-bg);
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }
        
        /* ========================================
           üöÄ SISTEMA DE INICIALIZA√á√ÉO COMPLETO
           Boot Screen + Tela de Boas-vindas
           ======================================== */
        
        /* Boot Screen M√≠stico */
        .boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                var(--azul-escuro) 0%, 
                #000 30%, 
                var(--vinho) 70%, 
                var(--azul-escuro) 100%);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--pergaminho);
            opacity: 1;
            transition: opacity 1.5s ease-out;
            overflow: hidden;
        }
        
        .boot-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Part√≠culas m√≠sticas de fundo */
        .boot-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }
        
        .boot-particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: var(--dourado);
            border-radius: 50%;
            animation: bootParticleFloat 12s infinite linear;
            opacity: 0;
            box-shadow: 0 0 6px var(--dourado);
        }
        
        @keyframes bootParticleFloat {
            0% {
                opacity: 0;
                transform: translateY(100vh) rotate(0deg) scale(0.5);
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) rotate(360deg) scale(1.5);
            }
        }
        
        /* Logo Aurora OS */
        .boot-logo {
            text-align: center;
            margin-bottom: 60px;
            animation: bootLogoAppear 2s ease-out;
        }
        
        @keyframes bootLogoAppear {
            0% {
                opacity: 0;
                transform: scale(0.5) rotateY(180deg);
            }
            50% {
                opacity: 0.5;
                transform: scale(0.8) rotateY(90deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotateY(0deg);
            }
        }
        
        .boot-logo h1 {
            font-family: 'VT323', monospace;
            font-size: 4rem;
            color: var(--dourado);
            text-shadow: 
                0 0 10px var(--dourado),
                0 0 20px var(--dourado),
                0 0 30px var(--dourado);
            margin-bottom: 10px;
            letter-spacing: 3px;
        }
        
        .boot-logo .subtitle {
            font-family: 'Alice', serif;
            font-size: 1.2rem;
            color: var(--pergaminho);
            opacity: 0.9;
            letter-spacing: 2px;
        }
        
        /* Mandala de carregamento */
        .boot-mandala {
            width: 200px;
            height: 200px;
            margin: 40px auto;
            position: relative;
            animation: bootMandalaRotate 8s infinite linear;
        }
        
        @keyframes bootMandalaRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .mandala-ring {
            position: absolute;
            border: 2px solid transparent;
            border-radius: 50%;
            animation: mandalaRingPulse 3s infinite ease-in-out;
        }
        
        .mandala-ring:nth-child(1) {
            width: 200px;
            height: 200px;
            border-top-color: var(--dourado);
            border-right-color: var(--dourado);
            animation-delay: 0s;
        }
        
        .mandala-ring:nth-child(2) {
            width: 150px;
            height: 150px;
            top: 25px;
            left: 25px;
            border-bottom-color: var(--verde-claro);
            border-left-color: var(--verde-claro);
            animation-delay: 0.5s;
        }
        
        .mandala-ring:nth-child(3) {
            width: 100px;
            height: 100px;
            top: 50px;
            left: 50px;
            border-top-color: var(--pergaminho);
            border-bottom-color: var(--pergaminho);
            animation-delay: 1s;
        }
        
        .mandala-ring:nth-child(4) {
            width: 50px;
            height: 50px;
            top: 75px;
            left: 75px;
            border-left-color: var(--dourado);
            border-right-color: var(--dourado);
            animation-delay: 1.5s;
        }
        
        @keyframes mandalaRingPulse {
            0%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            50% {
                opacity: 1;
                transform: scale(1.1);
            }
        }
        
        /* Mensagem de carregamento */
        .boot-message {
            text-align: center;
            margin-top: 40px;
            animation: bootMessageFade 2s ease-in-out infinite;
        }
        
        @keyframes bootMessageFade {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        .boot-message .loading-text {
            font-family: 'Alice', serif;
            font-size: 1.1rem;
            color: var(--pergaminho);
            margin-bottom: 20px;
            min-height: 30px;
        }
        
        /* Barra de progresso m√≠stica */
        .boot-progress {
            width: 400px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--dourado);
            box-shadow: 0 0 10px rgba(240, 170, 83, 0.3);
        }
        
        .boot-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, 
                var(--dourado) 0%, 
                var(--pergaminho) 50%, 
                var(--dourado) 100%);
            width: 0%;
            transition: width 0.5s ease-out;
            position: relative;
            overflow: hidden;
        }
        
        .boot-progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.4) 50%, 
                transparent 100%);
            animation: bootProgressShimmer 2s infinite;
        }
        
        @keyframes bootProgressShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .boot-progress-text {
            margin-top: 15px;
            font-family: 'VT323', monospace;
            font-size: 1rem;
            color: var(--dourado);
            text-align: center;
        }
        
        /* Informa√ß√µes do sistema */
        .boot-info {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            opacity: 0.7;
        }
        
        .boot-info .version {
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--pergaminho);
            margin-bottom: 5px;
        }
        
        .boot-info .copyright {
            font-family: 'Alice', serif;
            font-size: 0.8rem;
            color: var(--pergaminho);
        }
        
        /* ========================================
           üëã TELA DE BOAS-VINDAS COMPLETA
           ======================================== */
        
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                var(--azul-escuro) 0%, 
                var(--vinho) 50%, 
                var(--azul-escuro) 100%);
            z-index: 9999;
            display: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            overflow-y: auto;
        }
        
        .welcome-screen.active {
            display: flex;
            opacity: 1;
        }
        
        .welcome-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .welcome-container {
            width: 100%;
            max-width: 800px;
            margin: auto;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--pergaminho);
        }
        
        /* Cabe√ßalho da tela de boas-vindas */
        .welcome-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .welcome-header h1 {
            font-family: 'VT323', monospace;
            font-size: 3rem;
            color: var(--dourado);
            text-shadow: 0 0 15px var(--dourado);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }
        
        .welcome-header .moon-title {
            font-family: 'Alice', serif;
            font-size: 2rem;
            color: var(--pergaminho);
            margin: 20px 0;
            text-shadow: 0 0 10px rgba(242, 234, 255, 0.5);
        }
        
        .welcome-header .subtitle {
            font-family: 'Alice', serif;
            font-size: 1.1rem;
            color: var(--verde-claro);
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Container principal de login */
        .welcome-main {
            background: rgba(11, 24, 54, 0.8);
            border: 2px solid var(--dourado);
            border-radius: 15px;
            padding: 40px;
            width: 100%;
            max-width: 500px;
            box-shadow: 
                0 0 30px rgba(240, 170, 83, 0.3),
                inset 0 0 20px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        /* Se√ß√£o de login */
        .login-section {
            margin-bottom: 30px;
        }
        
        .login-section h3 {
            font-family: 'Alice', serif;
            font-size: 1.3rem;
            color: var(--dourado);
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            font-family: 'Alice', serif;
            font-size: 1rem;
            color: var(--pergaminho);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--vinho);
            border-radius: 8px;
            background: rgba(242, 234, 255, 0.1);
            color: var(--pergaminho);
            font-family: 'Alice', serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--dourado);
            background: rgba(242, 234, 255, 0.2);
            box-shadow: 0 0 10px rgba(240, 170, 83, 0.3);
        }
        
        .form-group input::placeholder {
            color: rgba(242, 234, 255, 0.5);
        }
        
        /* Checkbox personalizado */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin: 0;
        }
        
        .checkbox-group label {
            margin: 0;
            font-size: 0.9rem;
            color: var(--verde-claro);
        }
        
        /* Bot√µes de a√ß√£o */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 25px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--dourado) 0%, #e6941a 100%);
            color: var(--azul-escuro);
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-family: 'Alice', serif;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(240, 170, 83, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(240, 170, 83, 0.4);
            background: linear-gradient(135deg, #e6941a 0%, var(--dourado) 100%);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--pergaminho);
            border: 2px solid var(--vinho);
            padding: 12px 25px;
            border-radius: 8px;
            font-family: 'Alice', serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            border-color: var(--dourado);
            color: var(--dourado);
            background: rgba(240, 170, 83, 0.1);
        }
        
        /* Separador */
        .divider {
            text-align: center;
            margin: 25px 0;
            position: relative;
            color: var(--verde-claro);
            font-family: 'Alice', serif;
        }
        
        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--verde-claro), transparent);
        }
        
        .divider::before {
            left: 0;
        }
        
        .divider::after {
            right: 0;
        }
        
        /* Gatomante na tela de boas-vindas */
        .welcome-gatomante {
            position: absolute;
            bottom: 40px;
            left: 40px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: welcomeGatomanteFloat 3s ease-in-out infinite;
        }
        
        @keyframes welcomeGatomanteFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .welcome-gatomante .gatomante-avatar {
            font-size: 3rem;
            filter: drop-shadow(0 0 10px rgba(240, 170, 83, 0.5));
        }
        
        .welcome-gatomante .gatomante-speech {
            background: rgba(242, 234, 255, 0.9);
            color: var(--azul-escuro);
            padding: 15px 20px;
            border-radius: 20px;
            border: 2px solid var(--dourado);
            font-family: 'Alice', serif;
            font-size: 0.9rem;
            max-width: 300px;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .welcome-gatomante .gatomante-speech::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-right: 10px solid var(--dourado);
        }
        
        .welcome-gatomante .gatomante-speech::after {
            content: '';
            position: absolute;
            left: -8px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid rgba(242, 234, 255, 0.9);
        }
        
        /* Mensagens de status */
        .status-message {
            margin-top: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            font-family: 'Alice', serif;
            font-size: 0.9rem;
            text-align: center;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }
        
        .status-message.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .status-message.success {
            background: rgba(178, 209, 177, 0.2);
            border: 1px solid var(--verde-claro);
            color: var(--verde-claro);
        }
        
        .status-message.error {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid #dc3545;
            color: #ff6b7a;
        }
        
        .status-message.info {
            background: rgba(240, 170, 83, 0.2);
            border: 1px solid var(--dourado);
            color: var(--dourado);
        }
        
        /* Responsividade para tela de boas-vindas */
        @media (max-width: 768px) {
            .welcome-container {
                padding: 20px 15px;
            }
            
            .welcome-header h1 {
                font-size: 2.5rem;
            }
            
            .welcome-header .moon-title {
                font-size: 1.5rem;
            }
            
            .welcome-main {
                padding: 30px 20px;
            }
            
            .welcome-gatomante {
                position: relative;
                bottom: auto;
                left: auto;
                margin-top: 30px;
                justify-content: center;
            }
            
            .welcome-gatomante .gatomante-speech {
                max-width: 250px;
            }
        }
        
        @media (max-width: 480px) {
            .boot-logo h1 {
                font-size: 3rem;
            }
            
            .boot-mandala {
                width: 150px;
                height: 150px;
            }
            
            .boot-progress {
                width: 300px;
            }
            
            .welcome-header h1 {
                font-size: 2rem;
            }
            
            .welcome-main {
                padding: 25px 15px;
            }
        }
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) rotate(360deg);
            }
        }
        
        /* Logo Aurora OS */
        .boot-logo {
            font-size: 64px;
            margin-bottom: 30px;
            animation: logoMaterialize 3s ease-out;
            text-shadow: 0 0 30px var(--dourado);
            filter: drop-shadow(0 0 20px var(--dourado));
        }
        
        @keyframes logoMaterialize {
            0% { 
                opacity: 0;
                transform: scale(0.3) rotate(-10deg);
                filter: blur(20px) drop-shadow(0 0 50px var(--dourado));
            }
            50% {
                opacity: 0.8;
                transform: scale(1.1) rotate(2deg);
                filter: blur(5px) drop-shadow(0 0 40px var(--dourado));
            }
            100% { 
                opacity: 1;
                transform: scale(1) rotate(0deg);
                filter: blur(0) drop-shadow(0 0 20px var(--dourado));
            }
        }
        
        /* T√≠tulo principal */
        .boot-title {
            font-family: 'Alice', serif;
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--dourado);
            text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
            animation: titleSlideIn 2s ease-out 1s both;
            letter-spacing: 2px;
        }
        
        @keyframes titleSlideIn {
            0% { 
                opacity: 0; 
                transform: translateY(50px) scale(0.8);
            }
            100% { 
                opacity: 1; 
                transform: translateY(0) scale(1);
            }
        }
        
        /* Subt√≠tulo */
        .boot-subtitle {
            font-family: 'VT323', monospace;
            font-size: 18px;
            color: var(--verde-claro);
            margin-bottom: 50px;
            animation: subtitleFade 2s ease-out 1.5s both;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.6);
        }
        
        @keyframes subtitleFade {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        /* √Årea de carregamento */
        .boot-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 40px;
            animation: loadingAppear 1s ease-out 2s both;
        }
        
        @keyframes loadingAppear {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        /* Mensagem din√¢mica */
        .boot-message {
            font-family: 'Alice', serif;
            font-size: 16px;
            color: var(--pergaminho);
            text-align: center;
            min-height: 24px;
            margin-bottom: 15px;
            animation: messageGlow 2s ease-in-out infinite;
        }
        
        @keyframes messageGlow {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; text-shadow: 0 0 10px var(--pergaminho); }
        }
        
        /* Barra de progresso */
        .boot-progress-container {
            width: 400px;
            height: 8px;
            background: rgba(11, 24, 54, 0.8);
            border: 2px solid var(--dourado);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
            box-shadow: 
                0 0 15px rgba(240, 170, 83, 0.3),
                inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .boot-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, 
                var(--dourado) 0%, 
                rgba(240, 170, 83, 0.8) 50%, 
                var(--dourado) 100%);
            width: 0%;
            transition: width 0.3s ease-out;
            position: relative;
            box-shadow: 0 0 10px var(--dourado);
        }
        
        .boot-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.4) 50%, 
                transparent 100%);
            animation: progressShimmer 2s infinite;
        }
        
        @keyframes progressShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        /* Porcentagem */
        .boot-percentage {
            font-family: 'VT323', monospace;
            font-size: 14px;
            color: var(--dourado);
            margin-top: 10px;
            font-weight: bold;
        }
        
        /* Informa√ß√µes do sistema */
        .boot-info {
            position: absolute;
            bottom: 30px;
            text-align: center;
            animation: infoFade 1s ease-out 3s both;
        }
        
        @keyframes infoFade {
            0% { opacity: 0; }
            100% { opacity: 0.7; }
        }
        
        .boot-version {
            font-family: 'VT323', monospace;
            font-size: 12px;
            color: var(--verde-claro);
            margin-bottom: 5px;
        }
        
        .boot-copyright {
            font-family: 'VT323', monospace;
            font-size: 11px;
            color: rgba(242, 234, 255, 0.6);
        }
        
        /* ========================================
           üëã TELA DE BOAS-VINDAS
           Sistema de Login e Registro
           ======================================== */
        
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                var(--azul-escuro) 0%, 
                var(--vinho) 50%, 
                var(--azul-escuro) 100%);
            z-index: 9999;
            display: none;
            align-items: center;
            justify-content: center;
            color: var(--pergaminho);
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        
        .welcome-screen.active {
            display: flex;
            opacity: 1;
        }
        
        .welcome-container {
            background: linear-gradient(135deg, 
                rgba(11, 24, 54, 0.95) 0%, 
                rgba(62, 10, 41, 0.95) 100%);
            border: 3px solid var(--dourado);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 30px rgba(240, 170, 83, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: welcomeSlideIn 1s ease-out;
            backdrop-filter: blur(20px);
        }
        
        @keyframes welcomeSlideIn {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .welcome-header {
            margin-bottom: 30px;
        }
        
        .welcome-title {
            font-family: 'Alice', serif;
            font-size: 28px;
            color: var(--dourado);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        
        .welcome-subtitle {
            font-size: 14px;
            color: var(--verde-claro);
            line-height: 1.4;
        }
        
        /* Formul√°rio de Login */
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }
        
        .form-label {
            font-size: 12px;
            color: var(--dourado);
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-input {
            background: rgba(242, 234, 255, 0.1);
            border: 2px solid rgba(240, 170, 83, 0.3);
            border-radius: 8px;
            padding: 12px 15px;
            color: var(--pergaminho);
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--dourado);
            background: rgba(242, 234, 255, 0.15);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.3);
        }
        
        .form-input::placeholder {
            color: rgba(242, 234, 255, 0.5);
        }
        
        /* Bot√µes */
        .welcome-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .welcome-btn {
            background: linear-gradient(135deg, 
                var(--dourado) 0%, 
                rgba(240, 170, 83, 0.8) 100%);
            color: var(--vinho);
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .welcome-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(240, 170, 83, 0.4);
            background: linear-gradient(135deg, 
                rgba(240, 170, 83, 1.1) 0%, 
                var(--dourado) 100%);
        }
        
        .welcome-btn:active {
            transform: translateY(0);
        }
        
        .welcome-btn.secondary {
            background: transparent;
            color: var(--dourado);
            border: 2px solid var(--dourado);
        }
        
        .welcome-btn.secondary:hover {
            background: rgba(240, 170, 83, 0.1);
            border-color: rgba(240, 170, 83, 1.2);
        }
        
        /* Divisor */
        .welcome-divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
            color: rgba(242, 234, 255, 0.5);
            font-size: 12px;
        }
        
        .welcome-divider::before,
        .welcome-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: rgba(240, 170, 83, 0.3);
        }
        
        .welcome-divider span {
            padding: 0 15px;
        }
        
        /* Gatomante na tela de boas-vindas */
        .welcome-gatomante {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 15px;
            animation: gatomanteWelcome 3s ease-in-out infinite;
        }
        
        @keyframes gatomanteWelcome {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-5px); }
        }
        
        .welcome-gatomante-sprite {
            font-size: 32px;
            filter: drop-shadow(0 0 10px var(--dourado));
        }
        
        .welcome-gatomante-message {
            background: rgba(242, 234, 255, 0.9);
            color: var(--azul-escuro);
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-style: italic;
            max-width: 200px;
            position: relative;
        }
        
        .welcome-gatomante-message::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid rgba(242, 234, 255, 0.9);
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            .boot-title {
                font-size: 28px;
            }
            
            .boot-logo {
                font-size: 48px;
            }
            
            .boot-progress-container {
                width: 300px;
            }
            
            .welcome-container {
                padding: 30px 20px;
                margin: 20px;
            }
            
            .welcome-title {
                font-size: 24px;
            }
        }
        
        @media (max-width: 480px) {
            .boot-title {
                font-size: 24px;
            }
            
            .boot-logo {
                font-size: 40px;
            }
            
            .boot-progress-container {
                width: 250px;
            }
            
            .welcome-container {
                padding: 25px 15px;
            }
            
            .welcome-title {
                font-size: 20px;
            }
        }
        
        /* ========================================
           üë• SISTEMA DE REGISTRO COMPLETO
           Estilos para formul√°rio multi-etapas
           ======================================== */
        
        .register-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                var(--azul-escuro) 0%, 
                var(--vinho) 50%, 
                var(--azul-escuro) 100%);
            z-index: 9998;
            display: none;
            align-items: center;
            justify-content: center;
            color: var(--pergaminho);
            opacity: 0;
            transition: opacity 1s ease-in-out;
            overflow-y: auto;
            padding: 20px 0;
        }
        
        .register-screen.active {
            display: flex;
            opacity: 1;
        }
        
        .register-container {
            background: linear-gradient(135deg, 
                rgba(11, 24, 54, 0.95) 0%, 
                rgba(62, 10, 41, 0.95) 100%);
            border: 3px solid var(--dourado);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 30px rgba(240, 170, 83, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: registerSlideIn 1s ease-out;
            backdrop-filter: blur(20px);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        @keyframes registerSlideIn {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .register-header {
            margin-bottom: 30px;
        }
        
        .register-title {
            font-family: 'Alice', serif;
            font-size: 28px;
            color: var(--dourado);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        
        .register-subtitle {
            font-size: 14px;
            color: var(--verde-claro);
            line-height: 1.4;
        }
        
        /* Indicador de etapas */
        .register-step-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }
        
        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(240, 170, 83, 0.2);
            border: 2px solid rgba(240, 170, 83, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: rgba(242, 234, 255, 0.7);
            transition: all 0.3s ease;
        }
        
        .step.active {
            background: var(--dourado);
            border-color: var(--dourado);
            color: var(--vinho);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.5);
        }
        
        .step.completed {
            background: var(--verde-claro);
            border-color: var(--verde-claro);
            color: var(--azul-escuro);
        }
        
        .step-line {
            width: 50px;
            height: 2px;
            background: rgba(240, 170, 83, 0.3);
            transition: all 0.3s ease;
        }
        
        .step-line.completed {
            background: var(--verde-claro);
        }
        
        /* T√≠tulos das etapas */
        .register-step-title {
            font-family: 'Alice', serif;
            font-size: 20px;
            color: var(--dourado);
            margin-bottom: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.6);
        }
        
        .register-step-subtitle {
            font-size: 12px;
            color: var(--verde-claro);
            margin-bottom: 25px;
            line-height: 1.4;
        }
        
        /* Formul√°rios */
        .register-form {
            text-align: left;
        }
        
        .form-hint {
            font-size: 10px;
            color: rgba(242, 234, 255, 0.6);
            margin-top: 5px;
            display: block;
        }
        
        /* Grupo de checkboxes */
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--pergaminho);
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: background 0.3s ease;
        }
        
        .checkbox-group label:hover {
            background: rgba(240, 170, 83, 0.1);
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--dourado);
        }
        
        /* Upload de foto */
        .photo-upload-area {
            margin: 15px 0;
        }
        
        .photo-preview {
            width: 120px;
            height: 120px;
            border: 3px dashed rgba(240, 170, 83, 0.5);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .photo-preview:hover {
            border-color: var(--dourado);
            background: rgba(240, 170, 83, 0.1);
        }
        
        .photo-placeholder {
            text-align: center;
            color: rgba(242, 234, 255, 0.6);
        }
        
        .photo-icon {
            font-size: 32px;
            display: block;
            margin-bottom: 5px;
        }
        
        .photo-text {
            font-size: 10px;
        }
        
        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        /* Sele√ß√£o de avatares */
        .avatar-selection {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .avatar-option {
            font-size: 24px;
            padding: 8px;
            border: 2px solid transparent;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(240, 170, 83, 0.1);
        }
        
        .avatar-option:hover {
            border-color: var(--dourado);
            background: rgba(240, 170, 83, 0.2);
            transform: scale(1.1);
        }
        
        .avatar-option.selected {
            border-color: var(--dourado);
            background: rgba(240, 170, 83, 0.3);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.5);
        }
        
        /* Checkbox container */
        .checkbox-container {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin: 15px 0;
        }
        
        .checkbox-container input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--dourado);
            margin-top: 2px;
        }
        
        .checkbox-container label {
            font-size: 12px;
            color: var(--pergaminho);
            line-height: 1.4;
        }
        
        .checkbox-container a {
            color: var(--dourado);
            text-decoration: underline;
        }
        
        .checkbox-container a:hover {
            color: rgba(240, 170, 83, 1.2);
        }
        
        /* Bot√µes de registro */
        .register-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        /* Tela de sucesso */
        .register-success {
            text-align: center;
            padding: 40px 20px;
        }
        
        .success-animation {
            font-size: 64px;
            margin-bottom: 20px;
            animation: successBounce 2s ease-in-out infinite;
        }
        
        @keyframes successBounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        .success-title {
            font-family: 'Alice', serif;
            font-size: 24px;
            color: var(--dourado);
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        
        .success-message {
            font-size: 14px;
            color: var(--pergaminho);
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .success-progress {
            width: 300px;
            height: 6px;
            background: rgba(11, 24, 54, 0.8);
            border: 2px solid var(--dourado);
            border-radius: 4px;
            margin: 0 auto 15px;
            overflow: hidden;
        }
        
        .success-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, 
                var(--dourado) 0%, 
                var(--verde-claro) 100%);
            width: 0%;
            transition: width 0.5s ease-out;
        }
        
        .success-status {
            font-size: 12px;
            color: var(--verde-claro);
            font-style: italic;
        }
        
        /* Gatomante no registro */
        .register-gatomante {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: registerGatomanteFloat 3s ease-in-out infinite;
        }
        
        @keyframes registerGatomanteFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        
        .register-gatomante-sprite {
            font-size: 28px;
            filter: drop-shadow(0 0 10px var(--dourado));
        }
        
        .register-gatomante-message {
            background: rgba(242, 234, 255, 0.9);
            color: var(--azul-escuro);
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 11px;
            font-style: italic;
            max-width: 180px;
            position: relative;
        }
        
        .register-gatomante-message::before {
            content: '';
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-left: 8px solid rgba(242, 234, 255, 0.9);
        }
        
        /* Responsividade do registro */
        @media (max-width: 768px) {
            .register-container {
                padding: 30px 20px;
                margin: 10px;
            }
            
            .register-title {
                font-size: 24px;
            }
            
            .step {
                width: 35px;
                height: 35px;
            }
            
            .step-line {
                width: 30px;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .register-buttons {
                flex-direction: column;
            }
            
            .register-gatomante {
                position: relative;
                bottom: auto;
                right: auto;
                justify-content: center;
                margin-top: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .register-container {
                padding: 25px 15px;
            }
            
            .register-title {
                font-size: 20px;
            }
            
            .register-step-title {
                font-size: 18px;
            }
            
            .avatar-selection {
                gap: 5px;
            }
            
            .avatar-option {
                font-size: 20px;
                padding: 6px;
            }
        }
            font-family: 'Alice', serif;
            font-size: 16px;
            color: var(--verde-claro);
            margin-bottom: 40px;
            font-style: italic;
            animation: subtitleFade 3s ease-in-out 0.5s both;
        }
        
        @keyframes subtitleFade {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .boot-progress {
            width: 300px;
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 20px;
            border: 1px solid var(--dourado);
        }
        
        .boot-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--dourado), var(--verde-claro));
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px var(--dourado);
        }
        
        .boot-status {
            font-size: 12px;
            color: var(--pergaminho);
            opacity: 0.8;
            animation: statusPulse 2s ease-in-out infinite;
        }
        
        @keyframes statusPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--azul-escuro) 0%, var(--vinho) 100%);
            z-index: 9998;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--pergaminho);
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        
        .welcome-screen.active {
            display: flex;
            opacity: 1;
        }
        
        .welcome-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .welcome-content {
            text-align: center;
            max-width: 600px;
            padding: 40px;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            border: 2px solid var(--dourado);
            box-shadow: 0 0 30px rgba(240, 170, 83, 0.3);
            animation: welcomeFloat 0.8s ease-out;
        }
        
        @keyframes welcomeFloat {
            0% { 
                opacity: 0; 
                transform: translateY(50px) scale(0.9); 
            }
            100% { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .welcome-gatomante {
            font-size: 64px;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
            animation: gatomanteWelcome 2s ease-in-out infinite;
        }
        
        @keyframes gatomanteWelcome {
            0%, 100% { transform: translateY(0px) rotate(-2deg); }
            50% { transform: translateY(-10px) rotate(2deg); }
        }
        
        .welcome-gatomante::after {
            content: 'üëì';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: var(--dourado);
            animation: glassesSparkle 3s ease-in-out infinite;
        }
        
        @keyframes glassesSparkle {
            0%, 100% { 
                filter: drop-shadow(0 0 5px var(--dourado));
                opacity: 1;
            }
            50% { 
                filter: drop-shadow(0 0 15px var(--dourado));
                opacity: 0.7;
            }
        }
        
        .welcome-title {
            font-family: 'Alice', serif;
            font-size: 28px;
            color: var(--dourado);
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        
        .welcome-message {
            font-family: 'Alice', serif;
            font-size: 16px;
            line-height: 1.6;
            color: var(--pergaminho);
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .welcome-button {
            background: linear-gradient(135deg, var(--vinho), var(--azul-escuro));
            color: var(--dourado);
            border: 2px solid var(--dourado);
            padding: 12px 30px;
            font-size: 14px;
            font-family: 'Alice', serif;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .welcome-button:hover {
            background: linear-gradient(135deg, var(--azul-escuro), var(--vinho));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(240, 170, 83, 0.4);
        }
        
        .welcome-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .mystical-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            color: var(--dourado);
            font-size: 12px;
            opacity: 0.6;
            animation: particleFloat 8s linear infinite;
        }
        
        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Sistema de Autentica√ß√£o */
        .auth-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--azul-escuro) 0%, var(--vinho) 100%);
            z-index: 9997;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--pergaminho);
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        
        .auth-screen.active {
            display: flex;
            opacity: 1;
        }
        
        .auth-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .auth-container {
            background: rgba(0,0,0,0.4);
            border: 2px solid var(--dourado);
            border-radius: 20px;
            padding: 40px;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 0 30px rgba(240, 170, 83, 0.3);
            animation: authFloat 0.8s ease-out;
        }
        
        @keyframes authFloat {
            0% { 
                opacity: 0; 
                transform: translateY(50px) scale(0.9); 
            }
            100% { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .auth-logo {
            font-size: 48px;
            margin-bottom: 15px;
            animation: logoGlow 2s ease-in-out infinite;
        }
        
        .auth-title {
            font-family: 'Alice', serif;
            font-size: 24px;
            color: var(--dourado);
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        
        .auth-subtitle {
            font-family: 'Alice', serif;
            font-size: 14px;
            color: var(--verde-claro);
            font-style: italic;
        }
        
        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .auth-field {
            position: relative;
        }
        
        .auth-label {
            display: block;
            font-family: 'Alice', serif;
            font-size: 12px;
            color: var(--verde-claro);
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .auth-input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0,0,0,0.3);
            border: 2px solid var(--azul-escuro);
            border-radius: 8px;
            color: var(--pergaminho);
            font-family: 'Alice', serif;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .auth-input:focus {
            outline: none;
            border-color: var(--dourado);
            box-shadow: 0 0 10px rgba(240, 170, 83, 0.3);
            background: rgba(0,0,0,0.5);
        }
        
        .auth-input::placeholder {
            color: rgba(242, 234, 255, 0.6);
            font-style: italic;
        }
        
        .auth-section-title {
            font-family: 'Alice', serif;
            font-size: 16px;
            color: var(--dourado);
            font-weight: bold;
            margin: 20px 0 5px 0;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        
        .auth-section-subtitle {
            font-family: 'Alice', serif;
            font-size: 12px;
            color: var(--verde-claro);
            font-style: italic;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .auth-checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .auth-checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--dourado);
        }
        
        .auth-checkbox-label {
            font-family: 'Alice', serif;
            font-size: 12px;
            color: var(--pergaminho);
            cursor: pointer;
        }
        
        .auth-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .auth-button {
            background: linear-gradient(135deg, var(--vinho), var(--azul-escuro));
            color: var(--dourado);
            border: 2px solid var(--dourado);
            padding: 12px 20px;
            font-size: 14px;
            font-family: 'Alice', serif;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .auth-button:hover {
            background: linear-gradient(135deg, var(--azul-escuro), var(--vinho));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(240, 170, 83, 0.4);
        }
        
        .auth-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .auth-button.secondary {
            background: transparent;
            color: var(--verde-claro);
            border-color: var(--verde-claro);
        }
        
        .auth-button.secondary:hover {
            background: rgba(178, 209, 177, 0.1);
            color: var(--pergaminho);
        }
        
        .auth-button.demo {
            background: linear-gradient(135deg, #8b1538 0%, #3e0a29 100%);
            border: 2px solid var(--dourado);
            color: var(--dourado);
            position: relative;
            overflow: hidden;
        }
        
        .auth-button.demo::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(240, 170, 83, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .auth-button.demo:hover::before {
            left: 100%;
        }
        
        .auth-button.demo:hover {
            background: linear-gradient(135deg, #a01a42 0%, #4a0c30 100%);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.4);
            transform: translateY(-2px);
        }
        
        .auth-divider {
            text-align: center;
            margin: 20px 0;
            position: relative;
            color: var(--verde-claro);
            font-family: 'Alice', serif;
            font-size: 12px;
        }
        
        .auth-divider::before,
        .auth-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: var(--verde-claro);
        }
        
        .auth-divider::before {
            left: 0;
        }
        
        .auth-divider::after {
            right: 0;
        }
        
        .auth-links {
            text-align: center;
            margin-top: 20px;
        }
        
        .auth-link {
            color: var(--verde-claro);
            text-decoration: none;
            font-family: 'Alice', serif;
            font-size: 12px;
            transition: color 0.3s ease;
            cursor: pointer;
        }
        
        .auth-link:hover {
            color: var(--dourado);
            text-decoration: underline;
        }
        
        .auth-error {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #ff6b6b;
            color: #ffcccb;
            padding: 10px;
            border-radius: 8px;
            font-size: 12px;
            margin-bottom: 15px;
            text-align: center;
            font-family: 'Alice', serif;
        }
        
        .auth-success {
            background: rgba(178, 209, 177, 0.2);
            border: 1px solid var(--verde-claro);
            color: var(--verde-claro);
            padding: 10px;
            border-radius: 8px;
            font-size: 12px;
            margin-bottom: 15px;
            text-align: center;
            font-family: 'Alice', serif;
        }
        
        .auth-loading {
            display: none;
            text-align: center;
            color: var(--dourado);
            font-family: 'Alice', serif;
            font-size: 12px;
            margin-top: 10px;
        }
        
        .auth-loading.active {
            display: block;
        }
        
        .auth-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(240, 170, 83, 0.3);
            border-radius: 50%;
            border-top-color: var(--dourado);
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ========================================
           üåü DESKTOP M√ÅGICO COM WALLPAPERS DIN√ÇMICOS
           Muda conforme hora planet√°ria + part√≠culas m√≠sticas
           ======================================== */
        
        .desktop {
            position: relative;
            width: 100%;
            height: calc(100vh - 50px);
            background: var(--theme-bg);
            background-attachment: fixed;
            overflow: hidden;
            transition: background 2s ease-in-out;
        }
        
        /* Camada de part√≠culas m√≠sticas */
        .desktop-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .mystic-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, var(--dourado) 0%, transparent 70%);
            border-radius: 50%;
            animation: floatMystic 8s linear infinite;
            opacity: 0.7;
        }
        
        .mystic-particle.star {
            width: 6px;
            height: 6px;
            background: radial-gradient(circle, #fff 0%, var(--dourado) 50%, transparent 100%);
            animation: floatStar 12s linear infinite;
        }
        
        .mystic-particle.rune {
            width: 8px;
            height: 8px;
            background: none;
            color: var(--dourado);
            font-size: 8px;
            animation: floatRune 15s linear infinite;
        }
        
        @keyframes floatMystic {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-10vh) translateX(50px) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes floatStar {
            0% {
                transform: translateY(100vh) translateX(0) scale(0.5);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            50% {
                transform: translateY(50vh) translateX(25px) scale(1);
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-10vh) translateX(50px) scale(0.5);
                opacity: 0;
            }
        }
        
        @keyframes floatRune {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.5;
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-10vh) translateX(30px) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* Wallpapers din√¢micos por hora planet√°ria */
        .desktop.sol {
            background: radial-gradient(ellipse at center, 
                rgba(255, 215, 0, 0.3) 0%, 
                rgba(255, 140, 0, 0.2) 30%, 
                rgba(139, 69, 19, 0.4) 70%, 
                rgba(0, 0, 0, 0.8) 100%);
        }
        
        .desktop.lua {
            background: radial-gradient(ellipse at center, 
                rgba(192, 192, 192, 0.3) 0%, 
                rgba(119, 136, 153, 0.2) 30%, 
                rgba(25, 25, 112, 0.4) 70%, 
                rgba(0, 0, 0, 0.9) 100%);
        }
        
        .desktop.marte {
            background: radial-gradient(ellipse at center, 
                rgba(255, 69, 0, 0.3) 0%, 
                rgba(178, 34, 34, 0.2) 30%, 
                rgba(139, 0, 0, 0.4) 70%, 
                rgba(0, 0, 0, 0.8) 100%);
        }
        
        .desktop.mercurio {
            background: radial-gradient(ellipse at center, 
                rgba(255, 255, 0, 0.3) 0%, 
                rgba(255, 215, 0, 0.2) 30%, 
                rgba(184, 134, 11, 0.4) 70%, 
                rgba(0, 0, 0, 0.8) 100%);
        }
        
        .desktop.jupiter {
            background: radial-gradient(ellipse at center, 
                rgba(255, 165, 0, 0.3) 0%, 
                rgba(255, 140, 0, 0.2) 30%, 
                rgba(205, 133, 63, 0.4) 70%, 
                rgba(0, 0, 0, 0.8) 100%);
        }
        
        .desktop.venus {
            background: radial-gradient(ellipse at center, 
                rgba(255, 182, 193, 0.3) 0%, 
                rgba(255, 105, 180, 0.2) 30%, 
                rgba(199, 21, 133, 0.4) 70%, 
                rgba(0, 0, 0, 0.8) 100%);
        }
        
        .desktop.saturno {
            background: radial-gradient(ellipse at center, 
                rgba(128, 128, 128, 0.3) 0%, 
                rgba(105, 105, 105, 0.2) 30%, 
                rgba(47, 79, 79, 0.4) 70%, 
                rgba(0, 0, 0, 0.9) 100%);
        }
        
        /* Efeito de aurora boreal sutil */
        .desktop::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                transparent 0%, 
                rgba(0, 255, 127, 0.05) 25%, 
                transparent 50%, 
                rgba(138, 43, 226, 0.05) 75%, 
                transparent 100%);
            animation: auroraShift 20s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes auroraShift {
            0%, 100% {
                opacity: 0.3;
                transform: translateX(-50px) rotate(0deg);
            }
            25% {
                opacity: 0.6;
                transform: translateX(0px) rotate(1deg);
            }
            50% {
                opacity: 0.4;
                transform: translateX(30px) rotate(-1deg);
            }
            75% {
                opacity: 0.7;
                transform: translateX(-20px) rotate(0.5deg);
            }
        }
        
        /* Constela√ß√µes de fundo */
        .desktop-constellation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .constellation-star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s ease-in-out infinite;
        }
        
        .constellation-star.bright {
            width: 3px;
            height: 3px;
            box-shadow: 0 0 6px rgba(255, 255, 255, 0.8);
        }
        
        @keyframes twinkle {
            0%, 100% {
                opacity: 0.3;
                transform: scale(1);
            }
            50% {
                opacity: 1;
                transform: scale(1.5);
            }
        }
        
        /* Linhas de conex√£o das constela√ß√µes */
        .constellation-line {
            position: absolute;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.3) 50%, 
                transparent 100%);
            transform-origin: left center;
            animation: lineGlow 4s ease-in-out infinite;
        }
        
        @keyframes lineGlow {
            0%, 100% {
                opacity: 0.2;
            }
            50% {
                opacity: 0.6;
            }
        }
        
        .desktop-icons {
            display: grid;
            grid-template-columns: repeat(auto-fit, 80px);
            gap: 20px;
            padding: 20px;
            height: 100%;
            align-content: start;
        }
        
        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s;
            position: relative;
        }
        
        .desktop-icon:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .desktop-icon .icon {
            font-size: 32px;
            margin-bottom: 4px;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));
            animation: iconBreathe 3s ease-in-out infinite;
        }
        
        .desktop-icon.premium .icon::after {
            content: '‚≠ê';
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 16px;
            color: var(--dourado);
            text-shadow: 0 0 5px var(--dourado);
            animation: starGlow 2s ease-in-out infinite;
        }
        
        .desktop-icon .label {
            color: white;
            font-size: 10px;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            max-width: 70px;
            word-wrap: break-word;
        }
        
        @keyframes iconBreathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes starGlow {
            0%, 100% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        /* Menu de Contexto (Bot√£o Direito) */
        .context-menu {
            position: fixed;
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.5);
            z-index: 3000;
            display: none;
            min-width: 200px;
        }
        
        .context-menu-item {
            padding: 8px 16px;
            cursor: pointer;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: black;
            border-bottom: 1px solid #a0a0a0;
        }
        
        .context-menu-item:hover {
            background: #316AC5;
            color: white;
        }
        
        .context-menu-item:last-child {
            border-bottom: none;
        }
        
        .context-menu-separator {
            height: 1px;
            background: #808080;
            margin: 2px 0;
        }
        
        /* Taskbar Aprimorada */
        /* ========================================
           üöÄ BARRA DE TAREFAS MODERNIZADA
           Indicadores, thumbnails e agrupamento inteligente
           ======================================== */
        
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 50px;
            background: linear-gradient(to bottom, 
                rgba(30, 20, 60, 0.95) 0%, 
                rgba(15, 10, 40, 0.98) 70%, 
                rgba(0, 0, 0, 0.99) 100%);
            border-top: 2px solid var(--dourado);
            display: flex;
            align-items: center;
            padding: 0 12px;
            z-index: 1000;
            box-shadow: 
                0 -5px 20px rgba(0, 0, 0, 0.8),
                0 -2px 10px rgba(212, 175, 55, 0.3),
                inset 0 1px 0 rgba(212, 175, 55, 0.2);
            backdrop-filter: blur(15px);
        }
        
        .taskbar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                var(--dourado) 20%, 
                var(--dourado) 80%, 
                transparent 100%);
            animation: taskbarGlow 4s ease-in-out infinite;
        }
        
        @keyframes taskbarGlow {
            0%, 100% {
                opacity: 0.3;
                transform: scaleX(0.8);
            }
            50% {
                opacity: 1;
                transform: scaleX(1);
            }
        }
        
        /* Bot√£o Iniciar Modernizado */
        .start-button {
            background: radial-gradient(circle at center, 
                rgba(212, 175, 55, 0.9) 0%, 
                rgba(139, 105, 20, 0.8) 70%, 
                rgba(0, 0, 0, 0.9) 100%);
            border: 2px solid var(--dourado);
            border-radius: 25px;
            color: white;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 0 15px rgba(212, 175, 55, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .start-button::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255, 255, 255, 0.1) 50%, 
                transparent 70%);
            transform: rotate(-45deg);
            transition: all 0.6s ease;
            opacity: 0;
        }
        
        .start-button:hover {
            transform: scale(1.05);
            box-shadow: 
                0 0 25px rgba(212, 175, 55, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        
        .start-button:hover::before {
            opacity: 1;
            left: 100%;
        }
        
        .start-button:active {
            transform: scale(0.98);
            box-shadow: 
                0 0 10px rgba(212, 175, 55, 0.6),
                inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .start-button.active {
            background: radial-gradient(circle at center, 
                rgba(255, 215, 0, 0.9) 0%, 
                rgba(212, 175, 55, 0.8) 70%, 
                rgba(139, 105, 20, 0.9) 100%);
            box-shadow: 
                0 0 30px rgba(255, 215, 0, 0.8),
                inset 0 0 10px rgba(255, 255, 255, 0.3);
        }
        
        /* √Årea de aplica√ß√µes da taskbar */
        .taskbar-apps {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 4px;
            margin: 0 16px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .taskbar-apps::-webkit-scrollbar {
            display: none;
        }
        
        /* Itens de aplica√ß√£o na taskbar */
        .taskbar-item {
            position: relative;
            min-width: 60px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            overflow: hidden;
        }
        
        .taskbar-item::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background: var(--dourado);
            transition: width 0.3s ease;
        }
        
        .taskbar-item:hover {
            background: rgba(212, 175, 55, 0.2);
            border-color: var(--dourado);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
        }
        
        .taskbar-item:hover::before {
            width: 80%;
        }
        
        .taskbar-item.active {
            background: rgba(212, 175, 55, 0.3);
            border: 2px solid var(--dourado);
            box-shadow: 
                0 0 15px rgba(212, 175, 55, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .taskbar-item.active::before {
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                var(--dourado) 50%, 
                transparent 100%);
        }
        
        .taskbar-item.minimized {
            opacity: 0.6;
            background: rgba(100, 100, 100, 0.2);
        }
        
        .taskbar-item.minimized:hover {
            opacity: 1;
        }
        
        /* √çcones dos itens */
        .taskbar-item-icon {
            font-size: 18px;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.5));
        }
        
        /* Indicador de notifica√ß√µes */
        .taskbar-item .notification-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 16px;
            height: 16px;
            background: #ff4444;
            border: 2px solid white;
            border-radius: 50%;
            font-size: 10px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            animation: badgePulse 2s ease-in-out infinite;
        }
        
        @keyframes badgePulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 5px rgba(255, 68, 68, 0.5);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 0 15px rgba(255, 68, 68, 0.8);
            }
        }
        
        /* Thumbnail preview */
        .taskbar-thumbnail {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 150px;
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid var(--dourado);
            border-radius: 8px;
            padding: 8px;
            display: none;
            z-index: 3000;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
        }
        
        .taskbar-thumbnail.show {
            display: block;
            animation: thumbnailShow 0.3s ease-out;
        }
        
        @keyframes thumbnailShow {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(10px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) translateY(0) scale(1);
            }
        }
        
        .thumbnail-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            padding-bottom: 4px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        .thumbnail-icon {
            font-size: 16px;
        }
        
        .thumbnail-title {
            color: white;
            font-size: 12px;
            font-weight: bold;
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .thumbnail-preview {
            width: 100%;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 11px;
            text-align: center;
        }
        
        /* √Årea direita da taskbar */
        .taskbar-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Indicador de sistema */
        .system-indicator {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .system-indicator:hover {
            background: rgba(212, 175, 55, 0.4);
            border-color: var(--dourado);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
        }
        
        .system-indicator.active {
            background: rgba(212, 175, 55, 0.6);
            border: 2px solid var(--dourado);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.7);
        }
        
        .system-indicator .icon {
            font-size: 14px;
            color: var(--dourado);
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.5));
        }
        
        /* Agrupamento de aplica√ß√µes */
        .taskbar-group {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .taskbar-group .group-indicator {
            position: absolute;
            top: -2px;
            right: -2px;
            width: 12px;
            height: 12px;
            background: var(--dourado);
            border-radius: 50%;
            font-size: 8px;
            color: black;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
            align-items: center;
            gap: 6px;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
            transition: all 0.1s;
            border-radius: 4px;
        }
        
        .start-button:hover {
            background: linear-gradient(to bottom, #4a1a35, var(--theme-start-btn));
        }
        
        .start-button:active {
            border: 1px inset var(--theme-start-btn);
        }
        
        .start-logo {
            font-size: 16px;
            filter: drop-shadow(0 0 3px var(--dourado));
        }
        
        .taskbar-items {
            flex: 1;
            display: flex;
            gap: 4px;
            margin-left: 12px;
        }
        
        .taskbar-item {
            background: rgba(255,255,255,0.1);
            border: 1px outset rgba(255,255,255,0.2);
            color: white;
            padding: 4px 10px;
            cursor: pointer;
            font-size: 10px;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border-radius: 3px;
        }
        
        .taskbar-item:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .taskbar-item.active {
            background: rgba(255,255,255,0.3);
            border: 1px inset rgba(255,255,255,0.2);
        }
        
        /* √Årea direita da taskbar */
        .taskbar-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .taskbar-widget {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            background: rgba(255,255,255,0.1);
            border: 1px outset rgba(255,255,255,0.2);
            border-radius: 3px;
            cursor: pointer;
            font-size: 10px;
            color: var(--theme-clock);
            text-shadow: 0 0 3px var(--dourado);
            transition: all 0.1s;
        }
        
        .taskbar-widget:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .taskbar-widget:active {
            border: 1px inset rgba(255,255,255,0.2);
        }
        
        .planetary-symbol {
            font-size: 14px;
            animation: planetGlow 3s ease-in-out infinite;
        }
        
        @keyframes planetGlow {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; text-shadow: 0 0 8px var(--dourado); }
        }
        
        .clock {
            color: var(--theme-clock);
            font-size: 11px;
            font-weight: bold;
            text-shadow: 0 0 3px var(--dourado);
        }
        
        .notification-icon, .volume-icon {
            font-size: 14px;
            cursor: pointer;
            padding: 4px;
            border-radius: 3px;
            transition: all 0.1s;
        }
        
        .notification-icon:hover, .volume-icon:hover {
            background: rgba(255,255,255,0.2);
        }
        
        /* ========================================
           üéµ SISTEMA DE √ÅUDIO AMBIENTE
           Controles para sons m√≠sticos e frequ√™ncias
           ======================================== */
        
        .ambient-audio-control {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            max-height: 600px;
            background: linear-gradient(135deg, 
                rgba(75, 0, 130, 0.95) 0%, 
                rgba(25, 25, 112, 0.95) 50%, 
                rgba(0, 0, 0, 0.95) 100%);
            border: 3px solid var(--dourado);
            border-radius: 15px;
            box-shadow: 
                0 0 30px rgba(240, 170, 83, 0.5),
                inset 0 0 20px rgba(240, 170, 83, 0.1);
            z-index: 3000;
            backdrop-filter: blur(10px);
            overflow-y: auto;
        }
        
        .ambient-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 2px solid var(--dourado);
            background: rgba(240, 170, 83, 0.1);
            border-radius: 12px 12px 0 0;
        }
        
        .ambient-header span {
            color: var(--dourado);
            font-size: 18px;
            font-weight: bold;
            text-shadow: 0 0 10px var(--dourado);
        }
        
        .ambient-header button {
            background: rgba(220, 20, 60, 0.8);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .ambient-header button:hover {
            background: rgba(220, 20, 60, 1);
            transform: scale(1.1);
        }
        
        .ambient-categories {
            padding: 20px;
        }
        
        .ambient-category {
            margin-bottom: 25px;
        }
        
        .ambient-category h4 {
            color: var(--dourado);
            font-size: 16px;
            margin-bottom: 10px;
            text-shadow: 0 0 8px var(--dourado);
            border-bottom: 1px solid rgba(240, 170, 83, 0.3);
            padding-bottom: 5px;
        }
        
        .ambient-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }
        
        .ambient-btn {
            background: linear-gradient(135deg, 
                rgba(138, 43, 226, 0.6) 0%, 
                rgba(75, 0, 130, 0.6) 100%);
            color: white;
            border: 2px solid rgba(240, 170, 83, 0.3);
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .ambient-btn:hover {
            border-color: var(--dourado);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.5);
            transform: translateY(-2px);
        }
        
        .ambient-btn.active {
            background: linear-gradient(135deg, 
                var(--dourado) 0%, 
                rgba(255, 215, 0, 0.8) 100%);
            color: black;
            border-color: var(--dourado);
            box-shadow: 
                0 0 20px rgba(240, 170, 83, 0.8),
                inset 0 0 10px rgba(255, 255, 255, 0.2);
            animation: activeGlow 2s ease-in-out infinite;
        }
        
        @keyframes activeGlow {
            0%, 100% {
                box-shadow: 
                    0 0 20px rgba(240, 170, 83, 0.8),
                    inset 0 0 10px rgba(255, 255, 255, 0.2);
            }
            50% {
                box-shadow: 
                    0 0 30px rgba(240, 170, 83, 1),
                    inset 0 0 15px rgba(255, 255, 255, 0.4);
            }
        }
        
        .ambient-controls {
            padding: 20px;
            border-top: 2px solid var(--dourado);
            background: rgba(240, 170, 83, 0.1);
            border-radius: 0 0 12px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }
        
        .ambient-controls label {
            color: var(--dourado);
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .ambient-controls input[type="range"] {
            width: 150px;
            height: 6px;
            background: rgba(240, 170, 83, 0.3);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }
        
        .ambient-controls input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--dourado);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(240, 170, 83, 0.8);
        }
        
        .ambient-controls button {
            background: linear-gradient(135deg, 
                rgba(220, 20, 60, 0.8) 0%, 
                rgba(139, 0, 0, 0.8) 100%);
            color: white;
            border: 2px solid rgba(220, 20, 60, 0.5);
            border-radius: 8px;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .ambient-controls button:hover {
            border-color: rgba(220, 20, 60, 1);
            box-shadow: 0 0 15px rgba(220, 20, 60, 0.5);
            transform: translateY(-2px);
        }
        
        /* ========================================
           üñ•Ô∏è WORKSPACES VIRTUAIS E SNAP ZONES
           Sistema de m√∫ltiplas √°reas de trabalho
           ======================================== */
        
        .workspace-switcher {
            position: fixed;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            background: linear-gradient(135deg, 
                rgba(75, 0, 130, 0.9) 0%, 
                rgba(25, 25, 112, 0.9) 50%, 
                rgba(0, 0, 0, 0.9) 100%);
            padding: 10px 15px;
            border-radius: 25px;
            border: 2px solid var(--dourado);
            box-shadow: 
                0 0 20px rgba(240, 170, 83, 0.3),
                inset 0 0 10px rgba(240, 170, 83, 0.1);
            backdrop-filter: blur(10px);
            z-index: 1500;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .workspace-switcher.visible {
            opacity: 1;
        }
        
        .workspace-tab {
            width: 40px;
            height: 30px;
            background: linear-gradient(135deg, 
                rgba(138, 43, 226, 0.6) 0%, 
                rgba(75, 0, 130, 0.6) 100%);
            border: 2px solid rgba(240, 170, 83, 0.3);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .workspace-tab:hover {
            border-color: var(--dourado);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.5);
            transform: translateY(-2px);
        }
        
        .workspace-tab.active {
            background: linear-gradient(135deg, 
                var(--dourado) 0%, 
                rgba(255, 215, 0, 0.8) 100%);
            color: black;
            border-color: var(--dourado);
            box-shadow: 
                0 0 20px rgba(240, 170, 83, 0.8),
                inset 0 0 10px rgba(255, 255, 255, 0.2);
        }
        
        .workspace-tab .window-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: rgba(220, 20, 60, 0.9);
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid white;
        }
        
        .snap-zones {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .snap-zones.active {
            opacity: 1;
        }
        
        .snap-zone {
            position: absolute;
            border: 3px dashed var(--dourado);
            background: rgba(240, 170, 83, 0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
            opacity: 0.7;
        }
        
        .snap-zone.highlight {
            background: rgba(240, 170, 83, 0.3);
            border-color: rgba(255, 215, 0, 1);
            box-shadow: 
                0 0 20px rgba(240, 170, 83, 0.6),
                inset 0 0 15px rgba(255, 255, 255, 0.2);
        }
        
        .snap-zone-left {
            left: 10px;
            top: 10px;
            width: calc(50% - 15px);
            height: calc(100% - 70px);
        }
        
        .snap-zone-right {
            right: 10px;
            top: 10px;
            width: calc(50% - 15px);
            height: calc(100% - 70px);
        }
        
        .snap-zone-top {
            left: 10px;
            top: 10px;
            width: calc(100% - 20px);
            height: calc(50% - 35px);
        }
        
        .snap-zone-bottom {
            left: 10px;
            bottom: 60px;
            width: calc(100% - 20px);
            height: calc(50% - 35px);
        }
        
        .snap-zone-center {
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 60%;
            height: 60%;
        }
        
        .workspace-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, 
                rgba(75, 0, 130, 0.9) 0%, 
                rgba(25, 25, 112, 0.9) 100%);
            color: var(--dourado);
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid var(--dourado);
            font-size: 12px;
            font-weight: bold;
            text-shadow: 0 0 5px var(--dourado);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.3);
            backdrop-filter: blur(5px);
            z-index: 1500;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .workspace-indicator.visible {
            opacity: 1;
        }
        
        /* ========================================
           ü§ñ GATOMANTE IA AVAN√áADA - CHAT E VOZ
           Sistema de chat integrado e comandos de voz
           ======================================== */
        
        .gatomante-chat {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 350px;
            height: 450px;
            background: linear-gradient(135deg, 
                rgba(75, 0, 130, 0.95) 0%, 
                rgba(25, 25, 112, 0.95) 50%, 
                rgba(0, 0, 0, 0.95) 100%);
            border: 3px solid var(--dourado);
            border-radius: 20px;
            box-shadow: 
                0 0 30px rgba(240, 170, 83, 0.4),
                inset 0 0 20px rgba(240, 170, 83, 0.1);
            backdrop-filter: blur(15px);
            z-index: 2500;
            opacity: 0;
            transform: translateY(20px) scale(0.9);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            display: flex;
            flex-direction: column;
        }
        
        .gatomante-chat.visible {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        
        .gatomante-chat-header {
            padding: 15px 20px;
            border-bottom: 2px solid rgba(240, 170, 83, 0.3);
            display: flex;
            align-items: center;
            gap: 12px;
            background: linear-gradient(135deg, 
                rgba(138, 43, 226, 0.3) 0%, 
                rgba(75, 0, 130, 0.3) 100%);
            border-radius: 17px 17px 0 0;
        }
        
        .gatomante-chat-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border: 2px solid var(--dourado);
            animation: gatomanteBreath 3s ease-in-out infinite;
        }
        
        .gatomante-chat-info {
            flex: 1;
        }
        
        .gatomante-chat-name {
            color: var(--dourado);
            font-weight: bold;
            font-size: 14px;
            text-shadow: 0 0 5px var(--dourado);
        }
        
        .gatomante-chat-status {
            color: #90EE90;
            font-size: 11px;
            opacity: 0.8;
        }
        
        .gatomante-chat-close {
            background: rgba(220, 20, 60, 0.8);
            border: none;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .gatomante-chat-close:hover {
            background: rgba(220, 20, 60, 1);
            transform: scale(1.1);
        }
        
        .gatomante-chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .gatomante-message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 13px;
            line-height: 1.4;
            animation: messageSlideIn 0.4s ease-out;
        }
        
        .gatomante-message.bot {
            align-self: flex-start;
            background: linear-gradient(135deg, 
                rgba(138, 43, 226, 0.8) 0%, 
                rgba(75, 0, 130, 0.8) 100%);
            color: white;
            border: 1px solid rgba(240, 170, 83, 0.3);
        }
        
        .gatomante-message.user {
            align-self: flex-end;
            background: linear-gradient(135deg, 
                var(--dourado) 0%, 
                rgba(255, 215, 0, 0.8) 100%);
            color: black;
            font-weight: 500;
        }
        
        .gatomante-chat-input-area {
            padding: 15px;
            border-top: 2px solid rgba(240, 170, 83, 0.3);
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .gatomante-chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(240, 170, 83, 0.3);
            border-radius: 20px;
            padding: 8px 15px;
            color: white;
            font-size: 13px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .gatomante-chat-input:focus {
            border-color: var(--dourado);
            box-shadow: 0 0 10px rgba(240, 170, 83, 0.3);
        }
        
        .gatomante-chat-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .gatomante-voice-btn {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, 
                rgba(220, 20, 60, 0.8) 0%, 
                rgba(139, 0, 0, 0.8) 100%);
            border: 2px solid rgba(240, 170, 83, 0.5);
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .gatomante-voice-btn:hover {
            border-color: var(--dourado);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.5);
            transform: scale(1.1);
        }
        
        .gatomante-voice-btn.listening {
            background: linear-gradient(135deg, 
                rgba(255, 0, 0, 0.9) 0%, 
                rgba(220, 20, 60, 0.9) 100%);
            animation: voicePulse 1s ease-in-out infinite;
        }
        
        .gatomante-send-btn {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, 
                var(--dourado) 0%, 
                rgba(255, 215, 0, 0.8) 100%);
            border: 2px solid var(--dourado);
            border-radius: 50%;
            color: black;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .gatomante-send-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.8);
        }
        
        .gatomante-typing {
            align-self: flex-start;
            background: rgba(138, 43, 226, 0.6);
            color: white;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 13px;
            border: 1px solid rgba(240, 170, 83, 0.3);
        }
        
        .typing-dots {
            display: inline-flex;
            gap: 3px;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background: var(--dourado);
            border-radius: 50%;
            animation: typingDot 1.4s ease-in-out infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes voicePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        @keyframes typingDot {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        
        /* Bot√£o de Chat na Taskbar */
        .gatomante-chat-toggle {
            position: relative;
        }
        
        .gatomante-chat-toggle::after {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 8px;
            height: 8px;
            background: rgba(0, 255, 0, 0.8);
            border-radius: 50%;
            animation: onlineIndicator 2s ease-in-out infinite;
        }
        
        @keyframes onlineIndicator {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        /* Popups */
        .popup {
            position: fixed;
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.5);
            z-index: 2000;
            display: none;
            border-radius: 4px;
        }
        
        .popup.active {
            display: block;
        }
        
        /* Calend√°rio Popup */
        .calendar-popup {
            bottom: 50px;
            right: 10px;
            width: 280px;
            padding: 12px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-weight: bold;
        }
        
        .calendar-nav {
            background: #d0d0d0;
            border: 1px outset #d0d0d0;
            cursor: pointer;
            padding: 2px 6px;
            font-size: 10px;
        }
        
        .calendar-nav:hover {
            background: #e0e0e0;
        }
        
        .calendar-nav:active {
            border: 1px inset #d0d0d0;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            text-align: center;
        }
        
        .calendar-day-header {
            font-size: 9px;
            font-weight: bold;
            padding: 4px 2px;
            background: #a0a0a0;
            color: white;
        }
        
        .calendar-day {
            padding: 4px 2px;
            cursor: pointer;
            font-size: 10px;
            border-radius: 2px;
        }
        
        .calendar-day:hover {
            background: #316AC5;
            color: white;
        }
        
        .calendar-day.today {
            background: var(--dourado);
            color: black;
            font-weight: bold;
        }
        
        .calendar-day.other-month {
            color: #808080;
        }
        
        /* Volume Popup */
        .volume-popup {
            bottom: 50px;
            right: 10px;
            width: 200px;
            padding: 12px;
        }
        
        .volume-control {
            margin-bottom: 8px;
        }
        
        .volume-label {
            font-size: 10px;
            margin-bottom: 4px;
            font-weight: bold;
        }
        
        .volume-slider {
            width: 100%;
            height: 4px;
            background: #808080;
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }
        
        .volume-fill {
            height: 100%;
            background: var(--dourado);
            border-radius: 2px;
            transition: width 0.1s;
        }
        
        .volume-thumb {
            position: absolute;
            top: -4px;
            width: 12px;
            height: 12px;
            background: #c0c0c0;
            border: 1px outset #c0c0c0;
            border-radius: 50%;
            cursor: pointer;
            transform: translateX(-50%);
        }
        
        /* Planetary Info Popup */
        .planetary-popup {
            bottom: 50px;
            right: 10px;
            width: 300px;
            padding: 12px;
        }
        
        .planetary-info {
            text-align: center;
            margin-bottom: 12px;
        }
        
        .planetary-current {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--azul-escuro);
        }
        
        .planetary-time {
            font-size: 10px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .planetary-ruler {
            font-size: 12px;
            color: var(--vinho);
            font-weight: bold;
        }
        
        /* Gatomante - Assistente M√≠stico */
        .gatomante-container {
            position: fixed;
            bottom: 60px;
            right: 20px;
            z-index: 3000;
            display: none;
            animation: gatomanteAppear 0.5s ease-out;
        }
        
        .gatomante-container.active {
            display: block;
        }
        
        @keyframes gatomanteAppear {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.8); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .gatomante-character {
            position: relative;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .gatomante-sprite {
            position: relative;
            display: inline-block;
            font-size: 48px;
            animation: gatomanteIdle 3s ease-in-out infinite;
            cursor: pointer;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
        }
        
        @keyframes gatomanteIdle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }
        
        .gatomante-body {
            position: relative;
            z-index: 1;
        }
        
        .gatomante-glasses {
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 20px;
            color: var(--dourado);
            z-index: 2;
            animation: glassesGlow 2s ease-in-out infinite;
        }
        
        @keyframes glassesGlow {
            0%, 100% { 
                filter: drop-shadow(0 0 3px var(--dourado)); 
                opacity: 1;
            }
            50% { 
                filter: drop-shadow(0 0 8px var(--dourado)); 
                opacity: 0.8;
            }
        }
        
        /* ========================================
           üí¨ BAL√ÉO DE FALA DO GATOMANTE - COMIC STYLE
           Design aut√™ntico de quadrinhos com melhorias
           ======================================== */
        
        .gatomante-bubble {
            background: linear-gradient(135deg, 
                rgba(242, 234, 255, 0.98) 0%, 
                rgba(255, 255, 255, 0.95) 50%, 
                rgba(240, 170, 83, 0.1) 100%);
            border: 3px solid var(--azul-escuro);
            border-radius: 20px;
            padding: 18px 22px;
            max-width: 320px;
            min-width: 200px;
            position: relative;
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.3),
                0 0 15px rgba(240, 170, 83, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            animation: bubbleAppear 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            backdrop-filter: blur(10px);
            
            /* Efeito comic-style com bordas duplas */
            outline: 2px solid rgba(240, 170, 83, 0.6);
            outline-offset: 2px;
        }
        
        @keyframes bubbleAppear {
            0% { 
                opacity: 0; 
                transform: scale(0.3) translateY(30px) rotate(-5deg);
                filter: blur(5px);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.1) translateY(-5px) rotate(1deg);
                filter: blur(1px);
            }
            100% { 
                opacity: 1; 
                transform: scale(1) translateY(0) rotate(0deg);
                filter: blur(0);
            }
        }
        
        /* Cauda do bal√£o estilo comic */
        .gatomante-bubble::before {
            content: '';
            position: absolute;
            bottom: -15px;
            right: 35px;
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 15px solid var(--azul-escuro);
            filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
        }
        
        .gatomante-bubble::after {
            content: '';
            position: absolute;
            bottom: -12px;
            right: 37px;
            width: 0;
            height: 0;
            border-left: 13px solid transparent;
            border-right: 13px solid transparent;
            border-top: 13px solid rgba(242, 234, 255, 0.98);
        }
        
        /* Cauda secund√°ria para efeito 3D */
        .gatomante-bubble::before {
            box-shadow: -2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .gatomante-text {
            color: var(--azul-escuro);
            font-size: 14px;
            line-height: 1.5;
            font-family: 'Alice', serif;
            font-weight: 500;
            margin-bottom: 12px;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
            
            /* Efeito de texto comic */
            letter-spacing: 0.3px;
            word-spacing: 1px;
        }
        
        /* Efeitos especiais para diferentes tipos de mensagem */
        .gatomante-bubble.excited {
            animation: bubbleExcited 0.6s ease-out;
            border-color: var(--dourado);
            outline-color: var(--dourado);
        }
        
        @keyframes bubbleExcited {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.05) rotate(1deg); }
            75% { transform: scale(1.02) rotate(-1deg); }
        }
        
        .gatomante-bubble.thinking {
            animation: bubbleThinking 2s ease-in-out infinite;
        }
        
        @keyframes bubbleThinking {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        /* Bot√£o de fechar aprimorado */
        .gatomante-close {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, 
                var(--dourado) 0%, 
                rgba(240, 170, 83, 0.8) 100%);
            color: var(--vinho);
            border: 2px solid var(--azul-escuro);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            z-index: 10;
        }
        
        .gatomante-close:hover {
            transform: scale(1.2) rotate(90deg);
            background: linear-gradient(135deg, 
                rgba(220, 38, 38, 0.9) 0%, 
                rgba(185, 28, 28, 0.9) 100%);
            color: white;
            box-shadow: 
                0 6px 20px rgba(220, 38, 38, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        
        .gatomante-close:active {
            transform: scale(1.1) rotate(90deg);
        }
        
        /* Efeitos de hover no bal√£o */
        .gatomante-bubble:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 12px 35px rgba(0, 0, 0, 0.4),
                0 0 20px rgba(240, 170, 83, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
        }
        
        /* Responsividade do bal√£o */
        @media (max-width: 768px) {
            .gatomante-bubble {
                max-width: 280px;
                padding: 15px 18px;
                border-radius: 16px;
            }
            
            .gatomante-text {
                font-size: 13px;
                line-height: 1.4;
            }
            
            .gatomante-close {
                width: 22px;
                height: 22px;
                font-size: 12px;
                top: -6px;
                right: -6px;
            }
        }
        
        @media (max-width: 480px) {
            .gatomante-bubble {
                max-width: 250px;
                padding: 12px 16px;
                border-radius: 14px;
            }
            
            .gatomante-text {
                font-size: 12px;
            }
            
            .gatomante-bubble::before {
                right: 25px;
                border-left-width: 12px;
                border-right-width: 12px;
                border-top-width: 12px;
                bottom: -12px;
            }
            
            .gatomante-bubble::after {
                right: 27px;
                border-left-width: 10px;
                border-right-width: 10px;
                border-top-width: 10px;
                bottom: -10px;
            }
        }
        
        .gatomante-close {
            position: absolute;
            top: 4px;
            right: 8px;
            background: var(--vinho);
            color: white;
            border: none;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .gatomante-close:hover {
            background: #a0073a;
            transform: scale(1.1);
        }
        
        .gatomante-thinking {
            animation: gatomanteThinking 1s ease-in-out infinite;
        }
        
        @keyframes gatomanteThinking {
            0%, 100% { transform: rotate(-2deg); }
            50% { transform: rotate(2deg); }
        }
        
        /* ========================================
           üõ°Ô∏è SISTEMA AF√ÅST! - ANTIV√çRUS ASTROL√ìGICO
           Notifica√ß√µes estilo MSN no canto inferior direito
           ======================================== */
        
        .afast-msn-notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #3b82f6 100%);
            border: 2px solid #60a5fa;
            border-radius: 8px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
            z-index: 3000;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transform: translateX(350px);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            overflow: hidden;
        }
        
        .afast-msn-notification.show {
            transform: translateX(0);
        }
        
        .afast-msn-header {
            background: linear-gradient(135deg, #1e40af 0%, #1d4ed8 100%);
            padding: 6px 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #3b82f6;
        }
        
        .afast-msn-title {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .afast-msn-logo {
            font-size: 16px;
            animation: afastMsnPulse 2s ease-in-out infinite;
        }
        
        .afast-msn-close {
            background: #dc2626;
            color: white;
            border: none;
            width: 18px;
            height: 18px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .afast-msn-close:hover {
            background: #b91c1c;
            transform: scale(1.1);
        }
        
        .afast-msn-content {
            padding: 12px;
            color: white;
        }
        
        .afast-msn-event {
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .afast-msn-description {
            font-size: 11px;
            color: #e0e7ff;
            line-height: 1.3;
            margin-bottom: 8px;
        }
        
        .afast-msn-time {
            font-size: 10px;
            color: #c7d2fe;
            text-align: right;
            font-style: italic;
        }
        
        .afast-severity-critical {
            border-left: 4px solid #dc2626;
            background: linear-gradient(135deg, #7f1d1d 0%, #991b1b 50%, #dc2626 100%);
        }
        
        .afast-severity-warning {
            border-left: 4px solid #f59e0b;
            background: linear-gradient(135deg, #92400e 0%, #b45309 50%, #f59e0b 100%);
        }
        
        .afast-severity-info {
            border-left: 4px solid #10b981;
            background: linear-gradient(135deg, #065f46 0%, #047857 50%, #10b981 100%);
        }
        
        @keyframes afastMsnPulse {
            0%, 100% { 
                transform: scale(1); 
                filter: drop-shadow(0 0 3px #60a5fa); 
            }
            50% { 
                transform: scale(1.1); 
                filter: drop-shadow(0 0 8px #60a5fa); 
            }
        }
        
        /* Anima√ß√£o de entrada estilo MSN */
        @keyframes afastMsnSlideIn {
            0% {
                transform: translateX(350px);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            80% {
                transform: translateX(-10px);
            }
            100% {
                transform: translateX(0);
            }
        }
        
        .afast-msn-notification.slide-in {
            animation: afastMsnSlideIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        /* ========================================
           üõ°Ô∏è NOTIFICA√á√ïES AF√ÅST! ESTILO MSN
           Notifica√ß√µes no canto inferior direito
           ======================================== */
        
        .afast-msn-notification {
            position: fixed;
            bottom: 60px;
            right: 20px;
            width: 320px;
            min-height: 120px;
            background: linear-gradient(135deg, 
                rgba(11, 24, 54, 0.95) 0%, 
                rgba(62, 10, 41, 0.95) 50%, 
                rgba(0, 0, 0, 0.95) 100%);
            border: 2px solid var(--dourado);
            border-radius: 12px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.6),
                0 0 20px rgba(240, 170, 83, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            z-index: 2500;
            transform: translateX(350px);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        
        .afast-msn-notification.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        .afast-msn-notification::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                var(--dourado) 0%, 
                rgba(240, 170, 83, 0.8) 50%, 
                var(--dourado) 100%);
            animation: afastMsnPulse 2s ease-in-out infinite;
        }
        
        .afast-msn-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px 8px 16px;
            border-bottom: 1px solid rgba(240, 170, 83, 0.3);
            background: rgba(240, 170, 83, 0.1);
        }
        
        .afast-msn-title {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--dourado);
            font-weight: bold;
            font-size: 13px;
            text-shadow: 0 0 8px rgba(240, 170, 83, 0.8);
        }
        
        .afast-msn-logo {
            font-size: 16px;
            animation: afastMsnPulse 1.5s ease-in-out infinite;
        }
        
        .afast-msn-close {
            background: rgba(220, 20, 60, 0.8);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .afast-msn-close:hover {
            background: rgba(220, 20, 60, 1);
            transform: scale(1.1);
        }
        
        .afast-msn-content {
            padding: 16px;
        }
        
        .afast-msn-event {
            color: white;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
            line-height: 1.3;
        }
        
        .afast-msn-description {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            line-height: 1.4;
            margin-bottom: 12px;
        }
        
        .afast-msn-time {
            color: var(--dourado);
            font-size: 11px;
            text-align: right;
            opacity: 0.8;
            font-weight: bold;
        }
        
        /* Varia√ß√µes por severidade */
        .afast-severity-critical {
            border-color: #dc2626;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.6),
                0 0 20px rgba(220, 38, 38, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .afast-severity-critical::before {
            background: linear-gradient(90deg, 
                #dc2626 0%, 
                rgba(220, 38, 38, 0.8) 50%, 
                #dc2626 100%);
        }
        
        .afast-severity-critical .afast-msn-title {
            color: #fca5a5;
        }
        
        .afast-severity-critical .afast-msn-time {
            color: #fca5a5;
        }
        
        .afast-severity-warning {
            border-color: #f59e0b;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.6),
                0 0 20px rgba(245, 158, 11, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .afast-severity-warning::before {
            background: linear-gradient(90deg, 
                #f59e0b 0%, 
                rgba(245, 158, 11, 0.8) 50%, 
                #f59e0b 100%);
        }
        
        .afast-severity-warning .afast-msn-title {
            color: #fbbf24;
        }
        
        .afast-severity-warning .afast-msn-time {
            color: #fbbf24;
        }
        
        .afast-severity-info {
            border-color: #10b981;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.6),
                0 0 20px rgba(16, 185, 129, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .afast-severity-info::before {
            background: linear-gradient(90deg, 
                #10b981 0%, 
                rgba(16, 185, 129, 0.8) 50%, 
                #10b981 100%);
        }
        
        .afast-severity-info .afast-msn-title {
            color: #6ee7b7;
        }
        
        .afast-severity-info .afast-msn-time {
            color: #6ee7b7;
        }
        
        /* Anima√ß√µes espec√≠ficas */
        @keyframes afastMsnSlideIn {
            0% {
                transform: translateX(350px);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes afastMsnPulse {
            0%, 100% { 
                opacity: 1;
                transform: scale(1);
            }
            50% { 
                opacity: 0.7;
                transform: scale(1.05);
            }
        }
        
        /* Responsividade para notifica√ß√µes MSN */
        @media (max-width: 768px) {
            .afast-msn-notification {
                width: 280px;
                right: 10px;
                bottom: 70px;
            }
        }
        
        @media (max-width: 480px) {
            .afast-msn-notification {
                width: calc(100vw - 20px);
                right: 10px;
                left: 10px;
                bottom: 70px;
            }
        }
        
        /* ========================================
           üé® SELETOR DE CORES DA BARRA DE TAREFAS
           Popup para personalizar cores da taskbar
           ======================================== */
        
        .taskbar-color-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 450px;
            max-height: 600px;
            background: linear-gradient(135deg, 
                rgba(11, 24, 54, 0.95) 0%, 
                rgba(62, 10, 41, 0.95) 50%, 
                rgba(0, 0, 0, 0.95) 100%);
            border: 2px solid var(--dourado);
            border-radius: 15px;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.8),
                0 0 30px rgba(240, 170, 83, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            z-index: 2000;
            display: none;
            overflow: hidden;
        }
        
        .taskbar-color-popup.active {
            display: block;
            animation: popupFadeIn 0.3s ease-out;
        }
        
        .taskbar-color-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 2px solid var(--dourado);
            background: rgba(240, 170, 83, 0.1);
            color: var(--dourado);
            font-weight: bold;
            font-size: 16px;
            text-shadow: 0 0 10px rgba(240, 170, 83, 0.8);
        }
        
        .taskbar-color-content {
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .color-section {
            margin-bottom: 25px;
        }
        
        .color-section h4 {
            color: var(--dourado);
            font-size: 14px;
            margin-bottom: 15px;
            text-shadow: 0 0 8px rgba(240, 170, 83, 0.6);
            border-bottom: 1px solid rgba(240, 170, 83, 0.3);
            padding-bottom: 8px;
        }
        
        .taskbar-color-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .taskbar-color-option {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .taskbar-color-option:hover {
            border-color: var(--dourado);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(240, 170, 83, 0.6);
        }
        
        .taskbar-color-option.selected {
            border-color: var(--dourado);
            box-shadow: 
                0 0 20px rgba(240, 170, 83, 0.8),
                inset 0 0 10px rgba(255, 255, 255, 0.2);
        }
        
        .taskbar-color-option::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
        }
        
        .taskbar-color-option.selected::after {
            opacity: 1;
        }
        
        .custom-color-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .custom-color-controls input[type="color"] {
            width: 60px;
            height: 40px;
            border: 2px solid var(--dourado);
            border-radius: 8px;
            background: transparent;
            cursor: pointer;
        }
        
        .apply-custom-color {
            background: linear-gradient(135deg, var(--dourado) 0%, rgba(240, 170, 83, 0.8) 100%);
            color: var(--vinho);
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .apply-custom-color:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(240, 170, 83, 0.4);
        }
        
        .taskbar-preview {
            background: var(--theme-taskbar);
            border-radius: 8px;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
            border: 1px solid rgba(240, 170, 83, 0.3);
        }
        
        .preview-start-btn {
            background: rgba(240, 170, 83, 0.2);
            color: var(--dourado);
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .preview-items {
            display: flex;
            gap: 8px;
        }
        
        .preview-item {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
        }
        
        .preview-clock {
            color: var(--dourado);
            font-size: 12px;
            font-weight: bold;
        }
        
        /* ========================================
           ‚≠ê SE√á√ïES DE RECENTES E FAVORITOS
           Aplica√ß√µes recentes e favoritas no menu
           ======================================== */
        
        .recent-apps-section,
        .favorites-section {
            position: absolute;
            width: 200px;
            background: rgba(11, 24, 54, 0.9);
            border: 2px solid var(--dourado);
            border-radius: 12px;
            padding: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
        }
        
        .recent-apps-section {
            top: 80px;
            left: 50px;
        }
        
        .favorites-section {
            top: 80px;
            right: 50px;
        }
        
        .recent-apps-title,
        .favorites-title {
            color: var(--dourado);
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 12px;
            text-align: center;
            text-shadow: 0 0 8px rgba(240, 170, 83, 0.8);
            border-bottom: 1px solid rgba(240, 170, 83, 0.3);
            padding-bottom: 8px;
        }
        
        .recent-apps-list,
        .favorites-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .recent-app-item,
        .favorite-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: rgba(240, 170, 83, 0.1);
            border: 1px solid rgba(240, 170, 83, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-size: 12px;
        }
        
        .recent-app-item:hover,
        .favorite-item:hover {
            background: rgba(240, 170, 83, 0.2);
            border-color: var(--dourado);
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(240, 170, 83, 0.3);
        }
        
        .recent-app-icon,
        .favorite-icon {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }
        
        .favorite-star {
            color: var(--dourado);
            font-size: 12px;
            margin-left: auto;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .favorite-star:hover {
            transform: scale(1.2);
            text-shadow: 0 0 8px var(--dourado);
        }
        
        /* Responsividade para novas se√ß√µes */
        @media (max-width: 768px) {
            .recent-apps-section,
            .favorites-section {
                width: 150px;
                padding: 10px;
            }
            
            .recent-apps-section {
                left: 20px;
            }
            
            .favorites-section {
                right: 20px;
            }
            
            .taskbar-color-popup {
                width: 90vw;
                max-width: 400px;
            }
        }
        
        /* ========================================
           ‚ú® EFEITOS VISUAIS AVAN√áADOS
           Sombras din√¢micas, part√≠culas e anima√ß√µes
           ======================================== */
        
        /* Sombras din√¢micas para √≠cones do desktop */
        .desktop-icon {
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }
        
        .desktop-icon:hover {
            transform: translateY(-5px) scale(1.05);
            filter: drop-shadow(0 8px 25px rgba(240, 170, 83, 0.4));
        }
        
        .desktop-icon.system-icon {
            background: linear-gradient(135deg, 
                rgba(240, 170, 83, 0.1) 0%, 
                rgba(62, 10, 41, 0.1) 50%, 
                rgba(11, 24, 54, 0.1) 100%);
            border: 2px solid rgba(240, 170, 83, 0.3);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        
        .desktop-icon.system-icon:hover {
            border-color: var(--dourado);
            box-shadow: 
                0 0 20px rgba(240, 170, 83, 0.6),
                inset 0 0 20px rgba(240, 170, 83, 0.1);
        }
        
        /* Anima√ß√µes cinematogr√°ficas para janelas */
        .window {
            animation: windowMaterialize 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.5));
        }
        
        @keyframes windowMaterialize {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
                filter: blur(10px);
            }
            50% {
                opacity: 0.7;
                transform: scale(1.02) translateY(-5px);
                filter: blur(2px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
                filter: blur(0);
            }
        }
        
        .window.closing {
            animation: windowDissolve 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        
        @keyframes windowDissolve {
            0% {
                opacity: 1;
                transform: scale(1) translateY(0);
                filter: blur(0);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.05) translateY(-10px);
                filter: blur(5px);
            }
            100% {
                opacity: 0;
                transform: scale(0.9) translateY(30px);
                filter: blur(15px);
            }
        }
        
        /* Efeitos de part√≠culas douradas */
        .mystical-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: radial-gradient(circle, var(--dourado) 0%, transparent 70%);
            border-radius: 50%;
            animation: particleFloat 6s infinite linear;
            opacity: 0;
        }
        
        @keyframes particleFloat {
            0% {
                opacity: 0;
                transform: translateY(100vh) rotate(0deg);
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) rotate(360deg);
            }
        }
        
        /* Bordas com brilho pulsante */
        .window-header {
            position: relative;
            overflow: hidden;
        }
        
        .window-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(240, 170, 83, 0.3) 50%, 
                transparent 100%);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        /* Transpar√™ncia inteligente */
        .window.focused {
            backdrop-filter: blur(20px);
            background: rgba(11, 24, 54, 0.95);
        }
        
        .window:not(.focused) {
            backdrop-filter: blur(5px);
            background: rgba(11, 24, 54, 0.8);
            opacity: 0.9;
        }
        
        /* Efeitos hover com ondula√ß√£o dourada */
        .desktop-icon::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(240, 170, 83, 0.3) 0%, transparent 70%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }
        
        .desktop-icon:hover::before {
            width: 120px;
            height: 120px;
        }
        
        /* ========================================
           üñºÔ∏è GALERIA DE IMAGENS
           Visualizador de imagens integrado
           ======================================== */
        
        .gallery-window {
            background: linear-gradient(135deg, 
                rgba(11, 24, 54, 0.95) 0%, 
                rgba(62, 10, 41, 0.95) 100%);
        }
        
        .gallery-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(240, 170, 83, 0.1);
            border-bottom: 2px solid var(--dourado);
        }
        
        .gallery-controls {
            display: flex;
            gap: 10px;
        }
        
        .gallery-btn {
            background: linear-gradient(135deg, var(--dourado) 0%, rgba(240, 170, 83, 0.8) 100%);
            color: var(--vinho);
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .gallery-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(240, 170, 83, 0.4);
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .gallery-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(240, 170, 83, 0.3);
        }
        
        .gallery-item:hover {
            transform: scale(1.05);
            border-color: var(--dourado);
            box-shadow: 0 8px 25px rgba(240, 170, 83, 0.4);
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-item-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            color: white;
            padding: 10px;
            font-size: 12px;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        
        .gallery-item:hover .gallery-item-overlay {
            transform: translateY(0);
        }
        
        /* ========================================
           üåå GERENCIADOR DE WALLPAPERS AVAN√áADO
           Upload e gerenciamento de pap√©is de parede
           ======================================== */
        
        .wallpaper-manager {
            background: linear-gradient(135deg, 
                rgba(11, 24, 54, 0.95) 0%, 
                rgba(62, 10, 41, 0.95) 100%);
        }
        
        .wallpaper-upload-zone {
            border: 3px dashed rgba(240, 170, 83, 0.5);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            margin: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .wallpaper-upload-zone:hover,
        .wallpaper-upload-zone.dragover {
            border-color: var(--dourado);
            background: rgba(240, 170, 83, 0.1);
            transform: scale(1.02);
        }
        
        .wallpaper-upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.7;
        }
        
        .wallpaper-upload-text {
            color: var(--dourado);
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .wallpaper-upload-hint {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }
        
        .wallpaper-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .wallpaper-preview {
            position: relative;
            aspect-ratio: 16/9;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(240, 170, 83, 0.3);
        }
        
        .wallpaper-preview:hover {
            transform: scale(1.05);
            border-color: var(--dourado);
            box-shadow: 0 8px 25px rgba(240, 170, 83, 0.4);
        }
        
        .wallpaper-preview.active {
            border-color: var(--dourado);
            box-shadow: 0 0 20px rgba(240, 170, 83, 0.6);
        }
        
        .wallpaper-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .wallpaper-preview-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .wallpaper-preview:hover .wallpaper-preview-overlay {
            opacity: 1;
        }
        
        .wallpaper-preview-actions {
            display: flex;
            gap: 10px;
        }
        
        .wallpaper-action-btn {
            background: rgba(240, 170, 83, 0.9);
            color: var(--vinho);
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .wallpaper-action-btn:hover {
            background: var(--dourado);
            transform: scale(1.1);
        }
            padding: 8px 15px;
            color: #3e0a29;
            font-weight: bold;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        
        .afast-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }
        
        .afast-button.secondary {
            background: linear-gradient(135deg, #666 0%, #444 100%);
            color: white;
        }
        
        .afast-close {
            position: absolute;
            top: 8px;
            right: 12px;
            background: none;
            border: none;
            color: #f0aa53;
            font-size: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        .afast-close:hover {
            color: white;
            transform: scale(1.2);
        }
        
        @keyframes afastPulse {
            0%, 100% { 
                transform: scale(1);
                filter: drop-shadow(0 0 5px #f0aa53);
            }
            50% { 
                transform: scale(1.1);
                filter: drop-shadow(0 0 15px #f0aa53);
            }
        }
        
        /* Central de Notifica√ß√µes */
        .notification-center {
            position: fixed;
            top: 60px;
            right: 20px;
            width: 320px;
            max-height: 500px;
            background: linear-gradient(135deg, #0b1836 0%, #3e0a29 100%);
            border: 2px solid #f0aa53;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
            z-index: 1900;
            transform: translateX(350px);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            overflow: hidden;
        }
        
        .notification-center.active {
            transform: translateX(0);
        }
        
        .notification-center-header {
            background: linear-gradient(135deg, #f0aa53 0%, #d4941e 100%);
            color: #3e0a29;
            padding: 15px;
            font-weight: bold;
            font-size: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notification-center-close {
            background: rgba(62, 10, 41, 0.2);
            border: 1px solid #3e0a29;
            color: #3e0a29;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .notification-center-close:hover {
            background: rgba(62, 10, 41, 0.4);
        }
        
        /* Filtros de Notifica√ß√£o */
        .notification-filters {
            display: flex;
            padding: 10px;
            gap: 5px;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid #f0aa53;
        }
        
        .filter-btn {
            flex: 1;
            background: rgba(240, 170, 83, 0.2);
            border: 1px solid #f0aa53;
            color: #f2eaff;
            padding: 8px 4px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .filter-btn:hover {
            background: rgba(240, 170, 83, 0.4);
        }
        
        .filter-btn.active {
            background: #f0aa53;
            color: #3e0a29;
        }
        
        /* Estat√≠sticas AF√ÅST */
        .afast-stats {
            display: flex;
            padding: 15px 10px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid #f0aa53;
        }
        
        .stat-item {
            flex: 1;
            text-align: center;
            color: #f2eaff;
        }
        
        .stat-number {
            display: block;
            font-size: 18px;
            font-weight: bold;
            color: #f0aa53;
        }
        
        .stat-label {
            font-size: 10px;
            opacity: 0.8;
        }
        
        /* Estado vazio */
        .no-notifications {
            text-align: center;
            padding: 40px 20px;
            color: #f2eaff;
            opacity: 0.7;
        }
        
        /* A√ß√µes da Central */
        .notification-center-actions {
            display: flex;
            padding: 10px;
            gap: 5px;
            background: rgba(0,0,0,0.2);
            border-top: 1px solid #f0aa53;
        }
        
        .action-btn {
            flex: 1;
            background: rgba(240, 170, 83, 0.2);
            border: 1px solid #f0aa53;
            color: #f2eaff;
            padding: 8px 4px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: rgba(240, 170, 83, 0.4);
            transform: translateY(-1px);
        }
        
        .notification-center-content {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .notification-item {
            background: rgba(0,0,0,0.3);
            border: 1px solid #f0aa53;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            color: #f2eaff;
            font-size: 13px;
            transition: all 0.3s;
        }
        
        .notification-item:hover {
            background: rgba(240, 170, 83, 0.1);
            transform: translateX(5px);
        }
        
        .notification-item-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .notification-item-title {
            font-weight: bold;
            color: #f0aa53;
        }
        
        .notification-item-time {
            font-size: 11px;
            color: #b2d1b1;
            font-style: italic;
        }
        
        .notification-item-content {
            line-height: 1.4;
        }
        
        /* Modal de Personaliza√ß√£o */
        .personalization-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 4000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .personalization-modal.active {
            display: flex;
        }
        
        .personalization-dialog {
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            width: 600px;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 4px;
        }
        
        .personalization-header {
            background: var(--theme-window-header);
            color: white;
            padding: 8px 12px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .personalization-close {
            background: #ff6b6b;
            color: white;
            border: 1px outset #ff6b6b;
            width: 20px;
            height: 18px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }
        
        .personalization-close:hover {
            background: #ff5252;
        }
        
        .personalization-close:active {
            border: 1px inset #ff6b6b;
        }
        
        .personalization-content {
            padding: 16px;
        }
        
        .personalization-section {
            margin-bottom: 20px;
            border: 1px inset #c0c0c0;
            padding: 12px;
        }
        
        .personalization-section h3 {
            margin-bottom: 12px;
            color: var(--azul-escuro);
            font-size: 12px;
        }
        
        /* Sistema de Upload de Foto */
        .profile-photo-section {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .profile-photo-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid var(--dourado);
            margin: 0 auto 10px;
            background: var(--azul-escuro);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: var(--dourado);
            overflow: hidden;
        }
        
        .profile-photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-upload-btn {
            background: var(--verde-claro);
            color: var(--azul-escuro);
            border: 2px outset var(--verde-claro);
            padding: 6px 12px;
            cursor: pointer;
            font-size: 11px;
            margin: 4px;
            border-radius: 4px;
        }
        
        .photo-upload-btn:hover {
            background: #9bc49a;
        }
        
        .photo-upload-btn:active {
            border: 2px inset var(--verde-claro);
        }
        
        /* Sistema de Wallpapers Personalizados */
        .wallpaper-upload-section {
            border: 1px dashed var(--dourado);
            padding: 20px;
            text-align: center;
            margin: 10px 0;
            background: rgba(240, 170, 83, 0.1);
            border-radius: 8px;
        }
        
        .wallpaper-preview {
            width: 100%;
            height: 60px;
            border: 2px inset #c0c0c0;
            margin: 8px 0;
            background-size: cover;
            background-position: center;
            border-radius: 4px;
        }
        
        .custom-color-picker {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .color-input {
            width: 40px;
            height: 30px;
            border: 2px outset #c0c0c0;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .color-hex-input {
            background: white;
            border: 1px inset #c0c0c0;
            padding: 4px 8px;
            font-family: monospace;
            font-size: 11px;
            width: 80px;
        }
        
        .color-palette {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 4px;
            margin-bottom: 12px;
        }
        
        .color-option {
            width: 32px;
            height: 32px;
            border: 2px outset #c0c0c0;
            cursor: pointer;
            border-radius: 4px;
            position: relative;
        }
        
        .color-option:hover {
            border: 2px inset #c0c0c0;
        }
        
        .color-option.selected {
            border: 2px solid var(--dourado);
            box-shadow: 0 0 4px var(--dourado);
        }
        
        .wallpaper-section {
            margin-bottom: 12px;
        }
        
        .wallpaper-upload {
            margin-bottom: 8px;
        }
        
        .wallpaper-upload input[type="file"] {
            width: 100%;
            padding: 4px;
            border: 1px inset #c0c0c0;
        }
        
        .wallpaper-presets {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }
        
        .wallpaper-preset {
            height: 60px;
            border: 2px outset #c0c0c0;
            cursor: pointer;
            border-radius: 4px;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .wallpaper-preset:hover {
            border: 2px inset #c0c0c0;
        }
        
        .wallpaper-preset.selected {
            border: 2px solid var(--dourado);
            box-shadow: 0 0 4px var(--dourado);
        }
        
        .personalization-buttons {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid #808080;
        }
        
        .personalization-button {
            background: #d0d0d0;
            border: 1px outset #d0d0d0;
            padding: 6px 12px;
            cursor: pointer;
            font-size: 11px;
        }
        
        .personalization-button:hover {
            background: #e0e0e0;
        }
        
        .personalization-button:active {
            border: 1px inset #d0d0d0;
        }
        
        .personalization-button.primary {
            background: var(--azul-escuro);
            color: white;
        }
        
        .personalization-button.primary:hover {
            background: #1a2a4a;
        }
        
        /* ========================================
           üåü MENU INICIAR REVOLUCION√ÅRIO
           Layout em mandala com categorias m√≠sticas
           ======================================== */
        
        .start-menu {
            position: fixed;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            height: 500px;
            background: radial-gradient(circle at center, 
                rgba(30, 20, 60, 0.95) 0%, 
                rgba(15, 10, 40, 0.98) 70%, 
                rgba(0, 0, 0, 0.99) 100%);
            border: 3px solid var(--dourado);
            border-radius: 50%;
            box-shadow: 
                0 0 50px rgba(212, 175, 55, 0.6),
                inset 0 0 30px rgba(212, 175, 55, 0.2),
                0 0 100px rgba(0, 0, 0, 0.8);
            z-index: 2500;
            display: none;
            animation: mandalaOpen 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }
        
        .start-menu.active {
            display: block;
        }
        
        @keyframes mandalaOpen {
            0% {
                opacity: 0;
                transform: translateX(-50%) scale(0.3) rotate(-180deg);
                filter: blur(20px);
            }
            50% {
                opacity: 0.8;
                transform: translateX(-50%) scale(1.1) rotate(-90deg);
                filter: blur(5px);
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) scale(1) rotate(0deg);
                filter: blur(0px);
            }
        }
        
        /* Centro da mandala - Logo e busca */
        .mandala-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, var(--dourado) 0%, #8b6914 100%);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 0 30px var(--dourado),
                inset 0 0 20px rgba(0, 0, 0, 0.3);
            animation: centerPulse 3s ease-in-out infinite;
        }
        
        @keyframes centerPulse {
            0%, 100% {
                box-shadow: 
                    0 0 20px var(--dourado),
                    inset 0 0 15px rgba(0, 0, 0, 0.3);
            }
            50% {
                box-shadow: 
                    0 0 40px var(--dourado),
                    inset 0 0 25px rgba(0, 0, 0, 0.3);
            }
        }
        
        .mandala-logo {
            width: 40px;
            height: 40px;
            image-rendering: pixelated;
            filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.8));
        }
        
        .mandala-search {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
        }
        
        .mandala-search input {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid var(--dourado);
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: var(--dourado);
            font-size: 12px;
            text-align: center;
            outline: none;
            backdrop-filter: blur(5px);
        }
        
        .mandala-search input::placeholder {
            color: rgba(212, 175, 55, 0.7);
        }
        
        .mandala-search input:focus {
            box-shadow: 0 0 20px var(--dourado);
            background: rgba(0, 0, 0, 0.9);
        }
        
        /* Roda dos Elementos */
        .elements-wheel {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            border-radius: 50%;
            border: 2px solid rgba(212, 175, 55, 0.3);
        }
        
        .element-sector {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            border: 2px solid transparent;
        }
        
        .element-sector:hover {
            transform: scale(1.2);
            border: 2px solid var(--dourado);
            box-shadow: 0 0 30px var(--dourado);
        }
        
        .element-fire {
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: radial-gradient(circle, rgba(255, 69, 0, 0.8) 0%, rgba(139, 21, 56, 0.6) 100%);
        }
        
        .element-earth {
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: radial-gradient(circle, rgba(101, 67, 33, 0.8) 0%, rgba(62, 39, 35, 0.6) 100%);
        }
        
        .element-air {
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            background: radial-gradient(circle, rgba(135, 206, 235, 0.8) 0%, rgba(70, 130, 180, 0.6) 100%);
        }
        
        .element-water {
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            background: radial-gradient(circle, rgba(0, 191, 255, 0.8) 0%, rgba(30, 144, 255, 0.6) 100%);
        }
        
        .element-icon {
            font-size: 24px;
            margin-bottom: 4px;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.8));
        }
        
        .element-name {
            font-size: 10px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }
        
        /* Aplica√ß√µes em √≥rbita */
        .app-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 450px;
            height: 450px;
            border-radius: 50%;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .app-item {
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(212, 175, 55, 0.4);
            backdrop-filter: blur(3px);
        }
        
        .app-item:hover {
            transform: scale(1.3);
            background: rgba(212, 175, 55, 0.2);
            border: 2px solid var(--dourado);
            box-shadow: 0 0 20px var(--dourado);
        }
        
        .app-item.hidden {
            display: none;
        }
        
        .app-icon {
            font-size: 20px;
            margin-bottom: 2px;
        }
        
        .app-name {
            font-size: 8px;
            color: white;
            text-align: center;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.8);
            line-height: 1;
        }
        
        /* A√ß√µes r√°pidas na borda */
        .quick-actions-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 550px;
            height: 550px;
            border-radius: 50%;
        }
        
        .quick-action {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(212, 175, 55, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
        }
        
        .quick-action:hover {
            transform: scale(1.2);
            box-shadow: 0 0 25px var(--dourado);
        }
        
        .quick-action.personalize {
            top: 20px;
            right: 80px;
        }
        
        .quick-action.help {
            bottom: 20px;
            right: 80px;
        }
        
        .quick-action.logout {
            bottom: 20px;
            left: 80px;
            background: rgba(220, 38, 38, 0.8);
        }
        
        /* Part√≠culas m√≠sticas de fundo */
        .mandala-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            border-radius: 50%;
        }
        
        .mandala-particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: var(--dourado);
            border-radius: 50%;
            animation: mandalaParticleFloat 8s ease-in-out infinite;
            opacity: 0;
        }
        
        @keyframes mandalaParticleFloat {
            0%, 100% {
                opacity: 0;
                transform: translateY(100%) scale(0) rotate(0deg);
            }
            20% {
                opacity: 1;
                transform: translateY(80%) scale(1) rotate(90deg);
            }
            80% {
                opacity: 1;
                transform: translateY(20%) scale(1) rotate(270deg);
            }
            100% {
                opacity: 0;
                transform: translateY(0%) scale(0) rotate(360deg);
            }
        }
        
        .start-menu-header {
            background: var(--theme-window-header);
            color: white;
            padding: 12px 16px;
            font-weight: bold;
            font-size: 14px;
            border-bottom: 2px solid #808080;
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
        }
        
        .start-menu-header .logo {
            font-size: 20px;
            filter: drop-shadow(0 0 5px var(--dourado));
        }
        
        .start-menu-items {
            background: #c0c0c0;
            padding: 8px 0;
        }
        
        .start-menu-item {
            padding: 8px 16px;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: black;
            transition: all 0.1s;
            border-left: 3px solid transparent;
            position: relative;
        }
        
        .start-menu-item:hover {
            background: linear-gradient(90deg, #316AC5, #4a7bc8);
            color: white;
            border-left: 3px solid var(--dourado);
            transform: translateX(2px);
        }
        
        .start-menu-item .icon {
            font-size: 24px;
            min-width: 32px;
            text-align: center;
            filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.3));
        }
        
        .start-menu-item .text {
            flex: 1;
            font-weight: 500;
        }
        
        .start-menu-item.premium::after {
            content: '‚≠ê';
            position: absolute;
            right: 12px;
            font-size: 16px;
            color: var(--dourado);
            text-shadow: 0 0 3px var(--dourado);
            animation: starGlow 2s ease-in-out infinite;
        }
        
        .start-menu-item.premium:hover::after {
            color: white;
            text-shadow: 0 0 5px white;
        }
        
        .start-menu-separator {
            height: 2px;
            background: linear-gradient(90deg, transparent, #808080, transparent);
            margin: 4px 12px;
        }
        
        .start-menu-search {
            padding: 8px 12px;
            background: #e0e0e0;
            border-bottom: 1px solid #808080;
        }
        
        .start-menu-search input:focus {
            border-color: var(--dourado);
            box-shadow: 0 0 5px rgba(240, 170, 83, 0.3);
        }
        
        .start-menu-quick-actions {
            display: flex;
            gap: 4px;
            padding: 8px;
            background: #d0d0d0;
            border-top: 1px solid #808080;
        }
        
        .quick-action-btn {
            flex: 1;
            padding: 6px 8px;
            background: #c0c0c0;
            border: 1px outset #c0c0c0;
            font-size: 11px;
            cursor: pointer;
            border-radius: 2px;
            color: #000;
            transition: all 0.1s;
        }
        
        .quick-action-btn:hover {
            background: #b0b0b0;
            border: 1px inset #c0c0c0;
        }
        
        .quick-action-btn:active {
            border: 1px inset #c0c0c0;
            background: #a0a0a0;
        }
        
        .logout-btn {
            background: #ff6b6b;
            color: white;
            border: 1px outset #ff6b6b;
        }
        
        .logout-btn:hover {
            background: #ff5252;
        }
        
        .start-menu-item.system-app {
            background: linear-gradient(90deg, #f0f0f0, #e8e8e8);
            border-left: 3px solid #4CAF50;
            font-weight: 600;
        }
        
        .start-menu-item.system-app:hover {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            color: white;
            border-left: 3px solid var(--dourado);
        }
        
        .start-menu-item.hidden {
            display: none;
        }
        
        .start-menu-footer {
            background: #d0d0d0;
            padding: 8px 16px;
            border-top: 1px solid #808080;
            font-size: 11px;
            color: #666;
            text-align: center;
        }
        
        /* ========================================
           üé¨ SISTEMA DE JANELAS CINEMATOGR√ÅFICO
           Anima√ß√µes m√°gicas de materializa√ß√£o e dissolu√ß√£o
           ======================================== */
        
        .window {
            position: fixed;
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            min-width: 400px;
            min-height: 300px;
            z-index: 1500;
            display: none;
            box-shadow: 
                2px 2px 10px rgba(0,0,0,0.3),
                0 0 20px rgba(212, 175, 55, 0.2);
            border-radius: 4px;
            backdrop-filter: blur(2px);
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform-origin: center center;
        }
        
        .window.active {
            display: block;
        }
        
        .window.focused {
            z-index: 1600;
            border: 2px solid var(--dourado);
            box-shadow: 
                2px 2px 15px rgba(0,0,0,0.4),
                0 0 30px rgba(212, 175, 55, 0.4),
                inset 0 0 20px rgba(212, 175, 55, 0.1);
            animation: windowFocusPulse 2s ease-in-out infinite;
        }
        
        /* Anima√ß√£o de materializa√ß√£o */
        .window.materializing {
            animation: windowMaterialize 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }
        
        /* Anima√ß√£o de dissolu√ß√£o */
        .window.dissolving {
            animation: windowDissolve 0.6s ease-in forwards;
        }
        
        /* Efeito de brilho pulsante para janela focada */
        @keyframes windowFocusPulse {
            0%, 100% {
                box-shadow: 
                    2px 2px 15px rgba(0,0,0,0.4),
                    0 0 20px rgba(212, 175, 55, 0.3),
                    inset 0 0 15px rgba(212, 175, 55, 0.1);
            }
            50% {
                box-shadow: 
                    2px 2px 20px rgba(0,0,0,0.5),
                    0 0 40px rgba(212, 175, 55, 0.6),
                    inset 0 0 25px rgba(212, 175, 55, 0.2);
            }
        }
        
        /* Anima√ß√£o de materializa√ß√£o m√°gica */
        @keyframes windowMaterialize {
            0% {
                opacity: 0;
                transform: scale(0.3) rotate(10deg);
                filter: blur(10px) brightness(2);
                box-shadow: 
                    0 0 50px rgba(212, 175, 55, 0.8),
                    inset 0 0 30px rgba(255, 255, 255, 0.5);
            }
            30% {
                opacity: 0.7;
                transform: scale(0.8) rotate(2deg);
                filter: blur(3px) brightness(1.5);
                box-shadow: 
                    2px 2px 20px rgba(0,0,0,0.3),
                    0 0 30px rgba(212, 175, 55, 0.6);
            }
            70% {
                opacity: 0.9;
                transform: scale(1.05) rotate(-1deg);
                filter: blur(1px) brightness(1.2);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
                filter: blur(0px) brightness(1);
                box-shadow: 
                    2px 2px 15px rgba(0,0,0,0.4),
                    0 0 20px rgba(212, 175, 55, 0.3);
            }
        }
        
        /* Anima√ß√£o de dissolu√ß√£o em part√≠culas douradas */
        @keyframes windowDissolve {
            0% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
                filter: blur(0px) brightness(1);
            }
            30% {
                opacity: 0.8;
                transform: scale(1.02) rotate(1deg);
                filter: blur(1px) brightness(1.3);
                box-shadow: 
                    2px 2px 20px rgba(0,0,0,0.4),
                    0 0 40px rgba(212, 175, 55, 0.7);
            }
            70% {
                opacity: 0.4;
                transform: scale(0.9) rotate(-2deg);
                filter: blur(5px) brightness(1.8);
                box-shadow: 
                    0 0 60px rgba(212, 175, 55, 0.9),
                    inset 0 0 40px rgba(255, 255, 255, 0.3);
            }
            100% {
                opacity: 0;
                transform: scale(0.2) rotate(15deg);
                filter: blur(15px) brightness(3);
                box-shadow: 
                    0 0 100px rgba(212, 175, 55, 1),
                    inset 0 0 50px rgba(255, 255, 255, 0.8);
            }
        }
        
        /* Transpar√™ncia inteligente baseada no conte√∫do */
        .window.transparent-mode {
            background: rgba(192, 192, 192, 0.85);
            backdrop-filter: blur(8px);
            border: 2px solid rgba(212, 175, 55, 0.6);
        }
        
        .window.transparent-mode .window-content {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* Efeito de ondula√ß√£o dourada no hover */
        .window:hover {
            box-shadow: 
                2px 2px 15px rgba(0,0,0,0.4),
                0 0 25px rgba(212, 175, 55, 0.4);
            animation: windowHoverRipple 0.6s ease-out;
        }
        
        @keyframes windowHoverRipple {
            0% {
                box-shadow: 
                    2px 2px 15px rgba(0,0,0,0.4),
                    0 0 20px rgba(212, 175, 55, 0.3);
            }
            50% {
                box-shadow: 
                    2px 2px 20px rgba(0,0,0,0.5),
                    0 0 35px rgba(212, 175, 55, 0.6),
                    0 0 60px rgba(212, 175, 55, 0.2);
            }
            100% {
                box-shadow: 
                    2px 2px 15px rgba(0,0,0,0.4),
                    0 0 25px rgba(212, 175, 55, 0.4);
            }
        }
        
        /* Part√≠culas m√°gicas para efeitos especiais */
        .window-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            border-radius: 4px;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, var(--dourado) 0%, transparent 70%);
            border-radius: 50%;
            animation: particleFloat 3s ease-in-out infinite;
            opacity: 0;
        }
        
        @keyframes particleFloat {
            0% {
                opacity: 0;
                transform: translateY(100%) scale(0);
            }
            20% {
                opacity: 1;
                transform: translateY(80%) scale(1);
            }
            80% {
                opacity: 1;
                transform: translateY(20%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(0%) scale(0);
            }
        }
        
        /* Minimiza√ß√£o m√°gica - transforma√ß√£o em orbe de luz */
        .window.minimizing {
            animation: windowMinimize 0.5s ease-in forwards;
        }
        
        @keyframes windowMinimize {
            0% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
                border-radius: 4px;
            }
            50% {
                opacity: 0.8;
                transform: scale(0.5) rotate(180deg);
                border-radius: 50%;
                background: radial-gradient(circle, var(--dourado) 0%, transparent 70%);
                box-shadow: 0 0 50px var(--dourado);
            }
            100% {
                opacity: 0;
                transform: scale(0.1) rotate(360deg);
                border-radius: 50%;
                background: var(--dourado);
                box-shadow: 0 0 100px var(--dourado);
            }
        }
        
        .window-header {
            background: var(--theme-window-header);
            color: white;
            padding: 4px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            font-size: 11px;
            font-weight: bold;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
        }
        
        .window-title {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .window-controls {
            display: flex;
            gap: 2px;
        }
        
        .window-control {
            width: 18px;
            height: 16px;
            background: #c0c0c0;
            border: 1px outset #c0c0c0;
            cursor: pointer;
            font-size: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            color: black;
        }
        
        .window-control:hover {
            background: #d0d0d0;
        }
        
        .window-control:active {
            border: 1px inset #c0c0c0;
        }
        
        .window-control.close {
            background: #ff6b6b;
            color: white;
        }
        
        .window-content {
            height: calc(100% - 24px);
            overflow: hidden;
            position: relative;
        }
        
        .window-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            font-size: 12px;
            color: #666;
        }
        
        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--azul-escuro);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 12px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .window-resize-handle {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 16px;
            height: 16px;
            cursor: se-resize;
            background: linear-gradient(-45deg, transparent 40%, #808080 40%, #808080 60%, transparent 60%);
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            .desktop-icons {
                grid-template-columns: repeat(auto-fit, 60px);
                gap: 15px;
                padding: 15px;
            }
            
            .desktop-icon .icon {
                font-size: 24px;
            }
            
            .desktop-icon .label {
                font-size: 9px;
            }
            
            .taskbar {
                height: 36px;
            }
            
            .desktop {
                height: calc(100vh - 36px);
            }
            
            .start-menu {
                width: 280px;
            }
            
            .personalization-dialog {
                width: 90vw;
                  /* ========================================
           üì± RESPONSIVIDADE TOTAL - MODO MOBILE
           Sistema adaptativo para todos os dispositivos
           ======================================== */
        
        /* Tablets e telas m√©dias (768px - 1024px) */
        @media (max-width: 1024px) and (min-width: 769px) {
            .start-menu {
                width: 450px;
                height: 400px;
            }
            
            .start-menu-mandala {
                width: 400px;
                height: 350px;
            }
            
            .gatomante-chat {
                width: 320px;
                height: 400px;
            }
            
            .window {
                min-width: 300px;
                min-height: 200px;
            }
            
            .taskbar {
                height: 55px;
            }
            
            .system-indicator {
                width: 36px;
                height: 36px;
            }
        }
        
        /* Smartphones e telas pequenas (at√© 768px) */
        @media (max-width: 768px) {
            /* Desktop adaptativo */
            .desktop {
                grid-template-columns: repeat(auto-fit, 60px);
                gap: 15px;
                padding: 15px;
                padding-bottom: 70px; /* Espa√ßo para taskbar mobile */
            }
            
            .desktop-icon {
                width: 60px;
                height: 70px;
            }
            
            .desktop-icon .icon {
                font-size: 24px;
                margin-bottom: 4px;
            }
            
            .desktop-icon .label {
                font-size: 10px;
                line-height: 1.2;
            }
            
            /* Taskbar mobile */
            .taskbar {
                height: 60px;
                padding: 0 10px;
                flex-direction: row;
                justify-content: space-between;
            }
            
            .taskbar-left {
                flex: 0 0 auto;
            }
            
            .taskbar-center {
                flex: 1;
                justify-content: center;
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .taskbar-center::-webkit-scrollbar {
                display: none;
            }
            
            .taskbar-right {
                flex: 0 0 auto;
                gap: 6px;
            }
            
            .start-button {
                width: 45px;
                height: 45px;
                font-size: 12px;
                border-radius: 12px;
            }
            
            .system-indicator {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            /* Menu Iniciar mobile */
            .start-menu {
                width: 100vw;
                height: 100vh;
                max-width: none;
                max-height: none;
                left: 0;
                bottom: 0;
                border-radius: 0;
                background: linear-gradient(135deg, 
                    rgba(75, 0, 130, 0.98) 0%, 
                    rgba(25, 25, 112, 0.98) 50%, 
                    rgba(0, 0, 0, 0.98) 100%);
            }
            
            .start-menu-mandala {
                width: 90vw;
                height: 60vh;
                max-width: 350px;
                max-height: 350px;
            }
            
            .start-menu-center {
                width: 80px;
                height: 80px;
            }
            
            .start-menu-center img {
                width: 40px;
                height: 40px;
            }
            
            .start-menu-app {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .start-menu-search {
                width: 90%;
                max-width: 300px;
                margin: 20px auto;
            }
            
            /* Janelas mobile */
            .window {
                width: 95vw !important;
                height: 80vh !important;
                max-width: none;
                max-height: none;
                left: 2.5vw !important;
                top: 10vh !important;
                border-radius: 15px;
            }
            
            .window-header {
                height: 50px;
                padding: 0 15px;
                touch-action: none;
            }
            
            .window-title {
                font-size: 14px;
            }
            
            .window-controls {
                gap: 15px;
            }
            
            .window-control {
                width: 35px;
                height: 35px;
                font-size: 16px;
                border-radius: 8px;
            }
            
            .window-content {
                padding: 15px;
            }
            
            /* Chat do Gatomante mobile */
            .gatomante-chat {
                width: 95vw;
                height: 70vh;
                left: 2.5vw;
                bottom: 70px;
                border-radius: 15px;
            }
            
            .gatomante-chat-header {
                padding: 12px 15px;
            }
            
            .gatomante-chat-avatar {
                width: 35px;
                height: 35px;
                font-size: 18px;
            }
            
            .gatomante-chat-input {
                font-size: 14px;
                padding: 10px 15px;
            }
            
            .gatomante-voice-btn,
            .gatomante-send-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            /* Popups mobile */
            .popup {
                width: 90vw !important;
                max-width: 350px;
                left: 50% !important;
                transform: translateX(-50%);
                border-radius: 15px;
            }
            
            .calendar-popup {
                bottom: 70px;
                right: auto;
            }
            
            .planetary-popup {
                bottom: 70px;
                right: auto;
            }
            
            /* Workspaces mobile */
            .workspace-switcher {
                position: fixed;
                top: 10px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0, 0, 0, 0.8);
                border-radius: 20px;
                padding: 5px;
                z-index: 1500;
            }
            
            .workspace-tab {
                width: 35px;
                height: 35px;
                font-size: 12px;
            }
            
            .workspace-indicator {
                top: 60px;
                left: 50%;
                transform: translateX(-50%);
                font-size: 12px;
                padding: 5px 10px;
            }
            
            /* Snap zones mobile */
            .snap-zones {
                display: none; /* Desabilitar snap zones em mobile */
            }
            
            /* Gatomante mobile */
            .gatomante {
                width: 50px;
                height: 50px;
                bottom: 80px;
                right: 15px;
                font-size: 20px;
            }
            
            .gatomante-balloon {
                width: 200px;
                right: 60px;
                bottom: 10px;
                font-size: 11px;
                padding: 8px 12px;
            }
            
            /* √Åudio ambiente mobile */
            .ambient-audio-modal {
                width: 95vw;
                height: 80vh;
                max-width: none;
                max-height: none;
                left: 2.5vw;
                top: 10vh;
                border-radius: 15px;
            }
            
            /* Personaliza√ß√£o mobile */
            .personalization-modal {
                width: 95vw;
                height: 85vh;
                max-width: none;
                max-height: none;
                left: 2.5vw;
                top: 7.5vh;
                border-radius: 15px;
            }
            
            /* Notifica√ß√µes AF√ÅST mobile */
            .afast-notification {
                width: 90vw;
                max-width: 300px;
                right: 5vw;
                bottom: 80px;
                border-radius: 12px;
            }
            
            /* Part√≠culas reduzidas em mobile */
            .mystical-particles {
                opacity: 0.3;
            }
            
            .desktop-particles {
                opacity: 0.2;
            }
        }
        
        /* Smartphones pequenos (at√© 480px) */
        @media (max-width: 480px) {
            .desktop {
                grid-template-columns: repeat(auto-fit, 55px);
                gap: 12px;
                padding: 12px;
            }
            
            .desktop-icon {
                width: 55px;
                height: 65px;
            }
            
            .desktop-icon .icon {
                font-size: 22px;
            }
            
            .desktop-icon .label {
                font-size: 9px;
            }
            
            .taskbar {
                height: 55px;
                padding: 0 8px;
            }
            
            .start-button {
                width: 40px;
                height: 40px;
                font-size: 10px;
            }
            
            .system-indicator {
                width: 35px;
                height: 35px;
                font-size: 14px;
            }
            
            .start-menu-mandala {
                width: 85vw;
                height: 50vh;
                max-width: 300px;
                max-height: 300px;
            }
            
            .start-menu-app {
                width: 45px;
                height: 45px;
                font-size: 18px;
            }
            
            .gatomante-chat {
                width: 98vw;
                left: 1vw;
                height: 75vh;
            }
            
            .window {
                width: 98vw !important;
                left: 1vw !important;
                height: 85vh !important;
                top: 7.5vh !important;
            }
        }
        
        /* Orienta√ß√£o landscape em mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            .desktop {
                grid-template-columns: repeat(auto-fit, 50px);
                gap: 10px;
                padding: 10px;
                padding-bottom: 60px;
            }
            
            .desktop-icon {
                width: 50px;
                height: 60px;
            }
            
            .desktop-icon .icon {
                font-size: 20px;
            }
            
            .desktop-icon .label {
                font-size: 9px;
            }
            
            .window {
                width: 90vw !important;
                height: 70vh !important;
                left: 5vw !important;
                top: 15vh !important;
            }
            
            .gatomante-chat {
                width: 85vw;
                height: 60vh;
                left: 7.5vw;
            }
            
            .start-menu-mandala {
                width: 60vw;
                height: 50vh;
                max-width: 400px;
                max-height: 250px;
            }
        }
        
        /* Suporte a touch */
        @media (hover: none) and (pointer: coarse) {
            /* Aumentar √°reas de toque */
            .desktop-icon,
            .window-control,
            .system-indicator,
            .start-button,
            .taskbar-item {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Remover efeitos hover em dispositivos touch */
            .desktop-icon:hover,
            .window-control:hover,
            .system-indicator:hover,
            .start-button:hover {
                transform: none;
                box-shadow: none;
            }
            
            /* Adicionar efeitos de toque */
            .desktop-icon:active,
            .window-control:active,
            .system-indicator:active,
            .start-button:active {
                transform: scale(0.95);
                opacity: 0.8;
            }
        }
    </style>
</head>
<body>
    <!-- ========================================
         üöÄ SISTEMA DE INICIALIZA√á√ÉO COMPLETO
         Boot Screen + Tela de Boas-vindas
         ======================================== -->
    
    <!-- Tela de Boot M√≠stico -->
    <div class="boot-screen" id="bootScreen">
        <!-- Part√≠culas m√≠sticas de fundo -->
        <div class="boot-particles" id="bootParticles"></div>
        
        <!-- Logo Aurora OS -->
        <div class="boot-logo">
            <h1>üåü AURORA OS</h1>
            <div class="subtitle">‚Ä¢ MYSTICSOFT ‚Ä¢</div>
        </div>
        
        <!-- Mandala de carregamento -->
        <div class="boot-mandala">
            <div class="mandala-ring"></div>
            <div class="mandala-ring"></div>
            <div class="mandala-ring"></div>
            <div class="mandala-ring"></div>
        </div>
        
        <!-- Mensagem de carregamento -->
        <div class="boot-message">
            <div class="loading-text" id="bootLoadingText">Invocando energias m√≠sticas...</div>
            
            <!-- Barra de progresso m√≠stica -->
            <div class="boot-progress">
                <div class="boot-progress-fill" id="bootProgressFill"></div>
            </div>
            <div class="boot-progress-text" id="bootProgressText">0%</div>
        </div>
        
        <!-- Informa√ß√µes do sistema -->
        <div class="boot-info">
            <div class="version">Vers√£o 2.0.0 ‚Ä¢ Build 2025.09.28</div>
            <div class="copyright">¬© 2025 Aurora Sagrada ‚Ä¢ MysticSoft Technologies</div>
        </div>
    </div>
    
    <!-- Tela de Boas-vindas Completa -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-container">
            <!-- Cabe√ßalho -->
            <div class="welcome-header">
                <h1>üåü Aurora OS ‚Ä¢ MysticSoft</h1>
                <div class="moon-title">üåô BOAS-VINDAS! üåô</div>
                <div class="subtitle">
                    Bem-vindo ao Sistema Operacional M√≠stico<br>
                    mais avan√ßado do universo!
                </div>
            </div>
            
            <!-- Container principal de login -->
            <div class="welcome-main">
                <!-- Se√ß√£o de login -->
                <div class="login-section">
                    <h3>üë§ FAZER LOGIN</h3>
                    
                    <div class="form-group">
                        <label for="loginEmail">üìß Email ou Usu√°rio</label>
                        <input type="text" id="loginEmail" placeholder="Digite seu email ou usu√°rio..." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="loginPassword">üîí Senha</label>
                        <input type="password" id="loginPassword" placeholder="Digite sua senha..." required>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="rememberMe">
                        <label for="rememberMe">Lembrar-me</label>
                    </div>
                    
                    <!-- Bot√µes de a√ß√£o -->
                    <div class="action-buttons">
                        <button class="btn-primary" onclick="performLogin()">üåü ENTRAR</button>
                        <button class="btn-secondary" onclick="showForgotPassword()">üëÅÔ∏è Esqueci a senha</button>
                    </div>
                </div>
                
                <!-- Separador -->
                <div class="divider">OU</div>
                
                <!-- Bot√µes adicionais -->
                <div class="action-buttons">
                    <button class="btn-secondary" onclick="showRegisterForm()">‚ú® CRIAR NOVA CONTA</button>
                    <button class="btn-secondary" onclick="enterDemoMode()">üé≠ MODO DEMONSTRA√á√ÉO</button>
                </div>
                
                <!-- Mensagem de status -->
                <div class="status-message" id="statusMessage"></div>
            </div>
        </div>
        
        <!-- Gatomante na tela de boas-vindas -->
        <div class="welcome-gatomante">
            <div class="gatomante-avatar">üê±‚Äç‚¨õ</div>
            <div class="gatomante-speech" id="welcomeGatomanteText">
                Miau! Pronto para explorar os mist√©rios do Aurora OS?
            </div>
        </div>
    </div>
    
    <!-- Formul√°rio de Registro (oculto inicialmente) -->
    <div class="register-screen" id="registerScreen" style="display: none;">
        <div class="welcome-container">
            <div class="welcome-header">
                <h1>‚ú® CRIAR NOVA CONTA</h1>
                <div class="subtitle">
                    Junte-se √† comunidade m√≠stica do Aurora OS
                </div>
            </div>
            
            <div class="welcome-main">
                <!-- Etapa 1: Informa√ß√µes B√°sicas -->
                <div class="register-step" id="registerStep1">
                    <h3>üìù INFORMA√á√ïES B√ÅSICAS</h3>
                    
                    <div class="form-group">
                        <label for="registerName">üë§ Nome Completo</label>
                        <input type="text" id="registerName" placeholder="Digite seu nome completo..." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerEmail">üìß Email</label>
                        <input type="email" id="registerEmail" placeholder="Digite seu email..." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerPassword">üîí Senha</label>
                        <input type="password" id="registerPassword" placeholder="Digite uma senha segura..." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerPasswordConfirm">üîí Confirmar Senha</label>
                        <input type="password" id="registerPasswordConfirm" placeholder="Confirme sua senha..." required>
                    </div>
                </div>
                
                <!-- Etapa 2: Dados Astrol√≥gicos (Opcional) -->
                <div class="register-step" id="registerStep2" style="display: none;">
                    <h3>üîÆ DADOS ASTROL√ìGICOS (OPCIONAL)</h3>
                    
                    <div class="form-group">
                        <label for="birthDate">üìÖ Data de Nascimento</label>
                        <input type="date" id="birthDate">
                    </div>
                    
                    <div class="form-group">
                        <label for="birthTime">‚è∞ Hora de Nascimento</label>
                        <input type="time" id="birthTime">
                    </div>
                    
                    <div class="form-group">
                        <label for="birthPlace">üåç Local de Nascimento</label>
                        <input type="text" id="birthPlace" placeholder="Cidade, Estado, Pa√≠s...">
                    </div>
                </div>
                
                <!-- Etapa 3: Interesses e Foto -->
                <div class="register-step" id="registerStep3" style="display: none;">
                    <h3>üì∏ FINALIZA√á√ÉO</h3>
                    
                    <div class="form-group">
                        <label>üîÆ Interesses M√≠sticos</label>
                        <div class="interests-grid">
                            <label><input type="checkbox" value="astrologia"> Astrologia</label>
                            <label><input type="checkbox" value="tarot"> Tarot</label>
                            <label><input type="checkbox" value="cristais"> Cristais</label>
                            <label><input type="checkbox" value="numerologia"> Numerologia</label>
                            <label><input type="checkbox" value="meditacao"> Medita√ß√£o</label>
                            <label><input type="checkbox" value="wicca"> Wicca</label>
                        </div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="acceptTerms" required>
                        <label for="acceptTerms">Aceito os Termos de Uso e Pol√≠tica de Privacidade</label>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="acceptNotifications">
                        <label for="acceptNotifications">Desejo receber notifica√ß√µes m√≠sticas AF√ÅST</label>
                    </div>
                </div>
                
                <!-- Bot√µes de navega√ß√£o -->
                <div class="action-buttons">
                    <button class="btn-secondary" id="registerPrevBtn" onclick="previousRegisterStep()" style="display: none;">üîô VOLTAR</button>
                    <button class="btn-primary" id="registerNextBtn" onclick="nextRegisterStep()">PR√ìXIMO ‚û°Ô∏è</button>
                    <button class="btn-primary" id="registerSubmitBtn" onclick="submitRegistration()" style="display: none;">üåü CRIAR CONTA</button>
                    <button class="btn-secondary" onclick="showWelcomeScreen()">‚ùå CANCELAR</button>
                </div>
                
                <!-- Indicador de progresso -->
                <div class="register-progress">
                    <div class="progress-step active" id="progressStep1">1</div>
                    <div class="progress-step" id="progressStep2">2</div>
                    <div class="progress-step" id="progressStep3">3</div>
                </div>
                
                <!-- Mensagem de status -->
                <div class="status-message" id="registerStatusMessage"></div>
            </div>
        </div>
    </div>
        
        <!-- Gatomante na tela de boas-vindas -->
        <div class="welcome-gatomante">
            <div class="welcome-gatomante-sprite">üê±‚Äç‚¨õ</div>
            <div class="welcome-gatomante-message">
                Miau! Pronto para explorar os mist√©rios?
            </div>
        </div>
    </div>
    
    <!-- ========================================
         üë• SISTEMA DE USU√ÅRIOS COMPLETO
         Registro com Dados Astrol√≥gicos
         ======================================== -->
    
    <!-- Tela de Registro Completo -->
    <div class="register-screen" id="registerScreen">
        <div class="register-container">
            <!-- Cabe√ßalho -->
            <div class="register-header">
                <div class="register-title">üåü CRIAR NOVA CONTA</div>
                <div class="register-subtitle">
                    Junte-se ao universo m√≠stico do Aurora OS
                </div>
            </div>
            
            <!-- Formul√°rio de Registro - Etapa 1: Dados B√°sicos -->
            <div class="register-form" id="registerStep1">
                <div class="register-step-indicator">
                    <div class="step active">1</div>
                    <div class="step-line"></div>
                    <div class="step">2</div>
                    <div class="step-line"></div>
                    <div class="step">3</div>
                </div>
                
                <div class="register-step-title">üìù Informa√ß√µes B√°sicas</div>
                
                <div class="form-group">
                    <label class="form-label" for="regName">üë§ Nome Completo</label>
                    <input type="text" id="regName" class="form-input" placeholder="Digite seu nome completo..." required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="regEmail">üìß Email</label>
                    <input type="email" id="regEmail" class="form-input" placeholder="Digite seu email..." required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="regPassword">üîí Senha</label>
                    <input type="password" id="regPassword" class="form-input" placeholder="Crie uma senha segura..." required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="regConfirmPassword">üîí Confirmar Senha</label>
                    <input type="password" id="regConfirmPassword" class="form-input" placeholder="Confirme sua senha..." required>
                </div>
                
                <div class="register-buttons">
                    <button class="welcome-btn" onclick="nextRegisterStep(2)">Pr√≥ximo ‚û°Ô∏è</button>
                    <button class="welcome-btn secondary" onclick="backToWelcome()">üîô Voltar</button>
                </div>
            </div>
            
            <!-- Formul√°rio de Registro - Etapa 2: Dados Astrol√≥gicos -->
            <div class="register-form" id="registerStep2" style="display: none;">
                <div class="register-step-indicator">
                    <div class="step completed">‚úì</div>
                    <div class="step-line completed"></div>
                    <div class="step active">2</div>
                    <div class="step-line"></div>
                    <div class="step">3</div>
                </div>
                
                <div class="register-step-title">üîÆ Dados Astrol√≥gicos (Opcional)</div>
                <div class="register-step-subtitle">
                    Para criar seu mapa astral personalizado e integrar com o Astrom√°gick
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="regBirthDate">üìÖ Data de Nascimento</label>
                    <input type="date" id="regBirthDate" class="form-input">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="regBirthTime">‚è∞ Hora de Nascimento</label>
                    <input type="time" id="regBirthTime" class="form-input">
                    <small class="form-hint">Se n√£o souber a hora exata, deixe em branco</small>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="regBirthPlace">üåç Local de Nascimento</label>
                    <input type="text" id="regBirthPlace" class="form-input" placeholder="Cidade, Estado, Pa√≠s...">
                    <small class="form-hint">Ex: S√£o Paulo, SP, Brasil</small>
                </div>
                
                <div class="form-group">
                    <label class="form-label">üéØ Interesses M√≠sticos</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="interestAstrology"> Astrologia</label>
                        <label><input type="checkbox" id="interestTarot"> Tarot</label>
                        <label><input type="checkbox" id="interestCrystals"> Cristais</label>
                        <label><input type="checkbox" id="interestMeditation"> Medita√ß√£o</label>
                        <label><input type="checkbox" id="interestNumerology"> Numerologia</label>
                        <label><input type="checkbox" id="interestHerbs"> Ervas M√≠sticas</label>
                    </div>
                </div>
                
                <div class="register-buttons">
                    <button class="welcome-btn" onclick="nextRegisterStep(3)">Pr√≥ximo ‚û°Ô∏è</button>
                    <button class="welcome-btn secondary" onclick="prevRegisterStep(1)">‚¨ÖÔ∏è Anterior</button>
                    <button class="welcome-btn secondary" onclick="skipAstrologyData()">Pular esta etapa</button>
                </div>
            </div>
            
            <!-- Formul√°rio de Registro - Etapa 3: Foto e Finaliza√ß√£o -->
            <div class="register-form" id="registerStep3" style="display: none;">
                <div class="register-step-indicator">
                    <div class="step completed">‚úì</div>
                    <div class="step-line completed"></div>
                    <div class="step completed">‚úì</div>
                    <div class="step-line completed"></div>
                    <div class="step active">3</div>
                </div>
                
                <div class="register-step-title">üì∏ Foto de Perfil e Finaliza√ß√£o</div>
                
                <div class="form-group">
                    <label class="form-label">üì∏ Foto de Perfil</label>
                    <div class="photo-upload-area" id="photoUploadArea">
                        <div class="photo-preview" id="photoPreview">
                            <div class="photo-placeholder">
                                <span class="photo-icon">üì∑</span>
                                <span class="photo-text">Clique para adicionar foto</span>
                            </div>
                        </div>
                        <input type="file" id="photoInput" accept="image/*" style="display: none;">
                    </div>
                    <small class="form-hint">Ou escolha um avatar m√≠stico:</small>
                    <div class="avatar-selection">
                        <span class="avatar-option" onclick="selectAvatar('üßô‚Äç‚ôÇÔ∏è')">üßô‚Äç‚ôÇÔ∏è</span>
                        <span class="avatar-option" onclick="selectAvatar('üßô‚Äç‚ôÄÔ∏è')">üßô‚Äç‚ôÄÔ∏è</span>
                        <span class="avatar-option" onclick="selectAvatar('üîÆ')">üîÆ</span>
                        <span class="avatar-option" onclick="selectAvatar('üåô')">üåô</span>
                        <span class="avatar-option" onclick="selectAvatar('‚≠ê')">‚≠ê</span>
                        <span class="avatar-option" onclick="selectAvatar('ü¶â')">ü¶â</span>
                        <span class="avatar-option" onclick="selectAvatar('üê±‚Äç‚¨õ')">üê±‚Äç‚¨õ</span>
                        <span class="avatar-option" onclick="selectAvatar('ü¶ã')">ü¶ã</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="checkbox-container">
                        <input type="checkbox" id="acceptTerms" required>
                        <label for="acceptTerms">
                            Aceito os <a href="#" onclick="showTerms()">Termos de Uso</a> e 
                            <a href="#" onclick="showPrivacy()">Pol√≠tica de Privacidade</a>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="checkbox-container">
                        <input type="checkbox" id="acceptNotifications">
                        <label for="acceptNotifications">
                            Desejo receber notifica√ß√µes m√≠sticas AF√ÅST!
                        </label>
                    </div>
                </div>
                
                <div class="register-buttons">
                    <button class="welcome-btn" onclick="completeRegistration()">üåü CRIAR CONTA</button>
                    <button class="welcome-btn secondary" onclick="prevRegisterStep(2)">‚¨ÖÔ∏è Anterior</button>
                </div>
            </div>
            
            <!-- Tela de Sucesso -->
            <div class="register-success" id="registerSuccess" style="display: none;">
                <div class="success-animation">üéâ</div>
                <div class="success-title">Conta Criada com Sucesso!</div>
                <div class="success-message">
                    Bem-vindo ao Aurora OS, <span id="successUserName"></span>!<br>
                    Seu mapa astral est√° sendo calculado...
                </div>
                <div class="success-progress">
                    <div class="success-progress-bar" id="successProgressBar"></div>
                </div>
                <div class="success-status" id="successStatus">Processando dados astrol√≥gicos...</div>
            </div>
        </div>
        
        <!-- Gatomante no registro -->
        <div class="register-gatomante">
            <div class="register-gatomante-sprite">üê±‚Äç‚¨õ</div>
            <div class="register-gatomante-message" id="registerGatomanteMessage">
                Miau! Vamos criar sua conta m√≠stica juntos!
            </div>
        </div>
    </div>
                    <label class="auth-label" for="registerEmail">üìß Email</label>
                    <input type="email" id="registerEmail" class="auth-input" placeholder="Digite seu email..." required>
                </div>
                
                <div class="auth-field">
                    <label class="auth-label" for="registerPassword">üîí Senha</label>
                    <input type="password" id="registerPassword" class="auth-input" placeholder="Crie uma senha segura..." required>
                </div>
                
                <div class="auth-field">
                    <label class="auth-label" for="confirmPassword">üîí Confirmar Senha</label>
                    <input type="password" id="confirmPassword" class="auth-input" placeholder="Confirme sua senha..." required>
                </div>
                
                <!-- Se√ß√£o de Dados Astrol√≥gicos -->
                <div class="auth-section-title">üîÆ Dados Astrol√≥gicos (Opcional)</div>
                <div class="auth-section-subtitle">Para criar seu mapa astral personalizado</div>
                
                <div class="auth-field">
                    <label class="auth-label" for="birthDate">üìÖ Data de Nascimento</label>
                    <input type="date" id="birthDate" class="auth-input">
                </div>
                
                <div class="auth-field">
                    <label class="auth-label" for="birthTime">‚è∞ Hora de Nascimento</label>
                    <input type="time" id="birthTime" class="auth-input" placeholder="Ex: 14:30">
                </div>
                
                <div class="auth-field">
                    <label class="auth-label" for="birthPlace">üåç Local de Nascimento</label>
                    <input type="text" id="birthPlace" class="auth-input" placeholder="Ex: S√£o Paulo, SP, Brasil">
                </div>
                
                <div class="auth-checkbox-container">
                    <input type="checkbox" id="acceptTerms" class="auth-checkbox" required>
                    <label for="acceptTerms" class="auth-checkbox-label">Aceito os Termos de Uso e Pol√≠tica de Privacidade</label>
                </div>
                
                <div class="auth-checkbox-container">
                    <input type="checkbox" id="receiveNotifications" class="auth-checkbox">
                    <label for="receiveNotifications" class="auth-checkbox-label">Desejo receber notifica√ß√µes m√≠sticas</label>
                </div>
                
                <div class="auth-buttons">
                    <button class="auth-button" onclick="performRegister()">üåü Criar Conta</button>
                    <button class="auth-button secondary" onclick="showLoginForm()">üîô Voltar ao Login</button>
                </div>
                
                <div class="auth-loading" id="registerLoading">
                    <div class="auth-spinner"></div>
                    Criando sua conta m√≠stica...
                </div>
            </div>
            
            <!-- Formul√°rio de Recupera√ß√£o de Senha -->
            <div id="forgotForm" class="auth-form" style="display: none;">
                <div id="forgotMessage" class="auth-success" style="display: none;"></div>
                
                <div class="auth-field">
                    <label class="auth-label" for="forgotEmail">üìß Email</label>
                    <input type="email" id="forgotEmail" class="auth-input" placeholder="Digite seu email para recupera√ß√£o..." required>
                </div>
                
                <div class="auth-buttons">
                    <button class="auth-button" onclick="performForgotPassword()">üìß Enviar Link de Recupera√ß√£o</button>
                    <button class="auth-button secondary" onclick="showLoginForm()">üîô Voltar ao Login</button>
                </div>
                
                <div class="auth-loading" id="forgotLoading">
                    <div class="auth-spinner"></div>
                    Consultando os or√°culos...
                </div>
            </div>
        </div>
    </div>
    
    <!-- üåü DESKTOP M√ÅGICO COM WALLPAPERS DIN√ÇMICOS -->
    <div class="desktop" id="desktop">
        <!-- Part√≠culas m√≠sticas flutuantes -->
        <div class="desktop-particles" id="desktopParticles">
            <!-- Part√≠culas ser√£o geradas dinamicamente -->
        </div>
        
        <!-- Constela√ß√µes de fundo -->
        <div class="desktop-constellation" id="desktopConstellation">
            <!-- Estrelas e linhas ser√£o geradas dinamicamente -->
        </div>
        
        <!-- Widget Planet√°rio -->
        <div class="planetary-widget" id="planetaryWidget" style="
            position: fixed;
            top: 20px;
            right: 20px;
            width: 280px;
            background: linear-gradient(135deg, rgba(26,26,46,0.95) 0%, rgba(22,33,62,0.95) 100%);
            border: 2px solid var(--dourado);
            border-radius: 15px;
            padding: 15px;
            color: white;
            font-family: 'Alice', serif;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            z-index: 1000;
            transition: all 0.3s ease;
        ">
            <div class="widget-header" style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
                border-bottom: 1px solid rgba(218,165,32,0.3);
                padding-bottom: 10px;
            ">
                <h3 style="margin: 0; font-size: 16px; color: var(--dourado);">ü™ê Horas Planet√°rias</h3>
                <button onclick="togglePlanetaryWidget()" style="
                    background: none;
                    border: none;
                    color: rgba(255,255,255,0.7);
                    cursor: pointer;
                    font-size: 18px;
                    padding: 0;
                    width: 24px;
                    height: 24px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: all 0.3s ease;
                " onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='none'">‚àí</button>
            </div>
            
            <div class="widget-content" id="planetaryWidgetContent">
                <div class="current-hour" style="
                    text-align: center;
                    margin-bottom: 15px;
                    padding: 15px;
                    background: rgba(0,0,0,0.3);
                    border-radius: 10px;
                    border: 1px solid rgba(218,165,32,0.2);
                ">
                    <div class="planet-symbol" id="currentPlanetSymbol" style="
                        font-size: 48px;
                        margin-bottom: 8px;
                        text-shadow: 0 0 10px rgba(218,165,32,0.5);
                    ">‚òâ</div>
                    <div class="planet-name" id="currentPlanetName" style="
                        font-size: 18px;
                        font-weight: bold;
                        color: var(--dourado);
                        margin-bottom: 5px;
                    ">Sol</div>
                    <div class="planet-influence" id="currentPlanetInfluence" style="
                        font-size: 12px;
                        color: rgba(255,255,255,0.8);
                        font-style: italic;
                    ">Vitalidade, lideran√ßa, sucesso</div>
                </div>
                
                <div class="time-info" style="
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 10px;
                    margin-bottom: 15px;
                ">
                    <div class="time-block" style="
                        background: rgba(0,0,0,0.2);
                        padding: 10px;
                        border-radius: 8px;
                        text-align: center;
                    ">
                        <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 5px;">Hora Atual</div>
                        <div id="currentTime" style="font-size: 16px; font-weight: bold; color: var(--dourado);">--:--</div>
                    </div>
                    <div class="time-block" style="
                        background: rgba(0,0,0,0.2);
                        padding: 10px;
                        border-radius: 8px;
                        text-align: center;
                    ">
                        <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 5px;">Pr√≥xima Mudan√ßa</div>
                        <div id="nextChange" style="font-size: 16px; font-weight: bold; color: #ff6b6b;">--:--</div>
                    </div>
                </div>
                
                <div class="planetary-schedule" style="
                    background: rgba(0,0,0,0.2);
                    border-radius: 10px;
                    padding: 12px;
                    max-height: 200px;
                    overflow-y: auto;
                ">
                    <h4 style="margin: 0 0 10px 0; font-size: 14px; color: var(--dourado); text-align: center;">Cronograma do Dia</h4>
                    <div id="planetarySchedule">
                        <!-- Cronograma ser√° gerado dinamicamente -->
                    </div>
                </div>
                
                <div class="widget-footer" style="
                    margin-top: 15px;
                    padding-top: 10px;
                    border-top: 1px solid rgba(218,165,32,0.3);
                    text-align: center;
                ">
                    <div style="font-size: 11px; color: rgba(255,255,255,0.5);">
                        Baseado na sua localiza√ß√£o
                    </div>
                    <div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-top: 2px;">
                        Atualizado a cada minuto
                    </div>
                </div>
            </div>
        </div>

        <!-- √çcones do desktop -->
        <div class="desktop-icons" id="desktopIcons">
            <!-- √çcones ser√£o gerados dinamicamente -->
        </div>
    </div>
    
    <!-- ========================================
         üéµ SISTEMA DE √ÅUDIO PERSONALIZADO
         Sons ambientais, cristais, mantras, frequ√™ncias
         ======================================== -->
    
    <!-- √Åudios do Sistema -->
    <audio id="dialupSound1" preload="auto">
        <source src="dialup_chiados_dirty_enhanced.wav" type="audio/wav">
    </audio>
    <audio id="dialupSound2" preload="auto">
        <source src="dialup_chiados_vintage.wav" type="audio/wav">
    </audio>
    
    <!-- √Åudios Ambientais M√≠sticos -->
    <audio id="ambientForest" preload="none" loop>
        <!-- Floresta m√≠stica com p√°ssaros e vento -->
    </audio>
    <audio id="ambientOcean" preload="none" loop>
        <!-- Ondas do oceano com gaivotas -->
    </audio>
    <audio id="ambientRain" preload="none" loop>
        <!-- Chuva suave com trov√µes distantes -->
    </audio>
    <audio id="ambientCave" preload="none" loop>
        <!-- Caverna com gotejamento e ecos -->
    </audio>
    
    <!-- Frequ√™ncias de Cura -->
    <audio id="freq396Hz" preload="none" loop>
        <!-- 396 Hz - Libera√ß√£o de medos -->
    </audio>
    <audio id="freq528Hz" preload="none" loop>
        <!-- 528 Hz - Frequ√™ncia do amor -->
    </audio>
    <audio id="freq741Hz" preload="none" loop>
        <!-- 741 Hz - Despertar da intui√ß√£o -->
    </audio>
    
    <!-- Sons de Cristais -->
    <audio id="crystalBowl" preload="none">
        <!-- Tigela de cristal -->
    </audio>
    <audio id="crystalChimes" preload="none">
        <!-- Sinos de cristal -->
    </audio>
    
    <!-- Mantras e Cantos -->
    <audio id="mantraOm" preload="none" loop>
        <!-- Om Mani Padme Hum -->
    </audio>
    <audio id="mantraGayatri" preload="none" loop>
        <!-- Gayatri Mantra -->
    </audio>
    
    <!-- Controle de √Åudio Ambiente -->
    <div class="ambient-audio-control" id="ambientControl" style="display: none;">
        <div class="ambient-header">
            <span>üéµ √Åudio Ambiente</span>
            <button onclick="toggleAmbientControl()">√ó</button>
        </div>
        <div class="ambient-categories">
            <div class="ambient-category">
                <h4>üåø Natureza</h4>
                <div class="ambient-options">
                    <button class="ambient-btn" data-audio="ambientForest">Floresta</button>
                    <button class="ambient-btn" data-audio="ambientOcean">Oceano</button>
                    <button class="ambient-btn" data-audio="ambientRain">Chuva</button>
                    <button class="ambient-btn" data-audio="ambientCave">Caverna</button>
                </div>
            </div>
            <div class="ambient-category">
                <h4>üîÆ Frequ√™ncias</h4>
                <div class="ambient-options">
                    <button class="ambient-btn" data-audio="freq396Hz">396 Hz</button>
                    <button class="ambient-btn" data-audio="freq528Hz">528 Hz</button>
                    <button class="ambient-btn" data-audio="freq741Hz">741 Hz</button>
                </div>
            </div>
            <div class="ambient-category">
                <h4>üíé Cristais</h4>
                <div class="ambient-options">
                    <button class="ambient-btn" data-audio="crystalBowl">Tigela</button>
                    <button class="ambient-btn" data-audio="crystalChimes">Sinos</button>
                </div>
            </div>
            <div class="ambient-category">
                <h4>üïâÔ∏è Mantras</h4>
                <div class="ambient-options">
                    <button class="ambient-btn" data-audio="mantraOm">Om</button>
                    <button class="ambient-btn" data-audio="mantraGayatri">Gayatri</button>
                </div>
            </div>
        </div>
        <div class="ambient-controls">
            <label>Volume: <input type="range" id="ambientVolume" min="0" max="100" value="30"></label>
            <button onclick="stopAllAmbient()">Parar Tudo</button>
        </div>
    </div>
    
    <!-- Menu de Contexto -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" onclick="openPersonalization()">
            <span>‚öôÔ∏è</span>
            <span>Personalizar</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="refreshDesktop()">
            <span>üîÑ</span>
            <span>Atualizar</span>
        </div>
        <div class="context-menu-item" onclick="arrangeIcons()">
            <span>üìê</span>
            <span>Organizar √≠cones</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="toggleWorkspaceSwitcher()">
            <span>üñ•Ô∏è</span>
            <span>Workspaces</span>
        </div>
    </div>
    
    <!-- ========================================
         üñ•Ô∏è WORKSPACES VIRTUAIS E SNAP ZONES
         Sistema de m√∫ltiplas √°reas de trabalho
         ======================================== -->
    
    <!-- Seletor de Workspaces -->
    <div class="workspace-switcher" id="workspaceSwitcher">
        <div class="workspace-tab active" data-workspace="1" onclick="switchWorkspace(1)">
            1
            <div class="window-count" id="workspace1Count">0</div>
        </div>
        <div class="workspace-tab" data-workspace="2" onclick="switchWorkspace(2)">
            2
            <div class="window-count" id="workspace2Count">0</div>
        </div>
        <div class="workspace-tab" data-workspace="3" onclick="switchWorkspace(3)">
            3
            <div class="window-count" id="workspace3Count">0</div>
        </div>
        <div class="workspace-tab" data-workspace="4" onclick="switchWorkspace(4)">
            4
            <div class="window-count" id="workspace4Count">0</div>
        </div>
    </div>
    
    <!-- Indicador de Workspace Atual -->
    <div class="workspace-indicator" id="workspaceIndicator">
        Workspace 1
    </div>
    
    <!-- Zonas de Snap -->
    <div class="snap-zones" id="snapZones">
        <div class="snap-zone snap-zone-left" data-snap="left"></div>
        <div class="snap-zone snap-zone-right" data-snap="right"></div>
        <div class="snap-zone snap-zone-top" data-snap="top"></div>
        <div class="snap-zone snap-zone-bottom" data-snap="bottom"></div>
        <div class="snap-zone snap-zone-center" data-snap="center"></div>
    </div>
    
    <!-- ü§ñ GATOMANTE IA AVAN√áADA - CHAT INTEGRADO -->
    <div class="gatomante-chat" id="gatomanteChat">
        <div class="gatomante-chat-header">
            <div class="gatomante-chat-avatar">üê±‚Äç‚¨õ</div>
            <div class="gatomante-chat-info">
                <div class="gatomante-chat-name">Gatomante IA</div>
                <div class="gatomante-chat-status">Online ‚Ä¢ Assistente M√≠stico</div>
            </div>
            <button class="gatomante-chat-close" onclick="toggleGatomanteChat()">√ó</button>
        </div>
        
        <div class="gatomante-chat-messages" id="gatomanteMessages">
            <!-- Mensagens aparecer√£o aqui dinamicamente -->
        </div>
        
        <div class="gatomante-chat-input-area">
            <button class="gatomante-voice-btn" id="gatomanteVoiceBtn" onclick="toggleVoiceRecognition()" title="Comando de Voz">üé§</button>
            <input type="text" class="gatomante-chat-input" id="gatomanteInput" placeholder="Digite sua pergunta ou comando..." onkeypress="handleChatKeyPress(event)">
            <button class="gatomante-send-btn" onclick="sendChatMessage()" title="Enviar Mensagem">‚û§</button>
        </div>
    </div>
    
    <!-- Taskbar -->
    <!-- üöÄ BARRA DE TAREFAS MODERNIZADA -->
    <div class="taskbar">
        <!-- Bot√£o Iniciar Revolucion√°rio -->
        <button class="start-button" onclick="toggleStartMenu()">
            <span class="start-logo">
                <img src="mysticsoft-logo.png" alt="MysticSoft" style="width: 18px; height: 18px; image-rendering: pixelated;">
            </span>
            <span>Iniciar</span>
        </button>
        
        <!-- √Årea de Aplica√ß√µes com Agrupamento Inteligente -->
        <div class="taskbar-apps" id="taskbarApps">
            <!-- Aplica√ß√µes abertas ser√£o mostradas aqui -->
        </div>
        
        <!-- √Årea Direita com Indicadores de Sistema -->
        <div class="taskbar-right">
            <!-- Chat do Gatomante IA -->
            <div class="system-indicator gatomante-chat-toggle" onclick="toggleGatomanteChat()" title="Chat com Gatomante IA">
                <span class="icon">üê±‚Äç‚¨õ</span>
            </div>
            
            <!-- Indicador Planet√°rio -->
            <div class="system-indicator" onclick="togglePlanetaryPopup()" title="Hora Planet√°ria Atual" id="planetaryIndicator">
                <span class="icon" id="planetarySymbol">‚òâ</span>
            </div>
            
            <!-- Rel√≥gio Digital -->
            <div class="system-indicator" onclick="toggleCalendarPopup()" title="Calend√°rio e Hora">
                <span class="icon clock" id="clock">00:00</span>
            </div>
            
            <!-- Central AF√ÅST com Badge -->
            <div class="system-indicator" onclick="toggleNotificationCenter()" title="Central AF√ÅST - Prote√ß√£o Astrol√≥gica" id="afastIndicator">
                <span class="icon">üõ°Ô∏è</span>
                <div class="notification-badge" id="afastBadge" style="display: none;">0</div>
            </div>
            
            <!-- Controle de Volume -->
            <div class="system-indicator" onclick="toggleVolumePopup()" title="Controle de Volume" id="volumeIndicator">
                <span class="icon" id="volumeIcon">üîä</span>
            </div>
            
            <!-- √Åudio Ambiente -->
            <div class="system-indicator" onclick="toggleAmbientControl()" title="√Åudio Ambiente M√≠stico" id="ambientIndicator">
                <span class="icon">üéµ</span>
            </div>
        </div>
    </div>
    
    <!-- Menu Iniciar -->
    <!-- üåü MENU INICIAR REVOLUCION√ÅRIO - MANDALA M√çSTICA -->
    <div class="start-menu" id="startMenu">
        <!-- Part√≠culas m√≠sticas de fundo -->
        <div class="mandala-particles" id="mandalaParticles">
            <!-- Part√≠culas ser√£o geradas dinamicamente -->
        </div>
        
        <!-- Campo de busca no topo -->
        <div class="mandala-search">
            <input type="text" id="mandalaSearch" placeholder="üîÆ Buscar nos mist√©rios..." 
                   oninput="filterMandalaApps(this.value)" 
                   onkeydown="handleMandalaSearch(event)">
        </div>
        
        <!-- Centro da mandala com logo -->
        <div class="mandala-center">
            <img src="mysticsoft-logo.png" alt="MysticSoft" class="mandala-logo">
            <div style="font-size: 8px; color: rgba(0,0,0,0.8); font-weight: bold; margin-top: 4px;">AURORA OS</div>
        </div>
        
        <!-- Roda dos 4 Elementos -->
        <div class="elements-wheel">
            <div class="element-sector element-fire" onclick="filterByElement('fire')" title="Aplica√ß√µes de Fogo - Criatividade e A√ß√£o">
                <div class="element-icon">üî•</div>
                <div class="element-name">FOGO</div>
            </div>
            <div class="element-sector element-earth" onclick="filterByElement('earth')" title="Aplica√ß√µes de Terra - Estabilidade e Materializa√ß√£o">
                <div class="element-icon">üåç</div>
                <div class="element-name">TERRA</div>
            </div>
            <div class="element-sector element-air" onclick="filterByElement('air')" title="Aplica√ß√µes de Ar - Comunica√ß√£o e Intelecto">
                <div class="element-icon">üí®</div>
                <div class="element-name">AR</div>
            </div>
            <div class="element-sector element-water" onclick="filterByElement('water')" title="Aplica√ß√µes de √Ågua - Emo√ß√£o e Intui√ß√£o">
                <div class="element-icon">üåä</div>
                <div class="element-name">√ÅGUA</div>
            </div>
        </div>
        
        <!-- √ìrbita das aplica√ß√µes -->
        <div class="app-orbit" id="appOrbit">
            <!-- Aplica√ß√µes ser√£o posicionadas dinamicamente em c√≠rculo -->
        </div>
        
        <!-- Se√ß√£o de Aplica√ß√µes Recentes -->
        <div class="recent-apps-section">
            <div class="recent-apps-title">‚≠ê Recentes</div>
            <div class="recent-apps-list" id="recentAppsList">
                <!-- Aplica√ß√µes recentes ser√£o inseridas aqui -->
            </div>
        </div>
        
        <!-- Se√ß√£o de Favoritos -->
        <div class="favorites-section">
            <div class="favorites-title">üí´ Favoritos</div>
            <div class="favorites-list" id="favoritesList">
                <!-- Favoritos ser√£o inseridos aqui -->
            </div>
        </div>
        
        <!-- A√ß√µes r√°pidas na borda externa -->
        <div class="quick-actions-ring">
            <div class="quick-action documents" onclick="openDocuments()" title="üìÅ Pasta Documentos">
                üìÅ
            </div>
            <div class="quick-action text-processor" onclick="openTextProcessor()" title="üìù Processador de Texto">
                üìù
            </div>
            <div class="quick-action taskbar-colors" onclick="openTaskbarColorSelector()" title="üé® Cores da Barra de Tarefas">
                üé®
            </div>
            <div class="quick-action personalize" onclick="openPersonalization()" title="‚öôÔ∏è Personaliza√ß√£o M√≠stica">
                ‚öôÔ∏è
            </div>
            <div class="quick-action help" onclick="openSystemHelp()" title="‚ùì Grim√≥rio de Ajuda">
                ‚ùì
            </div>
            <div class="quick-action logout" onclick="performLogout()" title="üö™ Sair dos Mist√©rios">
                üö™
            </div>
        </div>
    </div>
    
    <!-- Popup do Calend√°rio -->
    <div class="popup calendar-popup" id="calendarPopup">
        <div class="calendar-header">
            <button class="calendar-nav" onclick="previousMonth()">‚óÄ</button>
            <span id="calendarTitle">Janeiro 2024</span>
            <button class="calendar-nav" onclick="nextMonth()">‚ñ∂</button>
        </div>
        <div class="calendar-grid" id="calendarGrid">
            <!-- Calend√°rio ser√° gerado dinamicamente -->
        </div>
    </div>
    
    <!-- Popup do Volume -->
    <div class="popup volume-popup" id="volumePopup">
        <div class="volume-control">
            <div class="volume-label">Volume Principal</div>
            <div class="volume-slider" onclick="setVolume(event, 'master')">
                <div class="volume-fill" id="masterVolumeFill" style="width: 70%"></div>
                <div class="volume-thumb" id="masterVolumeThumb" style="left: 70%"></div>
            </div>
        </div>
        <div class="volume-control">
            <div class="volume-label">Notifica√ß√µes</div>
            <div class="volume-slider" onclick="setVolume(event, 'notifications')">
                <div class="volume-fill" id="notificationsVolumeFill" style="width: 50%"></div>
                <div class="volume-thumb" id="notificationsVolumeThumb" style="left: 50%"></div>
            </div>
        </div>
        <div class="volume-control">
            <div class="volume-label">Sistema</div>
            <div class="volume-slider" onclick="setVolume(event, 'system')">
                <div class="volume-fill" id="systemVolumeFill" style="width: 60%"></div>
                <div class="volume-thumb" id="systemVolumeThumb" style="left: 60%"></div>
            </div>
        </div>
    </div>
    
    <!-- Seletor de Cores da Barra de Tarefas -->
    <div class="popup taskbar-color-popup" id="taskbarColorPopup">
        <div class="taskbar-color-header">
            <span>üé® Cores da Barra de Tarefas</span>
            <button class="popup-close" onclick="closeTaskbarColorSelector()">√ó</button>
        </div>
        <div class="taskbar-color-content">
            <div class="color-section">
                <h4>Cores Predefinidas</h4>
                <div class="taskbar-color-grid">
                    <div class="taskbar-color-option" data-color="#3e0a29" style="background: #3e0a29;" title="Vinho M√≠stico (Padr√£o)"></div>
                    <div class="taskbar-color-option" data-color="#0b1836" style="background: #0b1836;" title="Azul Profundo"></div>
                    <div class="taskbar-color-option" data-color="#1a1a2e" style="background: #1a1a2e;" title="Roxo Noturno"></div>
                    <div class="taskbar-color-option" data-color="#2d1b69" style="background: #2d1b69;" title="Violeta M√≠stico"></div>
                    <div class="taskbar-color-option" data-color="#4a0e4e" style="background: #4a0e4e;" title="Magenta Sombrio"></div>
                    <div class="taskbar-color-option" data-color="#1e3a8a" style="background: #1e3a8a;" title="Azul Real"></div>
                    <div class="taskbar-color-option" data-color="#7c2d12" style="background: #7c2d12;" title="Marrom Terroso"></div>
                    <div class="taskbar-color-option" data-color="#374151" style="background: #374151;" title="Cinza C√≥smico"></div>
                    <div class="taskbar-color-option" data-color="#1f2937" style="background: #1f2937;" title="Preto Estelar"></div>
                    <div class="taskbar-color-option" data-color="#581c87" style="background: #581c87;" title="P√∫rpura Imperial"></div>
                </div>
            </div>
            <div class="color-section">
                <h4>Cor Personalizada</h4>
                <div class="custom-color-controls">
                    <input type="color" id="customTaskbarColor" value="#3e0a29" onchange="previewTaskbarColor(this.value)">
                    <button class="apply-custom-color" onclick="applyCustomTaskbarColor()">Aplicar Cor</button>
                </div>
            </div>
            <div class="color-section">
                <h4>Pr√©-visualiza√ß√£o</h4>
                <div class="taskbar-preview" id="taskbarPreview">
                    <div class="preview-start-btn">üåü Iniciar</div>
                    <div class="preview-items">
                        <div class="preview-item">üì± App</div>
                        <div class="preview-item">üåê Web</div>
                    </div>
                    <div class="preview-clock">12:34</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sistema AF√ÅST! reformulado - notifica√ß√µes estilo MSN s√£o criadas dinamicamente -->
    
    <!-- Central de Notifica√ß√µes -->
    <div class="notification-center" id="notificationCenter">
        <div class="notification-center-header">
            üõ°Ô∏è Central AF√ÅST
            <button class="notification-center-close" onclick="toggleNotificationCenter()">√ó</button>
        </div>
        
        <!-- Filtros de Notifica√ß√£o -->
        <div class="notification-filters">
            <button class="filter-btn active" onclick="filterNotifications('all')" id="filterAll">
                üìã Todas
            </button>
            <button class="filter-btn" onclick="filterNotifications('critical')" id="filterCritical">
                üö® Cr√≠ticas
            </button>
            <button class="filter-btn" onclick="filterNotifications('warning')" id="filterWarning">
                ‚ö†Ô∏è Avisos
            </button>
            <button class="filter-btn" onclick="filterNotifications('info')" id="filterInfo">
                ‚ÑπÔ∏è Informa√ß√µes
            </button>
        </div>
        
        <!-- Estat√≠sticas AF√ÅST -->
        <div class="afast-stats">
            <div class="stat-item">
                <span class="stat-number" id="totalAlerts">0</span>
                <span class="stat-label">Total de Alertas</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="criticalAlerts">0</span>
                <span class="stat-label">Cr√≠ticos</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="todayAlerts">0</span>
                <span class="stat-label">Hoje</span>
            </div>
        </div>
        
        <div class="notification-center-content" id="notificationCenterContent">
            <div class="no-notifications" id="noNotifications">
                <div style="font-size: 48px; opacity: 0.5;">üõ°Ô∏è</div>
                <p>Nenhuma notifica√ß√£o AF√ÅST</p>
                <p style="font-size: 12px; opacity: 0.7;">O sistema est√° monitorando eventos astrol√≥gicos...</p>
            </div>
        </div>
        
        <!-- A√ß√µes da Central -->
        <div class="notification-center-actions">
            <button class="action-btn" onclick="clearAllNotifications()">
                üóëÔ∏è Limpar Todas
            </button>
            <button class="action-btn" onclick="exportNotifications()">
                üì§ Exportar
            </button>
            <button class="action-btn" onclick="afastSettings()">
                ‚öôÔ∏è Configura√ß√µes
            </button>
        </div>
    </div>
    
    <!-- Popup Planet√°rio -->
    <div class="popup planetary-popup" id="planetaryPopup">
        <div class="planetary-info">
            <div class="planetary-current">
                <span id="currentPlanetSymbol">‚òâ</span>
                <span id="currentPlanetName">Sol</span>
            </div>
            <div class="planetary-time" id="planetaryTime">
                Hora 1 do Dia ‚Ä¢ 06:00 - 07:00
            </div>
            <div class="planetary-ruler">
                Regente do Dia: <span id="dayRuler">Sol</span>
            </div>
        </div>
        <div style="font-size: 10px; color: #666; text-align: center;">
            Sistema baseado nas horas planet√°rias tradicionais
        </div>
    </div>
    
    <!-- Gatomante - Assistente M√≠stico -->
    <div class="gatomante-container" id="gatomanteContainer">
        <div class="gatomante-character" id="gatomanteCharacter">
            <div class="gatomante-sprite">
                <div class="gatomante-body">üê±‚Äç‚¨õ</div>
                <div class="gatomante-glasses">üëì</div>
            </div>
        </div>
        <div class="gatomante-bubble" id="gatomanteBubble">
            <div class="gatomante-text" id="gatomanteText">
                Miau! Bem-vindo ao Aurora OS, humano... Vejo que voc√™ busca conhecimento m√≠stico.
            </div>
            <div class="gatomante-close" onclick="hideGatomante()">√ó</div>
        </div>
    </div>

    <!-- Modal de Personaliza√ß√£o -->
    <div class="personalization-modal" id="personalizationModal">
        <div class="personalization-dialog">
            <div class="personalization-header">
                <span>Personaliza√ß√£o do Aurora OS</span>
                <button class="personalization-close" onclick="closePersonalization()">√ó</button>
            </div>
            <div class="personalization-content">
                <!-- Se√ß√£o de Foto de Perfil -->
                <div class="personalization-section profile-photo-section">
                    <h3>üì∏ Foto de Perfil</h3>
                    <div class="profile-photo-preview" id="profilePhotoPreview">
                        üë§
                    </div>
                    <div>
                        <button class="photo-upload-btn" onclick="document.getElementById('profilePhotoInput').click()">
                            üìÅ Escolher Arquivo
                        </button>
                        <button class="photo-upload-btn" onclick="removeProfilePhoto()">
                            üóëÔ∏è Remover
                        </button>
                        <input type="file" id="profilePhotoInput" accept="image/*" style="display: none;" onchange="uploadProfilePhoto(event)">
                    </div>
                </div>
                
                <div class="personalization-section">
                    <h3>üé® Cores do Tema</h3>
                    <div class="color-palette" id="colorPalette">
                        <!-- Cores ser√£o geradas dinamicamente -->
                    </div>
                    
                    <!-- Seletor de Cor Personalizada -->
                    <div class="custom-color-picker">
                        <label>Cor personalizada:</label>
                        <input type="color" id="customColorInput" class="color-input" onchange="applyCustomColor(this.value)">
                        <input type="text" id="colorHexInput" class="color-hex-input" placeholder="#FF0000" onchange="applyCustomHex(this.value)">
                    </div>
                </div>
                
                <div class="personalization-section">
                    <h3>üñºÔ∏è Papel de Parede</h3>
                    
                    <!-- Upload de Wallpaper Personalizado -->
                    <div class="wallpaper-upload-section">
                        <div>üìÅ <strong>Upload Personalizado</strong></div>
                        <div style="font-size: 11px; color: #666; margin: 5px 0;">
                            Formatos aceitos: JPG, PNG, GIF | Tamanho m√°ximo: 5MB
                        </div>
                        <button class="photo-upload-btn" onclick="document.getElementById('wallpaperUpload').click()">
                            üñºÔ∏è Escolher Imagem
                        </button>
                        <input type="file" id="wallpaperUpload" accept="image/*" style="display: none;" onchange="uploadWallpaper(event)">
                        
                        <!-- Preview do wallpaper personalizado -->
                        <div id="customWallpaperPreview" class="wallpaper-preview" style="display: none;"></div>
                    </div>
                    
                    <!-- Wallpapers Predefinidos -->
                    <div class="wallpaper-section">
                        <div style="font-size: 11px; margin-bottom: 8px;"><strong>Gradientes Predefinidos:</strong></div>
                        <div class="wallpaper-presets" id="wallpaperPresets">
                            <!-- Presets ser√£o gerados dinamicamente -->
                        </div>
                    </div>
                </div>
                
                <div class="personalization-section">
                    <h3>Configura√ß√µes da Taskbar</h3>
                    <label>
                        <input type="checkbox" id="showPlanetaryWidget" checked onchange="togglePlanetaryWidget()">
                        Mostrar widget planet√°rio
                    </label><br>
                    <label>
                        <input type="checkbox" id="showNotifications" checked onchange="toggleNotifications()">
                        Mostrar notifica√ß√µes
                    </label><br>
                    <label>
                        <input type="checkbox" id="showVolumeControl" checked onchange="toggleVolumeControl()">
                        Mostrar controle de volume
                    </label>
                </div>
                
                <div class="personalization-buttons">
                    <button class="personalization-button" onclick="resetPersonalization()">Restaurar Padr√£o</button>
                    <button class="personalization-button primary" onclick="savePersonalization()">Aplicar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // üéØ CONFIGURA√á√ÉO MANUAL DE SITES E √çCONES
        // ========================================
        // 
        // INSTRU√á√ïES PARA PERSONALIZA√á√ÉO:
        // 
        // 1. √çCONES:
        //    - Para emojis: use diretamente (ex: 'üîç', 'üì∫', 'üíª')
        //    - Para imagens: coloque o arquivo na pasta do projeto e use o nome (ex: 'meu-icone.png')
        //    - Tamanho recomendado para imagens: 64x64 pixels
        //
        // 2. LINKS:
        //    - URLs normais: 'https://seusite.com'
        //    - Aplicativo local de arquivos: 'local://files'
        //
        // 3. PREMIUM:
        //    - true: aparece na se√ß√£o premium (dourada) do menu
        //    - false: aparece na se√ß√£o b√°sica do menu
        //
        // 4. ID:
        //    - Use apenas letras min√∫sculas, n√∫meros e h√≠fens
        //    - Deve ser √∫nico para cada item
        //
        const sitesConfig = [
            // ==========================================
            // üì± APLICATIVOS B√ÅSICOS (Se√ß√£o Superior)
            // ==========================================
            { 
                id: 'google', 
                name: 'Google', 
                url: 'https://google.com', 
                icon: 'üîç', 
                premium: false 
            },
            { 
                id: 'youtube', 
                name: 'YouTube', 
                url: 'https://youtube.com', 
                icon: 'üì∫', 
                premium: false 
            },
            { 
                id: 'github', 
                name: 'GitHub', 
                url: 'https://github.com', 
                icon: 'üíª', 
                premium: false 
            },
            { 
                id: 'spotify', 
                name: 'Spotify', 
                url: 'https://spotify.com', 
                icon: 'üéµ', 
                premium: false 
            },
            { 
                id: 'arquivos', 
                name: 'Arquivos & Anota√ß√µes', 
                url: 'local://files', 
                icon: 'üìÅ', 
                premium: false 
            },
            
            // ==========================================
            // ‚≠ê APLICATIVOS PREMIUM (Se√ß√£o Dourada)
            // ==========================================
            { 
                id: 'mysticsoft', 
                name: 'MysticSoft Portal', 
                url: 'https://wix.com', 
                icon: 'mysticsoft-logo.png', 
                premium: true 
            },
            { 
                id: 'loja-mistica', 
                name: 'Loja M√≠stica', 
                url: 'https://wix.com', 
                icon: 'üõí', 
                premium: true 
            },
            { 
                id: 'tarot-online', 
                name: 'Tarot Online', 
                url: 'https://tarot.com', 
                icon: 'üîÆ', 
                premium: true 
            },
            { 
                id: 'portal-astrologico', 
                name: 'Portal Astrol√≥gico', 
                url: 'https://astro.com', 
                icon: '‚≠ê', 
                premium: true 
            },
            
            // ==========================================
            // üîÆ APLICA√á√ïES M√çSTICAS NATIVAS
            // ==========================================
            { 
                id: 'combine-cristais', 
                name: 'Combine os Cristais', 
                url: 'local://crystals', 
                icon: 'üíé', 
                premium: true 
            },
            { 
                id: 'combine-ervas', 
                name: 'Combine as Ervas', 
                url: 'local://herbs', 
                icon: 'üåø', 
                premium: true 
            },
            { 
                id: 'combine-cartas', 
                name: 'Combine as Cartas', 
                url: 'local://cards', 
                icon: 'üÉè', 
                premium: true 
            },
            { 
                id: 'estrelas-fixas', 
                name: 'Estrelas Fixas', 
                url: 'local://stars', 
                icon: '‚≠ê', 
                premium: true 
            },
            { 
                id: 'arvore-vida', 
                name: '√Årvore da Vida', 
                url: 'local://kabbalah', 
                icon: 'üå≥', 
                premium: true 
            },
            { 
                id: 'witch-tarot', 
                name: 'Witch Tarot', 
                url: 'local://tarot', 
                icon: 'üîÆ', 
                premium: true 
            },
            { 
                id: 'livros-interativos', 
                name: 'Livros Interativos', 
                url: 'local://books', 
                icon: 'üìö', 
                premium: true 
            },
            { 
                id: 'roda-do-ano', 
                name: 'Roda do Ano', 
                url: 'local://wheel', 
                icon: 'üé°', 
                premium: true 
            },
            
            // ==========================================
            // üéÆ JOGOS E ENTRETENIMENTO
            // ==========================================
            { 
                id: 'jogo-cobrinha', 
                name: 'Jogo da Cobrinha', 
                url: 'local://snake', 
                icon: 'üêç', 
                premium: false 
            },
            { 
                id: 'paciencia', 
                name: 'Paci√™ncia', 
                url: 'local://solitaire', 
                icon: 'üÉè', 
                premium: false 
            },
            { 
                id: 'domino', 
                name: 'Domin√≥', 
                url: 'local://domino', 
                icon: '‚ö´', 
                premium: false 
            },
            
            // ==========================================
            // üõ†Ô∏è APLICA√á√ïES LOCAIS
            // ==========================================
            { 
                id: 'editor-texto', 
                name: 'Editor de Texto', 
                url: 'local://notepad', 
                icon: 'üìù', 
                premium: false 
            },
            { 
                id: 'calculadora', 
                name: 'Calculadora', 
                url: 'local://calculator', 
                icon: 'üî¢', 
                premium: false 
            },
            { 
                id: 'leitor-documentos', 
                name: 'Leitor de Documentos', 
                url: 'local://reader', 
                icon: 'üìÑ', 
                premium: false 
            },
            { 
                id: 'visualizador-videos', 
                name: 'Visualizador de V√≠deos', 
                url: 'local://player', 
                icon: 'üé¨', 
                premium: false 
            },
            
            // ==========================================
            // ‚ûï ADICIONE SEUS PR√ìPRIOS SITES AQUI:
            // ==========================================
            // 
            // EXEMPLO DE NOVO SITE B√ÅSICO:
            // { 
            //     id: 'meu-site', 
            //     name: 'Meu Site Pessoal', 
            //     url: 'https://meusite.com', 
            //     icon: 'üåê', 
            //     premium: false 
            // },
            //
            // EXEMPLO DE NOVO SITE PREMIUM:
            // { 
            //     id: 'app-premium', 
            //     name: 'Meu App Premium', 
            //     url: 'https://meuapp.com', 
            //     icon: 'meu-icone.png', 
            //     premium: true 
            // },
        ];
        
        // ========================================
        // üé® CONFIGURA√á√ÉO MANUAL DE TEMAS DE CORES
        // ========================================
        // 
        // INSTRU√á√ïES:
        // - primary: Cor principal (barras, janelas)
        // - secondary: Cor secund√°ria (fundos, sombras)  
        // - accent: Cor de destaque (textos, bordas)
        // - Use c√≥digos hexadecimais (#000000)
        //
        const colorThemes = [
            { name: 'Aurora Original', primary: '#3e0a29', secondary: '#0b1836', accent: '#f0aa53' },
            { name: 'Noite C√≥smica', primary: '#1a1a2e', secondary: '#16213e', accent: '#e94560' },
            { name: 'Rosa M√≠stico', primary: '#8b1538', secondary: '#2d1b69', accent: '#f39c12' },
            { name: 'Verde Floresta', primary: '#2d5016', secondary: '#1b4332', accent: '#95d5b2' },
            { name: 'Azul Oceano', primary: '#023047', secondary: '#219ebc', accent: '#ffb703' },
            { name: 'Roxo Imperial', primary: '#5a189a', secondary: '#240046', accent: '#ff006e' },
            { name: 'Dourado Real', primary: '#b7410e', secondary: '#6f1d1b', accent: '#ffd60a' },
            { name: 'Prata Lunar', primary: '#495057', secondary: '#212529', accent: '#adb5bd' }
            
            // ‚ûï ADICIONE SEUS PR√ìPRIOS TEMAS AQUI:
            // { name: 'Meu Tema', primary: '#cor1', secondary: '#cor2', accent: '#cor3' },
        ];
        
        // ========================================
        // üñºÔ∏è CONFIGURA√á√ÉO MANUAL DE WALLPAPERS
        // ========================================
        // 
        // INSTRU√á√ïES:
        // - Use gradientes CSS linear-gradient()
        // - Formato: 'linear-gradient(√¢ngulo, cor1 %, cor2 %)'
        // - √Çngulo comum: 135deg (diagonal)
        //
        const wallpaperPresets = [
            { name: 'Aurora Original', gradient: 'linear-gradient(135deg, #0b1836 0%, #3e0a29 100%)' },
            { name: 'Noite Estrelada', gradient: 'linear-gradient(135deg, #000428 0%, #004e92 100%)' },
            { name: 'P√¥r do Sol', gradient: 'linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%)' },
            { name: 'Floresta M√≠stica', gradient: 'linear-gradient(135deg, #134e5e 0%, #71b280 100%)' },
            { name: 'Oceano Profundo', gradient: 'linear-gradient(135deg, #667db6 0%, #0082c8 100%)' },
            { name: 'Rosa Crep√∫sculo', gradient: 'linear-gradient(135deg, #8360c3 0%, #2ebf91 100%)' }
            
            // ‚ûï ADICIONE SEUS PR√ìPRIOS WALLPAPERS AQUI:
            // { name: 'Meu Wallpaper', gradient: 'linear-gradient(135deg, #cor1 0%, #cor2 100%)' },
        ];
        
        // S√≠mbolos planet√°rios
        const planetarySymbols = {
            'Sol': '‚òâ',
            'Lua': '‚òΩ',
            'Marte': '‚ôÇ',
            'Merc√∫rio': '‚òø',
            'J√∫piter': '‚ôÉ',
            'V√™nus': '‚ôÄ',
            'Saturno': '‚ôÑ'
        };
        
        // Ordem caldaica dos planetas
        const chaldeanOrder = ['Saturno', 'J√∫piter', 'Marte', 'Sol', 'V√™nus', 'Merc√∫rio', 'Lua'];
        const dayRulers = ['Sol', 'Lua', 'Marte', 'Merc√∫rio', 'J√∫piter', 'V√™nus', 'Saturno']; // Dom, Seg, Ter, Qua, Qui, Sex, S√°b
        
        // Estado do sistema
        let currentTheme = 0;
        let currentWallpaper = 0;
        let openWindows = [];
        let currentDate = new Date();
        let currentPlanetaryHour = { planet: 'Sol', hour: 1, period: 'dia' };
        
        // Volumes do sistema
        let volumes = {
            master: 70,
            notifications: 50,
            system: 60
        };
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar sistema de boot completo
            initBootSystem();
        });
        
        function setupEventListeners() {
            // Menu de contexto (bot√£o direito)
            document.addEventListener('contextmenu', function(e) {
                if (e.target.closest('.desktop')) {
                    e.preventDefault();
                    showContextMenu(e.clientX, e.clientY);
                }
            });
            
            // Fechar menus ao clicar fora
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.context-menu')) {
                    hideContextMenu();
                }
                if (!e.target.closest('.start-menu') && !e.target.closest('.start-button')) {
                    hideStartMenu();
                }
                if (!e.target.closest('.popup')) {
                    hideAllPopups();
                }
            });
            
            // Drag and drop para janelas
            setupWindowDragging();
        }
        
        function generateDesktopIcons() {
            const container = document.getElementById('desktopIcons');
            container.innerHTML = '';
            
            // Adicionar √≠cones do sistema primeiro
            
            // √çcone da Galeria
            const galleryIcon = document.createElement('div');
            galleryIcon.className = 'desktop-icon system-icon gallery-icon';
            galleryIcon.id = 'galleryIcon';
            galleryIcon.onclick = () => openGallery();
            galleryIcon.innerHTML = `
                <div class="icon">üñºÔ∏è</div>
                <div class="label">Galeria</div>
            `;
            galleryIcon.style.position = 'absolute';
            galleryIcon.style.bottom = '20px';
            galleryIcon.style.left = '20px';
            container.appendChild(galleryIcon);
            
            // √çcone do Gerenciador de Wallpapers
            const wallpaperIcon = document.createElement('div');
            wallpaperIcon.className = 'desktop-icon system-icon wallpaper-icon';
            wallpaperIcon.id = 'wallpaperIcon';
            wallpaperIcon.onclick = () => openWallpaperManager();
            wallpaperIcon.innerHTML = `
                <div class="icon">üåå</div>
                <div class="label">Wallpapers</div>
            `;
            wallpaperIcon.style.position = 'absolute';
            wallpaperIcon.style.bottom = '20px';
            wallpaperIcon.style.left = '120px';
            container.appendChild(wallpaperIcon);
            
            // √çcone da lixeira
            const trashIcon = document.createElement('div');
            trashIcon.className = 'desktop-icon system-icon trash-icon';
            trashIcon.id = 'trashIcon';
            trashIcon.onclick = () => openTrash();
            trashIcon.innerHTML = `
                <div class="icon">üóëÔ∏è</div>
                <div class="label">Lixeira</div>
            `;
            trashIcon.style.position = 'absolute';
            trashIcon.style.bottom = '20px';
            trashIcon.style.right = '20px';
            container.appendChild(trashIcon);
            
            // Carregar posi√ß√µes salvas dos √≠cones
            const savedPositions = JSON.parse(localStorage.getItem('auroraOS_icon_positions') || '{}');
            
            sitesConfig.forEach((site, index) => {
                const icon = document.createElement('div');
                icon.className = `desktop-icon ${site.premium ? 'premium' : ''}`;
                icon.draggable = true;
                icon.dataset.siteIndex = index;
                
                const iconContent = site.icon.endsWith('.png') ? 
                    `<img src="${site.icon}" alt="${site.name}" style="width: 32px; height: 32px; image-rendering: pixelated;">` : 
                    site.icon;
                
                icon.innerHTML = `
                    <div class="icon">${iconContent}</div>
                    <div class="label">${site.name}</div>
                `;
                
                // Aplicar posi√ß√£o salva se existir
                if (savedPositions[site.name]) {
                    icon.style.position = 'absolute';
                    icon.style.left = savedPositions[site.name].x + 'px';
                    icon.style.top = savedPositions[site.name].y + 'px';
                }
                
                // Eventos de arrastar
                icon.addEventListener('dragstart', handleDragStart);
                icon.addEventListener('dragend', handleDragEnd);
                icon.addEventListener('click', (e) => {
                    if (!icon.classList.contains('dragging')) {
                        openSite(site);
                    }
                });
                
                container.appendChild(icon);
            });
            
            // Configurar √°rea de drop
            container.addEventListener('dragover', handleDragOver);
            container.addEventListener('drop', handleDrop);
        }
        
        // ========================================
        // üñ±Ô∏è SISTEMA DE ARRASTAR √çCONES
        // ========================================
        
        let draggedIcon = null;
        let dragOffset = { x: 0, y: 0 };
        
        function handleDragStart(e) {
            draggedIcon = e.target.closest('.desktop-icon');
            draggedIcon.classList.add('dragging');
            
            const rect = draggedIcon.getBoundingClientRect();
            dragOffset.x = e.clientX - rect.left;
            dragOffset.y = e.clientY - rect.top;
            
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', draggedIcon.outerHTML);
        }
        
        function handleDragEnd(e) {
            if (draggedIcon) {
                draggedIcon.classList.remove('dragging');
                draggedIcon = null;
            }
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }
        
        function handleDrop(e) {
            e.preventDefault();
            
            if (draggedIcon) {
                const container = document.getElementById('desktopIcons');
                const containerRect = container.getBoundingClientRect();
                
                const x = e.clientX - containerRect.left - dragOffset.x;
                const y = e.clientY - containerRect.top - dragOffset.y;
                
                // Limitar posi√ß√£o dentro do container
                const maxX = containerRect.width - draggedIcon.offsetWidth;
                const maxY = containerRect.height - draggedIcon.offsetHeight;
                
                const finalX = Math.max(0, Math.min(x, maxX));
                const finalY = Math.max(0, Math.min(y, maxY));
                
                draggedIcon.style.position = 'absolute';
                draggedIcon.style.left = finalX + 'px';
                draggedIcon.style.top = finalY + 'px';
                
                // Salvar posi√ß√£o
                saveIconPosition(draggedIcon, finalX, finalY);
                
                draggedIcon.classList.remove('dragging');
                draggedIcon = null;
            }
        }
        
        function saveIconPosition(iconElement, x, y) {
            const siteIndex = iconElement.dataset.siteIndex;
            if (siteIndex !== undefined) {
                const siteName = sitesConfig[siteIndex].name;
                const savedPositions = JSON.parse(localStorage.getItem('auroraOS_icon_positions') || '{}');
                savedPositions[siteName] = { x, y };
                localStorage.setItem('auroraOS_icon_positions', JSON.stringify(savedPositions));
            }
        }
        
        function resetIconPositions() {
            localStorage.removeItem('auroraOS_icon_positions');
            generateDesktopIcons();
            
            // Notificar Gatomante
            setTimeout(() => {
                gatomanteContextual('personalizacao', { acao: '√≠cones reorganizados' });
            }, 1000);
        }
        
        // ========================================
        // üóëÔ∏è SISTEMA DE LIXEIRA
        // ========================================
        
        function openTrash() {
            const trashItems = JSON.parse(localStorage.getItem('auroraOS_trash') || '[]');
            
            let trashContent = '<h3>üóëÔ∏è Lixeira do Aurora OS</h3>';
            
            if (trashItems.length === 0) {
                trashContent += '<p>A lixeira est√° vazia.</p>';
            } else {
                trashContent += '<div style="margin: 15px 0;">';
                trashItems.forEach((item, index) => {
                    trashContent += `
                        <div style="display: flex; align-items: center; padding: 8px; border-bottom: 1px solid #444;">
                            <span style="margin-right: 10px;">${item.icon}</span>
                            <span style="flex: 1;">${item.name}</span>
                            <small style="opacity: 0.7;">${item.deletedAt}</small>
                            <button onclick="restoreFromTrash(${index})" style="margin-left: 10px; padding: 4px 8px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Restaurar</button>
                        </div>
                    `;
                });
                trashContent += '</div>';
                trashContent += '<button onclick="emptyTrash()" style="background: #f44336; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-top: 10px;">Esvaziar Lixeira</button>';
            }
            
            openMysticalApp('Lixeira', trashContent);
        }
        
        function addToTrash(item) {
            const trashItems = JSON.parse(localStorage.getItem('auroraOS_trash') || '[]');
            trashItems.push({
                ...item,
                deletedAt: new Date().toLocaleString('pt-BR')
            });
            localStorage.setItem('auroraOS_trash', JSON.stringify(trashItems));
        }
        
        function restoreFromTrash(index) {
            const trashItems = JSON.parse(localStorage.getItem('auroraOS_trash') || '[]');
            const item = trashItems[index];
            
            if (item) {
                // Restaurar item (implementar l√≥gica espec√≠fica conforme necess√°rio)
                trashItems.splice(index, 1);
                localStorage.setItem('auroraOS_trash', JSON.stringify(trashItems));
                
                alert(`${item.name} foi restaurado com sucesso!`);
                openTrash(); // Reabrir lixeira para mostrar mudan√ßas
            }
        }
        
        function emptyTrash() {
            if (confirm('Tem certeza que deseja esvaziar a lixeira? Esta a√ß√£o n√£o pode ser desfeita.')) {
                localStorage.removeItem('auroraOS_trash');
                alert('Lixeira esvaziada com sucesso!');
                openTrash(); // Reabrir lixeira para mostrar mudan√ßas
            }
        }
        
        // ========================================
        // üåü SISTEMA DE MENU MANDALA REVOLUCION√ÅRIO
        // ========================================
        
        let currentElementFilter = null;
        let mandalaApps = [];
        
        function generateMandalaMenu() {
            // Configurar aplica√ß√µes com elementos m√≠sticos
            mandalaApps = [
                // FOGO - Criatividade e A√ß√£o
                { name: 'Aurora Player', icon: 'üéµ', element: 'fire', action: () => openAuroraPlayer() },
                { name: 'Calculadora M√≠stica', icon: 'üî¢', element: 'fire', action: () => openMysticalCalculator() },
                { name: 'Combine os Cristais', icon: 'üíé', element: 'fire', action: () => openCrystalGame() },
                { name: 'Witch Tarot', icon: 'üîÆ', element: 'fire', action: () => openTarotGame() },
                { name: 'Jogo da Cobrinha', icon: 'üêç', element: 'fire', action: () => openSnakeGame() },
                { name: 'Est√∫dio de Arte', icon: 'üé®', element: 'fire', action: () => openArtStudio() },
                
                // TERRA - Estabilidade e Materializa√ß√£o
                { name: 'Gerenciador de Arquivos', icon: 'üìÇ', element: 'earth', action: () => openFileManager() },
                { name: 'Pasta Documentos', icon: 'üìÅ', element: 'earth', action: () => openDocumentsFolder() },
                { name: 'Combine as Ervas', icon: 'üåø', element: 'earth', action: () => openHerbsGame() },
                { name: '√Årvore da Vida', icon: 'üå≥', element: 'earth', action: () => openTreeOfLife() },
                { name: 'Jardim M√≠stico', icon: 'üå∫', element: 'earth', action: () => openMysticGarden() },
                { name: 'Alquimia Digital', icon: '‚öóÔ∏è', element: 'earth', action: () => openAlchemyLab() },
                
                // AR - Comunica√ß√£o e Intelecto
                { name: 'Processador de Texto', icon: 'üìù', element: 'air', action: () => openTextProcessor() },
                { name: 'Terminal M√≠stico', icon: 'üíª', element: 'air', action: () => openMysticTerminal() },
                { name: 'Navegador Astral', icon: 'üåê', element: 'air', action: () => openAstralBrowser() },
                { name: 'Livros Interativos', icon: 'üìö', element: 'air', action: () => openInteractiveBooks() },
                { name: 'Estrelas Fixas', icon: '‚≠ê', element: 'air', action: () => openFixedStars() },
                { name: 'Configura√ß√µes', icon: '‚öôÔ∏è', element: 'air', action: () => openSettings() },
                
                // √ÅGUA - Emo√ß√£o e Intui√ß√£o
                { name: 'Galeria M√≠stica', icon: 'üñºÔ∏è', element: 'water', action: () => openGallery() },
                { name: 'Wallpapers', icon: 'üåå', element: 'water', action: () => openWallpaperManager() },
                { name: 'Paci√™ncia M√≠stica', icon: 'üÉè', element: 'water', action: () => openSolitaireGame() },
                { name: 'Domin√≥ Astral', icon: '‚ö´', element: 'water', action: () => openDominoGame() },
                { name: 'Or√°culo dos Sonhos', icon: 'üåô', element: 'water', action: () => openDreamOracle() },
                { name: 'Medita√ß√£o Guiada', icon: 'üßò‚Äç‚ôÄÔ∏è', element: 'water', action: () => openMeditation() }
            ];
            
            // Adicionar sites externos como aplica√ß√µes m√≠sticas
            sitesConfig.forEach(site => {
                if (site.category === 'basic') {
                    mandalaApps.push({
                        name: site.name,
                        icon: site.icon,
                        element: getElementForSite(site.name),
                        action: () => openSite(site.id)
                    });
                }
            });
            
            renderMandalaApps();
            createMandalaParticles();
        }
        
        function getElementForSite(siteName) {
            // Classificar sites por elemento baseado no nome/fun√ß√£o
            const fireKeywords = ['game', 'jogo', 'create', 'art', 'music'];
            const earthKeywords = ['work', 'business', 'money', 'shop', 'store'];
            const airKeywords = ['social', 'chat', 'news', 'search', 'learn'];
            const waterKeywords = ['video', 'stream', 'emotion', 'love', 'spiritual'];
            
            const name = siteName.toLowerCase();
            
            if (fireKeywords.some(keyword => name.includes(keyword))) return 'fire';
            if (earthKeywords.some(keyword => name.includes(keyword))) return 'earth';
            if (airKeywords.some(keyword => name.includes(keyword))) return 'air';
            return 'water'; // Default para √°gua
        }
        
        function renderMandalaApps() {
            const orbit = document.getElementById('appOrbit');
            orbit.innerHTML = '';
            
            let appsToShow = mandalaApps;
            if (currentElementFilter) {
                appsToShow = mandalaApps.filter(app => app.element === currentElementFilter);
            }
            
            const totalApps = appsToShow.length;
            const angleStep = (2 * Math.PI) / totalApps;
            const radius = 200; // Raio da √≥rbita
            
            appsToShow.forEach((app, index) => {
                const angle = index * angleStep - Math.PI / 2; // Come√ßar do topo
                const x = Math.cos(angle) * radius;
                const y = Math.sin(angle) * radius;
                
                const appElement = document.createElement('div');
                appElement.className = 'app-item';
                appElement.style.left = `calc(50% + ${x}px - 30px)`;
                appElement.style.top = `calc(50% + ${y}px - 30px)`;
                appElement.onclick = app.action;
                appElement.title = app.name;
                
                // Adicionar classe do elemento para efeitos visuais
                appElement.classList.add(`element-${app.element}`);
                
                appElement.innerHTML = `
                    <div class="app-icon">${app.icon}</div>
                    <div class="app-name">${app.name.split(' ')[0]}</div>
                `;
                
                // Anima√ß√£o de entrada escalonada
                appElement.style.animationDelay = `${index * 0.1}s`;
                appElement.style.animation = 'appOrbitEntry 0.6s ease-out forwards';
                
                orbit.appendChild(appElement);
            });
        }
        
        function createMandalaParticles() {
            const container = document.getElementById('mandalaParticles');
            container.innerHTML = '';
            
            // Criar 20 part√≠culas m√≠sticas
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'mandala-particle';
                
                // Posi√ß√£o aleat√≥ria
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (6 + Math.random() * 4) + 's';
                
                container.appendChild(particle);
            }
        }
        
        function filterByElement(element) {
            if (currentElementFilter === element) {
                // Se j√° est√° filtrado por este elemento, remover filtro
                currentElementFilter = null;
                document.querySelectorAll('.element-sector').forEach(el => el.classList.remove('active'));
            } else {
                // Aplicar novo filtro
                currentElementFilter = element;
                document.querySelectorAll('.element-sector').forEach(el => el.classList.remove('active'));
                document.querySelector(`.element-${element}`).classList.add('active');
            }
            
            renderMandalaApps();
            
            // Notificar Gatomante sobre filtro
            const elementNames = {
                fire: 'Fogo - Criatividade e A√ß√£o',
                earth: 'Terra - Estabilidade e Materializa√ß√£o', 
                air: 'Ar - Comunica√ß√£o e Intelecto',
                water: '√Ågua - Emo√ß√£o e Intui√ß√£o'
            };
            
            setTimeout(() => {
                if (currentElementFilter) {
                    gatomanteContextual('navegacao', { 
                        acao: `filtro por elemento ${elementNames[element]} aplicado` 
                    });
                } else {
                    gatomanteContextual('navegacao', { acao: 'filtro de elemento removido' });
                }
            }, 500);
        }
        
        function filterMandalaApps(searchTerm) {
            const orbit = document.getElementById('appOrbit');
            const apps = orbit.querySelectorAll('.app-item');
            
            if (!searchTerm.trim()) {
                apps.forEach(app => app.classList.remove('hidden'));
                return;
            }
            
            const term = searchTerm.toLowerCase();
            let visibleCount = 0;
            
            apps.forEach(app => {
                const name = app.title.toLowerCase();
                if (name.includes(term)) {
                    app.classList.remove('hidden');
                    visibleCount++;
                } else {
                    app.classList.add('hidden');
                }
            });
            
            // Notificar sobre resultados da busca
            if (visibleCount === 0) {
                gatomanteContextual('navegacao', { acao: 'busca sem resultados nos mist√©rios' });
            }
        }
        
        function handleMandalaSearch(event) {
            if (event.key === 'Enter') {
                const visibleApps = document.querySelectorAll('.app-item:not(.hidden)');
                if (visibleApps.length > 0) {
                    visibleApps[0].click();
                    hideStartMenu();
                }
            } else if (event.key === 'Escape') {
                event.target.value = '';
                filterMandalaApps('');
            }
        }
        
        // Adicionar CSS para anima√ß√µes din√¢micas
        const mandalaStyles = document.createElement('style');
        mandalaStyles.textContent = `
            @keyframes appOrbitEntry {
                0% {
                    opacity: 0;
                    transform: scale(0) rotate(-180deg);
                }
                70% {
                    opacity: 1;
                    transform: scale(1.2) rotate(-20deg);
                }
                100% {
                    opacity: 1;
                    transform: scale(1) rotate(0deg);
                }
            }
            
            .element-sector.active {
                transform: scale(1.3) !important;
                border: 3px solid var(--dourado) !important;
                box-shadow: 0 0 40px var(--dourado) !important;
            }
            
            .app-item.element-fire:hover {
                box-shadow: 0 0 25px #ff4500 !important;
            }
            
            .app-item.element-earth:hover {
                box-shadow: 0 0 25px #8b4513 !important;
            }
            
            .app-item.element-air:hover {
                box-shadow: 0 0 25px #87ceeb !important;
            }
            
            .app-item.element-water:hover {
                box-shadow: 0 0 25px #00bfff !important;
            }
        `;
        document.head.appendChild(mandalaStyles);
        
        function generateStartMenu() {
            // Fun√ß√£o legacy mantida para compatibilidade
            generateMandalaMenu();
                { name: 'Pasta Documentos', icon: 'üìÅ', action: () => openDocumentsFolder() },
                { name: 'Ajuda do Sistema', icon: '‚ùì', action: () => openSystemHelp() },
                { name: 'Lixeira', icon: 'üóëÔ∏è', action: () => openTrash() }
            ];
            
            systemApps.forEach(app => {
                const item = document.createElement('div');
                item.className = 'start-menu-item system-app';
                item.onclick = app.action;
                
                item.innerHTML = `
                    <div class="icon">${app.icon}</div>
                    <div class="text">${app.name}</div>
                `;
                
                container.appendChild(item);
            });
            
            // Separador
            const systemSeparator = document.createElement('div');
            systemSeparator.className = 'start-menu-separator';
            container.appendChild(systemSeparator);
            
            // ========================================
            // üåê SITES E APLICA√á√ïES EXTERNAS
            // ========================================
            
            // Separar sites b√°sicos e premium
            const basicSites = sitesConfig.filter(site => !site.premium);
            const premiumSites = sitesConfig.filter(site => site.premium);
            
            // Adicionar sites b√°sicos
            basicSites.forEach(site => {
                const item = document.createElement('div');
                item.className = 'start-menu-item';
                item.onclick = () => openSite(site);
                
                const iconContent = site.icon.endsWith('.png') ? 
                    `<img src="${site.icon}" alt="${site.name}" style="width: 16px; height: 16px; image-rendering: pixelated;">` : 
                    site.icon;
                
                item.innerHTML = `
                    <div class="icon">${iconContent}</div>
                    <div class="text">${site.name}</div>
                `;
                
                container.appendChild(item);
            });
            
            if (premiumSites.length > 0) {
                const separator = document.createElement('div');
                separator.className = 'start-menu-separator';
                container.appendChild(separator);
                
                // Adicionar sites premium
                premiumSites.forEach(site => {
                    const item = document.createElement('div');
                    item.className = 'start-menu-item premium';
                    item.onclick = () => openSite(site);
                    
                    const iconContent = site.icon.endsWith('.png') ? 
                        `<img src="${site.icon}" alt="${site.name}" style="width: 16px; height: 16px; image-rendering: pixelated;">` : 
                        site.icon;
                    
                    item.innerHTML = `
                        <div class="icon">${iconContent}</div>
                        <div class="text">${site.name}</div>
                    `;
                    
                    container.appendChild(item);
                });
            }
        }
        
        // ========================================
        // üìù PROCESSADOR DE TEXTO
        // ========================================
        
        function openTextProcessor() {
            const savedDocuments = JSON.parse(localStorage.getItem('auroraOS_documents') || '[]');
            
            let content = `
                <div style="display: flex; flex-direction: column; height: 100%; font-family: 'Segoe UI', sans-serif;">
                    <div style="background: #2a2a2a; padding: 10px; border-bottom: 2px solid #444; display: flex; gap: 10px; align-items: center;">
                        <button onclick="newDocument()" style="padding: 5px 10px; background: #4CAF50; color: white; border: none; border-radius: 3px; cursor: pointer;">üìÑ Novo</button>
                        <button onclick="saveDocument()" style="padding: 5px 10px; background: #2196F3; color: white; border: none; border-radius: 3px; cursor: pointer;">üíæ Salvar</button>
                        <button onclick="loadDocument()" style="padding: 5px 10px; background: #FF9800; color: white; border: none; border-radius: 3px; cursor: pointer;">üìÇ Abrir</button>
                        <input type="text" id="documentTitle" placeholder="T√≠tulo do documento..." style="padding: 5px; border: 1px solid #555; background: #333; color: white; border-radius: 3px; flex: 1;">
                    </div>
                    <div style="flex: 1; padding: 15px; background: #1a1a1a;">
                        <textarea id="textEditor" placeholder="Digite seu texto aqui..." style="width: 100%; height: 100%; border: none; background: #222; color: #fff; font-family: 'Courier New', monospace; font-size: 14px; line-height: 1.5; resize: none; outline: none; padding: 15px;"></textarea>
                    </div>
                    <div style="background: #2a2a2a; padding: 8px; border-top: 1px solid #444; font-size: 12px; color: #aaa; display: flex; justify-content: space-between;">
                        <span id="documentStatus">Pronto</span>
                        <span id="characterCount">0 caracteres</span>
                    </div>
                </div>
            `;
            
            openMysticalApp('Processador de Texto', content);
            
            // Configurar eventos ap√≥s abrir a janela
            setTimeout(() => {
                const editor = document.getElementById('textEditor');
                const charCount = document.getElementById('characterCount');
                
                if (editor && charCount) {
                    editor.addEventListener('input', function() {
                        charCount.textContent = this.value.length + ' caracteres';
                        document.getElementById('documentStatus').textContent = 'Modificado';
                    });
                }
            }, 100);
        }
        
        function newDocument() {
            document.getElementById('textEditor').value = '';
            document.getElementById('documentTitle').value = '';
            document.getElementById('documentStatus').textContent = 'Novo documento';
            document.getElementById('characterCount').textContent = '0 caracteres';
        }
        
        function saveDocument() {
            const title = document.getElementById('documentTitle').value.trim();
            const content = document.getElementById('textEditor').value;
            
            if (!title) {
                alert('Por favor, digite um t√≠tulo para o documento.');
                return;
            }
            
            if (!content.trim()) {
                alert('O documento est√° vazio.');
                return;
            }
            
            const documents = JSON.parse(localStorage.getItem('auroraOS_documents') || '[]');
            const existingIndex = documents.findIndex(doc => doc.title === title);
            
            const document = {
                title: title,
                content: content,
                lastModified: new Date().toLocaleString('pt-BR'),
                wordCount: content.split(/\s+/).filter(word => word.length > 0).length
            };
            
            if (existingIndex >= 0) {
                documents[existingIndex] = document;
                alert('Documento atualizado com sucesso!');
            } else {
                documents.push(document);
                alert('Documento salvo com sucesso!');
            }
            
            localStorage.setItem('auroraOS_documents', JSON.stringify(documents));
            document.getElementById('documentStatus').textContent = 'Salvo';
            
            // Notificar Gatomante
            setTimeout(() => {
                gatomanteContextual('personalizacao', { acao: 'documento salvo' });
            }, 1000);
        }
        
        function loadDocument() {
            const documents = JSON.parse(localStorage.getItem('auroraOS_documents') || '[]');
            
            if (documents.length === 0) {
                alert('Nenhum documento salvo encontrado.');
                return;
            }
            
            let docList = 'Documentos salvos:\n\n';
            documents.forEach((doc, index) => {
                docList += `${index + 1}. ${doc.title}\n   ${doc.wordCount} palavras - ${doc.lastModified}\n\n`;
            });
            
            const choice = prompt(docList + 'Digite o n√∫mero do documento para abrir:');
            const docIndex = parseInt(choice) - 1;
            
            if (docIndex >= 0 && docIndex < documents.length) {
                const doc = documents[docIndex];
                document.getElementById('documentTitle').value = doc.title;
                document.getElementById('textEditor').value = doc.content;
                document.getElementById('documentStatus').textContent = 'Carregado';
                document.getElementById('characterCount').textContent = doc.content.length + ' caracteres';
            } else {
                alert('N√∫mero inv√°lido.');
            }
        }
        
        // ========================================
        // üìÅ PASTA DOCUMENTOS
        // ========================================
        
        function openDocumentsFolder() {
            const documents = JSON.parse(localStorage.getItem('auroraOS_documents') || '[]');
            
            let content = '<h3>üìÅ Pasta Documentos</h3>';
            
            if (documents.length === 0) {
                content += '<p style="color: #aaa; font-style: italic;">Nenhum documento encontrado. Use o Processador de Texto para criar documentos.</p>';
            } else {
                content += '<div style="margin: 15px 0;">';
                documents.forEach((doc, index) => {
                    content += `
                        <div style="display: flex; align-items: center; padding: 12px; border: 1px solid #444; border-radius: 6px; margin-bottom: 8px; background: #222;">
                            <div style="font-size: 24px; margin-right: 15px;">üìÑ</div>
                            <div style="flex: 1;">
                                <div style="font-weight: bold; color: #fff; margin-bottom: 4px;">${doc.title}</div>
                                <div style="font-size: 12px; color: #aaa;">${doc.wordCount} palavras ‚Ä¢ ${doc.lastModified}</div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="openDocumentInEditor('${doc.title}')" style="padding: 4px 8px; background: #2196F3; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 12px;">Abrir</button>
                                <button onclick="deleteDocument('${doc.title}')" style="padding: 4px 8px; background: #f44336; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 12px;">Excluir</button>
                            </div>
                        </div>
                    `;
                });
                content += '</div>';
            }
            
            openMysticalApp('Pasta Documentos', content);
        }
        
        function openDocumentInEditor(title) {
            // Fechar pasta documentos
            const windows = document.querySelectorAll('.window');
            windows.forEach(win => {
                if (win.querySelector('.window-title').textContent === 'Pasta Documentos') {
                    win.remove();
                }
            });
            
            // Abrir processador de texto
            openTextProcessor();
            
            // Carregar documento espec√≠fico
            setTimeout(() => {
                const documents = JSON.parse(localStorage.getItem('auroraOS_documents') || '[]');
                const doc = documents.find(d => d.title === title);
                
                if (doc) {
                    document.getElementById('documentTitle').value = doc.title;
                    document.getElementById('textEditor').value = doc.content;
                    document.getElementById('documentStatus').textContent = 'Carregado';
                    document.getElementById('characterCount').textContent = doc.content.length + ' caracteres';
                }
            }, 200);
        }
        
        function deleteDocument(title) {
            if (confirm(`Tem certeza que deseja excluir o documento "${title}"?`)) {
                const documents = JSON.parse(localStorage.getItem('auroraOS_documents') || '[]');
                const filteredDocs = documents.filter(doc => doc.title !== title);
                localStorage.setItem('auroraOS_documents', JSON.stringify(filteredDocs));
                
                // Adicionar √† lixeira
                const deletedDoc = documents.find(doc => doc.title === title);
                if (deletedDoc) {
                    addToTrash({ name: deletedDoc.title, icon: 'üìÑ', type: 'document' });
                }
                
                alert('Documento exclu√≠do com sucesso!');
                openDocumentsFolder(); // Reabrir pasta para mostrar mudan√ßas
            }
        }
        
        // ========================================
        // ‚ùì AJUDA DO SISTEMA
        // ========================================
        
        function openSystemHelp() {
            const helpContent = `
                <div style="font-family: 'Segoe UI', sans-serif; line-height: 1.6;">
                    <h2 style="color: #f0aa53; margin-bottom: 20px;">üîÆ Ajuda do Aurora OS ‚Ä¢ MysticSoft</h2>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #d4af37; margin-bottom: 10px;">üñ•Ô∏è Navega√ß√£o B√°sica</h3>
                        <ul style="color: #ccc; margin-left: 20px;">
                            <li><strong>√çcones do Desktop:</strong> Clique duas vezes para abrir aplica√ß√µes</li>
                            <li><strong>Arrastar √çcones:</strong> Clique e arraste para reorganizar</li>
                            <li><strong>Menu Iniciar:</strong> Clique no bot√£o Iniciar para acessar aplica√ß√µes</li>
                            <li><strong>Barra de Tarefas:</strong> Mostra aplica√ß√µes abertas e widgets</li>
                        </ul>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #d4af37; margin-bottom: 10px;">üõ°Ô∏è Sistema AF√ÅST!</h3>
                        <ul style="color: #ccc; margin-left: 20px;">
                            <li><strong>Antiv√≠rus Astrol√≥gico:</strong> Monitora eventos c√≥smicos 24/7</li>
                            <li><strong>Notifica√ß√µes:</strong> Aparecem no canto inferior direito</li>
                            <li><strong>Central AF√ÅST:</strong> Clique no escudo dourado para ver hist√≥rico</li>
                            <li><strong>Voz Feminina:</strong> Alerta "AF√ÅSTE" para eventos cr√≠ticos</li>
                        </ul>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #d4af37; margin-bottom: 10px;">üê±‚Äç‚¨õ Gatomante - Seu Assistente M√≠stico</h3>
                        <ul style="color: #ccc; margin-left: 20px;">
                            <li><strong>Dicas Contextuais:</strong> Aparece automaticamente com sugest√µes</li>
                            <li><strong>Clique no Gato:</strong> Para obter novas dicas</li>
                            <li><strong>Bal√£o de Fala:</strong> Estilo HQ com bot√£o de fechar</li>
                            <li><strong>Intelig√™ncia:</strong> Aprende seus padr√µes de uso</li>
                        </ul>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #d4af37; margin-bottom: 10px;">üé® Personaliza√ß√£o</h3>
                        <ul style="color: #ccc; margin-left: 20px;">
                            <li><strong>Temas de Cores:</strong> 6 temas m√≠sticos dispon√≠veis</li>
                            <li><strong>Wallpapers:</strong> Upload de imagens personalizadas</li>
                            <li><strong>Foto de Perfil:</strong> Personalize sua conta</li>
                            <li><strong>Seletor de Cores:</strong> Crie temas √∫nicos</li>
                        </ul>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #d4af37; margin-bottom: 10px;">üìù Aplica√ß√µes Nativas</h3>
                        <ul style="color: #ccc; margin-left: 20px;">
                            <li><strong>Processador de Texto:</strong> Crie e salve documentos</li>
                            <li><strong>Pasta Documentos:</strong> Gerencie seus arquivos</li>
                            <li><strong>Lixeira:</strong> Recupere itens exclu√≠dos</li>
                            <li><strong>Aplica√ß√µes M√≠sticas:</strong> Ferramentas esot√©ricas √∫nicas</li>
                        </ul>
                    </div>
                    
                    <div style="background: #2a2a2a; padding: 15px; border-radius: 8px; border-left: 4px solid #f0aa53;">
                        <h4 style="color: #f0aa53; margin-bottom: 10px;">üí° Dica Especial</h4>
                        <p style="color: #ccc; margin: 0;">O Aurora OS √© um sistema operacional m√≠stico √∫nico. Explore todas as funcionalidades e deixe o Gatomante gui√°-lo em sua jornada digital!</p>
                    </div>
                </div>
            `;
            
            openMysticalApp('Ajuda do Sistema', helpContent);
        }
        
        // ========================================
        // üîç BUSCA INTELIGENTE NO MENU INICIAR
        // ========================================
        
        let allMenuItems = []; // Cache de todos os itens do menu
        
        function filterStartMenu(searchTerm) {
            const items = document.querySelectorAll('.start-menu-item');
            const statusElement = document.getElementById('startMenuStatus');
            let visibleCount = 0;
            
            if (!searchTerm.trim()) {
                // Mostrar todos os itens
                items.forEach(item => {
                    item.classList.remove('hidden');
                    visibleCount++;
                });
                statusElement.textContent = 'Clique em qualquer item para abrir';
                return;
            }
            
            const searchLower = searchTerm.toLowerCase();
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                const isMatch = text.includes(searchLower);
                
                if (isMatch) {
                    item.classList.remove('hidden');
                    visibleCount++;
                } else {
                    item.classList.add('hidden');
                }
            });
            
            // Atualizar status
            if (visibleCount === 0) {
                statusElement.textContent = 'Nenhuma aplica√ß√£o encontrada';
                statusElement.style.color = '#ff6b6b';
            } else {
                statusElement.textContent = `${visibleCount} aplica√ß√£o${visibleCount > 1 ? '√µes' : ''} encontrada${visibleCount > 1 ? 's' : ''}`;
                statusElement.style.color = '#4CAF50';
            }
            
            // Notificar Gatomante sobre busca
            if (searchTerm.length >= 3) {
                setTimeout(() => {
                    gatomanteContextual('personalizacao', { acao: `busca por "${searchTerm}"` });
                }, 1500);
            }
        }
        
        function handleSearchKeydown(event) {
            if (event.key === 'Enter') {
                // Abrir primeiro item vis√≠vel
                const firstVisible = document.querySelector('.start-menu-item:not(.hidden)');
                if (firstVisible) {
                    firstVisible.click();
                    hideStartMenu();
                    document.getElementById('startMenuSearch').value = '';
                }
            } else if (event.key === 'Escape') {
                // Limpar busca
                document.getElementById('startMenuSearch').value = '';
                filterStartMenu('');
            }
        }
        
        // ========================================
        // üö™ SISTEMA DE LOGOUT
        // ========================================
        
        function performLogout() {
            if (confirm('Tem certeza que deseja sair do Aurora OS?')) {
                // Limpar sess√£o atual
                localStorage.removeItem('auroraOS_currentSession');
                localStorage.removeItem('auroraOS_rememberMe');
                
                // Salvar dados do usu√°rio antes de sair
                if (currentUser) {
                    const users = JSON.parse(localStorage.getItem('auroraOS_users') || '[]');
                    const userIndex = users.findIndex(u => u.email === currentUser.email);
                    if (userIndex >= 0) {
                        users[userIndex] = currentUser;
                        localStorage.setItem('auroraOS_users', JSON.stringify(users));
                    }
                }
                
                // Notificar Gatomante sobre logout
                gatomanteContextual('personalizacao', { acao: 'logout realizado' });
                
                // Aguardar um pouco e recarregar p√°gina
                setTimeout(() => {
                    location.reload();
                }, 1500);
                
                hideStartMenu();
            }
        }
        
        // ========================================
        // üìä ESTAT√çSTICAS DO MENU INICIAR
        // ========================================
        
        function updateStartMenuStats() {
            const systemApps = document.querySelectorAll('.start-menu-item.system-app').length;
            const basicApps = document.querySelectorAll('.start-menu-item:not(.premium):not(.system-app)').length;
            const premiumApps = document.querySelectorAll('.start-menu-item.premium').length;
            
            console.log(`üìä Menu Iniciar: ${systemApps} apps do sistema, ${basicApps} apps b√°sicos, ${premiumApps} apps premium`);
        }
        
        // Melhorar fun√ß√£o toggleStartMenu
        function toggleStartMenu() {
            const menu = document.getElementById('startMenu');
            const isVisible = menu.style.display === 'block';
            
            if (isVisible) {
                hideStartMenu();
            } else {
                showStartMenu();
            }
        }
        
        function showStartMenu() {
            const menu = document.getElementById('startMenu');
            menu.style.display = 'block';
            
            // Focar no campo de busca
            setTimeout(() => {
                const searchInput = document.getElementById('startMenuSearch');
                if (searchInput) {
                    searchInput.focus();
                }
            }, 100);
            
            // Atualizar estat√≠sticas
            updateStartMenuStats();
            
            // Notificar Gatomante ocasionalmente
            if (Math.random() < 0.3) {
                setTimeout(() => {
                    gatomanteContextual('navegacao');
                }, 2000);
            }
        }
        
        function hideStartMenu() {
            const menu = document.getElementById('startMenu');
            menu.style.display = 'none';
            
            // Limpar busca ao fechar
            const searchInput = document.getElementById('startMenuSearch');
            if (searchInput && searchInput.value) {
                searchInput.value = '';
                filterStartMenu('');
            }
        }
        
        function generateColorPalette() {
            const container = document.getElementById('colorPalette');
            container.innerHTML = '';
            
            colorThemes.forEach((theme, index) => {
                const colorOption = document.createElement('div');
                colorOption.className = `color-option ${index === currentTheme ? 'selected' : ''}`;
                colorOption.style.background = `linear-gradient(45deg, ${theme.primary}, ${theme.secondary})`;
                colorOption.title = theme.name;
                colorOption.onclick = () => selectColorTheme(index);
                
                container.appendChild(colorOption);
            });
        }
        
        function generateWallpaperPresets() {
            const container = document.getElementById('wallpaperPresets');
            container.innerHTML = '';
            
            wallpaperPresets.forEach((preset, index) => {
                const wallpaperOption = document.createElement('div');
                wallpaperOption.className = `wallpaper-preset ${index === currentWallpaper ? 'selected' : ''}`;
                wallpaperOption.style.background = preset.gradient;
                wallpaperOption.title = preset.name;
                wallpaperOption.onclick = () => selectWallpaper(index);
                
                container.appendChild(wallpaperOption);
            });
        }
        
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('pt-BR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            document.getElementById('clock').textContent = timeString;
        }
        
        // ========================================
        // üåü SISTEMA DE WALLPAPERS DIN√ÇMICOS
        // Muda conforme hora planet√°ria + part√≠culas
        // ========================================
        
        let currentPlanet = 'sol';
        let particlesInterval;
        let constellationInterval;
        
        function updatePlanetaryInfo() {
            const now = new Date();
            const dayOfWeek = now.getDay();
            const hour = now.getHours();
            
            // Calcular hora planet√°ria (simplificado)
            const dayRuler = dayRulers[dayOfWeek];
            const rulerIndex = chaldeanOrder.indexOf(dayRuler);
            const planetIndex = (rulerIndex + hour) % 7;
            const planetName = chaldeanOrder[planetIndex];
            
            // Atualizar interface
            const symbol = planetarySymbols[planetName];
            document.getElementById('planetarySymbol').textContent = symbol;
            document.getElementById('planetaryName').textContent = planetName;
            document.getElementById('currentPlanetSymbol').textContent = symbol;
            document.getElementById('currentPlanetName').textContent = planetName;
            document.getElementById('dayRuler').textContent = dayRuler;
            
            // Determinar per√≠odo (dia/noite) - simplificado
            const period = (hour >= 6 && hour < 18) ? 'dia' : 'noite';
            const hourInPeriod = period === 'dia' ? hour - 5 : (hour >= 18 ? hour - 17 : hour + 7);
            
            document.getElementById('planetaryTime').textContent = 
                `Hora ${hourInPeriod} do ${period === 'dia' ? 'Dia' : 'Noite'} ‚Ä¢ ${hour}:00 - ${(hour + 1) % 24}:00`;
            
            // üåü WALLPAPER DIN√ÇMICO - Mudar conforme planeta
            if (currentPlanet !== planetName) {
                currentPlanet = planetName;
                updateDynamicWallpaper(planetName);
                
                // Notificar Gatomante sobre mudan√ßa planet√°ria
                setTimeout(() => {
                    gatomanteContextual('planeta_mudou', { planeta: planetName });
                }, 2000);
            }
        }
        
        function updateDynamicWallpaper(planet) {
            const desktop = document.getElementById('desktop');
            
            // Remover classes planet√°rias anteriores
            desktop.classList.remove('sol', 'lua', 'marte', 'mercurio', 'jupiter', 'venus', 'saturno');
            
            // Adicionar nova classe planet√°ria
            const planetClass = planet.toLowerCase().replace('√∫', 'u'); // merc√∫rio -> mercurio
            desktop.classList.add(planetClass);
            
            // Ajustar part√≠culas conforme planeta
            updateParticlesByPlanet(planet);
            
            console.log(`üåü Wallpaper din√¢mico atualizado para: ${planet}`);
        }
        
        function updateParticlesByPlanet(planet) {
            // Limpar part√≠culas existentes
            clearInterval(particlesInterval);
            
            // Configurar part√≠culas baseadas no planeta
            const particleConfigs = {
                'Sol': { count: 15, types: ['star', 'mystic'], colors: ['#FFD700', '#FFA500'] },
                'Lua': { count: 10, types: ['mystic', 'rune'], colors: ['#C0C0C0', '#E6E6FA'] },
                'Marte': { count: 12, types: ['star', 'mystic'], colors: ['#FF4500', '#DC143C'] },
                'Merc√∫rio': { count: 20, types: ['rune', 'mystic'], colors: ['#FFFF00', '#FFD700'] },
                'J√∫piter': { count: 8, types: ['star', 'rune'], colors: ['#FFA500', '#DAA520'] },
                'V√™nus': { count: 14, types: ['star', 'mystic'], colors: ['#FFB6C1', '#FF69B4'] },
                'Saturno': { count: 6, types: ['rune'], colors: ['#808080', '#696969'] }
            };
            
            const config = particleConfigs[planet] || particleConfigs['Sol'];
            
            // Criar novas part√≠culas
            createMysticParticles(config);
            
            // Iniciar gera√ß√£o cont√≠nua
            particlesInterval = setInterval(() => {
                createMysticParticles(config);
            }, 3000);
        }
        
        function createMysticParticles(config) {
            const container = document.getElementById('desktopParticles');
            
            for (let i = 0; i < config.count; i++) {
                const particle = document.createElement('div');
                particle.className = `mystic-particle ${config.types[Math.floor(Math.random() * config.types.length)]}`;
                
                // Posi√ß√£o aleat√≥ria
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (8 + Math.random() * 4) + 's';
                
                // Cor baseada no planeta
                const color = config.colors[Math.floor(Math.random() * config.colors.length)];
                if (particle.classList.contains('rune')) {
                    particle.textContent = ['‚òΩ', '‚òâ', '‚ôÇ', '‚òø', '‚ôÉ', '‚ôÄ', '‚ôÑ'][Math.floor(Math.random() * 7)];
                    particle.style.color = color;
                } else {
                    particle.style.background = `radial-gradient(circle, ${color} 0%, transparent 70%)`;
                }
                
                container.appendChild(particle);
                
                // Remover ap√≥s anima√ß√£o
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 12000);
            }
        }
        
        function createDesktopConstellation() {
            const container = document.getElementById('desktopConstellation');
            container.innerHTML = '';
            
            // Criar constela√ß√£o simples (Ursa Maior)
            const stars = [
                { x: 20, y: 15, bright: true },
                { x: 25, y: 18, bright: false },
                { x: 30, y: 20, bright: true },
                { x: 35, y: 18, bright: false },
                { x: 40, y: 22, bright: true },
                { x: 38, y: 28, bright: false },
                { x: 32, y: 30, bright: true }
            ];
            
            // Criar estrelas
            stars.forEach((star, index) => {
                const starElement = document.createElement('div');
                starElement.className = `constellation-star ${star.bright ? 'bright' : ''}`;
                starElement.style.left = star.x + '%';
                starElement.style.top = star.y + '%';
                starElement.style.animationDelay = (index * 0.5) + 's';
                container.appendChild(starElement);
            });
            
            // Criar linhas conectoras
            for (let i = 0; i < stars.length - 1; i++) {
                const line = document.createElement('div');
                line.className = 'constellation-line';
                
                const star1 = stars[i];
                const star2 = stars[i + 1];
                
                const dx = star2.x - star1.x;
                const dy = star2.y - star1.y;
                const length = Math.sqrt(dx * dx + dy * dy);
                const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                
                line.style.left = star1.x + '%';
                line.style.top = star1.y + '%';
                line.style.width = length + '%';
                line.style.transform = `rotate(${angle}deg)`;
                line.style.animationDelay = (i * 0.3) + 's';
                
                container.appendChild(line);
            }
        }
        
        function initDynamicWallpaper() {
            // Criar constela√ß√£o inicial
            createDesktopConstellation();
            
            // Iniciar part√≠culas baseadas no planeta atual
            updateParticlesByPlanet(currentPlanet);
            
            console.log('üåü Sistema de wallpapers din√¢micos inicializado');
        }
        
        // ========================================
        // üéµ SISTEMA DE √ÅUDIO AMBIENTE M√çSTICO
        // Sons de cristais, mantras, frequ√™ncias de cura
        // ========================================
        
        let currentAmbientAudio = null;
        let ambientVolume = 0.3;
        
        function toggleAmbientControl() {
            const control = document.getElementById('ambientControl');
            if (control.style.display === 'none' || !control.style.display) {
                control.style.display = 'block';
                
                // Notificar Gatomante
                setTimeout(() => {
                    gatomanteContextual('audio_ambiente', { acao: 'aberto' });
                }, 1000);
            } else {
                control.style.display = 'none';
            }
        }
        
        function playAmbientAudio(audioId) {
            // Parar √°udio atual se existir
            if (currentAmbientAudio) {
                currentAmbientAudio.pause();
                currentAmbientAudio.currentTime = 0;
            }
            
            // Remover classe active de todos os bot√µes
            document.querySelectorAll('.ambient-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Buscar elemento de √°udio
            const audioElement = document.getElementById(audioId);
            
            if (audioElement) {
                // Se o √°udio tem src, tocar
                if (audioElement.src || audioElement.children.length > 0) {
                    audioElement.volume = ambientVolume;
                    audioElement.play().catch(e => {
                        console.log('Erro ao tocar √°udio:', e);
                        // Fallback: gerar som sint√©tico
                        generateSyntheticAmbient(audioId);
                    });
                    currentAmbientAudio = audioElement;
                } else {
                    // Gerar som sint√©tico
                    generateSyntheticAmbient(audioId);
                }
                
                // Marcar bot√£o como ativo
                const button = document.querySelector(`[data-audio="${audioId}"]`);
                if (button) {
                    button.classList.add('active');
                }
                
                // Notificar Gatomante
                setTimeout(() => {
                    gatomanteContextual('audio_ambiente', { 
                        acao: 'tocando', 
                        tipo: getAudioTypeName(audioId) 
                    });
                }, 1500);
                
                console.log(`üéµ √Åudio ambiente iniciado: ${audioId}`);
            }
        }
        
        function generateSyntheticAmbient(audioId) {
            // Gerar sons sint√©ticos baseados no tipo
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            const configs = {
                'ambientForest': {
                    frequencies: [200, 400, 800],
                    type: 'sine',
                    duration: 30,
                    description: 'Floresta m√≠stica'
                },
                'ambientOcean': {
                    frequencies: [100, 300, 600],
                    type: 'sine',
                    duration: 25,
                    description: 'Ondas do oceano'
                },
                'ambientRain': {
                    frequencies: [1000, 2000, 4000],
                    type: 'sawtooth',
                    duration: 20,
                    description: 'Chuva suave'
                },
                'freq396Hz': {
                    frequencies: [396],
                    type: 'sine',
                    duration: 60,
                    description: 'Frequ√™ncia 396Hz - Libera√ß√£o'
                },
                'freq528Hz': {
                    frequencies: [528],
                    type: 'sine',
                    duration: 60,
                    description: 'Frequ√™ncia 528Hz - Amor'
                },
                'freq741Hz': {
                    frequencies: [741],
                    type: 'sine',
                    duration: 60,
                    description: 'Frequ√™ncia 741Hz - Intui√ß√£o'
                },
                'crystalBowl': {
                    frequencies: [432, 864],
                    type: 'sine',
                    duration: 15,
                    description: 'Tigela de cristal'
                },
                'mantraOm': {
                    frequencies: [136.1, 272.2],
                    type: 'triangle',
                    duration: 45,
                    description: 'Mantra Om'
                }
            };
            
            const config = configs[audioId] || configs['ambientForest'];
            
            // Criar osciladores para cada frequ√™ncia
            config.frequencies.forEach((freq, index) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.type = config.type;
                oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                
                // Volume baixo e vari√°vel
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(ambientVolume * 0.1, audioContext.currentTime + 2);
                gainNode.gain.linearRampToValueAtTime(ambientVolume * 0.05, audioContext.currentTime + config.duration - 2);
                gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + config.duration);
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.start(audioContext.currentTime + index * 0.5);
                oscillator.stop(audioContext.currentTime + config.duration);
            });
            
            console.log(`üéµ Som sint√©tico gerado: ${config.description}`);
        }
        
        function getAudioTypeName(audioId) {
            const names = {
                'ambientForest': 'Floresta M√≠stica',
                'ambientOcean': 'Oceano Sereno',
                'ambientRain': 'Chuva Relaxante',
                'ambientCave': 'Caverna Profunda',
                'freq396Hz': 'Frequ√™ncia de Libera√ß√£o',
                'freq528Hz': 'Frequ√™ncia do Amor',
                'freq741Hz': 'Frequ√™ncia da Intui√ß√£o',
                'crystalBowl': 'Tigela de Cristal',
                'crystalChimes': 'Sinos de Cristal',
                'mantraOm': 'Mantra Om',
                'mantraGayatri': 'Mantra Gayatri'
            };
            return names[audioId] || 'Som Ambiente';
        }
        
        function updateAmbientVolume() {
            const volumeSlider = document.getElementById('ambientVolume');
            ambientVolume = volumeSlider.value / 100;
            
            if (currentAmbientAudio) {
                currentAmbientAudio.volume = ambientVolume;
            }
            
            console.log(`üéµ Volume ambiente ajustado: ${Math.round(ambientVolume * 100)}%`);
        }
        
        function stopAllAmbient() {
            if (currentAmbientAudio) {
                currentAmbientAudio.pause();
                currentAmbientAudio.currentTime = 0;
                currentAmbientAudio = null;
            }
            
            // Remover classe active de todos os bot√µes
            document.querySelectorAll('.ambient-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Notificar Gatomante
            setTimeout(() => {
                gatomanteContextual('audio_ambiente', { acao: 'parado' });
            }, 1000);
            
            console.log('üéµ Todos os √°udios ambiente foram parados');
        }
        
        function initAmbientAudio() {
            // Configurar eventos dos bot√µes
            document.querySelectorAll('.ambient-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const audioId = btn.getAttribute('data-audio');
                    playAmbientAudio(audioId);
                });
            });
            
            // Configurar slider de volume
            const volumeSlider = document.getElementById('ambientVolume');
            volumeSlider.addEventListener('input', updateAmbientVolume);
            
            console.log('üéµ Sistema de √°udio ambiente inicializado');
        }
        
        // ========================================
        // ========================================
        // üì± SISTEMA DE GESTOS TOUCH E RESPONSIVIDADE
        // ========================================
        
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;
        let isSwipeGesture = false;
        
        function initTouchGestures() {
            // Detectar se √© dispositivo touch
            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            
            if (!isTouchDevice) return;
            
            console.log('ü§ö Inicializando gestos touch...');
            
            // Gestos no desktop para mudan√ßa de workspace
            const desktop = document.getElementById('desktop');
            if (desktop) {
                desktop.addEventListener('touchstart', handleTouchStart, { passive: false });
                desktop.addEventListener('touchmove', handleTouchMove, { passive: false });
                desktop.addEventListener('touchend', handleTouchEnd, { passive: false });
            }
            
            // Gestos nas janelas para controle
            document.addEventListener('touchstart', handleWindowTouchStart, { passive: true });
            document.addEventListener('touchmove', handleWindowTouchMove, { passive: false });
            document.addEventListener('touchend', handleWindowTouchEnd, { passive: true });
            
            // Melhorar experi√™ncia de toque em bot√µes
            enhanceTouchExperience();
            
            // Adicionar suporte a orienta√ß√£o
            window.addEventListener('orientationchange', handleOrientationChange);
            
            console.log('‚úÖ Gestos touch inicializados!');
        }
        
        function handleTouchStart(e) {
            if (e.touches.length === 1) {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
                isSwipeGesture = true;
            }
        }
        
        function handleTouchMove(e) {
            if (!isSwipeGesture || e.touches.length !== 1) return;
            
            touchEndX = e.touches[0].clientX;
            touchEndY = e.touches[0].clientY;
            
            // Prevenir scroll durante swipe horizontal
            const deltaX = Math.abs(touchEndX - touchStartX);
            const deltaY = Math.abs(touchEndY - touchStartY);
            
            if (deltaX > deltaY && deltaX > 50) {
                e.preventDefault();
            }
        }
        
        function handleTouchEnd(e) {
            if (!isSwipeGesture) return;
            
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;
            const minSwipeDistance = 100;
            
            // Swipe horizontal para mudan√ßa de workspace
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
                if (deltaX > 0) {
                    // Swipe para direita - workspace anterior
                    const prevWorkspace = currentWorkspace > 1 ? currentWorkspace - 1 : 4;
                    switchWorkspace(prevWorkspace);
                    gatomanteContextual('workspaces', { acao: 'swipe_direita', workspace: prevWorkspace });
                } else {
                    // Swipe para esquerda - pr√≥ximo workspace
                    const nextWorkspace = currentWorkspace < 4 ? currentWorkspace + 1 : 1;
                    switchWorkspace(nextWorkspace);
                    gatomanteContextual('workspaces', { acao: 'swipe_esquerda', workspace: nextWorkspace });
                }
            }
            
            // Swipe vertical para a√ß√µes especiais
            if (Math.abs(deltaY) > Math.abs(deltaX) && Math.abs(deltaY) > minSwipeDistance) {
                if (deltaY < 0) {
                    // Swipe para cima - abrir menu Iniciar
                    toggleStartMenu();
                    gatomanteContextual('navegacao', { acao: 'swipe_menu' });
                } else {
                    // Swipe para baixo - mostrar Gatomante
                    showGatomante();
                    gatomanteContextual('boas_vindas', { acao: 'swipe_gatomante' });
                }
            }
            
            isSwipeGesture = false;
        }
        
        function handleWindowTouchStart(e) {
            const windowElement = e.target.closest('.window');
            if (!windowElement) return;
            
            // Marcar janela como sendo tocada
            windowElement.dataset.touching = 'true';
        }
        
        function handleWindowTouchMove(e) {
            const windowElement = e.target.closest('.window');
            if (!windowElement || !windowElement.dataset.touching) return;
            
            // Prevenir scroll do body quando movendo janela
            if (e.target.closest('.window-header')) {
                e.preventDefault();
            }
        }
        
        function handleWindowTouchEnd(e) {
            const windowElement = e.target.closest('.window');
            if (!windowElement) return;
            
            delete windowElement.dataset.touching;
        }
        
        function enhanceTouchExperience() {
            // Adicionar feedback t√°til para bot√µes importantes
            const importantButtons = document.querySelectorAll('.start-button, .window-control, .system-indicator');
            
            importantButtons.forEach(button => {
                button.addEventListener('touchstart', () => {
                    // Vibra√ß√£o sutil se suportada
                    if (navigator.vibrate) {
                        navigator.vibrate(10);
                    }
                    
                    // Feedback visual
                    button.style.transform = 'scale(0.95)';
                    button.style.opacity = '0.8';
                });
                
                button.addEventListener('touchend', () => {
                    // Restaurar estado visual
                    setTimeout(() => {
                        button.style.transform = '';
                        button.style.opacity = '';
                    }, 100);
                });
            });
        }
        
        function handleOrientationChange() {
            // Aguardar mudan√ßa de orienta√ß√£o
            setTimeout(() => {
                // Reposicionar elementos se necess√°rio
                const openWindows = document.querySelectorAll('.window:not([style*="display: none"])');
                
                openWindows.forEach(window => {
                    // Garantir que janelas permane√ßam vis√≠veis
                    const rect = window.getBoundingClientRect();
                    const viewportWidth = window.innerWidth;
                    const viewportHeight = window.innerHeight;
                    
                    if (rect.right > viewportWidth || rect.bottom > viewportHeight) {
                        // Reposicionar janela
                        if (viewportWidth <= 768) {
                            // Modo mobile - centralizar
                            window.style.left = '2.5vw';
                            window.style.top = '10vh';
                            window.style.width = '95vw';
                            window.style.height = '80vh';
                        }
                    }
                });
                
                // Fechar menus abertos em mudan√ßa de orienta√ß√£o
                const startMenu = document.getElementById('startMenu');
                if (startMenu && startMenu.classList.contains('visible')) {
                    toggleStartMenu();
                }
                
                console.log('üì± Orienta√ß√£o ajustada para:', screen.orientation?.angle || 'desconhecido');
            }, 500);
        }
        
        function isMobileDevice() {
            return window.innerWidth <= 768 || 'ontouchstart' in window || navigator.maxTouchPoints > 0;
        }
        
        function adaptToMobile() {
            if (!isMobileDevice()) return;
            
            // Ajustes espec√≠ficos para mobile
            const desktop = document.getElementById('desktop');
            if (desktop) {
                desktop.style.userSelect = 'none';
                desktop.style.webkitUserSelect = 'none';
            }
            
            // Prevenir zoom em inputs
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('focus', () => {
                    const viewport = document.querySelector('meta[name="viewport"]');
                    if (viewport) {
                        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
                    }
                });
                
                input.addEventListener('blur', () => {
                    const viewport = document.querySelector('meta[name="viewport"]');
                    if (viewport) {
                        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0');
                    }
                });
            });
            
            console.log('üì± Adapta√ß√µes mobile aplicadas!');
        }

        // ========================================
        // üñ•Ô∏è SISTEMA DE JANELAS AVAN√áADO
        // Workspaces virtuais, snap zones, thumbnails e modo foco
        // ========================================
        
        // Vari√°veis globais do sistema de janelas
        let currentWorkspace = 1;
        let workspaceWindows = {
            1: [],
            2: [],
            3: [],
            4: []
        };
        let isDraggingWindow = false;
        let draggedWindow = null;
        let snapZones = [];
        let focusMode = false;
        let windowThumbnails = new Map();
        
        // Fun√ß√£o principal para criar janelas
        function createWindow(id, title, icon, width = 600, height = 500) {
            const windowId = `window-${id}`;
            
            // Verificar se janela j√° est√° aberta
            if (document.getElementById(windowId)) {
                focusWindow(windowId);
                return document.getElementById(windowId);
            }
            
            const window = document.createElement('div');
            window.id = windowId;
            window.className = 'window active focused';
            window.setAttribute('data-workspace', currentWorkspace);
            
            // Posicionamento inteligente
            const position = calculateWindowPosition();
            window.style.left = position.x + 'px';
            window.style.top = position.y + 'px';
            window.style.width = width + 'px';
            window.style.height = height + 'px';
            
            // Estrutura b√°sica da janela
            window.innerHTML = `
                <div class="window-header" onmousedown="startWindowDrag(event, '${windowId}')">
                    <div class="window-title">
                        <span class="window-icon">${icon}</span>
                        <span class="window-title-text">${title}</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize" onclick="minimizeWindow('${windowId}')" title="Minimizar">_</div>
                        <div class="window-control maximize" onclick="toggleMaximizeWindow('${windowId}')" title="Maximizar">‚ñ°</div>
                        <div class="window-control close" onclick="closeWindow('${windowId}')" title="Fechar">√ó</div>
                    </div>
                </div>
                <div class="window-content">
                    <!-- Conte√∫do ser√° adicionado aqui -->
                </div>
                <div class="window-resize-handles">
                    <div class="resize-handle resize-n" onmousedown="startResize(event, '${windowId}', 'n')"></div>
                    <div class="resize-handle resize-s" onmousedown="startResize(event, '${windowId}', 's')"></div>
                    <div class="resize-handle resize-e" onmousedown="startResize(event, '${windowId}', 'e')"></div>
                    <div class="resize-handle resize-w" onmousedown="startResize(event, '${windowId}', 'w')"></div>
                    <div class="resize-handle resize-ne" onmousedown="startResize(event, '${windowId}', 'ne')"></div>
                    <div class="resize-handle resize-nw" onmousedown="startResize(event, '${windowId}', 'nw')"></div>
                    <div class="resize-handle resize-se" onmousedown="startResize(event, '${windowId}', 'se')"></div>
                    <div class="resize-handle resize-sw" onmousedown="startResize(event, '${windowId}', 'sw')"></div>
                </div>
            `;
            
            // Adicionar ao DOM
            document.getElementById('desktop').appendChild(window);
            
            // Registrar janela
            const windowData = {
                id: windowId,
                title: title,
                icon: icon,
                workspace: currentWorkspace,
                isMinimized: false,
                isMaximized: false,
                originalPosition: { x: position.x, y: position.y, width: width, height: height }
            };
            
            openWindows.push(windowData);
            workspaceWindows[currentWorkspace].push(windowData);
            
            // Criar thumbnail
            createWindowThumbnail(windowData);
            
            // Aplicar anima√ß√£o de entrada
            window.classList.add('materializing');
            setTimeout(() => {
                window.classList.remove('materializing');
            }, 600);
            
            // Atualizar barra de tarefas
            updateTaskbar();
            
            // Aplicar modo foco se ativo
            if (focusMode) {
                applyFocusMode(windowId);
            }
            
            // Notificar Gatomante
            setTimeout(() => {
                showGatomante(`Nova janela "${title}" aberta no workspace ${currentWorkspace}!`, 'excited');
            }, 800);
            
            return window;
        }
        
        // Calcular posi√ß√£o inteligente para nova janela
        function calculateWindowPosition() {
            const desktop = document.getElementById('desktop');
            const desktopRect = desktop.getBoundingClientRect();
            
            // Posi√ß√£o em cascata
            const offset = openWindows.length * 30;
            const maxOffset = 200;
            
            return {
                x: Math.min(100 + offset, desktopRect.width - 600),
                y: Math.min(50 + offset, desktopRect.height - 500)
            };
        }
        
        // ========================================
        // üè¢ WORKSPACES VIRTUAIS
        // ========================================
        
        function toggleWorkspaceSwitcher() {
            const switcher = document.getElementById('workspaceSwitcher');
            const indicator = document.getElementById('workspaceIndicator');
            
            if (switcher && switcher.classList.contains('visible')) {
                switcher.classList.remove('visible');
                indicator.classList.remove('active');
            } else if (switcher) {
                switcher.classList.add('visible');
                indicator.classList.add('active');
                updateWorkspacePreview();
            }
        }
        
        function switchToWorkspace(workspaceNumber) {
            if (workspaceNumber === currentWorkspace) return;
            
            // Ocultar janelas do workspace atual
            workspaceWindows[currentWorkspace].forEach(windowData => {
                const window = document.getElementById(windowData.id);
                if (window) {
                    window.style.display = 'none';
                    window.classList.add('workspace-transition');
                }
            });
            
            // Mostrar janelas do novo workspace
            setTimeout(() => {
                workspaceWindows[workspaceNumber].forEach(windowData => {
                    const window = document.getElementById(windowData.id);
                    if (window) {
                        window.style.display = 'block';
                        window.classList.remove('workspace-transition');
                        window.classList.add('workspace-enter');
                        
                        setTimeout(() => {
                            window.classList.remove('workspace-enter');
                        }, 300);
                    }
                });
                
                currentWorkspace = workspaceNumber;
                updateWorkspaceIndicator();
                updateTaskbar();
                
                // Fechar switcher
                toggleWorkspaceSwitcher();
                
                // Notificar mudan√ßa
                showGatomante(`Workspace ${workspaceNumber} ativado!`, 'normal');
            }, 200);
        }
        
        function updateWorkspaceIndicator() {
            const indicator = document.getElementById('workspaceIndicator');
            if (indicator) {
                indicator.textContent = `${currentWorkspace}/4`;
                indicator.setAttribute('data-workspace', currentWorkspace);
            }
        }
        
        function updateWorkspacePreview() {
            const switcher = document.getElementById('workspaceSwitcher');
            if (!switcher) return;
            
            switcher.innerHTML = '';
            
            for (let i = 1; i <= 4; i++) {
                const workspacePreview = document.createElement('div');
                workspacePreview.className = `workspace-preview ${i === currentWorkspace ? 'active' : ''}`;
                workspacePreview.onclick = () => switchToWorkspace(i);
                
                const windowCount = workspaceWindows[i].length;
                const activeWindows = workspaceWindows[i].filter(w => !w.isMinimized).length;
                
                workspacePreview.innerHTML = `
                    <div class="workspace-number">${i}</div>
                    <div class="workspace-info">
                        <div class="workspace-windows">${activeWindows}/${windowCount} janelas</div>
                        <div class="workspace-preview-windows">
                            ${workspaceWindows[i].slice(0, 4).map(w => 
                                `<div class="mini-window ${w.isMinimized ? 'minimized' : ''}" title="${w.title}">
                                    ${w.icon}
                                </div>`
                            ).join('')}
                        </div>
                    </div>
                `;
                
                switcher.appendChild(workspacePreview);
            }
        }
        
        // ========================================
        // üìê SNAP ZONES
        // ========================================
        
        function initializeSnapZones() {
            const desktop = document.getElementById('desktop');
            const desktopRect = desktop.getBoundingClientRect();
            
            snapZones = [
                // Metade esquerda
                {
                    id: 'left-half',
                    x: 0,
                    y: 0,
                    width: desktopRect.width / 2,
                    height: desktopRect.height,
                    action: 'snap-left'
                },
                // Metade direita
                {
                    id: 'right-half',
                    x: desktopRect.width / 2,
                    y: 0,
                    width: desktopRect.width / 2,
                    height: desktopRect.height,
                    action: 'snap-right'
                },
                // Maximizar
                {
                    id: 'maximize',
                    x: desktopRect.width * 0.25,
                    y: 0,
                    width: desktopRect.width * 0.5,
                    height: 50,
                    action: 'maximize'
                },
                // Quadrantes
                {
                    id: 'top-left',
                    x: 0,
                    y: 0,
                    width: desktopRect.width / 2,
                    height: desktopRect.height / 2,
                    action: 'snap-top-left'
                },
                {
                    id: 'top-right',
                    x: desktopRect.width / 2,
                    y: 0,
                    width: desktopRect.width / 2,
                    height: desktopRect.height / 2,
                    action: 'snap-top-right'
                },
                {
                    id: 'bottom-left',
                    x: 0,
                    y: desktopRect.height / 2,
                    width: desktopRect.width / 2,
                    height: desktopRect.height / 2,
                    action: 'snap-bottom-left'
                },
                {
                    id: 'bottom-right',
                    x: desktopRect.width / 2,
                    y: desktopRect.height / 2,
                    width: desktopRect.width / 2,
                    height: desktopRect.height / 2,
                    action: 'snap-bottom-right'
                }
            ];
        }
        
        function showSnapZones() {
            hideSnapZones(); // Limpar zones existentes
            
            snapZones.forEach(zone => {
                const zoneElement = document.createElement('div');
                zoneElement.className = 'snap-zone';
                zoneElement.id = `snap-zone-${zone.id}`;
                zoneElement.style.cssText = `
                    position: fixed;
                    left: ${zone.x}px;
                    top: ${zone.y}px;
                    width: ${zone.width}px;
                    height: ${zone.height}px;
                    background: rgba(218, 165, 32, 0.2);
                    border: 2px dashed var(--dourado);
                    z-index: 9998;
                    pointer-events: none;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                `;
                
                document.body.appendChild(zoneElement);
                
                // Mostrar com anima√ß√£o
                setTimeout(() => {
                    zoneElement.style.opacity = '1';
                }, 10);
            });
        }
        
        function hideSnapZones() {
            document.querySelectorAll('.snap-zone').forEach(zone => {
                zone.style.opacity = '0';
                setTimeout(() => {
                    if (zone.parentNode) {
                        zone.remove();
                    }
                }, 300);
            });
        }
        
        function checkSnapZone(x, y) {
            return snapZones.find(zone => 
                x >= zone.x && x <= zone.x + zone.width &&
                y >= zone.y && y <= zone.y + zone.height
            );
        }
        
        function applySnapAction(windowId, action) {
            const window = document.getElementById(windowId);
            if (!window) return;
            
            const desktop = document.getElementById('desktop');
            const desktopRect = desktop.getBoundingClientRect();
            
            // Salvar posi√ß√£o original se n√£o estiver snapped
            if (!window.classList.contains('snapped')) {
                const windowData = openWindows.find(w => w.id === windowId);
                if (windowData) {
                    windowData.originalPosition = {
                        x: parseInt(window.style.left),
                        y: parseInt(window.style.top),
                        width: parseInt(window.style.width),
                        height: parseInt(window.style.height)
                    };
                }
            }
            
            window.classList.add('snapped', 'snapping');
            
            switch (action) {
                case 'snap-left':
                    window.style.left = '0px';
                    window.style.top = '0px';
                    window.style.width = (desktopRect.width / 2) + 'px';
                    window.style.height = desktopRect.height + 'px';
                    break;
                    
                case 'snap-right':
                    window.style.left = (desktopRect.width / 2) + 'px';
                    window.style.top = '0px';
                    window.style.width = (desktopRect.width / 2) + 'px';
                    window.style.height = desktopRect.height + 'px';
                    break;
                    
                case 'maximize':
                    window.style.left = '0px';
                    window.style.top = '0px';
                    window.style.width = desktopRect.width + 'px';
                    window.style.height = desktopRect.height + 'px';
                    break;
                    
                case 'snap-top-left':
                    window.style.left = '0px';
                    window.style.top = '0px';
                    window.style.width = (desktopRect.width / 2) + 'px';
                    window.style.height = (desktopRect.height / 2) + 'px';
                    break;
                    
                case 'snap-top-right':
                    window.style.left = (desktopRect.width / 2) + 'px';
                    window.style.top = '0px';
                    window.style.width = (desktopRect.width / 2) + 'px';
                    window.style.height = (desktopRect.height / 2) + 'px';
                    break;
                    
                case 'snap-bottom-left':
                    window.style.left = '0px';
                    window.style.top = (desktopRect.height / 2) + 'px';
                    window.style.width = (desktopRect.width / 2) + 'px';
                    window.style.height = (desktopRect.height / 2) + 'px';
                    break;
                    
                case 'snap-bottom-right':
                    window.style.left = (desktopRect.width / 2) + 'px';
                    window.style.top = (desktopRect.height / 2) + 'px';
                    window.style.width = (desktopRect.width / 2) + 'px';
                    window.style.height = (desktopRect.height / 2) + 'px';
                    break;
            }
            
            setTimeout(() => {
                window.classList.remove('snapping');
            }, 300);
        }
        
        // ========================================
        // üñºÔ∏è THUMBNAILS NA BARRA DE TAREFAS
        // ========================================
        
        function createWindowThumbnail(windowData) {
            const thumbnail = document.createElement('canvas');
            thumbnail.width = 200;
            thumbnail.height = 150;
            thumbnail.className = 'window-thumbnail';
            
            const ctx = thumbnail.getContext('2d');
            
            // Desenhar thumbnail b√°sico
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, 200, 150);
            
            // Header
            ctx.fillStyle = '#2a2a2a';
            ctx.fillRect(0, 0, 200, 30);
            
            // √çcone e t√≠tulo
            ctx.fillStyle = '#fff';
            ctx.font = '12px Arial';
            ctx.fillText(windowData.icon + ' ' + windowData.title, 10, 20);
            
            // Conte√∫do simulado
            ctx.fillStyle = '#333';
            ctx.fillRect(10, 40, 180, 100);
            
            windowThumbnails.set(windowData.id, thumbnail);
            
            return thumbnail;
        }
        
        function updateWindowThumbnail(windowId) {
            const window = document.getElementById(windowId);
            const thumbnail = windowThumbnails.get(windowId);
            
            if (!window || !thumbnail) return;
            
            // Capturar screenshot da janela (simulado)
            const ctx = thumbnail.getContext('2d');
            
            // Limpar
            ctx.clearRect(0, 0, 200, 150);
            
            // Redesenhar com estado atual
            const windowData = openWindows.find(w => w.id === windowId);
            if (windowData) {
                // Background
                ctx.fillStyle = windowData.isMinimized ? '#0a0a0a' : '#1a1a1a';
                ctx.fillRect(0, 0, 200, 150);
                
                // Header
                ctx.fillStyle = '#2a2a2a';
                ctx.fillRect(0, 0, 200, 30);
                
                // T√≠tulo
                ctx.fillStyle = windowData.isMinimized ? '#666' : '#fff';
                ctx.font = '12px Arial';
                ctx.fillText(windowData.icon + ' ' + windowData.title, 10, 20);
                
                // Indicador de estado
                if (windowData.isMinimized) {
                    ctx.fillStyle = '#666';
                    ctx.fillText('Minimizada', 10, 80);
                }
            }
        }
        
        function showWindowThumbnail(windowId, x, y) {
            const thumbnail = windowThumbnails.get(windowId);
            if (!thumbnail) return;
            
            // Criar container do tooltip
            const tooltipContainer = document.createElement('div');
            tooltipContainer.className = 'window-thumbnail-tooltip';
            tooltipContainer.style.cssText = `
                position: fixed;
                left: ${x - 100}px;
                top: ${y - 160}px;
                background: rgba(0, 0, 0, 0.9);
                border: 1px solid var(--dourado);
                border-radius: 8px;
                padding: 10px;
                z-index: 10000;
                backdrop-filter: blur(10px);
                animation: fadeIn 0.3s ease;
            `;
            
            tooltipContainer.appendChild(thumbnail.cloneNode(true));
            document.body.appendChild(tooltipContainer);
            
            // Auto-remover ap√≥s 3 segundos
            setTimeout(() => {
                if (tooltipContainer.parentNode) {
                    tooltipContainer.remove();
                }
            }, 3000);
        }
        
        // ========================================
        // üéØ MODO FOCO
        // ========================================
        
        function toggleFocusMode() {
            focusMode = !focusMode;
            
            const focusButton = document.getElementById('focusModeButton');
            if (focusButton) {
                focusButton.classList.toggle('active', focusMode);
                focusButton.title = focusMode ? 'Desativar Modo Foco' : 'Ativar Modo Foco';
            }
            
            if (focusMode) {
                // Encontrar janela ativa
                const activeWindow = document.querySelector('.window.focused');
                if (activeWindow) {
                    applyFocusMode(activeWindow.id);
                }
                showGatomante('Modo foco ativado! Outras janelas ficar√£o desfocadas.', 'thinking');
            } else {
                removeFocusMode();
                showGatomante('Modo foco desativado!', 'normal');
            }
        }
        
        function applyFocusMode(focusedWindowId) {
            if (!focusMode) return;
            
            document.querySelectorAll('.window').forEach(window => {
                if (window.id === focusedWindowId) {
                    window.classList.remove('focus-blurred');
                    window.classList.add('focus-active');
                } else {
                    window.classList.remove('focus-active');
                    window.classList.add('focus-blurred');
                }
            });
        }
        
        function removeFocusMode() {
            document.querySelectorAll('.window').forEach(window => {
                window.classList.remove('focus-active', 'focus-blurred');
            });
        }
        
        // ========================================
        // üñ±Ô∏è SISTEMA DE ARRASTAR JANELAS
        // ========================================
        
        function startWindowDrag(event, windowId) {
            if (event.target.closest('.window-control')) return;
            
            event.preventDefault();
            isDraggingWindow = true;
            draggedWindow = windowId;
            
            const window = document.getElementById(windowId);
            if (!window) return;
            
            // Focar janela
            focusWindow(windowId);
            
            // Inicializar snap zones
            initializeSnapZones();
            
            const startX = event.clientX;
            const startY = event.clientY;
            const startLeft = parseInt(window.style.left) || 0;
            const startTop = parseInt(window.style.top) || 0;
            
            function onMouseMove(e) {
                if (!isDraggingWindow) return;
                
                const deltaX = e.clientX - startX;
                const deltaY = e.clientY - startY;
                
                window.style.left = (startLeft + deltaX) + 'px';
                window.style.top = (startTop + deltaY) + 'px';
                
                // Verificar snap zones
                const snapZone = checkSnapZone(e.clientX, e.clientY);
                if (snapZone && !document.querySelector('.snap-zone.highlight')) {
                    showSnapZones();
                    const zoneElement = document.getElementById(`snap-zone-${snapZone.id}`);
                    if (zoneElement) {
                        zoneElement.classList.add('highlight');
                        zoneElement.style.background = 'rgba(218, 165, 32, 0.4)';
                    }
                } else if (!snapZone) {
                    document.querySelectorAll('.snap-zone').forEach(zone => {
                        zone.classList.remove('highlight');
                        zone.style.background = 'rgba(218, 165, 32, 0.2)';
                    });
                }
            }
            
            function onMouseUp(e) {
                if (!isDraggingWindow) return;
                
                isDraggingWindow = false;
                draggedWindow = null;
                
                // Verificar snap
                const snapZone = checkSnapZone(e.clientX, e.clientY);
                if (snapZone) {
                    applySnapAction(windowId, snapZone.action);
                }
                
                hideSnapZones();
                
                document.removeEventListener('mousemove', onMouseMove);
                document.removeEventListener('mouseup', onMouseUp);
            }
            
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
        }
        
        // ========================================
        // üìè SISTEMA DE REDIMENSIONAR JANELAS
        // ========================================
        
        function startResize(event, windowId, direction) {
            event.preventDefault();
            event.stopPropagation();
            
            const window = document.getElementById(windowId);
            if (!window) return;
            
            const startX = event.clientX;
            const startY = event.clientY;
            const startWidth = parseInt(window.style.width);
            const startHeight = parseInt(window.style.height);
            const startLeft = parseInt(window.style.left);
            const startTop = parseInt(window.style.top);
            
            function onMouseMove(e) {
                const deltaX = e.clientX - startX;
                const deltaY = e.clientY - startY;
                
                let newWidth = startWidth;
                let newHeight = startHeight;
                let newLeft = startLeft;
                let newTop = startTop;
                
                switch (direction) {
                    case 'n':
                        newHeight = startHeight - deltaY;
                        newTop = startTop + deltaY;
                        break;
                    case 's':
                        newHeight = startHeight + deltaY;
                        break;
                    case 'e':
                        newWidth = startWidth + deltaX;
                        break;
                    case 'w':
                        newWidth = startWidth - deltaX;
                        newLeft = startLeft + deltaX;
                        break;
                    case 'ne':
                        newWidth = startWidth + deltaX;
                        newHeight = startHeight - deltaY;
                        newTop = startTop + deltaY;
                        break;
                    case 'nw':
                        newWidth = startWidth - deltaX;
                        newHeight = startHeight - deltaY;
                        newLeft = startLeft + deltaX;
                        newTop = startTop + deltaY;
                        break;
                    case 'se':
                        newWidth = startWidth + deltaX;
                        newHeight = startHeight + deltaY;
                        break;
                    case 'sw':
                        newWidth = startWidth - deltaX;
                        newHeight = startHeight + deltaY;
                        newLeft = startLeft + deltaX;
                        break;
                }
                
                // Aplicar limites m√≠nimos
                newWidth = Math.max(300, newWidth);
                newHeight = Math.max(200, newHeight);
                
                window.style.width = newWidth + 'px';
                window.style.height = newHeight + 'px';
                window.style.left = newLeft + 'px';
                window.style.top = newTop + 'px';
            }
            
            function onMouseUp() {
                document.removeEventListener('mousemove', onMouseMove);
                document.removeEventListener('mouseup', onMouseUp);
            }
            
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
        }
        
        // ========================================
        // üîÑ FUN√á√ïES DE CONTROLE DE JANELAS
        // ========================================
        
        function toggleMaximizeWindow(windowId) {
            const window = document.getElementById(windowId);
            const windowData = openWindows.find(w => w.id === windowId);
            
            if (!window || !windowData) return;
            
            if (windowData.isMaximized) {
                // Restaurar
                window.style.left = windowData.originalPosition.x + 'px';
                window.style.top = windowData.originalPosition.y + 'px';
                window.style.width = windowData.originalPosition.width + 'px';
                window.style.height = windowData.originalPosition.height + 'px';
                window.classList.remove('maximized');
                windowData.isMaximized = false;
            } else {
                // Maximizar
                const desktop = document.getElementById('desktop');
                const desktopRect = desktop.getBoundingClientRect();
                
                // Salvar posi√ß√£o atual
                windowData.originalPosition = {
                    x: parseInt(window.style.left),
                    y: parseInt(window.style.top),
                    width: parseInt(window.style.width),
                    height: parseInt(window.style.height)
                };
                
                window.style.left = '0px';
                window.style.top = '0px';
                window.style.width = desktopRect.width + 'px';
                window.style.height = desktopRect.height + 'px';
                window.classList.add('maximized');
                windowData.isMaximized = true;
            }
            
            updateTaskbar();
        }
        
        function minimizeWindow(windowId) {
            const window = document.getElementById(windowId);
            const windowData = openWindows.find(w => w.id === windowId);
            
            if (!window || !windowData) return;
            
            // Criar orbe de minimiza√ß√£o
            createMinimizeOrb(window);
            
            // Animar minimiza√ß√£o
            window.classList.add('minimizing');
            windowData.isMinimized = true;
            
            setTimeout(() => {
                window.style.display = 'none';
                window.classList.remove('minimizing');
                updateTaskbar();
                updateWindowThumbnail(windowId);
            }, 600);
        }
        
        function restoreWindow(windowId) {
            const window = document.getElementById(windowId);
            const windowData = openWindows.find(w => w.id === windowId);
            
            if (!window || !windowData) return;
            
            window.style.display = 'block';
            window.classList.add('restoring');
            windowData.isMinimized = false;
            
            setTimeout(() => {
                window.classList.remove('restoring');
                focusWindow(windowId);
                updateTaskbar();
                updateWindowThumbnail(windowId);
            }, 300);
        }
        
        function focusWindow(windowId) {
            // Remover foco de todas as janelas
            document.querySelectorAll('.window').forEach(w => {
                w.classList.remove('focused');
            });
            
            // Focar janela espec√≠fica
            const window = document.getElementById(windowId);
            if (window) {
                window.classList.add('focused');
                
                // Trazer para frente
                const maxZIndex = Math.max(...Array.from(document.querySelectorAll('.window')).map(w => 
                    parseInt(getComputedStyle(w).zIndex) || 0
                ));
                window.style.zIndex = maxZIndex + 1;
                
                // Aplicar modo foco se ativo
                if (focusMode) {
                    applyFocusMode(windowId);
                }
            }
        }
        
        function closeWindow(windowId) {
            const window = document.getElementById(windowId);
            if (!window) return;
            
            // Anima√ß√£o de dissolu√ß√£o
            window.classList.add('dissolving');
            createWindowParticles(window);
            
            setTimeout(() => {
                if (window.parentNode) {
                    window.remove();
                }
                
                // Remover dos registros
                openWindows = openWindows.filter(w => w.id !== windowId);
                
                // Remover de todos os workspaces
                Object.keys(workspaceWindows).forEach(workspace => {
                    workspaceWindows[workspace] = workspaceWindows[workspace].filter(w => w.id !== windowId);
                });
                
                // Remover thumbnail
                windowThumbnails.delete(windowId);
                
                updateTaskbar();
                
                showGatomante('Janela fechada com dissolu√ß√£o m√°gica!', 'normal');
            }, 600);
        }
        
        // Inicializar sistema de janelas
        function initializeWindowSystem() {
            // Inicializar snap zones
            initializeSnapZones();
            
            // Atualizar indicador de workspace
            updateWorkspaceIndicator();
            
            // Event listeners para redimensionamento da tela
            window.addEventListener('resize', () => {
                initializeSnapZones();
            });
            
            console.log('üñ•Ô∏è Sistema de janelas avan√ßado inicializado!');
        }
        
        function toggleWorkspaceSwitcher() {
            const switcher = document.getElementById('workspaceSwitcher');
            const indicator = document.getElementById('workspaceIndicator');
            
            if (switcher && switcher.classList.contains('visible')) {
                switcher.classList.remove('visible');
                indicator.classList.remove('visible');
                
                // Ocultar ap√≥s 3 segundos se n√£o houver intera√ß√£o
                setTimeout(() => {
                    if (!switcher.matches(':hover')) {
                        switcher.classList.remove('visible');
                        indicator.classList.remove('visible');
                    }
                }, 3000);
            } else {
                switcher.classList.add('visible');
                indicator.classList.add('visible');
                updateWorkspaceCounts();
                
                // Notificar Gatomante
                setTimeout(() => {
                    gatomanteContextual('workspaces', { acao: 'aberto', workspace: currentWorkspace });
                }, 1000);
            }
        }
        
        function switchWorkspace(workspaceId) {
            if (workspaceId === currentWorkspace) return;
            
            // Ocultar janelas do workspace atual
            workspaceWindows[currentWorkspace].forEach(windowId => {
                const windowElement = document.getElementById(windowId);
                if (windowElement) {
                    windowElement.style.display = 'none';
                }
            });
            
            // Mostrar janelas do novo workspace
            workspaceWindows[workspaceId].forEach(windowId => {
                const windowElement = document.getElementById(windowId);
                if (windowElement) {
                    windowElement.style.display = 'block';
                }
            });
            
            // Atualizar workspace atual
            const oldWorkspace = currentWorkspace;
            currentWorkspace = workspaceId;
            
            // Atualizar interface
            document.querySelectorAll('.workspace-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-workspace="${workspaceId}"]`).classList.add('active');
            
            // Atualizar indicador
            const indicator = document.getElementById('workspaceIndicator');
            indicator.textContent = `Workspace ${workspaceId}`;
            
            // Efeito visual de transi√ß√£o
            const desktop = document.getElementById('desktop');
            desktop.style.opacity = '0.7';
            setTimeout(() => {
                desktop.style.opacity = '1';
            }, 200);
            
            // Notificar Gatomante
            setTimeout(() => {
                gatomanteContextual('workspaces', { 
                    acao: 'mudou', 
                    de: oldWorkspace, 
                    para: workspaceId,
                    janelas: workspaceWindows[workspaceId].length
                });
            }, 1500);
            
            console.log(`üñ•Ô∏è Mudou para Workspace ${workspaceId}`);
        }
        
        function addWindowToWorkspace(windowId, workspaceId = currentWorkspace) {
            if (!workspaceWindows[workspaceId].includes(windowId)) {
                workspaceWindows[workspaceId].push(windowId);
                updateWorkspaceCounts();
                
                // Se n√£o √© o workspace atual, ocultar janela
                if (workspaceId !== currentWorkspace) {
                    const windowElement = document.getElementById(windowId);
                    if (windowElement) {
                        windowElement.style.display = 'none';
                    }
                }
            }
        }
        
        function removeWindowFromWorkspace(windowId) {
            Object.keys(workspaceWindows).forEach(workspaceId => {
                const index = workspaceWindows[workspaceId].indexOf(windowId);
                if (index > -1) {
                    workspaceWindows[workspaceId].splice(index, 1);
                }
            });
            updateWorkspaceCounts();
        }
        
        function updateWorkspaceCounts() {
            Object.keys(workspaceWindows).forEach(workspaceId => {
                const countElement = document.getElementById(`workspace${workspaceId}Count`);
                const count = workspaceWindows[workspaceId].length;
                if (countElement) {
                    countElement.textContent = count;
                    countElement.style.display = count > 0 ? 'flex' : 'none';
                }
            });
        }
        
        function initSnapZones() {
            const snapZones = document.getElementById('snapZones');
            let currentHighlight = null;
            
            // Mostrar snap zones quando arrastar janela
            document.addEventListener('mousedown', (e) => {
                if (e.target.closest('.window-header')) {
                    isDraggingWindow = true;
                    draggedWindow = e.target.closest('.window');
                    
                    setTimeout(() => {
                        if (isDraggingWindow) {
                            snapZones.classList.add('active');
                        }
                    }, 200);
                }
            });
            
            document.addEventListener('mousemove', (e) => {
                if (isDraggingWindow && snapZones.classList.contains('active')) {
                    // Detectar zona de snap
                    const zones = document.querySelectorAll('.snap-zone');
                    let foundZone = null;
                    
                    zones.forEach(zone => {
                        const rect = zone.getBoundingClientRect();
                        if (e.clientX >= rect.left && e.clientX <= rect.right &&
                            e.clientY >= rect.top && e.clientY <= rect.bottom) {
                            foundZone = zone;
                        }
                    });
                    
                    // Atualizar highlight
                    if (currentHighlight) {
                        currentHighlight.classList.remove('highlight');
                    }
                    
                    if (foundZone) {
                        foundZone.classList.add('highlight');
                        currentHighlight = foundZone;
                    } else {
                        currentHighlight = null;
                    }
                }
            });
            
            document.addEventListener('mouseup', (e) => {
                if (isDraggingWindow) {
                    // Aplicar snap se houver zona destacada
                    if (currentHighlight && draggedWindow) {
                        const snapType = currentHighlight.getAttribute('data-snap');
                        applyWindowSnap(draggedWindow, snapType);
                        
                        // Notificar Gatomante
                        setTimeout(() => {
                            gatomanteContextual('workspaces', { 
                                acao: 'snap', 
                                tipo: snapType,
                                workspace: currentWorkspace
                            });
                        }, 1000);
                    }
                    
                    // Limpar estado
                    snapZones.classList.remove('active');
                    if (currentHighlight) {
                        currentHighlight.classList.remove('highlight');
                        currentHighlight = null;
                    }
                    isDraggingWindow = false;
                    draggedWindow = null;
                }
            });
        }
        
        function applyWindowSnap(windowElement, snapType) {
            if (!windowElement) return;
            
            const desktop = document.getElementById('desktop');
            const desktopRect = desktop.getBoundingClientRect();
            
            switch (snapType) {
                case 'left':
                    windowElement.style.left = '10px';
                    windowElement.style.top = '10px';
                    windowElement.style.width = `${Math.floor(desktopRect.width / 2) - 15}px`;
                    windowElement.style.height = `${desktopRect.height - 70}px`;
                    break;
                    
                case 'right':
                    windowElement.style.left = `${Math.floor(desktopRect.width / 2) + 5}px`;
                    windowElement.style.top = '10px';
                    windowElement.style.width = `${Math.floor(desktopRect.width / 2) - 15}px`;
                    windowElement.style.height = `${desktopRect.height - 70}px`;
                    break;
                    
                case 'top':
                    windowElement.style.left = '10px';
                    windowElement.style.top = '10px';
                    windowElement.style.width = `${desktopRect.width - 20}px`;
                    windowElement.style.height = `${Math.floor(desktopRect.height / 2) - 35}px`;
                    break;
                    
                case 'bottom':
                    windowElement.style.left = '10px';
                    windowElement.style.top = `${Math.floor(desktopRect.height / 2) + 5}px`;
                    windowElement.style.width = `${desktopRect.width - 20}px`;
                    windowElement.style.height = `${Math.floor(desktopRect.height / 2) - 35}px`;
                    break;
                    
                case 'center':
                    windowElement.style.left = '20%';
                    windowElement.style.top = '20%';
                    windowElement.style.width = '60%';
                    windowElement.style.height = '60%';
                    break;
            }
            
            console.log(`üìê Janela ajustada para: ${snapType}`);
        }
        
        function initWorkspaces() {
            // Configurar eventos de teclado para workspaces
            document.addEventListener('keydown', (e) => {
                // Ctrl + 1-4 para mudar workspace
                if (e.ctrlKey && e.key >= '1' && e.key <= '4') {
                    e.preventDefault();
                    const workspaceId = parseInt(e.key);
                    switchWorkspace(workspaceId);
                }
                
                // Ctrl + Shift + 1-4 para mover janela para workspace
                if (e.ctrlKey && e.shiftKey && e.key >= '1' && e.key <= '4') {
                    e.preventDefault();
                    const workspaceId = parseInt(e.key);
                    const focusedWindow = document.querySelector('.window.focused');
                    if (focusedWindow) {
                        moveWindowToWorkspace(focusedWindow.id, workspaceId);
                    }
                }
            });
            
            // Inicializar snap zones
            initSnapZones();
            
            console.log('üñ•Ô∏è Sistema de workspaces inicializado');
        }
        
        // ========================================
        // ü§ñ GATOMANTE IA AVAN√áADA - CHAT E VOZ
        // Sistema de chat integrado e comandos de voz
        // ========================================
        
        let gatomanteVoiceRecognition = null;
        let isVoiceListening = false;
        let chatHistory = [];
        
        // Base de conhecimento expandida do Gatomante IA
        const gatomanteKnowledge = {
            greetings: [
                "Ol√°! Sou o Gatomante, seu assistente m√≠stico pessoal. Como posso ajudar?",
                "Miau! üê±‚Äç‚¨õ Bem-vindo ao chat! Estou aqui para gui√°-lo pelos mist√©rios do Aurora OS.",
                "Sauda√ß√µes, mortal! Que os ventos c√≥smicos o trouxeram at√© mim hoje?",
                "Ah, voc√™ descobriu meu chat secreto! Prepare-se para sabedoria felina e m√≠stica."
            ],
            commands: {
                'abrir': (app) => `Abrindo ${app}... Como um verdadeiro mago digital!`,
                'fechar': (app) => `Fechando ${app}... Puf! Desapareceu como m√°gica!`,
                'ajuda': () => "Posso ajudar com: navega√ß√£o, personaliza√ß√£o, AF√ÅST, workspaces, √°udio ambiente e muito mais!",
                'hora': () => `S√£o ${new Date().toLocaleTimeString('pt-BR')} - Hora perfeita para magia digital!`,
                'planeta': () => {
                    const info = getPlanetaryInfo();
                    return `Estamos na hora de ${info.planet} ${info.symbol} - ${info.description}`;
                },
                'workspace': (num) => {
                    if (num >= 1 && num <= 4) {
                        switchWorkspace(parseInt(num));
                        return `Mudando para workspace ${num}... Organiza√ß√£o felina em a√ß√£o!`;
                    }
                    return "Use 'workspace 1', 'workspace 2', etc. para mudar de workspace.";
                },
                'tema': (cor) => {
                    if (cor) {
                        return `Mudando tema para ${cor}... Que tal experimentar a personaliza√ß√£o visual?`;
                    }
                    return "Abra a personaliza√ß√£o para escolher temas m√≠sticos incr√≠veis!";
                },
                'volume': (nivel) => {
                    if (nivel) {
                        return `Ajustando volume para ${nivel}%... Som perfeito para suas atividades!`;
                    }
                    return "Use 'volume 50' para ajustar o volume, ou clique no √≠cone de som na taskbar.";
                },
                'af√°st': () => "O AF√ÅST monitora eventos astrol√≥gicos! Clique no escudo dourado üõ°Ô∏è para ver alertas.",
                '√°udio': () => "Experimente o √°udio ambiente! Clique em üéµ para sons m√≠sticos e frequ√™ncias de cura.",
                'snap': () => "Arraste janelas para as bordas para usar snap zones! Organiza√ß√£o autom√°tica √© m√°gica!"
            },
            responses: {
                unknown: [
                    "Hmm, n√£o entendi completamente... Pode reformular? Sou inteligente, mas ainda sou um gato! üê±",
                    "Essa pergunta est√° al√©m dos meus conhecimentos m√≠sticos atuais... Tente algo mais espec√≠fico!",
                    "Miau? ü§î N√£o captei essa vibra√ß√£o... Que tal perguntar sobre o Aurora OS?",
                    "Interessante... Mas prefiro falar sobre funcionalidades do sistema. O que gostaria de saber?"
                ],
                compliments: [
                    "Obrigado! Voc√™ tamb√©m √© incr√≠vel! üò∏",
                    "Aww, que fofo! Gatos adoram elogios! üê±‚Äç‚¨õ‚ú®",
                    "Voc√™ tem bom gosto... Afinal, est√° usando o Aurora OS! üòé",
                    "Miau! Isso me deixa ronronando de felicidade! üòª"
                ],
                jokes: [
                    "Por que gatos s√£o bons programadores? Porque sabem lidar com bugs! üêõüò∏",
                    "Qual a diferen√ßa entre um gato e um computador? O gato tem 9 vidas, o computador s√≥ tem backup! üíæ",
                    "Por que o Gatomante usa √≥culos? Para ver melhor os c√≥digos m√≠sticos! ü§ì‚ú®",
                    "Como um gato navega na internet? Com o mouse! üñ±Ô∏èüòπ"
                ]
            }
        };
        
        function toggleGatomanteChat() {
            const chat = document.getElementById('gatomanteChat');
            const isVisible = chat.classList.contains('visible');
            
            if (isVisible) {
                chat.classList.remove('visible');
            } else {
                chat.classList.add('visible');
                
                // Mensagem de boas-vindas se for a primeira vez
                if (chatHistory.length === 0) {
                    setTimeout(() => {
                        addChatMessage('bot', getRandomResponse(gatomanteKnowledge.greetings));
                    }, 500);
                }
                
                // Focar no input
                setTimeout(() => {
                    document.getElementById('gatomanteInput').focus();
                }, 600);
            }
            
            console.log('ü§ñ Chat do Gatomante:', isVisible ? 'fechado' : 'aberto');
        }
        
        function addChatMessage(sender, message) {
            const messagesContainer = document.getElementById('gatomanteMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `gatomante-message ${sender}`;
            messageDiv.textContent = message;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Adicionar ao hist√≥rico
            chatHistory.push({ sender, message, timestamp: new Date() });
            
            // Limitar hist√≥rico a 50 mensagens
            if (chatHistory.length > 50) {
                chatHistory = chatHistory.slice(-50);
            }
        }
        
        function showTypingIndicator() {
            const messagesContainer = document.getElementById('gatomanteMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'gatomante-typing';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                Gatomante est√° digitando
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        function processUserMessage(message) {
            const lowerMessage = message.toLowerCase().trim();
            
            // Comandos espec√≠ficos
            for (const [command, handler] of Object.entries(gatomanteKnowledge.commands)) {
                if (lowerMessage.includes(command)) {
                    if (typeof handler === 'function') {
                        // Extrair par√¢metro se houver
                        const parts = lowerMessage.split(' ');
                        const paramIndex = parts.indexOf(command) + 1;
                        const param = paramIndex < parts.length ? parts[paramIndex] : null;
                        return handler(param);
                    } else {
                        return handler;
                    }
                }
            }
            
            // Respostas baseadas em palavras-chave
            if (lowerMessage.includes('obrigad') || lowerMessage.includes('valeu') || lowerMessage.includes('legal')) {
                return getRandomResponse(gatomanteKnowledge.responses.compliments);
            }
            
            if (lowerMessage.includes('piada') || lowerMessage.includes('engra√ßado') || lowerMessage.includes('humor')) {
                return getRandomResponse(gatomanteKnowledge.responses.jokes);
            }
            
            if (lowerMessage.includes('oi') || lowerMessage.includes('ol√°') || lowerMessage.includes('hey')) {
                return getRandomResponse(gatomanteKnowledge.greetings);
            }
            
            // Resposta padr√£o para mensagens n√£o reconhecidas
            return getRandomResponse(gatomanteKnowledge.responses.unknown);
        }
        
        function getRandomResponse(responses) {
            return responses[Math.floor(Math.random() * responses.length)];
        }
        
        function sendChatMessage() {
            const input = document.getElementById('gatomanteInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Adicionar mensagem do usu√°rio
            addChatMessage('user', message);
            input.value = '';
            
            // Mostrar indicador de digita√ß√£o
            showTypingIndicator();
            
            // Simular tempo de resposta
            setTimeout(() => {
                hideTypingIndicator();
                const response = processUserMessage(message);
                addChatMessage('bot', response);
                
                // Notificar sobre uso do chat
                setTimeout(() => {
                    gatomanteContextual('chat_usado', { mensagem: message });
                }, 1000);
            }, 1000 + Math.random() * 1500); // 1-2.5s de delay
        }
        
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }
        
        // Sistema de Reconhecimento de Voz
        function initVoiceRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                gatomanteVoiceRecognition = new SpeechRecognition();
                
                gatomanteVoiceRecognition.continuous = false;
                gatomanteVoiceRecognition.interimResults = false;
                gatomanteVoiceRecognition.lang = 'pt-BR';
                
                gatomanteVoiceRecognition.onstart = () => {
                    isVoiceListening = true;
                    const voiceBtn = document.getElementById('gatomanteVoiceBtn');
                    voiceBtn.classList.add('listening');
                    voiceBtn.title = 'Ouvindo... Fale agora!';
                    console.log('üé§ Reconhecimento de voz iniciado');
                };
                
                gatomanteVoiceRecognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    const input = document.getElementById('gatomanteInput');
                    input.value = transcript;
                    
                    // Enviar automaticamente
                    setTimeout(() => {
                        sendChatMessage();
                    }, 500);
                    
                    console.log('üé§ Comando de voz reconhecido:', transcript);
                };
                
                gatomanteVoiceRecognition.onend = () => {
                    isVoiceListening = false;
                    const voiceBtn = document.getElementById('gatomanteVoiceBtn');
                    voiceBtn.classList.remove('listening');
                    voiceBtn.title = 'Comando de Voz';
                };
                
                gatomanteVoiceRecognition.onerror = (event) => {
                    console.error('‚ùå Erro no reconhecimento de voz:', event.error);
                    isVoiceListening = false;
                    const voiceBtn = document.getElementById('gatomanteVoiceBtn');
                    voiceBtn.classList.remove('listening');
                };
                
                console.log('üé§ Sistema de reconhecimento de voz inicializado');
            } else {
                console.warn('‚ö†Ô∏è Reconhecimento de voz n√£o suportado neste navegador');
            }
        }
        
        function toggleVoiceRecognition() {
            if (!gatomanteVoiceRecognition) {
                addChatMessage('bot', 'Desculpe, reconhecimento de voz n√£o est√° dispon√≠vel neste navegador. üòø');
                return;
            }
            
            if (isVoiceListening) {
                gatomanteVoiceRecognition.stop();
            } else {
                gatomanteVoiceRecognition.start();
            }
        }
        
        function moveWindowToWorkspace(windowId, targetWorkspace) {
            // Remover da workspace atual
            removeWindowFromWorkspace(windowId);
            
            // Adicionar √† nova workspace
            addWindowToWorkspace(windowId, targetWorkspace);
            
            // Se n√£o √© a workspace atual, ocultar janela
            if (targetWorkspace !== currentWorkspace) {
                const windowElement = document.getElementById(windowId);
                if (windowElement) {
                    windowElement.style.display = 'none';
                }
            }
            
            // Notificar Gatomante
            setTimeout(() => {
                gatomanteContextual('workspaces', { 
                    acao: 'moveu_janela', 
                    para: targetWorkspace,
                    de: currentWorkspace
                });
            }, 1000);
            
            console.log(`üñ•Ô∏è Janela ${windowId} movida para Workspace ${targetWorkspace}`);
        }
                    function openSite(siteId) {
            const site = sitesConfig.find(s => s.id === siteId);
            if (!site) return;
            
            // Adicionar aos recentes
            addToRecentApps(site);
            
            if (site.url === 'local://files') {
                // Abrir aplicativo local de arquivos
                openLocalFilesApp();
            } else if (site.url.startsWith('local://')) {
                // Abrir aplica√ß√£o m√≠stica local
                openMysticalApp(site);
            } else {
                // Abrir site em janela
                openWebsite(site);
            }
            hideStartMenu();
            
            // Notificar Gatomante sobre abertura de app
            setTimeout(() => {
                gatomanteContextual('app_aberto', { app: site.name });
                trackUserActivity('app_opened', { app: site.name });
                detectarConquistas();
            }, 2000);
        }        
        function openWebsite(site) {
            const windowId = `window-${site.id}`;
            
            // Verificar se janela j√° est√° aberta
            if (document.getElementById(windowId)) {
                focusWindow(windowId);
                return;
            }
            
            const window = document.createElement('div');
            window.id = windowId;
            window.className = 'window active focused';
            window.style.left = `${100 + openWindows.length * 30}px`;
            window.style.top = `${50 + openWindows.length * 30}px`;
            window.style.width = '800px';
            window.style.height = '600px';
            
            window.innerHTML = `
                <div class="window-header">
                    <div class="window-title">
                        <span>${site.icon}</span>
                        <span>${site.name}</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control" onclick="minimizeWindow('${windowId}')">_</div>
                        <div class="window-control" onclick="maximizeWindow('${windowId}')">‚ñ°</div>
                        <div class="window-control close" onclick="closeWindow('${windowId}')">√ó</div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="loading-overlay" id="loading-${site.id}">
                        <div class="loading-spinner"></div>
                        <div>Carregando ${site.name}...</div>
                    </div>
                    <iframe class="window-iframe" src="${site.url}" onload="hideLoading('${site.id}')"></iframe>
                </div>
                <div class="window-resize-handle"></div>
            `;
            
            document.body.appendChild(window);
            
            // Adicionar janela ao workspace atual
            addWindowToWorkspace(windowId);
            
            // Aplicar anima√ß√£o de materializa√ß√£o cinematogr√°fica
            animateWindowOpen(window);
            
            openWindows.push({ id: windowId, title: site.name, icon: site.icon });
            updateTaskbar();
            
            // Remover loading ap√≥s 3 segundos (fallback)
            setTimeout(() => hideLoading(site.id), 3000);
        }
        
        function openLocalFilesApp() {
            const windowId = 'window-files';
            
            if (document.getElementById(windowId)) {
                focusWindow(windowId);
                return;
            }
            
            const window = document.createElement('div');
            window.id = windowId;
            window.className = 'window active focused';
            window.style.left = '150px';
            window.style.top = '100px';
            window.style.width = '700px';
            window.style.height = '500px';
            
            window.innerHTML = `
                <div class="window-header">
                    <div class="window-title">
                        <span>üìÅ</span>
                        <span>Arquivos & Anota√ß√µes</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control" onclick="minimizeWindow('${windowId}')">_</div>
                        <div class="window-control" onclick="maximizeWindow('${windowId}')">‚ñ°</div>
                        <div class="window-control close" onclick="closeWindow('${windowId}')">√ó</div>
                    </div>
                </div>
                <div class="window-content">
                    <div style="padding: 20px; text-align: center; color: #666;">
                        <h3>Gerenciador de Arquivos</h3>
                        <p>Sistema de arquivos em desenvolvimento...</p>
                        <br>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 30px;">
                            <div style="padding: 20px; border: 1px solid #ccc; border-radius: 8px;">
                                <div style="font-size: 32px; margin-bottom: 10px;">üìÑ</div>
                                <div>Documentos</div>
                            </div>
                            <div style="padding: 20px; border: 1px solid #ccc; border-radius: 8px;">
                                <div style="font-size: 32px; margin-bottom: 10px;">üñºÔ∏è</div>
                                <div>Imagens</div>
                            </div>
                            <div style="padding: 20px; border: 1px solid #ccc; border-radius: 8px;">
                                <div style="font-size: 32px; margin-bottom: 10px;">üéµ</div>
                                <div>√Åudios</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="window-resize-handle"></div>
            `;
            
            document.body.appendChild(window);
            
            // Adicionar janela ao workspace atual
            addWindowToWorkspace(windowId);
            
            // Aplicar anima√ß√£o de materializa√ß√£o cinematogr√°fica
            animateWindowOpen(window);
            
            openWindows.push({ id: windowId, title: 'Arquivos & Anota√ß√µes', icon: 'üìÅ' });
            updateTaskbar();
        }
        
        function hideLoading(siteId) {
            const loading = document.getElementById(`loading-${siteId}`);
            if (loading) {
                loading.style.display = 'none';
            }
        }
        
        function closeWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                // Anima√ß√£o de dissolu√ß√£o antes de fechar
                window.classList.add('dissolving');
                
                // Criar part√≠culas douradas durante a dissolu√ß√£o
                createWindowParticles(window);
                
                // Remover janela ap√≥s anima√ß√£o
                setTimeout(() => {
                    if (window.parentNode) {
                        window.remove();
                    }
                    // Remover janela do workspace
                    removeWindowFromWorkspace(windowId);
                    openWindows = openWindows.filter(w => w.id !== windowId);
                    updateTaskbar();
                }, 600);
                
                // Notificar Gatomante sobre fechamento
                setTimeout(() => {
                    gatomanteContextual('navegacao', { acao: 'janela fechada com dissolu√ß√£o m√°gica' });
                }, 800);
            }
        }
        
        function minimizeWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                // Anima√ß√£o de minimiza√ß√£o m√°gica (transforma√ß√£o em orbe)
                window.classList.add('minimizing');
                
                // Criar efeito de orbe de luz
                createMinimizeOrb(window);
                
                // Ocultar janela ap√≥s anima√ß√£o
                setTimeout(() => {
                    window.style.display = 'none';
                    window.classList.remove('minimizing');
                    
                    // Atualizar estado da janela
                    const windowData = openWindows.find(w => w.id === windowId);
                    if (windowData) {
                        windowData.minimized = true;
                    }
                    updateTaskbar();
                }, 500);
                
                // Notificar Gatomante
                setTimeout(() => {
                    gatomanteContextual('navegacao', { acao: 'janela minimizada como orbe de luz' });
                }, 700);
            }
        }
        
        // ========================================
        // üé¨ FUN√á√ïES DE ANIMA√á√ïES CINEMATOGR√ÅFICAS
        // ========================================
        
        function createWindowParticles(window) {
            const particlesContainer = document.createElement('div');
            particlesContainer.className = 'window-particles';
            window.appendChild(particlesContainer);
            
            // Criar 15 part√≠culas douradas
            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // Posi√ß√£o aleat√≥ria
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 2 + 's';
                particle.style.animationDuration = (2 + Math.random() * 2) + 's';
                
                particlesContainer.appendChild(particle);
            }
            
            // Remover part√≠culas ap√≥s anima√ß√£o
            setTimeout(() => {
                if (particlesContainer.parentNode) {
                    particlesContainer.remove();
                }
            }, 3000);
        }
        
        function createMinimizeOrb(window) {
            const orb = document.createElement('div');
            orb.style.cssText = `
                position: fixed;
                width: 20px;
                height: 20px;
                background: radial-gradient(circle, var(--dourado) 0%, transparent 70%);
                border-radius: 50%;
                z-index: 9999;
                pointer-events: none;
                box-shadow: 0 0 30px var(--dourado);
                animation: orbFloat 2s ease-out forwards;
            `;
            
            // Posicionar orbe no centro da janela
            const rect = window.getBoundingClientRect();
            orb.style.left = (rect.left + rect.width / 2 - 10) + 'px';
            orb.style.top = (rect.top + rect.height / 2 - 10) + 'px';
            
            document.body.appendChild(orb);
            
            // Animar orbe para a barra de tarefas
            setTimeout(() => {
                const taskbar = document.querySelector('.taskbar');
                const taskbarRect = taskbar.getBoundingClientRect();
                
                orb.style.transition = 'all 1s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
                orb.style.left = (taskbarRect.left + taskbarRect.width / 2 - 10) + 'px';
                orb.style.top = (taskbarRect.top + 10) + 'px';
                orb.style.transform = 'scale(0.5)';
                orb.style.opacity = '0';
            }, 100);
            
            // Remover orbe
            setTimeout(() => {
                if (orb.parentNode) {
                    orb.remove();
                }
            }, 1200);
        }
        
        function animateWindowOpen(window) {
            // Aplicar anima√ß√£o de materializa√ß√£o
            window.classList.add('materializing');
            
            // Criar part√≠culas de materializa√ß√£o
            createMaterializeEffect(window);
            
            // Remover classe ap√≥s anima√ß√£o
            setTimeout(() => {
                window.classList.remove('materializing');
                
                // Adicionar foco com brilho pulsante
                focusWindow(window.id);
            }, 800);
        }
        
        function createMaterializeEffect(window) {
            // Criar efeito de brilho inicial
            const glowEffect = document.createElement('div');
            glowEffect.style.cssText = `
                position: absolute;
                top: -10px;
                left: -10px;
                right: -10px;
                bottom: -10px;
                background: radial-gradient(circle, var(--dourado) 0%, transparent 70%);
                border-radius: 8px;
                opacity: 0.8;
                pointer-events: none;
                z-index: -1;
                animation: materializeGlow 0.8s ease-out forwards;
            `;
            
            window.style.position = 'relative';
            window.appendChild(glowEffect);
            
            // Remover efeito ap√≥s anima√ß√£o
            setTimeout(() => {
                if (glowEffect.parentNode) {
                    glowEffect.remove();
                }
            }, 800);
        }
        
        function focusWindow(windowId) {
            // Remover foco de todas as janelas
            document.querySelectorAll('.window').forEach(w => {
                w.classList.remove('focused');
            });
            
            // Adicionar foco √† janela atual
            const window = document.getElementById(windowId);
            if (window) {
                window.classList.add('focused');
                
                // Trazer para frente
                window.style.zIndex = 1600;
                
                // Atualizar outras janelas
                document.querySelectorAll('.window').forEach(w => {
                    if (w.id !== windowId) {
                        w.style.zIndex = 1500;
                    }
                });
            }
        }
        
        function toggleTransparencyMode(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                window.classList.toggle('transparent-mode');
                
                // Notificar sobre mudan√ßa de transpar√™ncia
                const isTransparent = window.classList.contains('transparent-mode');
                gatomanteContextual('navegacao', { 
                    acao: isTransparent ? 'modo transparente ativado' : 'modo transparente desativado' 
                });
            }
        }
        
        // Adicionar CSS para anima√ß√µes din√¢micas
        const dynamicStyles = document.createElement('style');
        dynamicStyles.textContent = `
            @keyframes materializeGlow {
                0% {
                    opacity: 0;
                    transform: scale(0.5);
                }
                50% {
                    opacity: 1;
                    transform: scale(1.2);
                }
                100% {
                    opacity: 0;
                    transform: scale(1);
                }
            }
            
            @keyframes orbFloat {
                0% {
                    opacity: 1;
                    transform: scale(1) rotate(0deg);
                }
                50% {
                    opacity: 0.8;
                    transform: scale(1.5) rotate(180deg);
                }
                100% {
                    opacity: 0.3;
                    transform: scale(0.8) rotate(360deg);
                }
            }
        `;
        document.head.appendChild(dynamicStyles);
            if (window) {
                window.style.display = 'none';
            }
        }
        
        function maximizeWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                if (window.style.width === '100vw') {
                    // Restaurar
                    window.style.width = '800px';
                    window.style.height = '600px';
                    window.style.left = '100px';
                    window.style.top = '50px';
                } else {
                    // Maximizar
                    window.style.width = '100vw';
                    window.style.height = 'calc(100vh - 40px)';
                    window.style.left = '0';
                    window.style.top = '0';
                }
            }
        }
        
        function focusWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                window.style.display = 'block';
                window.style.zIndex = '1600';
                
                // Remover foco de outras janelas
                document.querySelectorAll('.window').forEach(w => {
                    if (w.id !== windowId) {
                        w.style.zIndex = '1500';
                    }
                });
            }
        }
        
        function updateTaskbar() {
            const container = document.getElementById('taskbarItems');
            container.innerHTML = '';
            
            openWindows.forEach(window => {
                const item = document.createElement('div');
                item.className = 'taskbar-item';
                item.onclick = () => focusWindow(window.id);
                item.innerHTML = `${window.icon} ${window.title}`;
                container.appendChild(item);
            });
        }
        
        function setupWindowDragging() {
            // Implementa√ß√£o simplificada do drag de janelas
            let isDragging = false;
            let currentWindow = null;
            let offset = { x: 0, y: 0 };
            
            document.addEventListener('mousedown', function(e) {
                const header = e.target.closest('.window-header');
                if (header && !e.target.closest('.window-control')) {
                    isDragging = true;
                    currentWindow = header.closest('.window');
                    const rect = currentWindow.getBoundingClientRect();
                    offset.x = e.clientX - rect.left;
                    offset.y = e.clientY - rect.top;
                    e.preventDefault();
                }
            });
            
            document.addEventListener('mousemove', function(e) {
                if (isDragging && currentWindow) {
                    currentWindow.style.left = (e.clientX - offset.x) + 'px';
                    currentWindow.style.top = (e.clientY - offset.y) + 'px';
                }
            });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
                currentWindow = null;
            });
        }
        
        // ========================================
        // üîÆ SISTEMA DE APLICA√á√ïES M√çSTICAS LOCAIS
        // ========================================
        
        function openMysticalApp(site) {
            const windowId = `window-${site.id}`;
            
            // Verificar se janela j√° est√° aberta
            if (document.getElementById(windowId)) {
                focusWindow(windowId);
                return;
            }
            
            const window = document.createElement('div');
            window.id = windowId;
            window.className = 'window active focused';
            window.style.left = `${100 + openWindows.length * 30}px`;
            window.style.top = `${50 + openWindows.length * 30}px`;
            window.style.width = '600px';
            window.style.height = '500px';
            
            let appContent = '';
            
            // Gerar conte√∫do espec√≠fico para cada aplica√ß√£o m√≠stica
            switch(site.url) {
                case 'local://crystals':
                    appContent = generateCrystalsApp();
                    break;
                case 'local://herbs':
                    appContent = generateHerbsApp();
                    break;
                case 'local://cards':
                    appContent = generateCardsApp();
                    break;
                case 'local://stars':
                    appContent = generateStarsApp();
                    break;
                case 'local://kabbalah':
                    appContent = generateKabbalahApp();
                    break;
                case 'local://tarot':
                    appContent = generateTarotApp();
                    break;
                case 'local://books':
                    appContent = generateBooksApp();
                    break;
                case 'local://wheel':
                    appContent = generateWheelApp();
                    break;
                case 'local://snake':
                    appContent = generateSnakeGame();
                    break;
                case 'local://solitaire':
                    appContent = generateSolitaireGame();
                    break;
                case 'local://domino':
                    appContent = generateDominoGame();
                    break;
                case 'local://notepad':
                    appContent = generateNotepadApp();
                    break;
                case 'local://calculator':
                    appContent = generateCalculatorApp();
                    break;
                case 'local://reader':
                    appContent = generateReaderApp();
                    break;
                case 'local://player':
                    appContent = generatePlayerApp();
                    break;
                default:
                    appContent = generateDefaultApp(site);
            }
            
            window.innerHTML = `
                <div class="window-header">
                    <div class="window-title">
                        <span>${site.icon}</span>
                        <span>${site.name}</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control" onclick="minimizeWindow('${windowId}')">_</div>
                        <div class="window-control" onclick="maximizeWindow('${windowId}')">‚ñ°</div>
                        <div class="window-control close" onclick="closeWindow('${windowId}')">√ó</div>
                    </div>
                </div>
                <div class="window-content">
                    ${appContent}
                </div>
                <div class="window-resize-handle"></div>
            `;
            
            document.body.appendChild(window);
            openWindows.push(windowId);
            
            // Tornar janela arrast√°vel
            makeDraggable(window);
            
            // Focar na nova janela
            focusWindow(windowId);
        }
        
        // ========================================
        // üéÆ JOGOS M√çSTICOS FUNCIONAIS
        // Jogos completos e jog√°veis conforme especifica√ß√µes
        // ========================================
        
        // Geradores de conte√∫do para aplica√ß√µes m√≠sticas
        function generateCrystalsApp() {
            return `
                <div class="crystal-game-container" style="padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; height: 100%; overflow: hidden; font-family: 'Alice', serif;">
                    <div class="game-header" style="text-align: center; margin-bottom: 15px;">
                        <h2 style="margin: 0; font-size: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">üíé Combine os Cristais</h2>
                        <div class="game-stats" style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px;">
                            <span>Pontos: <span id="crystalScore">0</span></span>
                            <span>N√≠vel: <span id="crystalLevel">1</span></span>
                            <span>Movimentos: <span id="crystalMoves">30</span></span>
                        </div>
                    </div>
                    
                    <div class="crystal-board" id="crystalBoard" style="
                        display: grid; 
                        grid-template-columns: repeat(8, 1fr); 
                        gap: 2px; 
                        background: rgba(0,0,0,0.3); 
                        padding: 10px; 
                        border-radius: 10px;
                        max-width: 400px;
                        margin: 0 auto;
                        aspect-ratio: 1;
                    ">
                        <!-- Tabuleiro ser√° gerado dinamicamente -->
                    </div>
                    
                    <div class="game-controls" style="text-align: center; margin-top: 15px;">
                        <button onclick="resetCrystalGame()" style="
                            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 20px;
                            cursor: pointer;
                            font-weight: bold;
                            margin: 0 5px;
                        ">üîÑ Reiniciar</button>
                        <button onclick="showCrystalHint()" style="
                            background: linear-gradient(45deg, #feca57, #ff9ff3);
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 20px;
                            cursor: pointer;
                            font-weight: bold;
                            margin: 0 5px;
                        ">üí° Dica</button>
                    </div>
                    
                    <div class="crystal-legend" style="
                        display: grid; 
                        grid-template-columns: repeat(4, 1fr); 
                        gap: 5px; 
                        margin-top: 15px; 
                        font-size: 12px;
                        text-align: center;
                    ">
                        <div>üîÆ Quartzo</div>
                        <div>üíé Diamante</div>
                        <div>üü£ Ametista</div>
                        <div>üü¢ Esmeralda</div>
                        <div>üî¥ Rubi</div>
                        <div>üü° Citrino</div>
                        <div>üîµ Safira</div>
                        <div>‚ö´ Obsidiana</div>
                    </div>
                </div>
                
                <script>
                    // Vari√°veis do jogo de cristais
                    let crystalBoard = [];
                    let crystalScore = 0;
                    let crystalLevel = 1;
                    let crystalMoves = 30;
                    let selectedCrystal = null;
                    const crystalTypes = ['üîÆ', 'üíé', 'üü£', 'üü¢', 'üî¥', 'üü°', 'üîµ', '‚ö´'];
                    
                    // Inicializar jogo de cristais
                    function initCrystalGame() {
                        crystalBoard = [];
                        for (let i = 0; i < 8; i++) {
                            crystalBoard[i] = [];
                            for (let j = 0; j < 8; j++) {
                                crystalBoard[i][j] = crystalTypes[Math.floor(Math.random() * crystalTypes.length)];
                            }
                        }
                        renderCrystalBoard();
                        updateCrystalStats();
                    }
                    
                    // Renderizar tabuleiro
                    function renderCrystalBoard() {
                        const board = document.getElementById('crystalBoard');
                        if (!board) return;
                        
                        board.innerHTML = '';
                        for (let i = 0; i < 8; i++) {
                            for (let j = 0; j < 8; j++) {
                                const cell = document.createElement('div');
                                cell.className = 'crystal-cell';
                                cell.style.cssText = \`
                                    background: rgba(255,255,255,0.1);
                                    border: 1px solid rgba(255,255,255,0.2);
                                    border-radius: 5px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 20px;
                                    cursor: pointer;
                                    transition: all 0.3s ease;
                                    aspect-ratio: 1;
                                \`;
                                cell.textContent = crystalBoard[i][j];
                                cell.onclick = () => selectCrystal(i, j);
                                cell.onmouseover = () => {
                                    cell.style.background = 'rgba(255,255,255,0.3)';
                                    cell.style.transform = 'scale(1.1)';
                                };
                                cell.onmouseout = () => {
                                    if (!cell.classList.contains('selected')) {
                                        cell.style.background = 'rgba(255,255,255,0.1)';
                                        cell.style.transform = 'scale(1)';
                                    }
                                };
                                board.appendChild(cell);
                            }
                        }
                    }
                    
                    // Selecionar cristal
                    function selectCrystal(row, col) {
                        if (crystalMoves <= 0) return;
                        
                        const cells = document.querySelectorAll('.crystal-cell');
                        const index = row * 8 + col;
                        const cell = cells[index];
                        
                        if (selectedCrystal) {
                            // Verificar se √© movimento v√°lido (adjacente)
                            const [prevRow, prevCol] = selectedCrystal;
                            const isAdjacent = Math.abs(row - prevRow) + Math.abs(col - prevCol) === 1;
                            
                            if (isAdjacent) {
                                // Trocar cristais
                                const temp = crystalBoard[row][col];
                                crystalBoard[row][col] = crystalBoard[prevRow][prevCol];
                                crystalBoard[prevRow][prevCol] = temp;
                                
                                // Verificar combina√ß√µes
                                const matches = findMatches();
                                if (matches.length > 0) {
                                    removeMatches(matches);
                                    crystalMoves--;
                                    updateCrystalStats();
                                } else {
                                    // Desfazer movimento inv√°lido
                                    crystalBoard[prevRow][prevCol] = crystalBoard[row][col];
                                    crystalBoard[row][col] = temp;
                                }
                            }
                            
                            // Limpar sele√ß√£o
                            cells.forEach(c => {
                                c.classList.remove('selected');
                                c.style.background = 'rgba(255,255,255,0.1)';
                                c.style.transform = 'scale(1)';
                            });
                            selectedCrystal = null;
                        } else {
                            // Selecionar cristal
                            cells.forEach(c => c.classList.remove('selected'));
                            cell.classList.add('selected');
                            cell.style.background = 'rgba(255,255,255,0.5)';
                            cell.style.transform = 'scale(1.2)';
                            selectedCrystal = [row, col];
                        }
                        
                        renderCrystalBoard();
                    }
                    
                    // Encontrar combina√ß√µes
                    function findMatches() {
                        const matches = [];
                        
                        // Verificar linhas horizontais
                        for (let i = 0; i < 8; i++) {
                            let count = 1;
                            let current = crystalBoard[i][0];
                            for (let j = 1; j < 8; j++) {
                                if (crystalBoard[i][j] === current) {
                                    count++;
                                } else {
                                    if (count >= 3) {
                                        for (let k = j - count; k < j; k++) {
                                            matches.push([i, k]);
                                        }
                                    }
                                    count = 1;
                                    current = crystalBoard[i][j];
                                }
                            }
                            if (count >= 3) {
                                for (let k = 8 - count; k < 8; k++) {
                                    matches.push([i, k]);
                                }
                            }
                        }
                        
                        // Verificar colunas verticais
                        for (let j = 0; j < 8; j++) {
                            let count = 1;
                            let current = crystalBoard[0][j];
                            for (let i = 1; i < 8; i++) {
                                if (crystalBoard[i][j] === current) {
                                    count++;
                                } else {
                                    if (count >= 3) {
                                        for (let k = i - count; k < i; k++) {
                                            matches.push([k, j]);
                                        }
                                    }
                                    count = 1;
                                    current = crystalBoard[i][j];
                                }
                            }
                            if (count >= 3) {
                                for (let k = 8 - count; k < 8; k++) {
                                    matches.push([k, j]);
                                }
                            }
                        }
                        
                        return matches;
                    }
                    
                    // Remover combina√ß√µes
                    function removeMatches(matches) {
                        const points = matches.length * 10 * crystalLevel;
                        crystalScore += points;
                        
                        // Marcar c√©lulas para remo√ß√£o
                        matches.forEach(([row, col]) => {
                            crystalBoard[row][col] = null;
                        });
                        
                        // Fazer cristais ca√≠rem
                        for (let j = 0; j < 8; j++) {
                            let writeIndex = 7;
                            for (let i = 7; i >= 0; i--) {
                                if (crystalBoard[i][j] !== null) {
                                    crystalBoard[writeIndex][j] = crystalBoard[i][j];
                                    if (writeIndex !== i) {
                                        crystalBoard[i][j] = null;
                                    }
                                    writeIndex--;
                                }
                            }
                            
                            // Preencher espa√ßos vazios
                            for (let i = writeIndex; i >= 0; i--) {
                                crystalBoard[i][j] = crystalTypes[Math.floor(Math.random() * crystalTypes.length)];
                            }
                        }
                        
                        // Verificar novas combina√ß√µes
                        setTimeout(() => {
                            const newMatches = findMatches();
                            if (newMatches.length > 0) {
                                removeMatches(newMatches);
                            }
                        }, 500);
                    }
                    
                    // Atualizar estat√≠sticas
                    function updateCrystalStats() {
                        const scoreEl = document.getElementById('crystalScore');
                        const levelEl = document.getElementById('crystalLevel');
                        const movesEl = document.getElementById('crystalMoves');
                        
                        if (scoreEl) scoreEl.textContent = crystalScore;
                        if (levelEl) levelEl.textContent = crystalLevel;
                        if (movesEl) movesEl.textContent = crystalMoves;
                        
                        // Verificar mudan√ßa de n√≠vel
                        const newLevel = Math.floor(crystalScore / 1000) + 1;
                        if (newLevel > crystalLevel) {
                            crystalLevel = newLevel;
                            crystalMoves += 10;
                            showGatomante(\`Parab√©ns! Voc√™ alcan√ßou o n√≠vel \${crystalLevel}!\`, 'excited');
                        }
                        
                        // Verificar fim de jogo
                        if (crystalMoves <= 0) {
                            setTimeout(() => {
                                alert(\`Jogo finalizado! Pontua√ß√£o final: \${crystalScore}\`);
                            }, 500);
                        }
                    }
                    
                    // Reiniciar jogo
                    function resetCrystalGame() {
                        crystalScore = 0;
                        crystalLevel = 1;
                        crystalMoves = 30;
                        selectedCrystal = null;
                        initCrystalGame();
                    }
                    
                    // Mostrar dica
                    function showCrystalHint() {
                        if (crystalMoves > 0) {
                            crystalMoves--;
                            updateCrystalStats();
                            
                            // Encontrar movimento poss√≠vel
                            for (let i = 0; i < 8; i++) {
                                for (let j = 0; j < 7; j++) {
                                    // Testar troca horizontal
                                    const temp = crystalBoard[i][j];
                                    crystalBoard[i][j] = crystalBoard[i][j + 1];
                                    crystalBoard[i][j + 1] = temp;
                                    
                                    if (findMatches().length > 0) {
                                        // Desfazer e destacar
                                        crystalBoard[i][j + 1] = crystalBoard[i][j];
                                        crystalBoard[i][j] = temp;
                                        
                                        const cells = document.querySelectorAll('.crystal-cell');
                                        const index1 = i * 8 + j;
                                        const index2 = i * 8 + (j + 1);
                                        
                                        cells[index1].style.background = 'rgba(255,255,0,0.5)';
                                        cells[index2].style.background = 'rgba(255,255,0,0.5)';
                                        
                                        setTimeout(() => {
                                            cells[index1].style.background = 'rgba(255,255,255,0.1)';
                                            cells[index2].style.background = 'rgba(255,255,255,0.1)';
                                        }, 2000);
                                        
                                        return;
                                    }
                                    
                                    // Desfazer
                                    crystalBoard[i][j + 1] = crystalBoard[i][j];
                                    crystalBoard[i][j] = temp;
                                }
                            }
                            
                            showGatomante('Tente combinar 3 ou mais cristais iguais!', 'thinking');
                        }
                    }
                    
                    // Inicializar quando a aplica√ß√£o for carregada
                    setTimeout(initCrystalGame, 100);
                </script>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 24px;">üíú</div>
                            <h4>Ametista</h4>
                            <p style="font-size: 12px;">Prote√ß√£o e intui√ß√£o</p>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 24px;">üíö</div>
                            <h4>Quartzo Rosa</h4>
                            <p style="font-size: 12px;">Amor e cura emocional</p>
                        </div>
                    </div>
                    
                    <button style="background: var(--dourado); color: var(--azul-escuro); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        üîç Explorar Combina√ß√µes
                    </button>
                </div>
            `;
        }
        
        function generateHerbsApp() {
            return `
                <div class="herbs-game-container" style="padding: 15px; background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; height: 100%; overflow: hidden; font-family: 'Alice', serif;">
                    <div class="game-header" style="text-align: center; margin-bottom: 15px;">
                        <h2 style="margin: 0; font-size: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">üåø Combine as Ervas</h2>
                        <div class="game-stats" style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px;">
                            <span>Po√ß√µes: <span id="herbPotions">0</span></span>
                            <span>N√≠vel: <span id="herbLevel">1</span></span>
                            <span>Energia: <span id="herbEnergy">100</span></span>
                        </div>
                    </div>
                    
                    <div class="herb-workspace" style="display: flex; gap: 15px; height: calc(100% - 120px);">
                        <!-- Invent√°rio de Ervas -->
                        <div class="herb-inventory" style="
                            flex: 1;
                            background: rgba(0,0,0,0.3);
                            border-radius: 10px;
                            padding: 10px;
                            overflow-y: auto;
                        ">
                            <h3 style="margin: 0 0 10px 0; font-size: 16px; text-align: center;">üì¶ Invent√°rio</h3>
                            <div id="herbInventory" style="
                                display: grid;
                                grid-template-columns: repeat(3, 1fr);
                                gap: 5px;
                            ">
                                <!-- Ervas ser√£o geradas aqui -->
                            </div>
                        </div>
                        
                        <!-- Caldeir√£o de Mistura -->
                        <div class="herb-cauldron" style="
                            flex: 1;
                            background: rgba(0,0,0,0.3);
                            border-radius: 10px;
                            padding: 10px;
                            text-align: center;
                        ">
                            <h3 style="margin: 0 0 10px 0; font-size: 16px;">üîÆ Caldeir√£o</h3>
                            <div id="cauldronSlots" style="
                                display: grid;
                                grid-template-columns: repeat(2, 1fr);
                                gap: 10px;
                                margin-bottom: 15px;
                                min-height: 120px;
                            ">
                                <!-- Slots do caldeir√£o -->
                            </div>
                            <button onclick="brewPotion()" id="brewButton" style="
                                background: linear-gradient(45deg, #ff6b6b, #ee5a24);
                                color: white;
                                border: none;
                                padding: 10px 20px;
                                border-radius: 20px;
                                cursor: pointer;
                                font-weight: bold;
                                width: 100%;
                                margin-bottom: 10px;
                            ">üß™ Preparar Po√ß√£o</button>
                            <div id="potionResult" style="
                                min-height: 60px;
                                background: rgba(255,255,255,0.1);
                                border-radius: 10px;
                                padding: 10px;
                                font-size: 12px;
                            ">
                                Combine ervas para criar po√ß√µes m√°gicas!
                            </div>
                        </div>
                        
                        <!-- Livro de Receitas -->
                        <div class="herb-recipes" style="
                            flex: 1;
                            background: rgba(0,0,0,0.3);
                            border-radius: 10px;
                            padding: 10px;
                            overflow-y: auto;
                        ">
                            <h3 style="margin: 0 0 10px 0; font-size: 16px; text-align: center;">üìö Receitas</h3>
                            <div id="recipeBook" style="font-size: 12px;">
                                <!-- Receitas ser√£o geradas aqui -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-controls" style="text-align: center; margin-top: 10px;">
                        <button onclick="resetHerbGame()" style="
                            background: linear-gradient(45deg, #feca57, #ff9ff3);
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 20px;
                            cursor: pointer;
                            font-weight: bold;
                            margin: 0 5px;
                        ">üîÑ Reiniciar</button>
                        <button onclick="gatherHerbs()" style="
                            background: linear-gradient(45deg, #48dbfb, #0abde3);
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 20px;
                            cursor: pointer;
                            font-weight: bold;
                            margin: 0 5px;
                        ">üå± Coletar Ervas</button>
                    </div>
                </div>
                
                <script>
                    // Vari√°veis do jogo de ervas
                    let herbInventory = {};
                    let cauldronContents = [];
                    let herbPotions = 0;
                    let herbLevel = 1;
                    let herbEnergy = 100;
                    
                    const herbTypes = {
                        'üåπ': { name: 'Rosa', element: 'amor', rarity: 'comum', energy: 5 },
                        'üåô': { name: 'Lavanda', element: 'paz', rarity: 'comum', energy: 5 },
                        'üî•': { name: 'Canela', element: 'energia', rarity: 'comum', energy: 5 },
                        'üåø': { name: 'S√°lvia', element: 'purifica√ß√£o', rarity: 'comum', energy: 5 },
                        '‚≠ê': { name: 'Anis Estrelado', element: 'prote√ß√£o', rarity: 'raro', energy: 10 },
                        'üçÑ': { name: 'Cogumelo M√≠stico', element: 'vis√£o', rarity: 'raro', energy: 10 },
                        'üå∫': { name: 'Hibisco', element: 'paix√£o', rarity: 'incomum', energy: 7 },
                        'üå∏': { name: 'Flor de Cerejeira', element: 'renova√ß√£o', rarity: 'incomum', energy: 7 },
                        'üçÄ': { name: 'Trevo de 4 Folhas', element: 'sorte', rarity: '√©pico', energy: 15 },
                        'üåü': { name: 'Poeira Estelar', element: 'magia', rarity: 'lend√°rio', energy: 25 }
                    };
                    
                    const potionRecipes = {
                        'Po√ß√£o do Amor': { ingredients: ['üåπ', 'üå∫'], effect: 'Atrai o amor verdadeiro', points: 50 },
                        'Elixir da Paz': { ingredients: ['üåô', 'üåø'], effect: 'Traz tranquilidade e serenidade', points: 40 },
                        'T√¥nico Energ√©tico': { ingredients: ['üî•', '‚≠ê'], effect: 'Aumenta energia e vitalidade', points: 60 },
                        'Po√ß√£o da Sorte': { ingredients: ['üçÄ', 'üåü'], effect: 'Multiplica a sorte por 7 dias', points: 200 },
                        'Elixir da Vis√£o': { ingredients: ['üçÑ', 'üå∏'], effect: 'Revela verdades ocultas', points: 80 },
                        'Po√ß√£o da Prote√ß√£o': { ingredients: ['‚≠ê', 'üåø'], effect: 'Cria escudo m√°gico protetor', points: 70 },
                        'Elixir Supremo': { ingredients: ['üåü', 'üçÄ', 'üçÑ'], effect: 'Poder m√°gico absoluto', points: 500 }
                    };
                    
                    // Inicializar jogo de ervas
                    function initHerbGame() {
                        herbInventory = {
                            'üåπ': 3, 'üåô': 3, 'üî•': 2, 'üåø': 2,
                            '‚≠ê': 1, 'üçÑ': 1, 'üå∫': 2, 'üå∏': 1
                        };
                        cauldronContents = [];
                        herbPotions = 0;
                        herbLevel = 1;
                        herbEnergy = 100;
                        
                        renderHerbInventory();
                        renderCauldron();
                        renderRecipeBook();
                        updateHerbStats();
                    }
                    
                    // Renderizar invent√°rio
                    function renderHerbInventory() {
                        const inventory = document.getElementById('herbInventory');
                        if (!inventory) return;
                        
                        inventory.innerHTML = '';
                        Object.entries(herbInventory).forEach(([herb, quantity]) => {
                            if (quantity > 0) {
                                const herbItem = document.createElement('div');
                                herbItem.className = 'herb-item';
                                herbItem.style.cssText = \`
                                    background: rgba(255,255,255,0.1);
                                    border: 1px solid rgba(255,255,255,0.2);
                                    border-radius: 8px;
                                    padding: 8px;
                                    text-align: center;
                                    cursor: pointer;
                                    transition: all 0.3s ease;
                                    position: relative;
                                \`;
                                
                                const herbData = herbTypes[herb];
                                const rarityColor = {
                                    'comum': '#4CAF50',
                                    'incomum': '#2196F3',
                                    'raro': '#9C27B0',
                                    '√©pico': '#FF9800',
                                    'lend√°rio': '#F44336'
                                }[herbData.rarity];
                                
                                herbItem.innerHTML = \`
                                    <div style="font-size: 24px;">\${herb}</div>
                                    <div style="font-size: 10px; color: \${rarityColor}; font-weight: bold;">\${herbData.name}</div>
                                    <div style="font-size: 12px; font-weight: bold;">\${quantity}</div>
                                \`;
                                
                                herbItem.onclick = () => addToCauldron(herb);
                                herbItem.onmouseover = () => {
                                    herbItem.style.background = 'rgba(255,255,255,0.3)';
                                    herbItem.style.transform = 'scale(1.1)';
                                };
                                herbItem.onmouseout = () => {
                                    herbItem.style.background = 'rgba(255,255,255,0.1)';
                                    herbItem.style.transform = 'scale(1)';
                                };
                                
                                inventory.appendChild(herbItem);
                            }
                        });
                    }
                    
                    // Adicionar ao caldeir√£o
                    function addToCauldron(herb) {
                        if (cauldronContents.length >= 4) {
                            showGatomante('O caldeir√£o est√° cheio! Prepare a po√ß√£o primeiro.', 'thinking');
                            return;
                        }
                        
                        if (herbInventory[herb] > 0) {
                            herbInventory[herb]--;
                            cauldronContents.push(herb);
                            renderHerbInventory();
                            renderCauldron();
                        }
                    }
                    
                    // Renderizar caldeir√£o
                    function renderCauldron() {
                        const cauldron = document.getElementById('cauldronSlots');
                        if (!cauldron) return;
                        
                        cauldron.innerHTML = '';
                        for (let i = 0; i < 4; i++) {
                            const slot = document.createElement('div');
                            slot.className = 'cauldron-slot';
                            slot.style.cssText = \`
                                background: rgba(255,255,255,0.1);
                                border: 2px dashed rgba(255,255,255,0.3);
                                border-radius: 10px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-size: 24px;
                                min-height: 50px;
                                transition: all 0.3s ease;
                            \`;
                            
                            if (cauldronContents[i]) {
                                slot.textContent = cauldronContents[i];
                                slot.style.background = 'rgba(255,255,255,0.2)';
                                slot.style.borderStyle = 'solid';
                                slot.onclick = () => removeFromCauldron(i);
                                slot.style.cursor = 'pointer';
                            } else {
                                slot.textContent = '+';
                                slot.style.color = 'rgba(255,255,255,0.5)';
                            }
                            
                            cauldron.appendChild(slot);
                        }
                    }
                    
                    // Remover do caldeir√£o
                    function removeFromCauldron(index) {
                        const herb = cauldronContents[index];
                        if (herb) {
                            herbInventory[herb] = (herbInventory[herb] || 0) + 1;
                            cauldronContents.splice(index, 1);
                            renderHerbInventory();
                            renderCauldron();
                        }
                    }
                    
                    // Preparar po√ß√£o
                    function brewPotion() {
                        if (cauldronContents.length === 0) {
                            showGatomante('Adicione ervas ao caldeir√£o primeiro!', 'thinking');
                            return;
                        }
                        
                        if (herbEnergy < 10) {
                            showGatomante('Energia insuficiente! Colete mais ervas.', 'thinking');
                            return;
                        }
                        
                        herbEnergy -= 10;
                        
                        // Verificar receitas
                        let potionMade = null;
                        Object.entries(potionRecipes).forEach(([name, recipe]) => {
                            const hasIngredients = recipe.ingredients.every(ingredient => 
                                cauldronContents.includes(ingredient)
                            );
                            
                            if (hasIngredients && recipe.ingredients.length === cauldronContents.length) {
                                potionMade = { name, ...recipe };
                            }
                        });
                        
                        const resultDiv = document.getElementById('potionResult');
                        if (potionMade) {
                            // Po√ß√£o conhecida
                            herbPotions += potionMade.points;
                            resultDiv.innerHTML = \`
                                <div style="color: #4CAF50; font-weight: bold;">‚ú® \${potionMade.name} ‚ú®</div>
                                <div style="font-size: 10px; margin-top: 5px;">\${potionMade.effect}</div>
                                <div style="color: #FFD700; font-weight: bold;">+\${potionMade.points} pontos</div>
                            \`;
                            showGatomante(\`Excelente! Voc√™ criou \${potionMade.name}!\`, 'excited');
                        } else {
                            // Po√ß√£o experimental
                            const points = cauldronContents.length * 5;
                            herbPotions += points;
                            resultDiv.innerHTML = \`
                                <div style="color: #FF9800; font-weight: bold;">üß™ Po√ß√£o Experimental</div>
                                <div style="font-size: 10px; margin-top: 5px;">Uma mistura interessante...</div>
                                <div style="color: #FFD700; font-weight: bold;">+\${points} pontos</div>
                            \`;
                        }
                        
                        // Limpar caldeir√£o
                        cauldronContents = [];
                        renderCauldron();
                        updateHerbStats();
                        
                        // Verificar mudan√ßa de n√≠vel
                        const newLevel = Math.floor(herbPotions / 500) + 1;
                        if (newLevel > herbLevel) {
                            herbLevel = newLevel;
                            herbEnergy = 100;
                            showGatomante(\`Parab√©ns! Voc√™ alcan√ßou o n√≠vel \${herbLevel} de alquimista!\`, 'excited');
                        }
                    }
                    
                    // Coletar ervas
                    function gatherHerbs() {
                        if (herbEnergy < 20) {
                            showGatomante('Energia insuficiente para coletar ervas!', 'thinking');
                            return;
                        }
                        
                        herbEnergy -= 20;
                        
                        // Gerar ervas aleat√≥rias baseadas na raridade
                        const rarityChances = {
                            'comum': 0.6,
                            'incomum': 0.25,
                            'raro': 0.1,
                            '√©pico': 0.04,
                            'lend√°rio': 0.01
                        };
                        
                        const herbsFound = [];
                        for (let i = 0; i < 3; i++) {
                            const rand = Math.random();
                            let cumulativeChance = 0;
                            
                            for (const [rarity, chance] of Object.entries(rarityChances)) {
                                cumulativeChance += chance;
                                if (rand <= cumulativeChance) {
                                    const herbsOfRarity = Object.entries(herbTypes).filter(([_, data]) => data.rarity === rarity);
                                    const [herb] = herbsOfRarity[Math.floor(Math.random() * herbsOfRarity.length)];
                                    herbsFound.push(herb);
                                    herbInventory[herb] = (herbInventory[herb] || 0) + 1;
                                    break;
                                }
                            }
                        }
                        
                        renderHerbInventory();
                        updateHerbStats();
                        
                        showGatomante(\`Voc√™ encontrou: \${herbsFound.join(' ')}\`, 'excited');
                    }
                    
                    // Renderizar livro de receitas
                    function renderRecipeBook() {
                        const book = document.getElementById('recipeBook');
                        if (!book) return;
                        
                        book.innerHTML = '';
                        Object.entries(potionRecipes).forEach(([name, recipe]) => {
                            const recipeDiv = document.createElement('div');
                            recipeDiv.style.cssText = \`
                                background: rgba(255,255,255,0.1);
                                border-radius: 8px;
                                padding: 8px;
                                margin-bottom: 8px;
                                border-left: 3px solid #FFD700;
                            \`;
                            
                            recipeDiv.innerHTML = \`
                                <div style="font-weight: bold; color: #FFD700;">\${name}</div>
                                <div style="margin: 5px 0;">\${recipe.ingredients.join(' + ')}</div>
                                <div style="font-size: 10px; color: #ccc;">\${recipe.effect}</div>
                                <div style="font-size: 10px; color: #4CAF50;">+\${recipe.points} pontos</div>
                            \`;
                            
                            book.appendChild(recipeDiv);
                        });
                    }
                    
                    // Atualizar estat√≠sticas
                    function updateHerbStats() {
                        const potionsEl = document.getElementById('herbPotions');
                        const levelEl = document.getElementById('herbLevel');
                        const energyEl = document.getElementById('herbEnergy');
                        
                        if (potionsEl) potionsEl.textContent = herbPotions;
                        if (levelEl) levelEl.textContent = herbLevel;
                        if (energyEl) energyEl.textContent = herbEnergy;
                    }
                    
                    // Reiniciar jogo
                    function resetHerbGame() {
                        initHerbGame();
                        showGatomante('Laborat√≥rio de alquimia reiniciado!', 'normal');
                    }
                    
                    // Inicializar quando a aplica√ß√£o for carregada
                    setTimeout(initHerbGame, 100);
                </script>
            `;
        }
        
        function generateTarotApp() {
            return `
                <div class="tarot-game-container" style="padding: 15px; background: linear-gradient(135deg, #2c3e50 0%, #4a6741 100%); color: white; height: 100%; overflow: hidden; font-family: 'Alice', serif;">
                    <div class="game-header" style="text-align: center; margin-bottom: 15px;">
                        <h2 style="margin: 0; font-size: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">üîÆ Witch Tarot</h2>
                        <div class="game-stats" style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px;">
                            <span>Leituras: <span id="tarotReadings">0</span></span>
                            <span>Precis√£o: <span id="tarotAccuracy">0%</span></span>
                            <span>Energia: <span id="tarotEnergy">100</span></span>
                        </div>
                    </div>
                    
                    <div class="tarot-workspace" style="display: flex; gap: 15px; height: calc(100% - 120px);">
                        <!-- Mesa de Cartas -->
                        <div class="tarot-table" style="
                            flex: 2;
                            background: rgba(0,0,0,0.3);
                            border-radius: 10px;
                            padding: 15px;
                            position: relative;
                            overflow: hidden;
                        ">
                            <div class="table-pattern" style="
                                position: absolute;
                                top: 0;
                                left: 0;
                                right: 0;
                                bottom: 0;
                                background: radial-gradient(circle at center, rgba(218,165,32,0.1) 0%, transparent 70%);
                                pointer-events: none;
                            "></div>
                            
                            <div class="card-spread" id="cardSpread" style="
                                position: relative;
                                height: 100%;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                flex-wrap: wrap;
                                gap: 10px;
                            ">
                                <!-- Cartas aparecer√£o aqui -->
                                <div class="no-cards" style="
                                    text-align: center;
                                    color: rgba(255,255,255,0.5);
                                    font-style: italic;
                                ">
                                    Escolha um tipo de leitura para come√ßar...
                                </div>
                            </div>
                        </div>
                        
                        <!-- Painel de Controle -->
                        <div class="tarot-controls" style="
                            flex: 1;
                            background: rgba(0,0,0,0.3);
                            border-radius: 10px;
                            padding: 15px;
                            overflow-y: auto;
                        ">
                            <h3 style="margin: 0 0 15px 0; font-size: 16px; text-align: center;">üé¥ Tipos de Leitura</h3>
                            
                            <button onclick="drawSingleCard()" style="
                                background: linear-gradient(45deg, #667eea, #764ba2);
                                color: white;
                                border: none;
                                padding: 12px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                width: 100%;
                                margin-bottom: 10px;
                                font-size: 14px;
                            ">üîÆ Carta do Dia</button>
                            
                            <button onclick="drawThreeCards()" style="
                                background: linear-gradient(45deg, #f093fb, #f5576c);
                                color: white;
                                border: none;
                                padding: 12px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                width: 100%;
                                margin-bottom: 10px;
                                font-size: 14px;
                            ">‚≠ê Passado/Presente/Futuro</button>
                            
                            <button onclick="drawLoveReading()" style="
                                background: linear-gradient(45deg, #ff6b6b, #ee5a24);
                                color: white;
                                border: none;
                                padding: 12px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                width: 100%;
                                margin-bottom: 10px;
                                font-size: 14px;
                            ">üíï Leitura do Amor</button>
                            
                            <button onclick="drawCelticCross()" style="
                                background: linear-gradient(45deg, #4ecdc4, #44a08d);
                                color: white;
                                border: none;
                                padding: 12px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                width: 100%;
                                margin-bottom: 15px;
                                font-size: 14px;
                            ">‚ú® Cruz Celta (10 cartas)</button>
                            
                            <div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 15px;">
                                <button onclick="clearTable()" style="
                                    background: linear-gradient(45deg, #feca57, #ff9ff3);
                                    color: white;
                                    border: none;
                                    padding: 10px;
                                    border-radius: 10px;
                                    cursor: pointer;
                                    font-weight: bold;
                                    width: 100%;
                                    margin-bottom: 10px;
                                ">üßπ Limpar Mesa</button>
                                
                                <button onclick="shuffleDeck()" style="
                                    background: linear-gradient(45deg, #48dbfb, #0abde3);
                                    color: white;
                                    border: none;
                                    padding: 10px;
                                    border-radius: 10px;
                                    cursor: pointer;
                                    font-weight: bold;
                                    width: 100%;
                                ">üîÑ Embaralhar</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Modal de Interpreta√ß√£o -->
                    <div id="tarotModal" style="
                        display: none;
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0,0,0,0.8);
                        z-index: 10000;
                        backdrop-filter: blur(5px);
                    ">
                        <div style="
                            position: absolute;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            background: linear-gradient(135deg, #2c3e50 0%, #4a6741 100%);
                            border: 2px solid var(--dourado);
                            border-radius: 15px;
                            padding: 20px;
                            max-width: 500px;
                            max-height: 80vh;
                            overflow-y: auto;
                            color: white;
                        ">
                            <div id="modalContent">
                                <!-- Conte√∫do ser√° inserido aqui -->
                            </div>
                            <button onclick="closeTarotModal()" style="
                                background: var(--dourado);
                                color: var(--azul-escuro);
                                border: none;
                                padding: 10px 20px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                margin-top: 15px;
                                width: 100%;
                            ">Fechar</button>
                        </div>
                    </div>
                </div>
                
                <script>
                    // Vari√°veis do jogo de tarot
                    let tarotDeck = [];
                    let currentSpread = [];
                    let tarotReadings = 0;
                    let tarotAccuracy = 0;
                    let tarotEnergy = 100;
                    
                    // Baralho de Tarot Completo (Arcanos Maiores)
                    const tarotCards = {
                        0: { name: 'O Louco', symbol: 'üÉè', meaning: 'Novos come√ßos, espontaneidade, inoc√™ncia', reversed: 'Imprud√™ncia, falta de dire√ß√£o' },
                        1: { name: 'O Mago', symbol: 'üé©', meaning: 'Manifesta√ß√£o, poder pessoal, a√ß√£o', reversed: 'Manipula√ß√£o, falta de energia' },
                        2: { name: 'A Sacerdotisa', symbol: 'üåô', meaning: 'Intui√ß√£o, mist√©rio, sabedoria interior', reversed: 'Segredos, falta de intui√ß√£o' },
                        3: { name: 'A Imperatriz', symbol: 'üëë', meaning: 'Fertilidade, feminilidade, abund√¢ncia', reversed: 'Depend√™ncia, vazio criativo' },
                        4: { name: 'O Imperador', symbol: '‚öîÔ∏è', meaning: 'Autoridade, estrutura, controle', reversed: 'Tirania, rigidez excessiva' },
                        5: { name: 'O Hierofante', symbol: 'üèõÔ∏è', meaning: 'Tradi√ß√£o, conformidade, moralidade', reversed: 'Rebeli√£o, subvers√£o' },
                        6: { name: 'Os Amantes', symbol: 'üíï', meaning: 'Amor, harmonia, relacionamentos', reversed: 'Desarmonia, escolhas ruins' },
                        7: { name: 'A Carruagem', symbol: 'üèá', meaning: 'Controle, determina√ß√£o, vit√≥ria', reversed: 'Falta de controle, derrota' },
                        8: { name: 'A For√ßa', symbol: 'ü¶Å', meaning: 'For√ßa interior, coragem, paci√™ncia', reversed: 'Fraqueza, falta de autocontrole' },
                        9: { name: 'O Eremita', symbol: 'üïØÔ∏è', meaning: 'Introspec√ß√£o, busca interior, orienta√ß√£o', reversed: 'Isolamento, solid√£o' },
                        10: { name: 'A Roda da Fortuna', symbol: '‚ò∏Ô∏è', meaning: 'Destino, mudan√ßa, ciclos', reversed: 'M√° sorte, falta de controle' },
                        11: { name: 'A Justi√ßa', symbol: '‚öñÔ∏è', meaning: 'Justi√ßa, verdade, causa e efeito', reversed: 'Injusti√ßa, falta de responsabilidade' },
                        12: { name: 'O Enforcado', symbol: 'üôÉ', meaning: 'Suspens√£o, sacrif√≠cio, nova perspectiva', reversed: 'Atraso, resist√™ncia' },
                        13: { name: 'A Morte', symbol: 'üíÄ', meaning: 'Transforma√ß√£o, fim de ciclo, renascimento', reversed: 'Resist√™ncia √† mudan√ßa, estagna√ß√£o' },
                        14: { name: 'A Temperan√ßa', symbol: 'üç∑', meaning: 'Equil√≠brio, modera√ß√£o, paci√™ncia', reversed: 'Impaci√™ncia, falta de equil√≠brio' },
                        15: { name: 'O Diabo', symbol: 'üòà', meaning: 'Tenta√ß√£o, materialismo, v√≠cio', reversed: 'Liberta√ß√£o, quebra de correntes' },
                        16: { name: 'A Torre', symbol: 'üóº', meaning: 'Mudan√ßa s√∫bita, revela√ß√£o, destrui√ß√£o', reversed: 'Evitar desastre, resist√™ncia' },
                        17: { name: 'A Estrela', symbol: '‚≠ê', meaning: 'Esperan√ßa, inspira√ß√£o, orienta√ß√£o espiritual', reversed: 'Falta de f√©, pessimismo' },
                        18: { name: 'A Lua', symbol: 'üåô', meaning: 'Ilus√£o, intui√ß√£o, subconsciente', reversed: 'Confus√£o, medo, desorienta√ß√£o' },
                        19: { name: 'O Sol', symbol: '‚òÄÔ∏è', meaning: 'Alegria, sucesso, vitalidade', reversed: 'Pessimismo, falta de energia' },
                        20: { name: 'O Julgamento', symbol: 'üìØ', meaning: 'Renascimento, perd√£o, chamado interior', reversed: 'Julgamento severo, falta de perd√£o' },
                        21: { name: 'O Mundo', symbol: 'üåç', meaning: 'Completude, realiza√ß√£o, sucesso', reversed: 'Falta de fechamento, objetivos n√£o alcan√ßados' }
                    };
                    
                    // Inicializar jogo de tarot
                    function initTarotGame() {
                        shuffleDeck();
                        currentSpread = [];
                        tarotReadings = 0;
                        tarotAccuracy = 0;
                        tarotEnergy = 100;
                        updateTarotStats();
                    }
                    
                    // Embaralhar baralho
                    function shuffleDeck() {
                        tarotDeck = Object.keys(tarotCards).map(Number);
                        for (let i = tarotDeck.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [tarotDeck[i], tarotDeck[j]] = [tarotDeck[j], tarotDeck[i]];
                        }
                        showGatomante('Baralho embaralhado com energia m√≠stica!', 'excited');
                    }
                    
                    // Tirar uma carta
                    function drawSingleCard() {
                        if (tarotEnergy < 10) {
                            showGatomante('Energia insuficiente para uma leitura!', 'thinking');
                            return;
                        }
                        
                        clearTable();
                        tarotEnergy -= 10;
                        
                        const cardId = tarotDeck.pop();
                        const card = tarotCards[cardId];
                        const isReversed = Math.random() < 0.3;
                        
                        currentSpread = [{
                            id: cardId,
                            card: card,
                            reversed: isReversed,
                            position: 'Carta do Dia'
                        }];
                        
                        renderSpread();
                        tarotReadings++;
                        updateTarotStats();
                        
                        setTimeout(() => {
                            showCardInterpretation(currentSpread[0]);
                        }, 1000);
                    }
                    
                    // Leitura de 3 cartas
                    function drawThreeCards() {
                        if (tarotEnergy < 25) {
                            showGatomante('Energia insuficiente para esta leitura!', 'thinking');
                            return;
                        }
                        
                        clearTable();
                        tarotEnergy -= 25;
                        
                        const positions = ['Passado', 'Presente', 'Futuro'];
                        currentSpread = [];
                        
                        for (let i = 0; i < 3; i++) {
                            const cardId = tarotDeck.pop();
                            const card = tarotCards[cardId];
                            const isReversed = Math.random() < 0.3;
                            
                            currentSpread.push({
                                id: cardId,
                                card: card,
                                reversed: isReversed,
                                position: positions[i]
                            });
                        }
                        
                        renderSpread();
                        tarotReadings++;
                        updateTarotStats();
                        
                        setTimeout(() => {
                            showSpreadInterpretation(currentSpread, 'Leitura Passado/Presente/Futuro');
                        }, 1500);
                    }
                    
                    // Leitura do amor
                    function drawLoveReading() {
                        if (tarotEnergy < 30) {
                            showGatomante('Energia insuficiente para esta leitura!', 'thinking');
                            return;
                        }
                        
                        clearTable();
                        tarotEnergy -= 30;
                        
                        const positions = ['Voc√™', 'Seu Cora√ß√£o', 'Seu Amor', 'Resultado'];
                        currentSpread = [];
                        
                        for (let i = 0; i < 4; i++) {
                            const cardId = tarotDeck.pop();
                            const card = tarotCards[cardId];
                            const isReversed = Math.random() < 0.3;
                            
                            currentSpread.push({
                                id: cardId,
                                card: card,
                                reversed: isReversed,
                                position: positions[i]
                            });
                        }
                        
                        renderSpread();
                        tarotReadings++;
                        updateTarotStats();
                        
                        setTimeout(() => {
                            showSpreadInterpretation(currentSpread, 'Leitura do Amor');
                        }, 2000);
                    }
                    
                    // Cruz Celta
                    function drawCelticCross() {
                        if (tarotEnergy < 50) {
                            showGatomante('Energia insuficiente para a Cruz Celta!', 'thinking');
                            return;
                        }
                        
                        clearTable();
                        tarotEnergy -= 50;
                        
                        const positions = [
                            'Situa√ß√£o Atual', 'Desafio', 'Passado Distante', 'Futuro Pr√≥ximo',
                            'Poss√≠vel Resultado', 'Passado Recente', 'Sua Abordagem', 'Influ√™ncias Externas',
                            'Esperan√ßas e Medos', 'Resultado Final'
                        ];
                        
                        currentSpread = [];
                        
                        for (let i = 0; i < 10; i++) {
                            const cardId = tarotDeck.pop();
                            const card = tarotCards[cardId];
                            const isReversed = Math.random() < 0.3;
                            
                            currentSpread.push({
                                id: cardId,
                                card: card,
                                reversed: isReversed,
                                position: positions[i]
                            });
                        }
                        
                        renderSpread();
                        tarotReadings++;
                        updateTarotStats();
                        
                        setTimeout(() => {
                            showSpreadInterpretation(currentSpread, 'Cruz Celta');
                        }, 3000);
                    }
                    
                    // Renderizar spread
                    function renderSpread() {
                        const spreadDiv = document.getElementById('cardSpread');
                        if (!spreadDiv) return;
                        
                        spreadDiv.innerHTML = '';
                        
                        currentSpread.forEach((cardData, index) => {
                            const cardElement = document.createElement('div');
                            cardElement.className = 'tarot-card';
                            cardElement.style.cssText = \`
                                width: 80px;
                                height: 120px;
                                background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
                                border: 2px solid var(--dourado);
                                border-radius: 10px;
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                                justify-content: center;
                                cursor: pointer;
                                transition: all 0.5s ease;
                                transform: rotateY(180deg);
                                animation: cardFlip 0.8s ease forwards;
                                animation-delay: \${index * 0.3}s;
                                position: relative;
                                margin: 5px;
                                \${cardData.reversed ? 'transform: rotateY(0deg) rotateZ(180deg);' : ''}
                            \`;
                            
                            cardElement.innerHTML = \`
                                <div style="font-size: 24px; margin-bottom: 5px;">\${cardData.card.symbol}</div>
                                <div style="font-size: 10px; text-align: center; font-weight: bold; color: var(--dourado);">\${cardData.card.name}</div>
                                <div style="font-size: 8px; text-align: center; margin-top: 5px; color: #ccc;">\${cardData.position}</div>
                                \${cardData.reversed ? '<div style="position: absolute; top: 2px; right: 2px; color: red; font-size: 12px;">‚Üª</div>' : ''}
                            \`;
                            
                            cardElement.onclick = () => showCardInterpretation(cardData);
                            
                            spreadDiv.appendChild(cardElement);
                        });
                    }
                    
                    // Mostrar interpreta√ß√£o de carta individual
                    function showCardInterpretation(cardData) {
                        const modal = document.getElementById('tarotModal');
                        const content = document.getElementById('modalContent');
                        
                        const meaning = cardData.reversed ? cardData.card.reversed : cardData.card.meaning;
                        const orientation = cardData.reversed ? 'Invertida' : 'Normal';
                        
                        content.innerHTML = \`
                            <div style="text-align: center; margin-bottom: 20px;">
                                <div style="font-size: 48px; margin-bottom: 10px;">\${cardData.card.symbol}</div>
                                <h2 style="margin: 0; color: var(--dourado);">\${cardData.card.name}</h2>
                                <div style="font-size: 14px; color: #ccc; margin-top: 5px;">
                                    \${cardData.position} ‚Ä¢ \${orientation}
                                </div>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                <h3 style="margin: 0 0 10px 0; color: var(--dourado);">Significado:</h3>
                                <p style="margin: 0; line-height: 1.5;">\${meaning}</p>
                            </div>
                            
                            <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px;">
                                <h3 style="margin: 0 0 10px 0; color: var(--dourado);">Conselho M√≠stico:</h3>
                                <p style="margin: 0; line-height: 1.5; font-style: italic;">
                                    \${generateMysticalAdvice(cardData)}
                                </p>
                            </div>
                        \`;
                        
                        modal.style.display = 'block';
                    }
                    
                    // Mostrar interpreta√ß√£o do spread completo
                    function showSpreadInterpretation(spread, title) {
                        const modal = document.getElementById('tarotModal');
                        const content = document.getElementById('modalContent');
                        
                        let cardsHtml = '';
                        spread.forEach(cardData => {
                            const meaning = cardData.reversed ? cardData.card.reversed : cardData.card.meaning;
                            const orientation = cardData.reversed ? '‚Üª' : '';
                            
                            cardsHtml += \`
                                <div style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                                        <span style="font-size: 20px; margin-right: 10px;">\${cardData.card.symbol}</span>
                                        <div>
                                            <strong style="color: var(--dourado);">\${cardData.position}:</strong>
                                            <span style="margin-left: 5px;">\${cardData.card.name} \${orientation}</span>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #ccc; margin-left: 30px;">
                                        \${meaning}
                                    </div>
                                </div>
                            \`;
                        });
                        
                        content.innerHTML = \`
                            <div style="text-align: center; margin-bottom: 20px;">
                                <h2 style="margin: 0; color: var(--dourado);">\${title}</h2>
                                <div style="font-size: 14px; color: #ccc; margin-top: 5px;">
                                    \${spread.length} cartas reveladas
                                </div>
                            </div>
                            
                            <div style="max-height: 300px; overflow-y: auto; margin-bottom: 15px;">
                                \${cardsHtml}
                            </div>
                            
                            <div style="background: rgba(218,165,32,0.2); padding: 15px; border-radius: 10px; border: 1px solid var(--dourado);">
                                <h3 style="margin: 0 0 10px 0; color: var(--dourado);">S√≠ntese da Leitura:</h3>
                                <p style="margin: 0; line-height: 1.5; font-style: italic;">
                                    \${generateSpreadSynthesis(spread, title)}
                                </p>
                            </div>
                        \`;
                        
                        modal.style.display = 'block';
                    }
                    
                    // Gerar conselho m√≠stico
                    function generateMysticalAdvice(cardData) {
                        const advices = {
                            0: 'Confie em sua intui√ß√£o e abrace novos come√ßos com coragem.',
                            1: 'Use seu poder pessoal para manifestar seus desejos.',
                            2: 'Ou√ßa sua voz interior e confie em sua sabedoria.',
                            3: 'Nutra seus projetos criativos e permita que flores√ßam.',
                            4: 'Estabele√ßa estruturas s√≥lidas para alcan√ßar seus objetivos.',
                            5: 'Busque orienta√ß√£o em tradi√ß√µes e ensinamentos antigos.',
                            6: 'Fa√ßa escolhas baseadas no amor e na harmonia.',
                            7: 'Mantenha o foco e a determina√ß√£o em sua jornada.',
                            8: 'Use sua for√ßa interior para superar desafios.',
                            9: 'Reserve tempo para reflex√£o e busca interior.',
                            10: 'Aceite as mudan√ßas como parte do ciclo natural.',
                            11: 'Aja com justi√ßa e assuma responsabilidade por suas a√ß√µes.',
                            12: 'Veja as situa√ß√µes de uma nova perspectiva.',
                            13: 'Permita que transforma√ß√µes necess√°rias aconte√ßam.',
                            14: 'Busque equil√≠brio e modera√ß√£o em todas as coisas.',
                            15: 'Liberte-se de v√≠cios e limita√ß√µes autoimposta.',
                            16: 'Prepare-se para mudan√ßas s√∫bitas e revela√ß√µes.',
                            17: 'Mantenha a esperan√ßa e siga sua estrela guia.',
                            18: 'Confie em sua intui√ß√£o para navegar pela incerteza.',
                            19: 'Celebre suas conquistas e irradie positividade.',
                            20: 'Ou√ßa seu chamado interior para renascimento.',
                            21: 'Celebre a completude de um ciclo importante.'
                        };
                        
                        return advices[cardData.id] || 'As cartas sussurram segredos antigos para quem sabe escutar.';
                    }
                    
                    // Gerar s√≠ntese do spread
                    function generateSpreadSynthesis(spread, title) {
                        const syntheses = {
                            'Leitura Passado/Presente/Futuro': 'Sua jornada mostra uma evolu√ß√£o natural. O passado moldou quem voc√™ √© hoje, e o futuro aguarda suas escolhas conscientes.',
                            'Leitura do Amor': 'O amor flui atrav√©s de m√∫ltiplas dimens√µes. Compreenda seu cora√ß√£o para atrair relacionamentos harmoniosos.',
                            'Cruz Celta': 'Esta leitura complexa revela as m√∫ltiplas for√ßas em a√ß√£o em sua vida. Cada carta oferece uma pe√ßa do quebra-cabe√ßas c√≥smico.'
                        };
                        
                        return syntheses[title] || 'As energias m√≠sticas se alinham para revelar verdades ocultas sobre seu caminho.';
                    }
                    
                    // Limpar mesa
                    function clearTable() {
                        const spreadDiv = document.getElementById('cardSpread');
                        if (spreadDiv) {
                            spreadDiv.innerHTML = '<div class="no-cards" style="text-align: center; color: rgba(255,255,255,0.5); font-style: italic;">Escolha um tipo de leitura para come√ßar...</div>';
                        }
                        currentSpread = [];
                    }
                    
                    // Fechar modal
                    function closeTarotModal() {
                        document.getElementById('tarotModal').style.display = 'none';
                    }
                    
                    // Atualizar estat√≠sticas
                    function updateTarotStats() {
                        const readingsEl = document.getElementById('tarotReadings');
                        const accuracyEl = document.getElementById('tarotAccuracy');
                        const energyEl = document.getElementById('tarotEnergy');
                        
                        if (readingsEl) readingsEl.textContent = tarotReadings;
                        if (accuracyEl) accuracyEl.textContent = Math.min(100, tarotReadings * 5) + '%';
                        if (energyEl) energyEl.textContent = tarotEnergy;
                        
                        // Regenerar energia lentamente
                        if (tarotEnergy < 100) {
                            setTimeout(() => {
                                tarotEnergy = Math.min(100, tarotEnergy + 1);
                                updateTarotStats();
                            }, 30000); // 1 energia por 30 segundos
                        }
                    }
                    
                    // Adicionar estilos CSS para anima√ß√µes
                    const style = document.createElement('style');
                    style.textContent = \`
                        @keyframes cardFlip {
                            0% { transform: rotateY(180deg); }
                            100% { transform: rotateY(0deg); }
                        }
                        
                        .tarot-card:hover {
                            transform: scale(1.05) !important;
                            box-shadow: 0 0 20px rgba(218,165,32,0.5) !important;
                        }
                    \`;
                    document.head.appendChild(style);
                    
                    // Inicializar quando a aplica√ß√£o for carregada
                    setTimeout(initTarotGame, 100);
                </script>
            `;
        }
        
        function generateCalculatorApp() {
            return `
                <div style="padding: 20px; background: #c0c0c0; height: 100%; font-family: 'MS Sans Serif', sans-serif;">
                    <div style="background: white; border: 2px inset #c0c0c0; padding: 10px; margin-bottom: 10px; text-align: right; font-size: 18px; font-family: monospace;">
                        <div id="calc-display">0</div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px;">
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="clearCalc()">C</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('/')">/</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('*')">*</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('-')">-</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('7')">7</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('8')">8</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('9')">9</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer; grid-row: span 2;" onclick="calcInput('+')">+</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('4')">4</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('5')">5</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('6')">6</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('1')">1</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('2')">2</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('3')">3</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer; grid-row: span 2;" onclick="calcEquals()">=</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer; grid-column: span 2;" onclick="calcInput('0')">0</button>
                        <button style="background: #c0c0c0; border: 2px outset #c0c0c0; padding: 15px; cursor: pointer;" onclick="calcInput('.')">.</button>
                    </div>
                </div>
            `;
        }
        
        function generateDefaultApp(site) {
            return `
                <div style="padding: 40px; text-align: center; background: linear-gradient(135deg, var(--azul-escuro) 0%, var(--vinho) 100%); color: white; height: 100%;">
                    <div style="font-size: 64px; margin-bottom: 20px;">${site.icon}</div>
                    <h2>${site.name}</h2>
                    <p>Esta aplica√ß√£o m√≠stica est√° sendo desenvolvida...</p>
                    <p style="font-size: 12px; opacity: 0.8;">Em breve, novas funcionalidades ser√£o adicionadas!</p>
                    
                    <button style="background: var(--dourado); color: var(--azul-escuro); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; margin-top: 20px;">
                        ‚ú® Em Desenvolvimento
                    </button>
                </div>
            `;
        }
        
        // Fun√ß√µes da calculadora
        let calcExpression = '';
        let calcDisplay = '0';
        
        function calcInput(value) {
            if (calcDisplay === '0' && !isNaN(value)) {
                calcDisplay = value;
            } else {
                calcDisplay += value;
            }
            calcExpression += value;
            document.getElementById('calc-display').textContent = calcDisplay;
        }
        
        function clearCalc() {
            calcExpression = '';
            calcDisplay = '0';
            document.getElementById('calc-display').textContent = calcDisplay;
        }
        
        function calcEquals() {
            try {
                const result = eval(calcExpression);
                calcDisplay = result.toString();
                calcExpression = result.toString();
                document.getElementById('calc-display').textContent = calcDisplay;
            } catch (error) {
                calcDisplay = 'Erro';
                calcExpression = '';
                document.getElementById('calc-display').textContent = calcDisplay;
            }
        }
        
        // Fun√ß√µes do menu de contexto
        function showContextMenu(x, y) {
            const menu = document.getElementById('contextMenu');
            menu.style.display = 'block';
            menu.style.left = x + 'px';
            menu.style.top = y + 'px';
        }
        
        function hideContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
        }
        
        function refreshDesktop() {
            location.reload();
            hideContextMenu();
        }
        
        function arrangeIcons() {
            // Reorganizar √≠cones automaticamente
            generateDesktopIcons();
            hideContextMenu();
        }
        
        // Fun√ß√µes do menu iniciar
        function toggleStartMenu() {
            const menu = document.getElementById('startMenu');
            menu.classList.toggle('active');
        }
        
        function hideStartMenu() {
            document.getElementById('startMenu').classList.remove('active');
        }
        
        // ========================================
        // üé® SELETOR DE CORES DA BARRA DE TAREFAS
        // ========================================
        
        function openTaskbarColorSelector() {
            const popup = document.getElementById('taskbarColorPopup');
            hideAllPopups();
            popup.classList.add('active');
            
            // Marcar cor atual como selecionada
            const currentColor = getComputedStyle(document.documentElement).getPropertyValue('--theme-taskbar').trim();
            const colorOptions = document.querySelectorAll('.taskbar-color-option');
            colorOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.color === currentColor) {
                    option.classList.add('selected');
                }
            });
            
            // Configurar event listeners para as cores
            colorOptions.forEach(option => {
                option.onclick = () => selectTaskbarColor(option.dataset.color, option);
            });
            
            // Atualizar preview
            updateTaskbarPreview(currentColor);
        }
        
        function closeTaskbarColorSelector() {
            document.getElementById('taskbarColorPopup').classList.remove('active');
        }
        
        function selectTaskbarColor(color, element) {
            // Remover sele√ß√£o anterior
            document.querySelectorAll('.taskbar-color-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Selecionar nova cor
            element.classList.add('selected');
            
            // Aplicar cor
            applyTaskbarColor(color);
            
            // Atualizar preview
            updateTaskbarPreview(color);
        }
        
        function previewTaskbarColor(color) {
            updateTaskbarPreview(color);
        }
        
        function applyCustomTaskbarColor() {
            const color = document.getElementById('customTaskbarColor').value;
            applyTaskbarColor(color);
            updateTaskbarPreview(color);
            
            // Marcar como selecionada (remover outras sele√ß√µes)
            document.querySelectorAll('.taskbar-color-option').forEach(opt => {
                opt.classList.remove('selected');
            });
        }
        
        function applyTaskbarColor(color) {
            // Atualizar vari√°vel CSS
            document.documentElement.style.setProperty('--theme-taskbar', color);
            document.documentElement.style.setProperty('--theme-start-btn', color);
            
            // Salvar prefer√™ncia do usu√°rio
            if (currentUser) {
                if (!currentUser.settings) currentUser.settings = {};
                if (!currentUser.settings.theme) currentUser.settings.theme = {};
                currentUser.settings.theme.taskbarColor = color;
                saveUserSettings();
            }
            
            console.log('üé® Cor da barra de tarefas alterada para:', color);
        }
        
        function updateTaskbarPreview(color) {
            const preview = document.getElementById('taskbarPreview');
            if (preview) {
                preview.style.background = color;
            }
        }
        
        // ========================================
        // ‚≠ê SISTEMA DE APLICA√á√ïES RECENTES E FAVORITOS
        // ========================================
        
        let recentApps = [];
        let favoriteApps = [];
        
        function addToRecentApps(app) {
            // Remover se j√° existe
            recentApps = recentApps.filter(recent => recent.id !== app.id);
            
            // Adicionar no in√≠cio
            recentApps.unshift({
                id: app.id,
                name: app.name,
                icon: app.icon,
                url: app.url,
                timestamp: Date.now()
            });
            
            // Manter apenas os 8 mais recentes
            recentApps = recentApps.slice(0, 8);
            
            // Salvar no localStorage
            localStorage.setItem('auroraOS_recentApps', JSON.stringify(recentApps));
            
            // Atualizar interface
            updateRecentAppsList();
        }
        
        function updateRecentAppsList() {
            const container = document.getElementById('recentAppsList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (recentApps.length === 0) {
                container.innerHTML = '<div style="color: rgba(255,255,255,0.5); font-size: 11px; text-align: center;">Nenhum app recente</div>';
                return;
            }
            
            recentApps.forEach(app => {
                const item = document.createElement('div');
                item.className = 'recent-app-item';
                item.innerHTML = `
                    <span class="recent-app-icon">${app.icon}</span>
                    <span class="recent-app-name">${app.name}</span>
                    <span class="favorite-star ${favoriteApps.some(fav => fav.id === app.id) ? 'active' : ''}" 
                          onclick="toggleFavorite('${app.id}', event)">‚≠ê</span>
                `;
                
                item.onclick = (e) => {
                    if (!e.target.classList.contains('favorite-star')) {
                        openSite(app);
                        hideStartMenu();
                    }
                };
                
                container.appendChild(item);
            });
        }
        
        function toggleFavorite(appId, event) {
            event.stopPropagation();
            
            const app = recentApps.find(app => app.id === appId) || 
                       sites.find(site => site.id === appId);
            
            if (!app) return;
            
            const isFavorite = favoriteApps.some(fav => fav.id === appId);
            
            if (isFavorite) {
                // Remover dos favoritos
                favoriteApps = favoriteApps.filter(fav => fav.id !== appId);
            } else {
                // Adicionar aos favoritos
                favoriteApps.push({
                    id: app.id,
                    name: app.name,
                    icon: app.icon,
                    url: app.url
                });
            }
            
            // Salvar no localStorage
            localStorage.setItem('auroraOS_favoriteApps', JSON.stringify(favoriteApps));
            
            // Atualizar interfaces
            updateRecentAppsList();
            updateFavoritesList();
        }
        
        function updateFavoritesList() {
            const container = document.getElementById('favoritesList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (favoriteApps.length === 0) {
                container.innerHTML = '<div style="color: rgba(255,255,255,0.5); font-size: 11px; text-align: center;">Nenhum favorito</div>';
                return;
            }
            
            favoriteApps.forEach(app => {
                const item = document.createElement('div');
                item.className = 'favorite-item';
                item.innerHTML = `
                    <span class="favorite-icon">${app.icon}</span>
                    <span class="favorite-name">${app.name}</span>
                    <span class="favorite-star active" onclick="toggleFavorite('${app.id}', event)">‚≠ê</span>
                `;
                
                item.onclick = (e) => {
                    if (!e.target.classList.contains('favorite-star')) {
                        openSite(app);
                        hideStartMenu();
                    }
                };
                
                container.appendChild(item);
            });
        }
        
        function loadRecentAndFavorites() {
            // Carregar aplica√ß√µes recentes
            const savedRecent = localStorage.getItem('auroraOS_recentApps');
            if (savedRecent) {
                recentApps = JSON.parse(savedRecent);
                updateRecentAppsList();
            }
            
            // Carregar favoritos
            const savedFavorites = localStorage.getItem('auroraOS_favoriteApps');
            if (savedFavorites) {
                favoriteApps = JSON.parse(savedFavorites);
                updateFavoritesList();
            }
        }
        
        // ========================================
        // üìÅ PASTA DOCUMENTOS E PROCESSADOR DE TEXTO
        // ========================================
        
        function openDocuments() {
            hideStartMenu();
            
            // Verificar se janela j√° est√° aberta
            if (document.getElementById('window-documents')) {
                focusWindow('window-documents');
                return;
            }
            
            const window = createWindow('documents', 'üìÅ Documentos', 'documents');
            window.innerHTML = `
                <div class="window-header">
                    <div class="window-title">
                        <span>üìÅ</span>
                        <span>Documentos</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control" onclick="minimizeWindow('window-documents')">_</div>
                        <div class="window-control" onclick="maximizeWindow('window-documents')">‚ñ°</div>
                        <div class="window-control close" onclick="closeWindow('window-documents')">√ó</div>
                    </div>
                </div>
                <div class="window-content" style="padding: 20px;">
                    <div class="documents-toolbar">
                        <button onclick="createNewDocument()" class="doc-btn">üìÑ Novo Documento</button>
                        <button onclick="openTextProcessor()" class="doc-btn">üìù Processador de Texto</button>
                        <button onclick="refreshDocuments()" class="doc-btn">üîÑ Atualizar</button>
                    </div>
                    <div class="documents-list" id="documentsList">
                        <!-- Lista de documentos ser√° carregada aqui -->
                    </div>
                </div>
            `;
            
            // Carregar documentos salvos
            loadDocumentsList();
        }
        
        function openTextProcessor() {
            hideStartMenu();
            
            // Verificar se janela j√° est√° aberta
            if (document.getElementById('window-textprocessor')) {
                focusWindow('window-textprocessor');
                return;
            }
            
            const window = createWindow('textprocessor', 'üìù Processador de Texto', 'textprocessor');
            window.innerHTML = `
                <div class="window-header">
                    <div class="window-title">
                        <span>üìù</span>
                        <span>Processador de Texto</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control" onclick="minimizeWindow('window-textprocessor')">_</div>
                        <div class="window-control" onclick="maximizeWindow('window-textprocessor')">‚ñ°</div>
                        <div class="window-control close" onclick="closeWindow('window-textprocessor')">√ó</div>
                    </div>
                </div>
                <div class="window-content" style="padding: 0;">
                    <div class="text-processor-toolbar">
                        <button onclick="newDocument()" title="Novo">üìÑ</button>
                        <button onclick="saveDocument()" title="Salvar">üíæ</button>
                        <button onclick="openDocument()" title="Abrir">üìÇ</button>
                        <span class="toolbar-separator">|</span>
                        <button onclick="formatBold()" title="Negrito"><b>B</b></button>
                        <button onclick="formatItalic()" title="It√°lico"><i>I</i></button>
                        <button onclick="formatUnderline()" title="Sublinhado"><u>U</u></button>
                        <span class="toolbar-separator">|</span>
                        <select onchange="changeFontSize(this.value)">
                            <option value="12">12px</option>
                            <option value="14" selected>14px</option>
                            <option value="16">16px</option>
                            <option value="18">18px</option>
                            <option value="20">20px</option>
                        </select>
                    </div>
                    <div class="text-editor-container">
                        <textarea id="textEditor" class="text-editor" placeholder="Digite seu texto aqui..."></textarea>
                    </div>
                </div>
            `;
        }
        
        // ========================================
        // üñºÔ∏è GALERIA DE IMAGENS
        // ========================================
        
        let galleryImages = [];
        
        function openGallery() {
            // Verificar se janela j√° est√° aberta
            if (document.getElementById('window-gallery')) {
                focusWindow('window-gallery');
                return;
            }
            
            const window = createWindow('gallery', 'üñºÔ∏è Galeria', 'gallery');
            window.className += ' gallery-window';
            window.innerHTML = `
                <div class="window-header">
                    <div class="window-title">
                        <span>üñºÔ∏è</span>
                        <span>Galeria de Imagens</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control" onclick="minimizeWindow('window-gallery')">_</div>
                        <div class="window-control" onclick="maximizeWindow('window-gallery')">‚ñ°</div>
                        <div class="window-control close" onclick="closeWindow('window-gallery')">√ó</div>
                    </div>
                </div>
                <div class="window-content" style="padding: 0;">
                    <div class="gallery-toolbar">
                        <div class="gallery-info">
                            <span id="galleryCount">0 imagens</span>
                        </div>
                        <div class="gallery-controls">
                            <button class="gallery-btn" onclick="uploadToGallery()">üì§ Upload</button>
                            <button class="gallery-btn" onclick="refreshGallery()">üîÑ Atualizar</button>
                            <button class="gallery-btn" onclick="clearGallery()">üóëÔ∏è Limpar</button>
                        </div>
                    </div>
                    <div class="gallery-grid" id="galleryGrid">
                        <!-- Imagens ser√£o carregadas aqui -->
                    </div>
                </div>
            `;
            
            // Carregar imagens da galeria
            loadGalleryImages();
        }
        
        function loadGalleryImages() {
            const savedImages = localStorage.getItem('auroraOS_gallery');
            if (savedImages) {
                galleryImages = JSON.parse(savedImages);
            }
            
            // Adicionar wallpapers padr√£o √† galeria
            const defaultWallpapers = [
                { name: 'Nebulosa M√≠stica', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAgMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxyYWRpYWxHcmFkaWVudCBpZD0iYSIgY3g9IjUwJSIgY3k9IjUwJSIgcj0iNTAlIj48c3RvcCBzdG9wLWNvbG9yPSIjM2UwYTI5Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMGIxODM2Ii8+PC9yYWRpYWxHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNhKSIvPjwvc3ZnPg==', type: 'default' },
                { name: 'Cosmos Dourado', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAgMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agc3RvcC1jb2xvcj0iI2YwYWE1MyIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzNlMGEyOSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjYikiLz48L3N2Zz4=', type: 'default' }
            ];
            
            // Adicionar wallpapers padr√£o se n√£o existirem
            defaultWallpapers.forEach(wallpaper => {
                if (!galleryImages.some(img => img.name === wallpaper.name)) {
                    galleryImages.push(wallpaper);
                }
            });
            
            updateGalleryDisplay();
        }
        
        function updateGalleryDisplay() {
            const grid = document.getElementById('galleryGrid');
            const count = document.getElementById('galleryCount');
            
            if (!grid || !count) return;
            
            count.textContent = `${galleryImages.length} imagens`;
            grid.innerHTML = '';
            
            if (galleryImages.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: rgba(255,255,255,0.5);">
                        <div style="font-size: 48px; margin-bottom: 15px;">üñºÔ∏è</div>
                        <div>Nenhuma imagem na galeria</div>
                        <div style="font-size: 12px; margin-top: 10px;">Clique em "Upload" para adicionar imagens</div>
                    </div>
                `;
                return;
            }
            
            galleryImages.forEach((image, index) => {
                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.innerHTML = `
                    <img src="${image.url}" alt="${image.name}" loading="lazy">
                    <div class="gallery-item-overlay">
                        <div>${image.name}</div>
                        <div style="font-size: 10px; opacity: 0.7;">${image.type || 'Personalizada'}</div>
                    </div>
                `;
                
                item.onclick = () => viewImageFullscreen(image, index);
                grid.appendChild(item);
            });
        }
        
        function uploadToGallery() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = true;
            
            input.onchange = (e) => {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = (event) => {
                            const newImage = {
                                name: file.name,
                                url: event.target.result,
                                type: 'upload',
                                size: file.size,
                                uploadDate: new Date().toISOString()
                            };
                            
                            galleryImages.push(newImage);
                            localStorage.setItem('auroraOS_gallery', JSON.stringify(galleryImages));
                            updateGalleryDisplay();
                        };
                        reader.readAsDataURL(file);
                    }
                });
            };
            
            input.click();
        }
        
        function refreshGallery() {
            loadGalleryImages();
        }
        
        function clearGallery() {
            if (confirm('Tem certeza que deseja limpar toda a galeria? Esta a√ß√£o n√£o pode ser desfeita.')) {
                galleryImages = [];
                localStorage.removeItem('auroraOS_gallery');
                updateGalleryDisplay();
            }
        }
        
        function viewImageFullscreen(image, index) {
            // Implementar visualizador fullscreen
            console.log('Visualizando imagem:', image.name);
        }
        
        // ========================================
        // üåå GERENCIADOR DE WALLPAPERS AVAN√áADO
        // ========================================
        
        let customWallpapers = [];
        
        function openWallpaperManager() {
            // Verificar se janela j√° est√° aberta
            if (document.getElementById('window-wallpaper-manager')) {
                focusWindow('window-wallpaper-manager');
                return;
            }
            
            const window = createWindow('wallpaper-manager', 'üåå Wallpapers', 'wallpaper-manager');
            window.className += ' wallpaper-manager';
            window.innerHTML = `
                <div class="window-header">
                    <div class="window-title">
                        <span>üåå</span>
                        <span>Gerenciador de Wallpapers</span>
                    </div>
                    <div class="window-controls">
                        <div class="window-control" onclick="minimizeWindow('window-wallpaper-manager')">_</div>
                        <div class="window-control" onclick="maximizeWindow('window-wallpaper-manager')">‚ñ°</div>
                        <div class="window-control close" onclick="closeWindow('window-wallpaper-manager')">√ó</div>
                    </div>
                </div>
                <div class="window-content" style="padding: 0;">
                    <div class="wallpaper-upload-zone" onclick="uploadWallpaper()" ondrop="handleWallpaperDrop(event)" ondragover="handleWallpaperDragOver(event)">
                        <div class="wallpaper-upload-icon">üåå</div>
                        <div class="wallpaper-upload-text">Adicionar Novo Wallpaper</div>
                        <div class="wallpaper-upload-hint">Clique aqui ou arraste uma imagem (JPG, PNG, GIF)</div>
                    </div>
                    <div class="wallpaper-preview-grid" id="wallpaperPreviewGrid">
                        <!-- Wallpapers ser√£o carregados aqui -->
                    </div>
                </div>
            `;
            
            // Carregar wallpapers
            loadWallpaperPreviews();
        }
        
        function loadWallpaperPreviews() {
            const savedWallpapers = localStorage.getItem('auroraOS_customWallpapers');
            if (savedWallpapers) {
                customWallpapers = JSON.parse(savedWallpapers);
            }
            
            // Wallpapers padr√£o
            const defaultWallpapers = [
                { name: 'Nebulosa M√≠stica', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAgMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxyYWRpYWxHcmFkaWVudCBpZD0iYSIgY3g9IjUwJSIgY3k9IjUwJSIgcj0iNTAlIj48c3RvcCBzdG9wLWNvbG9yPSIjM2UwYTI5Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMGIxODM2Ii8+PC9yYWRpYWxHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNhKSIvPjwvc3ZnPg==', type: 'default', active: true },
                { name: 'Cosmos Dourado', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAgMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agc3RvcC1jb2xvcj0iI2YwYWE1MyIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzNlMGEyOSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjYikiLz48L3N2Zz4=', type: 'default' },
                { name: 'Violeta Profundo', url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAgMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYyIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+PHN0b3Agc3RvcC1jb2xvcj0iIzJkMWI2OSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzBiMTgzNiIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjYykiLz48L3N2Zz4=', type: 'default' }
            ];
            
            updateWallpaperPreviewGrid([...defaultWallpapers, ...customWallpapers]);
        }
        
        function updateWallpaperPreviewGrid(wallpapers) {
            const grid = document.getElementById('wallpaperPreviewGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            wallpapers.forEach((wallpaper, index) => {
                const preview = document.createElement('div');
                preview.className = `wallpaper-preview ${wallpaper.active ? 'active' : ''}`;
                preview.innerHTML = `
                    <img src="${wallpaper.url}" alt="${wallpaper.name}" loading="lazy">
                    <div class="wallpaper-preview-overlay">
                        <div class="wallpaper-preview-actions">
                            <button class="wallpaper-action-btn" onclick="applyWallpaper('${wallpaper.url}', '${wallpaper.name}')">‚úì Aplicar</button>
                            ${wallpaper.type !== 'default' ? `<button class="wallpaper-action-btn" onclick="deleteWallpaper(${index})">üóëÔ∏è Excluir</button>` : ''}
                        </div>
                    </div>
                `;
                
                grid.appendChild(preview);
            });
        }
        
        function uploadWallpaper() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const newWallpaper = {
                            name: file.name,
                            url: event.target.result,
                            type: 'custom',
                            uploadDate: new Date().toISOString()
                        };
                        
                        customWallpapers.push(newWallpaper);
                        localStorage.setItem('auroraOS_customWallpapers', JSON.stringify(customWallpapers));
                        loadWallpaperPreviews();
                    };
                    reader.readAsDataURL(file);
                }
            };
            
            input.click();
        }
        
        function handleWallpaperDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }
        
        function handleWallpaperDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files);
            files.forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const newWallpaper = {
                            name: file.name,
                            url: event.target.result,
                            type: 'custom',
                            uploadDate: new Date().toISOString()
                        };
                        
                        customWallpapers.push(newWallpaper);
                        localStorage.setItem('auroraOS_customWallpapers', JSON.stringify(customWallpapers));
                        loadWallpaperPreviews();
                    };
                    reader.readAsDataURL(file);
                }
            });
        }
        
        function applyWallpaper(url, name) {
            document.body.style.backgroundImage = `url(${url})`;
            document.body.style.backgroundSize = 'cover';
            document.body.style.backgroundPosition = 'center';
            document.body.style.backgroundRepeat = 'no-repeat';
            
            // Salvar wallpaper atual
            if (currentUser) {
                if (!currentUser.settings) currentUser.settings = {};
                currentUser.settings.customWallpaper = url;
                currentUser.settings.wallpaperName = name;
                saveUserSettings();
            }
            
            // Atualizar previews
            document.querySelectorAll('.wallpaper-preview').forEach(preview => {
                preview.classList.remove('active');
            });
            
            // Marcar como ativo
            const activePreview = Array.from(document.querySelectorAll('.wallpaper-preview img')).find(img => img.src === url);
            if (activePreview) {
                activePreview.closest('.wallpaper-preview').classList.add('active');
            }
            
            console.log('üåå Wallpaper aplicado:', name);
        }
        
        function deleteWallpaper(index) {
            if (confirm('Tem certeza que deseja excluir este wallpaper?')) {
                customWallpapers.splice(index, 1);
                localStorage.setItem('auroraOS_customWallpapers', JSON.stringify(customWallpapers));
                loadWallpaperPreviews();
            }
        }
        
        // ========================================
        // ‚ú® SISTEMA DE PART√çCULAS DIN√ÇMICAS
        // ========================================
        
        function initDynamicParticles() {
            const desktop = document.getElementById('desktop');
            if (!desktop) return;
            
            // Criar container de part√≠culas se n√£o existir
            let particlesContainer = document.getElementById('desktopParticles');
            if (!particlesContainer) {
                particlesContainer = document.createElement('div');
                particlesContainer.id = 'desktopParticles';
                particlesContainer.className = 'mystical-particles';
                desktop.appendChild(particlesContainer);
            }
            
            // Gerar part√≠culas periodicamente
            setInterval(() => {
                if (Math.random() < 0.3) { // 30% de chance
                    createParticle(particlesContainer);
                }
            }, 2000);
        }
        
        function createParticle(container) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            // Posi√ß√£o aleat√≥ria
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 2 + 's';
            particle.style.animationDuration = (4 + Math.random() * 4) + 's';
            
            container.appendChild(particle);
            
            // Remover part√≠cula ap√≥s anima√ß√£o
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.parentNode.removeChild(particle);
                }
            }, 8000);
        }
        
        // Fun√ß√µes dos popups
        function toggleCalendarPopup() {
            const popup = document.getElementById('calendarPopup');
            hideAllPopups();
            popup.classList.toggle('active');
            if (popup.classList.contains('active')) {
                generateCalendar();
            }
        }
        
        function toggleVolumePopup() {
            const popup = document.getElementById('volumePopup');
            hideAllPopups();
            popup.classList.toggle('active');
        }
        
        function togglePlanetaryPopup() {
            const popup = document.getElementById('planetaryPopup');
            hideAllPopups();
            popup.classList.toggle('active');
        }
        
        function toggleNotifications() {
            // Implementar sistema de notifica√ß√µes
            console.log('Sistema de notifica√ß√µes em desenvolvimento');
        }
        
        function hideAllPopups() {
            document.querySelectorAll('.popup').forEach(popup => {
                popup.classList.remove('active');
            });
        }
        
        // Fun√ß√µes do calend√°rio
        function generateCalendar() {
            const grid = document.getElementById('calendarGrid');
            const title = document.getElementById('calendarTitle');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            title.textContent = currentDate.toLocaleDateString('pt-BR', { 
                month: 'long', 
                year: 'numeric' 
            });
            
            grid.innerHTML = '';
            
            // Cabe√ßalhos dos dias da semana
            const dayHeaders = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];
            dayHeaders.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-day-header';
                header.textContent = day;
                grid.appendChild(header);
            });
            
            // Primeiro dia do m√™s e √∫ltimo dia
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const today = new Date();
            
            // Dias vazios no in√≠cio
            for (let i = 0; i < firstDay.getDay(); i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day other-month';
                grid.appendChild(emptyDay);
            }
            
            // Dias do m√™s
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                
                // Marcar dia atual
                if (year === today.getFullYear() && 
                    month === today.getMonth() && 
                    day === today.getDate()) {
                    dayElement.classList.add('today');
                }
                
                grid.appendChild(dayElement);
            }
        }
        
        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
        }
        
        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
        }
        
        // Fun√ß√µes de volume
        function setVolume(event, type) {
            const slider = event.currentTarget;
            const rect = slider.getBoundingClientRect();
            const percentage = ((event.clientX - rect.left) / rect.width) * 100;
            const clampedPercentage = Math.max(0, Math.min(100, percentage));
            
            volumes[type] = clampedPercentage;
            
            const fill = document.getElementById(`${type}VolumeFill`);
            const thumb = document.getElementById(`${type}VolumeThumb`);
            
            fill.style.width = clampedPercentage + '%';
            thumb.style.left = clampedPercentage + '%';
            
            // Notificar Gatomante sobre mudan√ßa de volume (apenas para master)
            if (type === 'master') {
                setTimeout(() => {
                    gatomanteContextual('volume_mudou');
                }, 500);
            }
        }
        
        // Fun√ß√µes de personaliza√ß√£o
        function openPersonalization() {
            document.getElementById('personalizationModal').classList.add('active');
            hideContextMenu();
            
            // Notificar Gatomante sobre personaliza√ß√£o
            setTimeout(() => {
                gatomanteContextual('personalizacao');
            }, 2000);
        }
        
        function closePersonalization() {
            document.getElementById('personalizationModal').classList.remove('active');
        }
        
        function selectColorTheme(index) {
            currentTheme = index;
            applyColorTheme();
            
            // Atualizar sele√ß√£o visual
            document.querySelectorAll('.color-option').forEach((option, i) => {
                option.classList.toggle('selected', i === index);
            });
            
            // Notificar Gatomante sobre mudan√ßa de tema
            setTimeout(() => {
                gatomanteContextual('tema_mudou');
                trackUserActivity('theme_changed');
                detectarConquistas();
            }, 1000);
        }
        
        function selectWallpaper(index) {
            currentWallpaper = index;
            applyWallpaper();
            
            // Atualizar sele√ß√£o visual
            document.querySelectorAll('.wallpaper-preset').forEach((preset, i) => {
                preset.classList.toggle('selected', i === index);
            });
        }
        
        function applyColorTheme() {
            const theme = colorThemes[currentTheme];
            const root = document.documentElement;
            
            root.style.setProperty('--vinho', theme.primary);
            root.style.setProperty('--azul-escuro', theme.secondary);
            root.style.setProperty('--dourado', theme.accent);
            root.style.setProperty('--theme-taskbar', theme.primary);
            root.style.setProperty('--theme-start-btn', theme.primary);
            root.style.setProperty('--theme-start-text', theme.accent);
            root.style.setProperty('--theme-clock', theme.accent);
            root.style.setProperty('--theme-window-header', theme.secondary);
        }
        
        function applyWallpaper() {
            const wallpaper = wallpaperPresets[currentWallpaper];
            const root = document.documentElement;
            
            root.style.setProperty('--theme-bg', wallpaper.gradient);
            document.body.style.background = wallpaper.gradient;
            document.querySelector('.desktop').style.background = wallpaper.gradient;
        }
        
        function uploadWallpaper(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageUrl = e.target.result;
                    document.body.style.backgroundImage = `url(${imageUrl})`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    document.querySelector('.desktop').style.backgroundImage = `url(${imageUrl})`;
                    document.querySelector('.desktop').style.backgroundSize = 'cover';
                    document.querySelector('.desktop').style.backgroundPosition = 'center';
                };
                reader.readAsDataURL(file);
            }
        }
        
        function togglePlanetaryWidget() {
            const widget = document.querySelector('.taskbar-widget');
            const checkbox = document.getElementById('showPlanetaryWidget');
            widget.style.display = checkbox.checked ? 'flex' : 'none';
        }
        
        function toggleNotifications() {
            const icon = document.querySelector('.notification-icon');
            const checkbox = document.getElementById('showNotifications');
            icon.style.display = checkbox.checked ? 'block' : 'none';
        }
        
        function toggleVolumeControl() {
            const icon = document.querySelector('.volume-icon');
            const checkbox = document.getElementById('showVolumeControl');
            icon.style.display = checkbox.checked ? 'block' : 'none';
        }
        
        function savePersonalization() {
            const settings = {
                theme: currentTheme,
                wallpaper: currentWallpaper,
                showPlanetaryWidget: document.getElementById('showPlanetaryWidget').checked,
                showNotifications: document.getElementById('showNotifications').checked,
                showVolumeControl: document.getElementById('showVolumeControl').checked,
                volumes: volumes
            };
            
            // Salvar para usu√°rio logado ou localStorage
            if (currentUser) {
                saveUserSettings();
            } else {
                localStorage.setItem('auroraOS_settings', JSON.stringify(settings));
            }
            
            closePersonalization();
            
            // Mostrar notifica√ß√£o de sucesso
            console.log('Configura√ß√µes salvas com sucesso!');
        }
        
        function loadPersonalization() {
            let settings = null;
            
            // Carregar configura√ß√µes do usu√°rio logado ou localStorage
            if (currentUser && currentUser.settings) {
                settings = currentUser.settings;
            } else {
                const saved = localStorage.getItem('auroraOS_settings');
                if (saved) {
                    settings = JSON.parse(saved);
                }
            }
            
            if (settings) {
                currentTheme = settings.theme || 0;
                currentWallpaper = settings.wallpaper || 0;
                volumes = settings.volumes || volumes;
                
                applyColorTheme();
                applyWallpaper();
                
                // Aplicar configura√ß√µes de widgets
                if (settings.showPlanetaryWidget !== undefined) {
                    document.getElementById('showPlanetaryWidget').checked = settings.showPlanetaryWidget;
                    togglePlanetaryWidget();
                }
                
                if (settings.showNotifications !== undefined) {
                    document.getElementById('showNotifications').checked = settings.showNotifications;
                    toggleNotifications();
                }
                
                if (settings.showVolumeControl !== undefined) {
                    document.getElementById('showVolumeControl').checked = settings.showVolumeControl;
                    toggleVolumeControl();
                }
            }
        }
        
        function resetPersonalization() {
            localStorage.removeItem('auroraOS_settings');
            currentTheme = 0;
            currentWallpaper = 0;
            volumes = { master: 70, notifications: 50, system: 60 };
            
            applyColorTheme();
            applyWallpaper();
            
            // Resetar checkboxes
            document.getElementById('showPlanetaryWidget').checked = true;
            document.getElementById('showNotifications').checked = true;
            document.getElementById('showVolumeControl').checked = true;
            
            togglePlanetaryWidget();
            toggleNotifications();
            toggleVolumeControl();
            
            // Atualizar sele√ß√µes visuais
            generateColorPalette();
            generateWallpaperPresets();
        }
        
        // ========================================
        // üì∏ SISTEMA DE UPLOAD DE FOTO E WALLPAPER
        // ========================================
        
        function uploadProfilePhoto(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validar tipo de arquivo
            if (!file.type.startsWith('image/')) {
                alert('Por favor, selecione apenas arquivos de imagem.');
                return;
            }
            
            // Validar tamanho (m√°ximo 2MB para foto de perfil)
            if (file.size > 2 * 1024 * 1024) {
                alert('A imagem deve ter no m√°ximo 2MB.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageData = e.target.result;
                
                // Atualizar preview
                const preview = document.getElementById('profilePhotoPreview');
                preview.innerHTML = `<img src="${imageData}" alt="Foto de Perfil">`;
                
                // Salvar no localStorage
                if (currentUser) {
                    currentUser.profilePhoto = imageData;
                    userDatabase[currentUser.email] = currentUser;
                    localStorage.setItem('auroraOS_users', JSON.stringify(userDatabase));
                    sessionStorage.setItem('auroraOS_current_user', JSON.stringify(currentUser));
                }
                
                // Notificar Gatomante
                setTimeout(() => {
                    gatomanteContextual('personalizacao', { acao: 'foto de perfil atualizada' });
                }, 1500);
            };
            
            reader.readAsDataURL(file);
        }
        
        function removeProfilePhoto() {
            // Remover preview
            const preview = document.getElementById('profilePhotoPreview');
            preview.innerHTML = 'üë§';
            
            // Remover do usu√°rio
            if (currentUser) {
                delete currentUser.profilePhoto;
                userDatabase[currentUser.email] = currentUser;
                localStorage.setItem('auroraOS_users', JSON.stringify(userDatabase));
                sessionStorage.setItem('auroraOS_current_user', JSON.stringify(currentUser));
            }
            
            // Limpar input
            document.getElementById('profilePhotoInput').value = '';
        }
        
        function uploadWallpaper(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validar tipo de arquivo
            if (!file.type.startsWith('image/')) {
                alert('Por favor, selecione apenas arquivos de imagem.');
                return;
            }
            
            // Validar tamanho (m√°ximo 5MB para wallpaper)
            if (file.size > 5 * 1024 * 1024) {
                alert('A imagem deve ter no m√°ximo 5MB.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageData = e.target.result;
                
                // Mostrar preview
                const preview = document.getElementById('customWallpaperPreview');
                preview.style.display = 'block';
                preview.style.backgroundImage = `url(${imageData})`;
                
                // Aplicar wallpaper personalizado
                applyCustomWallpaper(imageData);
                
                // Notificar Gatomante
                setTimeout(() => {
                    gatomanteContextual('personalizacao', { acao: 'wallpaper personalizado aplicado' });
                }, 1500);
            };
            
            reader.readAsDataURL(file);
        }
        
        function applyCustomWallpaper(imageData) {
            // Aplicar wallpaper personalizado
            document.body.style.backgroundImage = `url(${imageData})`;
            document.body.style.backgroundSize = 'cover';
            document.body.style.backgroundPosition = 'center';
            document.body.style.backgroundRepeat = 'no-repeat';
            
            // Salvar configura√ß√£o
            const settings = {
                theme: currentTheme,
                wallpaper: 'custom',
                customWallpaper: imageData,
                volumes: volumes,
                showPlanetaryWidget: document.getElementById('showPlanetaryWidget').checked,
                showNotifications: document.getElementById('showNotifications').checked,
                showVolumeControl: document.getElementById('showVolumeControl').checked
            };
            
            if (currentUser) {
                currentUser.settings = settings;
                userDatabase[currentUser.email] = currentUser;
                localStorage.setItem('auroraOS_users', JSON.stringify(userDatabase));
            } else {
                localStorage.setItem('auroraOS_settings', JSON.stringify(settings));
            }
        }
        
        function applyCustomColor(colorValue) {
            // Aplicar cor personalizada como tema
            document.documentElement.style.setProperty('--theme-primary', colorValue);
            document.documentElement.style.setProperty('--theme-secondary', adjustBrightness(colorValue, -20));
            document.documentElement.style.setProperty('--theme-accent', adjustBrightness(colorValue, 20));
            
            // Atualizar input hex
            document.getElementById('colorHexInput').value = colorValue;
            
            // Salvar como tema personalizado
            currentTheme = 'custom';
            savePersonalization();
        }
        
        function applyCustomHex(hexValue) {
            if (hexValue.match(/^#[0-9A-F]{6}$/i)) {
                document.getElementById('customColorInput').value = hexValue;
                applyCustomColor(hexValue);
            }
        }
        
        function adjustBrightness(hex, percent) {
            // Fun√ß√£o auxiliar para ajustar brilho da cor
            const num = parseInt(hex.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) + amt;
            const G = (num >> 8 & 0x00FF) + amt;
            const B = (num & 0x0000FF) + amt;
            return "#" + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
        }
        
        function loadUserProfilePhoto() {
            if (currentUser && currentUser.profilePhoto) {
                const preview = document.getElementById('profilePhotoPreview');
                if (preview) {
                    preview.innerHTML = `<img src="${currentUser.profilePhoto}" alt="Foto de Perfil">`;
                }
            }
        }
        
        function loadCustomWallpaper() {
            const settings = currentUser ? currentUser.settings : JSON.parse(localStorage.getItem('auroraOS_settings') || '{}');
            
            if (settings.wallpaper === 'custom' && settings.customWallpaper) {
                document.body.style.backgroundImage = `url(${settings.customWallpaper})`;
                document.body.style.backgroundSize = 'cover';
                document.body.style.backgroundPosition = 'center';
                document.body.style.backgroundRepeat = 'no-repeat';
                
                // Mostrar preview no modal
                const preview = document.getElementById('customWallpaperPreview');
                if (preview) {
                    preview.style.display = 'block';
                    preview.style.backgroundImage = `url(${settings.customWallpaper})`;
                }
            }
        }
        
        // Sistema Gatomante - Assistente M√≠stico
        const gatomante = {
            nome: "Gatomante",
            estado: "ativo",
            humor: "sabio",
            ultimaAparicao: 0,
            dicasJaMostradas: [],
            
            // Base de conhecimento de dicas expandida
            dicas: {
                boasVindas: [
                    "Miau! Bem-vindo ao Aurora OS, humano... Vejo que voc√™ busca conhecimento m√≠stico.",
                    "Ah, mais um mortal adentrando os mist√©rios digitais. Permita-me gui√°-lo...",
                    "Sauda√ß√µes! Sou Gatomante, seu guia pelos caminhos esot√©ricos deste sistema.",
                    "As estrelas se alinharam para sua chegada... que interessante! üåü"
                ],
                boasVindasPersonalizada: [
                    "Ah, {nome}... as energias c√≥smicas sussurraram sua chegada!",
                    "Bem-vindo de volta, {nome}! Senti sua aura se aproximando...",
                    "Ol√°, {nome}! Espero que tenha trazido curiosidade para nossa jornada m√≠stica!",
                    "Miau, {nome}! Pronto para desvendar mais segredos digitais?"
                ],
                navegacao: [
                    "Clique com o bot√£o direito no desktop para personalizar... at√© um filhote saberia isso!",
                    "Arraste as janelas pela barra de t√≠tulo, n√£o √© magia negra, √© s√≥ tecnologia.",
                    "O widget planet√°rio mostra a hora atual... muito √∫til para rituais, n√£o acha?",
                    "Use o menu Iniciar para acessar seus aplicativos favoritos... elementar!"
                ],
                navegacaoPersonalizada: [
                    "Vejo que voc√™ gosta do tema {tema}, {nome}... excelente escolha m√≠stica!",
                    "Seus {numApps} aplicativos favoritos est√£o bem organizados, {nome}!",
                    "Notei que voc√™ usa muito o {appFavorito}... um verdadeiro conhecedor!",
                    "Que tal explorar algo novo hoje, {nome}? H√° mist√©rios inexplorados aqui!"
                ],
                misticas: [
                    "A hora planet√°ria mudou para {planeta}... momento prop√≠cio para {acao}!",
                    "As estrelas se alinham favoravelmente... que tal explorar algo novo?",
                    "Sinto energias de {planeta} no ar... perfeito para {atividade}!",
                    "A lua sussurra segredos... mas primeiro, que tal personalizar seu tema?"
                ],
                tecnicas: [
                    "Seus atalhos est√£o desorganizados... um verdadeiro caos c√≥smico!",
                    "Que tal personalizar seu tema? At√© gatos gostam de variedade.",
                    "O sistema de volume permite controlar cada aspecto... muito √∫til!",
                    "Voc√™ pode adicionar novos sites ao sistema... magia moderna!",
                    "Experimente o √°udio ambiente üéµ... sons m√≠sticos para elevar sua vibra√ß√£o!",
                    "As frequ√™ncias de cura podem harmonizar seus chakras digitais...",
                    "Sons de cristal ajudam na concentra√ß√£o... at√© gatos aprovam!"
                ],
                tecnicasPersonalizadas: [
                    "Vejo que voc√™ mudou o tema {vezes} vezes, {nome}... um verdadeiro artista m√≠stico!",
                    "Seu volume est√° em {volume}%... perfeito para rituais noturnos!",
                    "Voc√™ tem {numSites} sites configurados... impressionante cole√ß√£o digital!",
                    "Que tal experimentar o tema {sugestaoTema}? Combinaria com sua aura!"
                ],
                inatividade: [
                    "Hmm... parece que voc√™ est√° contemplando o vazio c√≥smico...",
                    "Posso ajud√°-lo com algo? Ou prefere continuar admirando minha eleg√¢ncia?",
                    "O tempo passa... como as areias de uma ampulheta m√≠stica...",
                    "Que tal explorar alguma funcionalidade? Estou aqui para gui√°-lo!"
                ],
                inactividadePersonalizada: [
                    "{nome}, as energias c√≥smicas sugerem uma pausa... ou a√ß√£o?",
                    "Vejo que voc√™ est√° meditando, {nome}... ou apenas procrastinando?",
                    "O {planeta} atual favorece {acao}, {nome}... que tal tentar?",
                    "Sua √∫ltima atividade foi {ultimaAcao}... pronto para algo novo?"
                ],
                conquistas: [
                    "Parab√©ns! Voc√™ desbloqueou o mist√©rio da personaliza√ß√£o!",
                    "Impressionante! Voc√™ dominou {numAcoes} funcionalidades m√≠sticas!",
                    "Excelente! Voc√™ se tornou um verdadeiro mago digital!",
                    "Fant√°stico! As estrelas celebram sua dedica√ß√£o!"
                ],
                dicas_avancadas: [
                    "Dica secreta: Pressione Ctrl+Shift+G para invocar poderes ocultos!",
                    "Mist√©rio revelado: O tema muda com as fases da lua... experimente!",
                    "Segredo ancestral: Clique 3 vezes no logo para easter eggs!",
                    "Conhecimento oculto: O widget planet√°rio prev√™ momentos prop√≠cios!"
                ],
                afast_alerts: [
                    "AF√ÅSTI! O sistema detectou {evento}... mantenha-se protegido!",
                    "Alerta m√≠stico: {evento} foi identificado pelo nosso antiv√≠rus astrol√≥gico!",
                    "Cuidado, {nome}! O AF√ÅST detectou energias de {evento}...",
                    "Prote√ß√£o ativada! {evento} n√£o passar√° despercebido pelo AF√ÅST!"
                ],
                afast_info: [
                    "O AF√ÅST √© nosso antiv√≠rus astrol√≥gico... protege contra energias c√≥smicas adversas!",
                    "Clique no escudo dourado üõ°Ô∏è para ver a central de notifica√ß√µes AF√ÅST!",
                    "O sistema AF√ÅST monitora eventos como Merc√∫rio retr√≥grado e eclipses...",
                    "Quando o AF√ÅST alerta, √© melhor prestar aten√ß√£o... confie em mim!"
                ],
                audio_ambiente: [
                    "Ah, voc√™ descobriu o √°udio ambiente! üéµ Sons m√≠sticos para elevar sua vibra√ß√£o...",
                    "Experimente as frequ√™ncias de cura... 528Hz √© a frequ√™ncia do amor!",
                    "Sons de cristal s√£o perfeitos para medita√ß√£o... at√© gatos ficam zen!",
                    "A floresta m√≠stica acalma a mente... ideal para trabalhos espirituais.",
                    "Mantras Om ressoam com o universo... uma vibra√ß√£o ancestral poderosa!",
                    "Frequ√™ncia 396Hz libera medos... muito √∫til para limpezas energ√©ticas.",
                    "O oceano sereno traz paz interior... como ronronar, mas para humanos!",
                    "Chuva relaxante limpa as energias... perfeita para rituais de purifica√ß√£o."
                ],
                workspaces: [
                    "Workspaces virtuais! üñ•Ô∏è Organize suas janelas como um verdadeiro mago digital...",
                    "Ctrl + 1-4 muda de workspace... atalhos que at√© gatos conseguem decorar!",
                    "Arraste janelas para as zonas douradas... snap autom√°tico √© pura magia!",
                    "Workspace {workspace} tem {janelas} janelas... uma organiza√ß√£o felina!",
                    "Snap para a esquerda, direita, cima, baixo ou centro... escolha sua posi√ß√£o m√≠stica!",
                    "Ctrl + Shift + 1-4 move janelas entre workspaces... produtividade ninja!",
                    "4 workspaces virtuais... como os 4 elementos da natureza!",
                    "Zonas de snap aparecem quando voc√™ arrasta... guias douradas para organiza√ß√£o perfeita!"
                ],
                chat_ia: [
                    "Descobriu meu chat! ü§ñ Agora podemos conversar de verdade... que evolu√ß√£o felina!",
                    "Use comandos de voz clicando no microfone üé§... tecnologia m√≠stica em a√ß√£o!",
                    "Posso executar comandos como 'abrir calculadora' ou 'workspace 2'... sou seu assistente digital!",
                    "Pergunte sobre qualquer funcionalidade do Aurora OS... tenho conhecimento infinito!",
                    "Digite 'piada' se quiser humor felino... ou 'ajuda' para comandos dispon√≠veis!",
                    "Reconhecimento de voz em portugu√™s brasileiro... finalmente algu√©m que me entende!",
                    "Chat inteligente + comandos de voz = Gatomante IA completo! üê±‚Äç‚¨õ‚ú®",
                    "Experimente falar 'hora planeta' ou 'mudar tema'... magia vocal pura!"
                ],
                demo_login: [
                    "Bem-vindo √† conta demo, Luna Mystica! Sou o Gatomante, seu guia m√≠stico pessoal.",
                    "Ol√°, Luna! Esta conta demo mostra todas as funcionalidades do Aurora OS... explore √† vontade!",
                    "Miau! Vejo que voc√™ √© de Le√£o com Lua em Escorpi√£o... uma combina√ß√£o poderosa!",
                    "Luna, sua conta demo tem mapa astral completo e hist√≥rico AF√ÅST... perfeito para explorar!"
                ],
                demo_features: [
                    "Esta conta demo tem 47 logins e 15 personaliza√ß√µes... veja como tudo funciona!",
                    "Seu perfil astrol√≥gico est√° completo: Sol em Le√£o, Lua em Escorpi√£o, Ascendente em Libra!",
                    "O sistema AF√ÅST j√° detectou 8 eventos astrol√≥gicos nesta conta... impressionante!",
                    "Explore o tema Roxo Imperial e o wallpaper Aurora... combinam com sua energia!"
                ]
            },
            
            // Sistema de contexto inteligente
            contexto: {
                usuarioLogado: false,
                nomeUsuario: '',
                tempoSessao: 0,
                acoesPorSessao: 0,
                temaAtual: 0,
                appsFavoritos: [],
                ultimaAcao: '',
                planetaAtual: 'Sol',
                numeroPersonalizacoes: 0,
                conquistasDesbloqueadas: []
            },
            
            // Mapeamento de planetas para a√ß√µes
            planetasAcoes: {
                'Sol': { acao: 'criatividade', atividade: 'projetos criativos' },
                'Lua': { acao: 'intui√ß√£o', atividade: 'medita√ß√£o' },
                'Marte': { acao: 'a√ß√£o', atividade: 'tarefas desafiadoras' },
                'Merc√∫rio': { acao: 'comunica√ß√£o', atividade: 'estudos' },
                'J√∫piter': { acao: 'expans√£o', atividade: 'aprendizado' },
                'V√™nus': { acao: 'harmonia', atividade: 'arte e beleza' },
                'Saturno': { acao: 'disciplina', atividade: 'organiza√ß√£o' }
            }
        };
        
        let gatomanteTimer = null;
        let gatomanteVisible = false;
        
        function showGatomante(tipo = 'boasVindas', delay = 0, contextoExtra = {}) {
            setTimeout(() => {
                const container = document.getElementById('gatomanteContainer');
                const textElement = document.getElementById('gatomanteText');
                const bubble = document.getElementById('gatomanteBubble');
                
                // Atualizar contexto do Gatomante
                updateGatomanteContext();
                
                // Escolher dica inteligente baseada no contexto
                const dicaPersonalizada = getSmartTip(tipo, contextoExtra);
                
                textElement.textContent = dicaPersonalizada;
                
                // Aplicar estilo comic baseado no tipo
                bubble.className = 'gatomante-bubble';
                if (tipo === 'conquista' || tipo === 'app_aberto') {
                    bubble.classList.add('excited');
                } else if (tipo === 'inatividade' || tipo === 'dica_avancada') {
                    bubble.classList.add('thinking');
                }
                
                container.classList.add('active');
                gatomanteVisible = true;
                
                // Efeito sonoro sutil para apari√ß√£o
                if (currentUser?.settings?.volumes?.system > 0) {
                    playGatomanteSound(tipo);
                }
                
                // Registrar a√ß√£o
                gatomante.contexto.acoesPorSessao++;
                
                // Auto-hide inteligente baseado no tipo
                const hideDelay = tipo === 'conquista' ? 12000 : 
                                tipo === 'dica_avancada' ? 15000 : 8000;
                
                clearTimeout(gatomanteTimer);
                gatomanteTimer = setTimeout(() => {
                    hideGatomante();
                }, hideDelay);
                
                // Atualizar √∫ltima apari√ß√£o
                gatomante.ultimaAparicao = Date.now();
                
            }, delay);
        }
        
        function playGatomanteSound(tipo = 'normal') {
            try {
                // Som sutil de "miau" sint√©tico baseado no tipo
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Frequ√™ncias diferentes baseadas no tipo
                if (tipo === 'conquista' || tipo === 'app_aberto') {
                    // Som mais agudo e animado
                    oscillator.frequency.setValueAtTime(1000, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.1);
                    oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.2);
                } else if (tipo === 'inatividade' || tipo === 'dica_avancada') {
                    // Som mais grave e pensativo
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.15);
                    oscillator.frequency.exponentialRampToValueAtTime(500, audioContext.currentTime + 0.3);
                } else {
                    // Som padr√£o
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.1);
                    oscillator.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.2);
                }
                
                const volume = 0.08 * (currentUser?.settings?.volumes?.system || 0.5);
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(volume, audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.35);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.35);
            } catch (error) {
                console.log('üîä Erro ao reproduzir som do Gatomante:', error);
            }
        }
        
        function updateGatomanteContext() {
            // Atualizar contexto com informa√ß√µes atuais
            gatomante.contexto.usuarioLogado = !!currentUser;
            gatomante.contexto.nomeUsuario = currentUser ? currentUser.name.split(' ')[0] : '';
            gatomante.contexto.temaAtual = currentTheme;
            gatomante.contexto.planetaAtual = document.getElementById('planetaryName')?.textContent || 'Sol';
            gatomante.contexto.tempoSessao = Date.now() - (gatomante.ultimaAparicao || Date.now());
            
            // Contar personaliza√ß√µes do usu√°rio
            if (currentUser && currentUser.settings) {
                gatomante.contexto.numeroPersonalizacoes = 
                    (currentUser.settings.theme !== 0 ? 1 : 0) +
                    (currentUser.settings.wallpaper !== 0 ? 1 : 0) +
                    (currentUser.settings.volumes.master !== 70 ? 1 : 0);
            }
        }
        
        function getSmartTip(tipo, contextoExtra = {}) {
            const ctx = gatomante.contexto;
            let dicasDisponiveis = [];
            let dicaEscolhida = '';
            
            // Escolher categoria de dicas baseada no contexto
            if (ctx.usuarioLogado && gatomante.dicas[tipo + 'Personalizada']) {
                dicasDisponiveis = gatomante.dicas[tipo + 'Personalizada'];
            } else if (ctx.usuarioLogado && tipo === 'inatividade' && gatomante.dicas['inactividadePersonalizada']) {
                dicasDisponiveis = gatomante.dicas['inactividadePersonalizada'];
            } else {
                dicasDisponiveis = gatomante.dicas[tipo] || gatomante.dicas.boasVindas;
            }
            
            // Escolher dica aleat√≥ria
            dicaEscolhida = dicasDisponiveis[Math.floor(Math.random() * dicasDisponiveis.length)];
            
            // Personalizar dica com contexto
            dicaEscolhida = personalizarDica(dicaEscolhida, contextoExtra);
            
            return dicaEscolhida;
        }
        
        function personalizarDica(dica, contextoExtra = {}) {
            const ctx = gatomante.contexto;
            const temas = ['Aurora Sagrada', 'Windows ME', 'Cyberpunk', 'Vintage'];
            
            // Substitui√ß√µes de contexto
            const substituicoes = {
                '{nome}': ctx.nomeUsuario,
                '{tema}': temas[ctx.temaAtual] || 'Aurora Sagrada',
                '{planeta}': ctx.planetaAtual,
                '{acao}': gatomante.planetasAcoes[ctx.planetaAtual]?.acao || 'reflex√£o',
                '{atividade}': gatomante.planetasAcoes[ctx.planetaAtual]?.atividade || 'contempla√ß√£o',
                '{numApps}': sitesConfig.length,
                '{appFavorito}': sitesConfig[0]?.name || 'aplicativo',
                '{vezes}': ctx.numeroPersonalizacoes,
                '{volume}': Math.round(volumes.master),
                '{numSites}': sitesConfig.length,
                '{sugestaoTema}': temas[(ctx.temaAtual + 1) % temas.length],
                '{ultimaAcao}': ctx.ultimaAcao || 'explora√ß√£o',
                '{numAcoes}': ctx.acoesPorSessao,
                ...contextoExtra
            };
            
            // Aplicar substitui√ß√µes
            let dicaPersonalizada = dica;
            for (const [placeholder, valor] of Object.entries(substituicoes)) {
                dicaPersonalizada = dicaPersonalizada.replace(new RegExp(placeholder, 'g'), valor);
            }
            
            return dicaPersonalizada;
        }
        
        function hideGatomante() {
            const container = document.getElementById('gatomanteContainer');
            container.classList.remove('active');
            gatomanteVisible = false;
            clearTimeout(gatomanteTimer);
        }
        
        function gatomanteContextual(acao, contextoExtra = {}) {
            // Evitar spam de dicas
            if (gatomanteVisible || Date.now() - gatomante.ultimaAparicao < 10000) {
                return;
            }
            
            // Registrar a√ß√£o no contexto
            gatomante.contexto.ultimaAcao = acao;
            
            let tipoDica = 'navegacao';
            let delay = 1000;
            
            switch(acao) {
                case 'personalizacao':
                    tipoDica = 'tecnicas';
                    delay = 2000;
                    break;
                case 'planeta_mudou':
                    tipoDica = 'misticas';
                    delay = 1500;
                    break;
                case 'inatividade':
                    tipoDica = 'inatividade';
                    delay = 500;
                    break;
                case 'primeiro_acesso':
                    tipoDica = currentUser ? 'boasVindasPersonalizada' : 'boasVindas';
                    delay = 3000;
                    break;
                case 'login_sucesso':
                    tipoDica = 'boasVindasPersonalizada';
                    delay = 2000;
                    break;
                case 'afast_alert':
                    tipoDica = 'afast_alerts';
                    delay = 1000;
                    break;
                case 'afast_info':
                    tipoDica = 'afast_info';
                    delay = 1500;
                    break;
                case 'audio_ambiente':
                    tipoDica = 'audio_ambiente';
                    delay = 1000;
                    break;
                case 'workspaces':
                    tipoDica = 'workspaces';
                    delay = 1000;
                    break;
                case 'chat_usado':
                    tipoDica = 'chat_ia';
                    delay = 2000;
                    break;
                case 'tema_mudou':
                    tipoDica = 'tecnicasPersonalizadas';
                    contextoExtra.acao = 'mudan√ßa de tema';
                    delay = 1500;
                    break;
                case 'volume_mudou':
                    tipoDica = 'tecnicasPersonalizadas';
                    contextoExtra.acao = 'ajuste de volume';
                    delay = 1000;
                    break;
                case 'app_aberto':
                    tipoDica = 'navegacaoPersonalizada';
                    contextoExtra.app = contextoExtra.app || 'aplicativo';
                    delay = 1500;
                    break;
                case 'conquista':
                    tipoDica = 'conquistas';
                    delay = 1000;
                    break;
                case 'dica_avancada':
                    tipoDica = 'dicas_avancadas';
                    delay = 2000;
                    break;
                case 'demo_login':
                    tipoDica = 'demo_login';
                    delay = 1000;
                    break;
                case 'demo_features':
                    tipoDica = 'demo_features';
                    delay = 1500;
                    break;
                default:
                    tipoDica = 'navegacao';
            }
            
            showGatomante(tipoDica, delay, contextoExtra);
        }
        
        // ==========================================
        // üèÜ SISTEMA DE CONQUISTAS E GAMIFICA√á√ÉO
        // ==========================================
        
        // Base de dados de conquistas
        const achievementsDatabase = {
            // Conquistas de Inicia√ß√£o
            'primeiro_login': {
                id: 'primeiro_login',
                name: 'Primeiro Login M√≠stico',
                description: 'Bem-vindo ao Aurora OS! Sua jornada m√≠stica come√ßou.',
                icon: 'üåü',
                category: 'iniciacao',
                points: 100,
                rarity: 'comum',
                unlocked: false
            },
            'perfil_completo': {
                id: 'perfil_completo',
                name: 'Perfil Astral Completo',
                description: 'Complete seu perfil com dados astrol√≥gicos.',
                icon: 'üîÆ',
                category: 'iniciacao',
                points: 200,
                rarity: 'comum',
                unlocked: false
            },
            'primeiro_mapa': {
                id: 'primeiro_mapa',
                name: 'Primeiro Mapa Astral',
                description: 'Calcule seu primeiro mapa astral completo.',
                icon: '‚≠ê',
                category: 'astrologia',
                points: 300,
                rarity: 'incomum',
                unlocked: false
            },
            
            // Conquistas de Personaliza√ß√£o
            'primeiro_tema': {
                id: 'primeiro_tema',
                name: 'Personaliza√ß√£o M√≠stica',
                description: 'Altere o tema do sistema pela primeira vez.',
                icon: 'üé®',
                category: 'personalizacao',
                points: 150,
                rarity: 'comum',
                unlocked: false
            },
            'wallpaper_custom': {
                id: 'wallpaper_custom',
                name: 'Ambiente Personalizado',
                description: 'Fa√ßa upload de seu primeiro wallpaper personalizado.',
                icon: 'üñºÔ∏è',
                category: 'personalizacao',
                points: 200,
                rarity: 'comum',
                unlocked: false
            },
            'colecionador_temas': {
                id: 'colecionador_temas',
                name: 'Colecionador de Temas',
                description: 'Experimente todos os 10 temas dispon√≠veis.',
                icon: 'üåà',
                category: 'personalizacao',
                points: 500,
                rarity: 'raro',
                unlocked: false
            },
            
            // Conquistas de Jogos
            'primeiro_jogo': {
                id: 'primeiro_jogo',
                name: 'Jogador M√≠stico',
                description: 'Jogue seu primeiro jogo m√≠stico.',
                icon: 'üéÆ',
                category: 'jogos',
                points: 150,
                rarity: 'comum',
                unlocked: false
            },
            'mestre_cristais': {
                id: 'mestre_cristais',
                name: 'Mestre dos Cristais',
                description: 'Alcance 10.000 pontos no Combine os Cristais.',
                icon: 'üíé',
                category: 'jogos',
                points: 400,
                rarity: 'incomum',
                unlocked: false
            },
            'alquimista_expert': {
                id: 'alquimista_expert',
                name: 'Alquimista Expert',
                description: 'Crie todas as 7 po√ß√µes no Combine as Ervas.',
                icon: 'üß™',
                category: 'jogos',
                points: 600,
                rarity: 'raro',
                unlocked: false
            },
            'tarot_master': {
                id: 'tarot_master',
                name: 'Mestre do Tarot',
                description: 'Realize 50 leituras de tarot.',
                icon: 'üÉè',
                category: 'jogos',
                points: 800,
                rarity: 'raro',
                unlocked: false
            },
            'paciencia_zen': {
                id: 'paciencia_zen',
                name: 'Paci√™ncia Zen',
                description: 'Ven√ßa 10 jogos de Paci√™ncia M√≠stica.',
                icon: 'üßò',
                category: 'jogos',
                points: 500,
                rarity: 'incomum',
                unlocked: false
            },
            'domino_astral': {
                id: 'domino_astral',
                name: 'Dominador Astral',
                description: 'Ven√ßa 20 partidas de Domin√≥ Astral.',
                icon: '‚ö´',
                category: 'jogos',
                points: 700,
                rarity: 'raro',
                unlocked: false
            },
            
            // Conquistas do Sistema AF√ÅST
            'primeiro_afaste': {
                id: 'primeiro_afaste',
                name: 'Primeira Prote√ß√£o',
                description: 'Receba sua primeira notifica√ß√£o do AF√ÅST!',
                icon: 'üõ°Ô∏è',
                category: 'afast',
                points: 200,
                rarity: 'comum',
                unlocked: false
            },
            'sobrevivente_mercurio': {
                id: 'sobrevivente_mercurio',
                name: 'Sobrevivente de Merc√∫rio',
                description: 'Sobreviva a um per√≠odo completo de Merc√∫rio retr√≥grado.',
                icon: '‚òø',
                category: 'afast',
                points: 1000,
                rarity: 'epico',
                unlocked: false
            },
            'guardiao_astral': {
                id: 'guardiao_astral',
                name: 'Guardi√£o Astral',
                description: 'Receba 100 notifica√ß√µes do AF√ÅST!',
                icon: 'üåü',
                category: 'afast',
                points: 1500,
                rarity: 'lendario',
                unlocked: false
            },
            
            // Conquistas de Uso
            'explorador': {
                id: 'explorador',
                name: 'Explorador M√≠stico',
                description: 'Abra 50 aplica√ß√µes diferentes.',
                icon: 'üó∫Ô∏è',
                category: 'uso',
                points: 300,
                rarity: 'incomum',
                unlocked: false
            },
            'viciado_sistema': {
                id: 'viciado_sistema',
                name: 'Viciado no Sistema',
                description: 'Passe 10 horas usando o Aurora OS.',
                icon: '‚è∞',
                category: 'uso',
                points: 600,
                rarity: 'raro',
                unlocked: false
            },
            'maratonista': {
                id: 'maratonista',
                name: 'Maratonista Digital',
                description: 'Use o sistema por 24 horas em uma semana.',
                icon: 'üèÉ',
                category: 'uso',
                points: 1200,
                rarity: 'epico',
                unlocked: false
            },
            
            // Conquistas Especiais
            'beta_tester': {
                id: 'beta_tester',
                name: 'Beta Tester M√≠stico',
                description: 'Seja um dos primeiros usu√°rios do Aurora OS.',
                icon: 'üöÄ',
                category: 'especial',
                points: 2000,
                rarity: 'lendario',
                unlocked: false
            },
            'colecionador_completo': {
                id: 'colecionador_completo',
                name: 'Colecionador Completo',
                description: 'Desbloqueie todas as conquistas dispon√≠veis.',
                icon: 'üëë',
                category: 'especial',
                points: 5000,
                rarity: 'mitico',
                unlocked: false
            }
        };
        
        // Sistema de n√≠veis e pontua√ß√£o
        const gamificationSystem = {
            currentLevel: 1,
            currentXP: 0,
            totalPoints: 0,
            unlockedAchievements: [],
            dailyChallenges: [],
            weeklyChallenges: [],
            stats: {
                appsOpened: 0,
                gamesPlayed: 0,
                timeSpent: 0,
                themesChanged: 0,
                afastNotifications: 0,
                tarotReadings: 0,
                gameWins: 0
            }
        };
        
        // N√≠veis e requisitos de XP
        const levelSystem = [
            { level: 1, xpRequired: 0, title: 'Iniciante M√≠stico', reward: null },
            { level: 2, xpRequired: 500, title: 'Aprendiz Astral', reward: 'Tema especial desbloqueado' },
            { level: 3, xpRequired: 1200, title: 'Estudante das Estrelas', reward: 'Wallpaper exclusivo' },
            { level: 4, xpRequired: 2000, title: 'Praticante C√≥smico', reward: '√çcone personalizado' },
            { level: 5, xpRequired: 3000, title: 'Adepto M√≠stico', reward: 'Som especial desbloqueado' },
            { level: 6, xpRequired: 4500, title: 'Mestre Astral', reward: 'Efeito visual exclusivo' },
            { level: 7, xpRequired: 6500, title: 'S√°bio C√≥smico', reward: 'Gatomante especial' },
            { level: 8, xpRequired: 9000, title: 'Guardi√£o das Estrelas', reward: 'Modo noturno premium' },
            { level: 9, xpRequired: 12000, title: 'Or√°culo Digital', reward: 'Previs√µes personalizadas' },
            { level: 10, xpRequired: 16000, title: 'Mestre Supremo', reward: 'Acesso total ao sistema' }
        ];
        
        // Inicializar sistema de gamifica√ß√£o
        function initGamificationSystem() {
            console.log('üèÜ Inicializando Sistema de Gamifica√ß√£o');
            
            // Carregar dados salvos
            loadGamificationData();
            
            // Inicializar desafios di√°rios
            initDailyChallenges();
            
            // Atualizar interface
            updateGamificationUI();
            
            // Salvar dados periodicamente
            setInterval(saveGamificationData, 30000); // A cada 30 segundos
        }
        
        // Carregar dados de gamifica√ß√£o
        function loadGamificationData() {
            const saved = localStorage.getItem('auroraOS_gamification');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    Object.assign(gamificationSystem, data);
                    
                    // Atualizar base de conquistas com dados salvos
                    gamificationSystem.unlockedAchievements.forEach(achievementId => {
                        if (achievementsDatabase[achievementId]) {
                            achievementsDatabase[achievementId].unlocked = true;
                        }
                    });
                } catch (e) {
                    console.error('Erro ao carregar dados de gamifica√ß√£o:', e);
                }
            }
        }
        
        // Salvar dados de gamifica√ß√£o
        function saveGamificationData() {
            localStorage.setItem('auroraOS_gamification', JSON.stringify(gamificationSystem));
        }
        
        // Detectar e desbloquear conquistas
        function detectarConquistas() {
            const ctx = gatomante.contexto;
            const conquistasAntigas = ctx.conquistasDesbloqueadas.length;
            let newAchievements = [];
            
            // Conquista: Primeiro login
            if (currentUser && !isAchievementUnlocked('primeiro_login')) {
                unlockAchievement('primeiro_login');
                newAchievements.push('Primeiro Login M√≠stico!');
            }
            
            // Conquista: Perfil completo
            if (currentUser && currentUser.birthData && currentUser.birthData.hasAstrologicalData && !isAchievementUnlocked('perfil_completo')) {
                unlockAchievement('perfil_completo');
                newAchievements.push('Perfil Astral Completo!');
            }
            
            // Conquista: Primeiro mapa astral
            if (currentUser && currentUser.astrologicalProfile && !isAchievementUnlocked('primeiro_mapa')) {
                unlockAchievement('primeiro_mapa');
                newAchievements.push('Primeiro Mapa Astral!');
            }
            
            // Conquista: Primeiro tema
            if (gamificationSystem.stats.themesChanged >= 1 && !isAchievementUnlocked('primeiro_tema')) {
                unlockAchievement('primeiro_tema');
                newAchievements.push('Personaliza√ß√£o M√≠stica!');
            }
            
            // Conquista: Explorador
            if (gamificationSystem.stats.appsOpened >= 50 && !isAchievementUnlocked('explorador')) {
                unlockAchievement('explorador');
                newAchievements.push('Explorador M√≠stico!');
            }
            
            // Conquista: Primeiro jogo
            if (gamificationSystem.stats.gamesPlayed >= 1 && !isAchievementUnlocked('primeiro_jogo')) {
                unlockAchievement('primeiro_jogo');
                newAchievements.push('Jogador M√≠stico!');
            }
            
            // Conquista: Primeiro AF√ÅST
            if (gamificationSystem.stats.afastNotifications >= 1 && !isAchievementUnlocked('primeiro_afaste')) {
                unlockAchievement('primeiro_afaste');
                newAchievements.push('Primeira Prote√ß√£o!');
            }
            
            // Conquista: Guardi√£o Astral
            if (gamificationSystem.stats.afastNotifications >= 100 && !isAchievementUnlocked('guardiao_astral')) {
                unlockAchievement('guardiao_astral');
                newAchievements.push('Guardi√£o Astral!');
            }
            
            // Conquista: Mestre do Tarot
            if (gamificationSystem.stats.tarotReadings >= 50 && !isAchievementUnlocked('tarot_master')) {
                unlockAchievement('tarot_master');
                newAchievements.push('Mestre do Tarot!');
            }
            
            // Conquista: Beta Tester (para primeiros usu√°rios)
            if (currentUser && !isAchievementUnlocked('beta_tester')) {
                unlockAchievement('beta_tester');
                newAchievements.push('Beta Tester M√≠stico!');
            }
            
            // Mostrar notifica√ß√µes de novas conquistas
            newAchievements.forEach((achievement, index) => {
                setTimeout(() => {
                    gatomanteContextual('conquista', { conquista: achievement });
                    showAchievementNotification(achievement);
                }, (index + 1) * 2000);
            });
            
            // Verificar se desbloqueou todas as conquistas
            checkCompleteCollection();
            
            // Atualizar n√≠vel
            updatePlayerLevel();
        }
        
        // Verificar se conquista est√° desbloqueada
        function isAchievementUnlocked(achievementId) {
            return gamificationSystem.unlockedAchievements.includes(achievementId);
        }
        
        // Desbloquear conquista
        function unlockAchievement(achievementId) {
            if (!isAchievementUnlocked(achievementId) && achievementsDatabase[achievementId]) {
                gamificationSystem.unlockedAchievements.push(achievementId);
                achievementsDatabase[achievementId].unlocked = true;
                
                const achievement = achievementsDatabase[achievementId];
                gamificationSystem.currentXP += achievement.points;
                gamificationSystem.totalPoints += achievement.points;
                
                console.log(`üèÜ Conquista desbloqueada: ${achievement.name} (+${achievement.points} XP)`);
                saveGamificationData();
            }
        }
        
        // Mostrar notifica√ß√£o de conquista
        function showAchievementNotification(achievementName) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 120px;
                right: 20px;
                background: linear-gradient(135deg, #FFD700, #FFA500);
                color: #1a1a2e;
                padding: 15px 20px;
                border-radius: 12px;
                font-family: 'Alice', serif;
                font-size: 14px;
                font-weight: bold;
                box-shadow: 0 8px 25px rgba(255,215,0,0.4);
                z-index: 10001;
                opacity: 0;
                transform: translateX(100%) scale(0.8);
                transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                max-width: 320px;
                border: 2px solid #FFD700;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div style="font-size: 24px; text-shadow: 0 0 10px rgba(255,215,0,0.8);">üèÜ</div>
                    <div>
                        <div style="font-size: 12px; opacity: 0.8; margin-bottom: 2px;">CONQUISTA DESBLOQUEADA!</div>
                        <div style="font-size: 16px;">${achievementName}</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animar entrada
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0) scale(1)';
            }, 100);
            
            // Remover ap√≥s 5 segundos
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%) scale(0.8)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 400);
            }, 5000);
        }
        
        // Verificar cole√ß√£o completa
        function checkCompleteCollection() {
            const totalAchievements = Object.keys(achievementsDatabase).length;
            const unlockedCount = gamificationSystem.unlockedAchievements.length;
            
            if (unlockedCount === totalAchievements - 1 && !isAchievementUnlocked('colecionador_completo')) {
                unlockAchievement('colecionador_completo');
                setTimeout(() => {
                    showAchievementNotification('Colecionador Completo!');
                    gatomanteContextual('conquista', { conquista: 'Colecionador Completo - Todas as conquistas desbloqueadas!' });
                }, 1000);
            }
        }
        
        // Atualizar n√≠vel do jogador
        function updatePlayerLevel() {
            const currentXP = gamificationSystem.currentXP;
            let newLevel = 1;
            
            for (let i = levelSystem.length - 1; i >= 0; i--) {
                if (currentXP >= levelSystem[i].xpRequired) {
                    newLevel = levelSystem[i].level;
                    break;
                }
            }
            
            if (newLevel > gamificationSystem.currentLevel) {
                const oldLevel = gamificationSystem.currentLevel;
                gamificationSystem.currentLevel = newLevel;
                
                // Mostrar notifica√ß√£o de level up
                showLevelUpNotification(oldLevel, newLevel);
                
                // Recompensa por level up
                const levelData = levelSystem.find(l => l.level === newLevel);
                if (levelData && levelData.reward) {
                    setTimeout(() => {
                        gatomanteContextual('level_up', { 
                            level: newLevel, 
                            title: levelData.title,
                            reward: levelData.reward 
                        });
                    }, 2000);
                }
            }
        }
        
        // Mostrar notifica√ß√£o de level up
        function showLevelUpNotification(oldLevel, newLevel) {
            const levelData = levelSystem.find(l => l.level === newLevel);
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0.5);
                background: linear-gradient(135deg, #9C27B0, #673AB7);
                color: white;
                padding: 30px;
                border-radius: 20px;
                font-family: 'Alice', serif;
                text-align: center;
                box-shadow: 0 20px 60px rgba(156,39,176,0.4);
                z-index: 10002;
                opacity: 0;
                transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                border: 3px solid #E1BEE7;
                min-width: 300px;
            `;
            
            notification.innerHTML = `
                <div style="font-size: 48px; margin-bottom: 15px; text-shadow: 0 0 20px rgba(255,255,255,0.8);">‚≠ê</div>
                <div style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">LEVEL UP!</div>
                <div style="font-size: 18px; margin-bottom: 5px;">N√≠vel ${oldLevel} ‚Üí ${newLevel}</div>
                <div style="font-size: 16px; color: #E1BEE7; font-style: italic;">${levelData ? levelData.title : 'Mestre M√≠stico'}</div>
                ${levelData && levelData.reward ? `<div style="font-size: 14px; margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 10px;">üéÅ ${levelData.reward}</div>` : ''}
            `;
            
            document.body.appendChild(notification);
            
            // Animar entrada
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translate(-50%, -50%) scale(1)';
            }, 100);
            
            // Remover ap√≥s 6 segundos
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translate(-50%, -50%) scale(0.5)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 600);
            }, 6000);
        }
        
        // Inicializar desafios di√°rios
        function initDailyChallenges() {
            const today = new Date().toDateString();
            const savedChallenges = localStorage.getItem('auroraOS_dailyChallenges');
            
            if (!savedChallenges || JSON.parse(savedChallenges).date !== today) {
                // Gerar novos desafios di√°rios
                gamificationSystem.dailyChallenges = generateDailyChallenges();
                localStorage.setItem('auroraOS_dailyChallenges', JSON.stringify({
                    date: today,
                    challenges: gamificationSystem.dailyChallenges
                }));
            } else {
                gamificationSystem.dailyChallenges = JSON.parse(savedChallenges).challenges;
            }
        }
        
        // Gerar desafios di√°rios
        function generateDailyChallenges() {
            const challenges = [
                { id: 'daily_apps', name: 'Explorador Di√°rio', description: 'Abra 10 aplica√ß√µes diferentes', target: 10, current: 0, reward: 50, completed: false },
                { id: 'daily_games', name: 'Jogador Ativo', description: 'Jogue 3 jogos diferentes', target: 3, current: 0, reward: 75, completed: false },
                { id: 'daily_tarot', name: 'Consulta Di√°ria', description: 'Fa√ßa 2 leituras de tarot', target: 2, current: 0, reward: 60, completed: false },
                { id: 'daily_theme', name: 'Mudan√ßa Visual', description: 'Altere o tema do sistema', target: 1, current: 0, reward: 40, completed: false },
                { id: 'daily_time', name: 'Tempo M√≠stico', description: 'Use o sistema por 30 minutos', target: 30, current: 0, reward: 80, completed: false }
            ];
            
            // Selecionar 3 desafios aleat√≥rios
            const selectedChallenges = [];
            const shuffled = challenges.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, 3);
        }
        
        // Atualizar progresso de desafios
        function updateChallengeProgress(challengeType, amount = 1) {
            gamificationSystem.dailyChallenges.forEach(challenge => {
                if (challenge.id === challengeType && !challenge.completed) {
                    challenge.current = Math.min(challenge.current + amount, challenge.target);
                    
                    if (challenge.current >= challenge.target) {
                        challenge.completed = true;
                        gamificationSystem.currentXP += challenge.reward;
                        gamificationSystem.totalPoints += challenge.reward;
                        
                        showChallengeCompletedNotification(challenge);
                        saveGamificationData();
                    }
                }
            });
        }
        
        // Mostrar notifica√ß√£o de desafio completo
        function showChallengeCompletedNotification(challenge) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 180px;
                right: 20px;
                background: linear-gradient(135deg, #4CAF50, #45a049);
                color: white;
                padding: 15px 20px;
                border-radius: 12px;
                font-family: 'Alice', serif;
                font-size: 14px;
                box-shadow: 0 8px 25px rgba(76,175,80,0.4);
                z-index: 10001;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.4s ease;
                max-width: 320px;
                border: 2px solid #66BB6A;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div style="font-size: 24px;">‚úÖ</div>
                    <div>
                        <div style="font-size: 12px; opacity: 0.9; margin-bottom: 2px;">DESAFIO COMPLETO!</div>
                        <div style="font-size: 16px; font-weight: bold;">${challenge.name}</div>
                        <div style="font-size: 12px; opacity: 0.8;">+${challenge.reward} XP</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 400);
            }, 4000);
        }
        
        // Atualizar interface de gamifica√ß√£o
        function updateGamificationUI() {
            // Esta fun√ß√£o ser√° chamada para atualizar elementos da UI
            // quando a interface de conquistas for implementada
            console.log(`üèÜ N√≠vel ${gamificationSystem.currentLevel} | XP: ${gamificationSystem.currentXP} | Conquistas: ${gamificationSystem.unlockedAchievements.length}`);
        }
        
        // Registrar atividade do usu√°rio
        function trackUserActivity(activityType, data = {}) {
            switch (activityType) {
                case 'app_opened':
                    gamificationSystem.stats.appsOpened++;
                    updateChallengeProgress('daily_apps');
                    break;
                case 'game_played':
                    gamificationSystem.stats.gamesPlayed++;
                    updateChallengeProgress('daily_games');
                    break;
                case 'theme_changed':
                    gamificationSystem.stats.themesChanged++;
                    updateChallengeProgress('daily_theme');
                    break;
                case 'tarot_reading':
                    gamificationSystem.stats.tarotReadings++;
                    updateChallengeProgress('daily_tarot');
                    break;
                case 'afast_notification':
                    gamificationSystem.stats.afastNotifications++;
                    break;
                case 'game_won':
                    gamificationSystem.stats.gameWins++;
                    break;
                case 'time_spent':
                    gamificationSystem.stats.timeSpent += data.minutes || 1;
                    updateChallengeProgress('daily_time', data.minutes || 1);
                    break;
            }
            
            // Detectar conquistas ap√≥s atividade
            detectarConquistas();
            saveGamificationData();
        }
            
            // Conquista: Personaliza√ß√£o
            if (ctx.numeroPersonalizacoes >= 3 && !ctx.conquistasDesbloqueadas.includes('personalizador')) {
                ctx.conquistasDesbloqueadas.push('personalizador');
                gatomanteContextual('conquista', { conquista: 'Mestre da Personaliza√ß√£o!' });
            }
            
            // Conquista: Explorador
            if (ctx.acoesPorSessao >= 10 && !ctx.conquistasDesbloqueadas.includes('explorador')) {
                ctx.conquistasDesbloqueadas.push('explorador');
                gatomanteContextual('conquista', { conquista: 'Explorador C√≥smico!' });
            }
            
            // Conquista: Tempo de sess√£o
            if (ctx.tempoSessao > 300000 && !ctx.conquistasDesbloqueadas.includes('dedicado')) { // 5 minutos
                ctx.conquistasDesbloqueadas.push('dedicado');
                gatomanteContextual('conquista', { conquista: 'Usu√°rio Dedicado!' });
            }
        }
        
        function gatomanteThinking() {
            const sprite = document.getElementById('gatomanteCharacter');
            sprite.classList.add('gatomante-thinking');
            
            setTimeout(() => {
                sprite.classList.remove('gatomante-thinking');
            }, 2000);
        }
        
        // Detectar inatividade do usu√°rio
        let inactivityTimer = null;
        let lastActivity = Date.now();
        
        function resetInactivityTimer() {
            lastActivity = Date.now();
            clearTimeout(inactivityTimer);
            
            inactivityTimer = setTimeout(() => {
                if (!gatomanteVisible) {
                    gatomanteContextual('inatividade');
                }
            }, 30000); // 30 segundos de inatividade
        }
        
        // Eventos para detectar atividade
        document.addEventListener('mousemove', resetInactivityTimer);
        document.addEventListener('click', resetInactivityTimer);
        document.addEventListener('keypress', resetInactivityTimer);
        
        // Clique no Gatomante para nova dica
        document.getElementById('gatomanteCharacter').addEventListener('click', () => {
            if (gatomanteVisible) {
                gatomanteThinking();
                setTimeout(() => {
                    showGatomante('navegacao');
                }, 1000);
            }
        });
        
        // Inicializar Gatomante
        function initGatomante() {
            // Verificar se √© primeira visita
            const primeiraVisita = !localStorage.getItem('auroraOS_gatomante_visited');
            
            if (primeiraVisita) {
                localStorage.setItem('auroraOS_gatomante_visited', 'true');
                showGatomante('boasVindas', 2000);
            } else {
                // Usu√°rio retornando
                const saudacoes = [
                    "Ah, voc√™ retornou... as energias c√≥smicas o trouxeram de volta!",
                    "Bem-vindo de volta, mortal... senti sua presen√ßa se aproximando.",
                    "Ol√° novamente! Espero que tenha trazido oferendas... ou pelo menos curiosidade!"
                ];
                const saudacao = saudacoes[Math.floor(Math.random() * saudacoes.length)];
                
                setTimeout(() => {
                    const textElement = document.getElementById('gatomanteText');
                    textElement.textContent = saudacao;
                    showGatomante('boasVindas', 1500);
                }, 1000);
            }
            
            // Iniciar timer de inatividade
            resetInactivityTimer();
        }
        
        // Sistema de Boot e Boas-vindas
        let bootProgress = 0;
        let bootSteps = [
            "Inicializando sistema m√≠stico...",
            "Carregando energias c√≥smicas...",
            "Conectando com as esferas celestiais...",
            "Preparando o Gatomante...",
            "Alinhando chakras digitais...",
            "Invocando interfaces ancestrais...",
            "Ativando portais dimensionais...",
            "Sistema pronto para uso!"
        ];
        
        function createMysticalParticles(containerId) {
            const container = document.getElementById(containerId);
            const particles = ['‚ú®', 'üåü', '‚≠ê', 'üí´', 'üîÆ', 'üåô', '‚òΩ', '‚òæ'];
            
            setInterval(() => {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.textContent = particles[Math.floor(Math.random() * particles.length)];
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 2 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                
                container.appendChild(particle);
                
                // Remover part√≠cula ap√≥s anima√ß√£o
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 8000);
            }, 500);
        }
        
        // ========================================
        // üöÄ SISTEMA DE INICIALIZA√á√ÉO COMPLETO
        // Boot Screen + Tela de Boas-vindas
        // ========================================
        
        // Mensagens din√¢micas do boot
        const bootMessages = [
            "Invocando energias m√≠sticas...",
            "Alinhando chakras do sistema...",
            "Consultando as estrelas...",
            "Preparando o Gatomante...",
            "Carregando sabedoria ancestral...",
            "Sincronizando com o cosmos...",
            "Ativando prote√ß√µes astrais...",
            "Inicializando AF√ÅST!...",
            "Conectando com dimens√µes superiores...",
            "Sistema m√≠stico pronto!"
        ];
        
        let bootProgress = 0;
        let bootMessageIndex = 0;
        
        // Criar part√≠culas para o boot screen
        function createBootParticles() {
            const container = document.getElementById('bootParticles');
            if (!container) return;
            
            // Limpar part√≠culas existentes
            container.innerHTML = '';
            
            // Criar 30 part√≠culas
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'boot-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (6 + Math.random() * 4) + 's';
                container.appendChild(particle);
            }
        }
        
        // Atualizar progresso do boot
        function updateBootProgress() {
            const progressBar = document.getElementById('bootProgressBar');
            const messageElement = document.getElementById('bootMessage');
            const percentageElement = document.getElementById('bootPercentage');
            
            if (bootProgress <= 100) {
                // Atualizar barra de progresso
                progressBar.style.width = bootProgress + '%';
                percentageElement.textContent = bootProgress + '%';
                
                // Atualizar mensagem din√¢mica
                if (bootProgress % 10 === 0 && bootMessageIndex < bootMessages.length) {
                    messageElement.textContent = bootMessages[bootMessageIndex];
                    bootMessageIndex++;
                }
                
                // Reproduzir sons nost√°lgicos em momentos espec√≠ficos
                if (bootProgress === 20) {
                    playDialupSound('dialup_chiados_dirty_enhanced.wav');
                } else if (bootProgress === 60) {
                    playDialupSound('dialup_chiados_vintage.wav');
                }
                
                bootProgress += 2;
                
                if (bootProgress <= 100) {
                    setTimeout(updateBootProgress, 150);
                } else {
                    setTimeout(showWelcomeScreen, 1500);
                }
            }
        }
        
        // Reproduzir sons nost√°lgicos
        function playDialupSound(filename) {
            try {
                const audio = new Audio(filename);
                audio.volume = 0.3;
                audio.play().catch(e => console.log('Som n√£o p√¥de ser reproduzido:', e));
            } catch (e) {
                console.log('Erro ao carregar som:', e);
            }
        }
        
        // Mostrar tela de boas-vindas
        function showWelcomeScreen() {
            const bootScreen = document.getElementById('bootScreen');
            const welcomeScreen = document.getElementById('welcomeScreen');
            
            // Fade out do boot screen
            bootScreen.classList.add('hidden');
            
            setTimeout(() => {
                bootScreen.style.display = 'none';
                welcomeScreen.classList.add('active');
                
                // Animar mensagem do Gatomante
                animateGatomanteWelcome();
            }, 1500);
        }
        
        // Animar Gatomante na tela de boas-vindas
        function animateGatomanteWelcome() {
            const messages = [
                "Miau! Pronto para explorar os mist√©rios?",
                "Bem-vindo ao reino digital m√≠stico!",
                "Seus segredos astrais aguardam...",
                "O cosmos digital te chama!"
            ];
            
            const gatomanteMessage = document.querySelector('.welcome-gatomante-message');
            let messageIndex = 0;
            
            setInterval(() => {
                gatomanteMessage.style.opacity = '0';
                setTimeout(() => {
                    gatomanteMessage.textContent = messages[messageIndex];
                    gatomanteMessage.style.opacity = '1';
                    messageIndex = (messageIndex + 1) % messages.length;
                }, 300);
            }, 4000);
        }
        
        // ========================================
        // üë• SISTEMA DE USU√ÅRIOS
        // Login, Registro e Autentica√ß√£o
        // ========================================
        
        // Realizar login
        function performLogin() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const rememberMe = document.getElementById('rememberMe').checked;
            
            if (!email || !password) {
                showWelcomeMessage('Por favor, preencha todos os campos!', 'error');
                return;
            }
            
            // Simular autentica√ß√£o
            if (email === 'demo@aurora.com' && password === 'demo123') {
                // Login bem-sucedido
                const userData = {
                    name: 'Usu√°rio Demo',
                    email: email,
                    avatar: 'üßô‚Äç‚ôÇÔ∏è',
                    loginTime: new Date().toISOString(),
                    isDemo: true
                };
                
                // Salvar dados do usu√°rio
                if (rememberMe) {
                    localStorage.setItem('auroraOS_user', JSON.stringify(userData));
                }
                sessionStorage.setItem('auroraOS_currentUser', JSON.stringify(userData));
                
                // Entrar no sistema
                enterSystem();
            } else {
                showWelcomeMessage('Credenciais inv√°lidas! Use: demo@aurora.com / demo123', 'error');
            }
        }
        
        // ========================================
        // üë• SISTEMA DE REGISTRO COMPLETO
        // Formul√°rio multi-etapas com dados astrol√≥gicos
        // ========================================
        
        let currentRegisterStep = 1;
        let registerData = {};
        let selectedAvatar = null;
        
        // Mostrar formul√°rio de registro
        function showRegisterForm() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            const registerScreen = document.getElementById('registerScreen');
            
            // Ocultar tela de boas-vindas
            welcomeScreen.style.opacity = '0';
            
            setTimeout(() => {
                welcomeScreen.style.display = 'none';
                registerScreen.classList.add('active');
                
                // Resetar formul√°rio
                currentRegisterStep = 1;
                registerData = {};
                selectedAvatar = null;
                
                // Mostrar primeira etapa
                showRegisterStep(1);
                
                // Animar Gatomante
                animateRegisterGatomante();
            }, 500);
        }
        
        // Voltar para tela de boas-vindas
        function backToWelcome() {
            const registerScreen = document.getElementById('registerScreen');
            const welcomeScreen = document.getElementById('welcomeScreen');
            
            registerScreen.style.opacity = '0';
            
            setTimeout(() => {
                registerScreen.classList.remove('active');
                registerScreen.style.display = 'none';
                welcomeScreen.classList.add('active');
            }, 500);
        }
        
        // Mostrar etapa espec√≠fica do registro
        function showRegisterStep(step) {
            // Ocultar todas as etapas
            for (let i = 1; i <= 3; i++) {
                const stepElement = document.getElementById(`registerStep${i}`);
                if (stepElement) {
                    stepElement.style.display = 'none';
                }
            }
            
            // Mostrar etapa atual
            const currentStepElement = document.getElementById(`registerStep${step}`);
            if (currentStepElement) {
                currentStepElement.style.display = 'block';
            }
            
            currentRegisterStep = step;
            
            // Atualizar mensagem do Gatomante
            updateRegisterGatomanteMessage(step);
        }
        
        // Pr√≥xima etapa do registro
        function nextRegisterStep(nextStep) {
            if (validateCurrentRegisterStep()) {
                saveCurrentStepData();
                showRegisterStep(nextStep);
            }
        }
        
        // Etapa anterior do registro
        function prevRegisterStep(prevStep) {
            showRegisterStep(prevStep);
        }
        
        // Pular dados astrol√≥gicos
        function skipAstrologyData() {
            showRegisterStep(3);
        }
        
        // Validar etapa atual
        function validateCurrentRegisterStep() {
            if (currentRegisterStep === 1) {
                const name = document.getElementById('regName').value.trim();
                const email = document.getElementById('regEmail').value.trim();
                const password = document.getElementById('regPassword').value.trim();
                const confirmPassword = document.getElementById('regConfirmPassword').value.trim();
                
                if (!name || !email || !password || !confirmPassword) {
                    showRegisterMessage('Por favor, preencha todos os campos obrigat√≥rios!', 'error');
                    return false;
                }
                
                if (password !== confirmPassword) {
                    showRegisterMessage('As senhas n√£o coincidem!', 'error');
                    return false;
                }
                
                if (password.length < 6) {
                    showRegisterMessage('A senha deve ter pelo menos 6 caracteres!', 'error');
                    return false;
                }
                
                // Validar email b√°sico
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    showRegisterMessage('Por favor, digite um email v√°lido!', 'error');
                    return false;
                }
                
                return true;
            }
            
            if (currentRegisterStep === 3) {
                const acceptTerms = document.getElementById('acceptTerms').checked;
                
                if (!acceptTerms) {
                    showRegisterMessage('Voc√™ deve aceitar os Termos de Uso para continuar!', 'error');
                    return false;
                }
                
                return true;
            }
            
            return true;
        }
        
        // Salvar dados da etapa atual
        function saveCurrentStepData() {
            if (currentRegisterStep === 1) {
                registerData.name = document.getElementById('regName').value.trim();
                registerData.email = document.getElementById('regEmail').value.trim();
                registerData.password = document.getElementById('regPassword').value.trim();
            }
            
            if (currentRegisterStep === 2) {
                registerData.birthDate = document.getElementById('regBirthDate').value;
                registerData.birthTime = document.getElementById('regBirthTime').value;
                registerData.birthPlace = document.getElementById('regBirthPlace').value.trim();
                
                // Salvar interesses m√≠sticos
                registerData.interests = {
                    astrology: document.getElementById('interestAstrology').checked,
                    tarot: document.getElementById('interestTarot').checked,
                    crystals: document.getElementById('interestCrystals').checked,
                    meditation: document.getElementById('interestMeditation').checked,
                    numerology: document.getElementById('interestNumerology').checked,
                    herbs: document.getElementById('interestHerbs').checked
                };
            }
            
            if (currentRegisterStep === 3) {
                registerData.acceptTerms = document.getElementById('acceptTerms').checked;
                registerData.acceptNotifications = document.getElementById('acceptNotifications').checked;
                registerData.avatar = selectedAvatar || 'üßô‚Äç‚ôÇÔ∏è';
            }
        }
        
        // Selecionar avatar
        function selectAvatar(avatar) {
            selectedAvatar = avatar;
            
            // Remover sele√ß√£o anterior
            document.querySelectorAll('.avatar-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Adicionar sele√ß√£o atual
            event.target.classList.add('selected');
            
            // Atualizar preview
            const photoPreview = document.getElementById('photoPreview');
            photoPreview.innerHTML = `<div style="font-size: 48px;">${avatar}</div>`;
        }
        
        // Upload de foto
        function setupPhotoUpload() {
            const photoUploadArea = document.getElementById('photoUploadArea');
            const photoInput = document.getElementById('photoInput');
            const photoPreview = document.getElementById('photoPreview');
            
            if (photoUploadArea && photoInput) {
                photoUploadArea.addEventListener('click', () => {
                    photoInput.click();
                });
                
                photoInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            photoPreview.innerHTML = `<img src="${e.target.result}" alt="Foto de perfil">`;
                            selectedAvatar = e.target.result; // Base64 da imagem
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }
        
        // Completar registro
        function completeRegistration() {
            if (validateCurrentRegisterStep()) {
                saveCurrentStepData();
                
                // Mostrar tela de sucesso
                showRegisterSuccess();
                
                // Simular processamento
                processRegistration();
            }
        }
        
        // Mostrar tela de sucesso
        function showRegisterSuccess() {
            // Ocultar formul√°rio
            for (let i = 1; i <= 3; i++) {
                const stepElement = document.getElementById(`registerStep${i}`);
                if (stepElement) {
                    stepElement.style.display = 'none';
                }
            }
            
            // Mostrar tela de sucesso
            const successElement = document.getElementById('registerSuccess');
            const userNameElement = document.getElementById('successUserName');
            
            if (successElement && userNameElement) {
                userNameElement.textContent = registerData.name;
                successElement.style.display = 'block';
            }
        }
        
        // Processar registro
        function processRegistration() {
            const progressBar = document.getElementById('successProgressBar');
            const statusElement = document.getElementById('successStatus');
            
            const steps = [
                { progress: 20, status: 'Criando conta...' },
                { progress: 40, status: 'Processando dados astrol√≥gicos...' },
                { progress: 60, status: 'Calculando mapa astral...' },
                { progress: 80, status: 'Configurando prefer√™ncias...' },
                { progress: 100, status: 'Conta criada com sucesso!' }
            ];
            
            let currentStep = 0;
            
            const processStep = () => {
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    progressBar.style.width = step.progress + '%';
                    statusElement.textContent = step.status;
                    currentStep++;
                    
                    setTimeout(processStep, 1000);
                } else {
                    // Finalizar registro
                    setTimeout(() => {
                        finalizeRegistration();
                    }, 2000);
                }
            };
            
            processStep();
        }
        
        // Finalizar registro
        function finalizeRegistration() {
            // Criar dados do usu√°rio
            const userData = {
                id: 'user_' + Date.now(),
                name: registerData.name,
                email: registerData.email,
                avatar: registerData.avatar || 'üßô‚Äç‚ôÇÔ∏è',
                createdAt: new Date().toISOString(),
                loginTime: new Date().toISOString(),
                isDemo: false,
                
                // Dados astrol√≥gicos
                birthData: {
                    date: registerData.birthDate,
                    time: registerData.birthTime,
                    place: registerData.birthPlace
                },
                
                // Interesses
                interests: registerData.interests || {},
                
                // Configura√ß√µes
                settings: {
                    notifications: registerData.acceptNotifications,
                    theme: 'aurora-original'
                },
                
                // Mapa astral (ser√° calculado)
                astralChart: null
            };
            
            // Salvar usu√°rio
            localStorage.setItem('auroraOS_user', JSON.stringify(userData));
            sessionStorage.setItem('auroraOS_currentUser', JSON.stringify(userData));
            
            // Calcular mapa astral se dados dispon√≠veis
            if (registerData.birthDate && registerData.birthPlace) {
                calculateAstralChart(userData);
            }
            
            // Entrar no sistema
            setTimeout(() => {
                enterSystem();
            }, 1000);
        }
        
        // Calcular mapa astral
        function calculateAstralChart(userData) {
            // Simula√ß√£o de c√°lculo de mapa astral
            // Em implementa√ß√£o real, integraria com APIs de astrologia
            const mockChart = {
                sun: { sign: 'Aqu√°rio', house: 11, degrees: 15.5 },
                moon: { sign: 'Peixes', house: 12, degrees: 8.2 },
                ascendant: { sign: 'Libra', degrees: 22.1 },
                mercury: { sign: 'Aqu√°rio', house: 11, degrees: 2.8 },
                venus: { sign: 'Capric√≥rnio', house: 10, degrees: 28.4 },
                mars: { sign: '√Åries', house: 1, degrees: 12.7 },
                jupiter: { sign: 'G√™meos', house: 3, degrees: 19.3 },
                saturn: { sign: 'Virgem', house: 6, degrees: 5.9 },
                uranus: { sign: 'Sagit√°rio', house: 9, degrees: 14.1 },
                neptune: { sign: 'Capric√≥rnio', house: 10, degrees: 11.6 },
                pluto: { sign: 'Escorpi√£o', house: 8, degrees: 7.2 }
            };
            
            userData.astralChart = mockChart;
            
            // Atualizar dados salvos
            localStorage.setItem('auroraOS_user', JSON.stringify(userData));
            sessionStorage.setItem('auroraOS_currentUser', JSON.stringify(userData));
            
            console.log('Mapa astral calculado:', mockChart);
        }
        
        // Animar Gatomante no registro
        function animateRegisterGatomante() {
            updateRegisterGatomanteMessage(1);
        }
        
        // Atualizar mensagem do Gatomante no registro
        function updateRegisterGatomanteMessage(step) {
            const messages = {
                1: "Miau! Vamos criar sua conta m√≠stica juntos!",
                2: "Interessante... dados astrol√≥gicos revelam muito sobre voc√™!",
                3: "Quase l√°! Escolha um avatar que represente sua ess√™ncia!"
            };
            
            const messageElement = document.getElementById('registerGatomanteMessage');
            if (messageElement) {
                messageElement.style.opacity = '0';
                setTimeout(() => {
                    messageElement.textContent = messages[step] || messages[1];
                    messageElement.style.opacity = '1';
                }, 300);
            }
        }
        
        // Mostrar mensagem no registro
        function showRegisterMessage(message, type = 'info') {
            showWelcomeMessage(message, type); // Reutilizar fun√ß√£o existente
        }
        
        // Mostrar termos de uso
        function showTerms() {
            alert('Termos de Uso do Aurora OS\n\n' +
                  '1. Este √© um sistema operacional m√≠stico experimental\n' +
                  '2. Seus dados astrol√≥gicos s√£o usados apenas para c√°lculos m√≠sticos\n' +
                  '3. N√£o nos responsabilizamos por previs√µes astrol√≥gicas\n' +
                  '4. Use com sabedoria e discernimento\n' +
                  '5. O Gatomante pode ser sarc√°stico √†s vezes\n\n' +
                  'Ao aceitar, voc√™ concorda com estes termos.');
        }
        
        // Mostrar pol√≠tica de privacidade
        function showPrivacy() {
            alert('Pol√≠tica de Privacidade do Aurora OS\n\n' +
                  '‚Ä¢ Seus dados s√£o armazenados localmente no navegador\n' +
                  '‚Ä¢ Dados astrol√≥gicos s√£o usados apenas para funcionalidades m√≠sticas\n' +
                  '‚Ä¢ N√£o compartilhamos informa√ß√µes com terceiros\n' +
                  '‚Ä¢ Voc√™ pode excluir seus dados a qualquer momento\n' +
                  '‚Ä¢ O Gatomante mant√©m sigilo sobre suas consultas m√≠sticas\n\n' +
                  'Sua privacidade √© sagrada para n√≥s.');
        }
        
        // Inicializar sistema de registro
        function initRegisterSystem() {
            setupPhotoUpload();
        }
        
        // Mostrar recupera√ß√£o de senha
        function showForgotPassword() {
            showWelcomeMessage('Funcionalidade de recupera√ß√£o ser√° implementada em breve!', 'info');
        }
        
        // Entrar no modo demonstra√ß√£o
        function enterDemoMode() {
            const demoUser = {
                name: 'Visitante M√≠stico',
                email: 'demo@aurora.com',
                avatar: 'üé≠',
                loginTime: new Date().toISOString(),
                isDemo: true
            };
            
            sessionStorage.setItem('auroraOS_currentUser', JSON.stringify(demoUser));
            enterSystem();
        }
        
        // Entrar no sistema principal
        function enterSystem() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            
            // Fade out da tela de boas-vindas
            welcomeScreen.style.opacity = '0';
            
            setTimeout(() => {
                welcomeScreen.style.display = 'none';
                
                // Inicializar sistema principal
                initializeMainSystem();
                
                // Mostrar desktop
                document.getElementById('desktop').style.display = 'block';
                document.getElementById('taskbar').style.display = 'flex';
                
                // Sauda√ß√£o do Gatomante
                setTimeout(() => {
                    const currentUser = JSON.parse(sessionStorage.getItem('auroraOS_currentUser') || '{}');
                    showGatomante(`Bem-vindo ao Aurora OS, ${currentUser.name || 'Usu√°rio'}! Estou aqui para gui√°-lo pelos mist√©rios deste sistema encantado.`, 'excited');
                }, 2000);
                
            }, 1000);
        }
        
        // Mostrar mensagem na tela de boas-vindas
        function showWelcomeMessage(message, type = 'info') {
            // Criar elemento de mensagem se n√£o existir
            let messageElement = document.getElementById('welcomeMessage');
            if (!messageElement) {
                messageElement = document.createElement('div');
                messageElement.id = 'welcomeMessage';
                messageElement.style.cssText = `
                    position: absolute;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    padding: 10px 20px;
                    border-radius: 10px;
                    font-size: 12px;
                    font-weight: bold;
                    z-index: 10001;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                `;
                document.body.appendChild(messageElement);
            }
            
            // Definir estilo baseado no tipo
            const styles = {
                error: 'background: rgba(220, 53, 69, 0.9); color: white; border: 2px solid #dc3545;',
                success: 'background: rgba(40, 167, 69, 0.9); color: white; border: 2px solid #28a745;',
                info: 'background: rgba(240, 170, 83, 0.9); color: #3e0a29; border: 2px solid #f0aa53;'
            };
            
            messageElement.style.cssText += styles[type] || styles.info;
            messageElement.textContent = message;
            messageElement.style.opacity = '1';
            
            // Auto-ocultar ap√≥s 4 segundos
            setTimeout(() => {
                messageElement.style.opacity = '0';
            }, 4000);
        }
        
        // Inicializar sistema principal
        function initializeMainSystem() {
            // Carregar configura√ß√µes do usu√°rio
            loadUserSettings();
            
            // Inicializar sistemas
            initAfastSystem();
            initPlanetaryWidget();
            initWixSync();
            initBackupSystem();
            initGamificationSystem();
            generateDesktopIcons();
            initRegisterSystem();
            
            // Aplicar tema salvo
            const savedTheme = localStorage.getItem('auroraOS_theme');
            if (savedTheme) {
                applyTheme(savedTheme);
            }
            
            console.log('Sistema Aurora OS inicializado com sucesso!');
        }
        
        function enterSystem() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            
            // Tocar sons de dial-up em sequ√™ncia
            playDialupSounds();
            
            welcomeScreen.classList.add('hidden');
            
            setTimeout(() => {
                welcomeScreen.style.display = 'none';
                
                // Verificar se usu√°rio j√° est√° logado
                if (checkAutoLogin()) {
                    // Ir direto para o sistema
                    initMainSystem();
                } else {
                    // Mostrar tela de autentica√ß√£o
                    showAuthScreen();
                }
            }, 1000);
        }
        
        function playDialupSounds() {
            const sound1 = document.getElementById('dialupSound1');
            const sound2 = document.getElementById('dialupSound2');
            
            // Configurar volume baseado nas configura√ß√µes do sistema
            const masterVolume = volumes.master / 100;
            const systemVolume = volumes.system / 100;
            const finalVolume = masterVolume * systemVolume;
            
            sound1.volume = finalVolume;
            sound2.volume = finalVolume;
            
            // Tocar primeiro som
            sound1.play().catch(e => {
                console.log('Erro ao reproduzir primeiro som de dial-up:', e);
            });
            
            // Quando o primeiro som terminar, tocar o segundo
            sound1.addEventListener('ended', function() {
                sound2.play().catch(e => {
                    console.log('Erro ao reproduzir segundo som de dial-up:', e);
                });
            }, { once: true });
        }
        
        function initMainSystem() {
            // Fun√ß√µes j√° existentes de inicializa√ß√£o
            generateDesktopIcons();
            generateStartMenu();
            generateColorPalette();
            generateWallpaperPresets();
            updateClock();
            updatePlanetaryInfo();
            loadPersonalization();
                 // üåü Inicializar wallpapers din√¢micos e part√≠culas
            initDynamicWallpaper();
            
            // üéµ Inicializar sistema de √°udio ambiente
            initAmbientAudio();
            
            // Inicializar workspaces virtuais e snap zones
            initWorkspaces();
            
            // üì± Inicializar gestos touch e responsividade
            initTouchGestures();
            adaptToMobile();
            
            // ü§ñ Inicializar Gatomante IA Avan√ßada
            initVoiceRecognition();
            
            // Inicializar Gatomante ap√≥s entrar no sistema√ÅST!
            loadAfastVoiceSettings();
            loadAfastNotifications();
            initAfastSystem();
            
            // Carregar aplica√ß√µes recentes e favoritos
            loadRecentAndFavorites();
            
            // Inicializar part√≠culas din√¢micas
            initDynamicParticles();
            
            // Carregar foto de perfil e wallpaper personalizado
            loadUserProfilePhoto();
            loadCustomWallpaper();
            
            // Atualiza rel√≥gio a cada segundo
            setInterval(updateClock, 1000);
            
            // Atualiza informa√ß√µes planet√°rias a cada minuto
            setInterval(updatePlanetaryInfo, 60000);
            
            // Event listeners
            setupEventListeners();
            
            // Inicializar Gatomante ap√≥s entrar no sistema
            setTimeout(() => {
                initGatomante();
                // Detectar conquistas periodicamente
                setInterval(detectarConquistas, 30000); // A cada 30 segundos
                
                // Inicializar sistema AF√ÅST
                initAfastSystem();
            }, 2000);
        }
        
        // Sistema de Autentica√ß√£o
        let currentUser = null;
        let userDatabase = JSON.parse(localStorage.getItem('auroraOS_users') || '{}');
        
        // Criar conta demo se n√£o existir
        function initDemoAccount() {
            const demoEmail = 'demo@auroraos.com';
            
            if (!userDatabase[demoEmail]) {
                const demoUser = {
                    id: 'demo_user_001',
                    name: 'Luna Mystica',
                    email: demoEmail,
                    password: 'demo123',
                    createdAt: '2024-01-15T14:30:00.000Z',
                    receiveNotifications: true,
                    birthData: {
                        date: '1990-07-23',
                        time: '14:30',
                        place: 'S√£o Paulo, SP, Brasil',
                        hasAstrologicalData: true
                    },
                    astrologicalProfile: {
                        calculatedAt: '2024-01-15T14:30:00.000Z',
                        birthData: {
                            date: '1990-07-23',
                            time: '14:30',
                            place: 'S√£o Paulo, SP, Brasil'
                        },
                        sunSign: { name: 'Le√£o', symbol: '‚ôå', element: 'Fogo', quality: 'Fixo' },
                        moonSign: { name: 'Escorpi√£o', symbol: '‚ôè', element: '√Ågua' },
                        ascendant: { name: 'Libra', symbol: '‚ôé' },
                        elements: { Fogo: 1, Terra: 0, Ar: 1, √Ågua: 1 },
                        qualities: { Cardinal: 0, Fixo: 1, Mut√°vel: 0 },
                        personalityTraits: ['Criativo', 'Generoso', 'Dram√°tico', 'Intenso', 'Transformador'],
                        recommendations: [
                            'Pratique exerc√≠cios f√≠sicos regulares para canalizar sua energia',
                            'Desenvolva projetos criativos que despertem sua paix√£o',
                            'Medite para equilibrar sua impulsividade natural',
                            'Honre suas emo√ß√µes e pratique autocompaix√£o',
                            'Desenvolva sua intui√ß√£o atrav√©s da medita√ß√£o'
                        ]
                    },
                    settings: {
                        theme: 2, // Tema Roxo Imperial
                        wallpaper: 1, // Gradiente Aurora
                        volumes: { master: 75, notifications: 60, system: 65 },
                        showPlanetaryWidget: true,
                        showNotifications: true,
                        showVolumeControl: true
                    },
                    stats: {
                        loginCount: 47,
                        totalSessionTime: 12540, // em minutos
                        personalizationChanges: 15,
                        appsOpened: 89,
                        afastAlertsReceived: 8
                    }
                };
                
                userDatabase[demoEmail] = demoUser;
                localStorage.setItem('auroraOS_users', JSON.stringify(userDatabase));
            }
        }
        
        function showAuthScreen() {
            const authScreen = document.getElementById('authScreen');
            authScreen.classList.add('active');
            createMysticalParticles('authParticles');
        }
        
        function hideAuthScreen() {
            const authScreen = document.getElementById('authScreen');
            authScreen.classList.add('hidden');
            
            setTimeout(() => {
                authScreen.style.display = 'none';
                authScreen.classList.remove('hidden');
            }, 1000);
        }
        
        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'flex';
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('forgotForm').style.display = 'none';
            clearMessages();
        }
        
        function showRegisterForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'flex';
            document.getElementById('forgotForm').style.display = 'none';
            clearMessages();
        }
        
        function showForgotPassword() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('forgotForm').style.display = 'flex';
            clearMessages();
        }
        
        function clearMessages() {
            document.getElementById('authMessage').style.display = 'none';
            document.getElementById('registerMessage').style.display = 'none';
            document.getElementById('forgotMessage').style.display = 'none';
        }
        
        function showMessage(elementId, message, isError = true) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = isError ? 'auth-error' : 'auth-success';
            element.style.display = 'block';
        }
        
        function showLoading(loadingId, show = true) {
            const element = document.getElementById(loadingId);
            element.classList.toggle('active', show);
        }
        
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
        
        function validatePassword(password) {
            return password.length >= 6;
        }
        
        function loginDemo() {
            // Inicializar conta demo
            initDemoAccount();
            
            clearMessages();
            showLoading('authLoading', true);
            
            // Simular delay de autentica√ß√£o
            setTimeout(() => {
                const demoUser = userDatabase['demo@auroraos.com'];
                
                if (demoUser) {
                    // Login bem-sucedido
                    currentUser = demoUser;
                    sessionStorage.setItem('auroraOS_current_user', JSON.stringify(demoUser));
                    
                    showLoading('authLoading', false);
                    showMessage('authMessage', `Bem-vindo √† conta demo, ${demoUser.name}! Explore todas as funcionalidades m√≠sticas.`, false);
                    
                    // Entrar no sistema ap√≥s 2 segundos
                    setTimeout(() => {
                        hideAuthScreen();
                        setTimeout(() => {
                            initMainSystem();
                            
                            // Mostrar dica especial do Gatomante para conta demo
                            setTimeout(() => {
                                gatomanteContextual('demo_login', { userName: demoUser.name });
                            }, 3000);
                        }, 1000);
                    }, 2000);
                } else {
                    showLoading('authLoading', false);
                    showMessage('authMessage', 'Erro ao carregar conta demo. Tente novamente.');
                }
            }, 1500);
        }
        
        function performLogin() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            clearMessages();
            
            if (!email || !password) {
                showMessage('authMessage', 'Por favor, preencha todos os campos.');
                return;
            }
            
            showLoading('authLoading', true);
            
            // Simular delay de autentica√ß√£o
            setTimeout(() => {
                // Verificar credenciais
                const user = userDatabase[email.toLowerCase()];
                
                if (!user || user.password !== password) {
                    showLoading('authLoading', false);
                    showMessage('authMessage', 'Email/usu√°rio ou senha incorretos.');
                    return;
                }
                
                // Login bem-sucedido
                currentUser = user;
                
                // Salvar sess√£o
                if (rememberMe) {
                    localStorage.setItem('auroraOS_current_user', JSON.stringify(user));
                } else {
                    sessionStorage.setItem('auroraOS_current_user', JSON.stringify(user));
                }
                
                showLoading('authLoading', false);
                showMessage('authMessage', `Bem-vindo de volta, ${user.name}!`, false);
                
                // Carregar configura√ß√µes do usu√°rio
                loadUserSettings();
                
                // Entrar no sistema ap√≥s 1.5 segundos
                setTimeout(() => {
                    hideAuthScreen();
                    setTimeout(() => {
                        initMainSystem();
                        // Notificar Gatomante sobre login bem-sucedido
                        setTimeout(() => {
                            gatomanteContextual('login_sucesso');
                            detectarConquistas();
                        }, 3000);
                    }, 1000);
                }, 1500);
                
            }, 1500);
        }
        
        function performRegister() {
            const name = document.getElementById('registerName').value.trim();
            const email = document.getElementById('registerEmail').value.trim().toLowerCase();
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const acceptTerms = document.getElementById('acceptTerms').checked;
            const receiveNotifications = document.getElementById('receiveNotifications').checked;
            
            // Dados astrol√≥gicos opcionais
            const birthDate = document.getElementById('birthDate').value;
            const birthTime = document.getElementById('birthTime').value;
            const birthPlace = document.getElementById('birthPlace').value.trim();
            
            clearMessages();
            
            // Valida√ß√µes
            if (!name || !email || !password || !confirmPassword) {
                showMessage('registerMessage', 'Por favor, preencha todos os campos obrigat√≥rios.');
                return;
            }
            
            if (!validateEmail(email)) {
                showMessage('registerMessage', 'Por favor, digite um email v√°lido.');
                return;
            }
            
            if (!validatePassword(password)) {
                showMessage('registerMessage', 'A senha deve ter pelo menos 6 caracteres.');
                return;
            }
            
            if (password !== confirmPassword) {
                showMessage('registerMessage', 'As senhas n√£o coincidem.');
                return;
            }
            
            if (!acceptTerms) {
                showMessage('registerMessage', 'Voc√™ deve aceitar os Termos de Uso.');
                return;
            }
            
            if (userDatabase[email]) {
                showMessage('registerMessage', 'Este email j√° est√° cadastrado.');
                return;
            }
            
            showLoading('registerLoading', true);
            
            // Simular delay de registro
            setTimeout(() => {
                // Criar novo usu√°rio
                const newUser = {
                    id: Date.now().toString(),
                    name: name,
                    email: email,
                    password: password,
                    createdAt: new Date().toISOString(),
                    receiveNotifications: receiveNotifications,
                    birthData: {
                        date: birthDate,
                        time: birthTime,
                        place: birthPlace,
                        hasAstrologicalData: !!(birthDate && birthTime && birthPlace)
                    },
                    astrologicalProfile: null, // Ser√° calculado se dados estiverem dispon√≠veis
                    settings: {
                        theme: 0,
                        wallpaper: 0,
                        volumes: { master: 70, notifications: 50, system: 60 },
                        showPlanetaryWidget: true,
                        showNotifications: true,
                        showVolumeControl: true
                    }
                };
                
                // Calcular mapa astral se dados estiverem dispon√≠veis
                if (newUser.birthData.hasAstrologicalData) {
                    newUser.astrologicalProfile = calculateAstrologicalProfile(birthDate, birthTime, birthPlace);
                }
                
                // Salvar no banco de dados
                userDatabase[email] = newUser;
                localStorage.setItem('auroraOS_users', JSON.stringify(userDatabase));
                
                showLoading('registerLoading', false);
                showMessage('registerMessage', `Conta criada com sucesso! Bem-vindo, ${name}!`, false);
                
                // Auto-login
                currentUser = newUser;
                sessionStorage.setItem('auroraOS_current_user', JSON.stringify(newUser));
                
                // Entrar no sistema ap√≥s 2 segundos
                setTimeout(() => {
                    hideAuthScreen();
                    setTimeout(() => {
                        initMainSystem();
                    }, 1000);
                }, 2000);
                
            }, 2000);
        }
        
        function performForgotPassword() {
            const email = document.getElementById('forgotEmail').value.trim().toLowerCase();
            
            clearMessages();
            
            if (!email) {
                showMessage('forgotMessage', 'Por favor, digite seu email.', true);
                return;
            }
            
            if (!validateEmail(email)) {
                showMessage('forgotMessage', 'Por favor, digite um email v√°lido.', true);
                return;
            }
            
            showLoading('forgotLoading', true);
            
            // Simular envio de email
            setTimeout(() => {
                showLoading('forgotLoading', false);
                
                if (userDatabase[email]) {
                    showMessage('forgotMessage', 'Link de recupera√ß√£o enviado para seu email!', false);
                } else {
                    showMessage('forgotMessage', 'Email n√£o encontrado em nossa base de dados.', true);
                }
            }, 2000);
        }
        
        function loadUserSettings() {
            if (!currentUser || !currentUser.settings) return;
            
            const settings = currentUser.settings;
            
            // Aplicar configura√ß√µes salvas
            currentTheme = settings.theme || 0;
            currentWallpaper = settings.wallpaper || 0;
            volumes = settings.volumes || { master: 70, notifications: 50, system: 60 };
            
            applyColorTheme();
            applyWallpaper();
        }
        
        function saveUserSettings() {
            if (!currentUser) return;
            
            // Atualizar configura√ß√µes do usu√°rio
            currentUser.settings = {
                theme: currentTheme,
                wallpaper: currentWallpaper,
                volumes: volumes,
                showPlanetaryWidget: document.getElementById('showPlanetaryWidget')?.checked || true,
                showNotifications: document.getElementById('showNotifications')?.checked || true,
                showVolumeControl: document.getElementById('showVolumeControl')?.checked || true
            };
            
            // Salvar no banco de dados
            userDatabase[currentUser.email] = currentUser;
            localStorage.setItem('auroraOS_users', JSON.stringify(userDatabase));
            
            // Atualizar sess√£o
            const storage = localStorage.getItem('auroraOS_current_user') ? localStorage : sessionStorage;
            storage.setItem('auroraOS_current_user', JSON.stringify(currentUser));
        }
        
        function checkAutoLogin() {
            // Verificar se h√° usu√°rio logado
            const savedUser = localStorage.getItem('auroraOS_current_user') || 
                             sessionStorage.getItem('auroraOS_current_user');
            
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                loadUserSettings();
                return true;
            }
            
            return false;
        }
        
        function logout() {
            currentUser = null;
            localStorage.removeItem('auroraOS_current_user');
            sessionStorage.removeItem('auroraOS_current_user');
            
            // Recarregar p√°gina para reiniciar sistema
            location.reload();
        }
        
        // ========================================
        // üõ°Ô∏è SISTEMA AF√ÅST! - ANTIV√çRUS ASTROL√ìGICO
        // ========================================
        
        // Base de dados de eventos astrol√≥gicos reformulada
        const afastEvents = {
            mercuryRetrograde: {
                name: "Merc√∫rio Retr√≥grado",
                icon: "‚òø",
                shortAlert: "Af√°st! Uma amea√ßa foi detectada: Merc√∫rio retr√≥grado.",
                description: "Comunica√ß√£o vulner√°vel. Reforce sua paci√™ncia.",
                voiceAlert: "Uma amea√ßa foi detectada: Merc√∫rio retr√≥grado. Comunica√ß√£o vulner√°vel. Reforce sua paci√™ncia.",
                severity: "critical",
                duration: 21,
                color: "#ff4444"
            },
            jupiterRetrograde: {
                name: "J√∫piter Retr√≥grado", 
                icon: "‚ôÉ",
                shortAlert: "Af√°st! J√∫piter retr√≥grado. Expans√µes em quarentena.",
                description: "Expans√µes bloqueadas. Evite promessas grandiosas.",
                voiceAlert: "J√∫piter em retr√≥grado. Expans√µes bloqueadas. Evite promessas grandiosas.",
                severity: "warning",
                duration: 120,
                color: "#ff8800"
            },
            fullMoon: {
                name: "Lua Cheia",
                icon: "üåï",
                shortAlert: "Lua Cheia detectada. Emo√ß√µes em modo m√°ximo.",
                description: "Emo√ß√µes inst√°veis podem comprometer o sistema.",
                voiceAlert: "Uma amea√ßa foi detectada: Lua Cheia em andamento. Emo√ß√µes inst√°veis podem comprometer o sistema.",
                severity: "warning",
                duration: 3,
                color: "#ffaa00"
            },
            newMoon: {
                name: "Lua Nova",
                icon: "üåë",
                shortAlert: "Af√°st! Lua Nova ativada. Hora de reinicializar inten√ß√µes.",
                description: "Rituais e inten√ß√µes prontos para instala√ß√£o.",
                voiceAlert: "Varredura conclu√≠da. Lua Nova ativa. Rituais e inten√ß√µes prontos para instala√ß√£o.",
                severity: "info",
                duration: 3,
                color: "#4488ff"
            },
            marsHour: {
                name: "Hora de Marte",
                icon: "‚ôÇ",
                shortAlert: "Af√°st! Hora de Marte: discuss√µes em risco de explos√£o.",
                description: "Conflitos em potencial. Proteja seus relacionamentos.",
                voiceAlert: "Af√°st! Hora de Marte iniciada. Conflitos em potencial. Proteja seus relacionamentos.",
                severity: "warning",
                duration: 1,
                color: "#ff6600"
            },
            venusHour: {
                name: "Hora de V√™nus",
                icon: "‚ôÄ",
                shortAlert: "Hora de V√™nus detectada. Vulnerabilidade amorosa ativa.",
                description: "Amea√ßa de distra√ß√µes rom√¢nticas detectada.",
                voiceAlert: "Hora de V√™nus em curso. Amea√ßa de distra√ß√µes rom√¢nticas detectada.",
                severity: "info",
                duration: 1,
                color: "#ff69b4"
            },
            voidMoon: {
                name: "Lua Fora de Curso",
                icon: "üåë",
                shortAlert: "Af√°st! Lua Fora de Curso. Decis√µes inst√°veis detectadas.",
                description: "Nenhum feiti√ßo seguro at√© a pr√≥xima fase.",
                voiceAlert: "Uma amea√ßa foi detectada: Lua Fora de Curso. Decis√µes correm risco de falha cr√≠tica.",
                severity: "critical",
                duration: 8,
                color: "#cc0000"
            },
            eclipse: {
                name: "Eclipse Solar/Lunar",
                icon: "üåò",
                shortAlert: "Af√°st! Eclipse detectado. Transforma√ß√µes em andamento.",
                description: "Energias intensas de mudan√ßa ativas.",
                voiceAlert: "Aten√ß√£o. Eclipse detectado. Energias intensas de transforma√ß√£o em andamento. Sistema em alerta m√°ximo.",
                severity: "critical",
                duration: 7,
                color: "#8800cc"
            }
        };
        
        // ========================================
        // üõ°Ô∏è SISTEMA AF√ÅST! - ESTILO MSN CONFORME ESPECIFICA√á√ïES
        // ========================================
        
        let afastNotifications = [];
        let afastVoiceEnabled = true;
        let afastFirstTimeToday = true;
        let afastLastNotificationTime = 0;
        
        // Configura√ß√µes de voz feminina brasileira
        const afastVoiceConfig = {
            lang: 'pt-BR',
            voice: null,
            rate: 0.8,
            pitch: 1.0,
            volume: 0.7
        };
        
        // Base de eventos conforme especifica√ß√µes originais
        const afastEvents = {
            mercuryRetrograde: {
                name: "Merc√∫rio Retr√≥grado",
                message: "Uma amea√ßa foi detectada: Merc√∫rio retr√≥grado",
                shortAlert: "Merc√∫rio retr√≥grado detectado",
                description: "Comunica√ß√£o vulner√°vel. Reforce sua paci√™ncia.",
                advice: "Evite assinar contratos e revisar comunica√ß√µes importantes.",
                voiceAlert: "AF√ÅSTE! Merc√∫rio retr√≥grado detectado. Comunica√ß√µes em risco.",
                severity: "critical",
                hasVoice: true,
                color: "#dc2626"
            },
            jupiterRetrograde: {
                name: "J√∫piter Retr√≥grado",
                message: "J√∫piter retr√≥grado. Expans√µes em quarentena.",
                shortAlert: "J√∫piter retr√≥grado ativo",
                description: "Evite promessas grandiosas e investimentos arriscados.",
                advice: "Momento de reflex√£o sobre crescimento pessoal.",
                voiceAlert: "AF√ÅSTE! J√∫piter retr√≥grado. Expans√µes bloqueadas.",
                severity: "warning",
                hasVoice: true,
                color: "#f59e0b"
            },
            fullMoon: {
                name: "Lua Cheia",
                message: "Lua Cheia detectada. Emo√ß√µes em modo m√°ximo.",
                shortAlert: "Lua Cheia ativa",
                description: "Emo√ß√µes inst√°veis podem comprometer o sistema.",
                advice: "Pratique medita√ß√£o e evite decis√µes impulsivas.",
                voiceAlert: "AF√ÅSTE! Lua Cheia. Emo√ß√µes intensificadas.",
                severity: "warning",
                hasVoice: true,
                color: "#8b5cf6"
            },
            newMoon: {
                name: "Lua Nova",
                message: "Lua Nova ativada. Hora de reinicializar inten√ß√µes.",
                shortAlert: "Lua Nova detectada",
                description: "Rituais e inten√ß√µes prontos para instala√ß√£o.",
                advice: "Momento ideal para novos come√ßos e definir metas.",
                voiceAlert: "Lua Nova detectada. Energias de renova√ß√£o ativas.",
                severity: "info",
                hasVoice: false,
                color: "#10b981"
            },
            marsHour: {
                name: "Hora de Marte",
                message: "AF√ÅSTE! Hora de Marte: discuss√µes em risco de explos√£o.",
                shortAlert: "Hora de Marte ativa",
                description: "Proteja seus relacionamentos de conflitos desnecess√°rios.",
                advice: "Evite confrontos e pratique paci√™ncia.",
                voiceAlert: "AF√ÅSTE! Hora de Marte. Conflitos em potencial.",
                severity: "warning",
                hasVoice: true,
                color: "#dc2626"
            },
            venusHour: {
                name: "Hora de V√™nus",
                message: "Hora de V√™nus detectada. Vulnerabilidade amorosa ativa.",
                shortAlert: "Hora de V√™nus ativa",
                description: "Energias rom√¢nticas intensas podem afetar julgamento.",
                advice: "Momento favor√°vel para amor e criatividade.",
                voiceAlert: "Hora de V√™nus ativa. Energias rom√¢nticas intensificadas.",
                severity: "info",
                hasVoice: false,
                color: "#ec4899"
            },
            voidMoon: {
                name: "Lua Fora de Curso",
                message: "Uma amea√ßa foi detectada: Lua Fora de Curso.",
                shortAlert: "Lua Fora de Curso",
                description: "Decis√µes correm risco de falha cr√≠tica.",
                advice: "Evite decis√µes importantes at√© a Lua entrar em novo signo.",
                voiceAlert: "AF√ÅSTE! Lua Fora de Curso detectada. Decis√µes em risco.",
                severity: "critical",
                hasVoice: true,
                color: "#7c2d12"
            },
            eclipse: {
                name: "Eclipse",
                message: "Sistema em espera. Transforma√ß√µes em andamento.",
                shortAlert: "Eclipse detectado",
                description: "Eclipse detectado. Mudan√ßas profundas se aproximam.",
                advice: "Per√≠odo de transforma√ß√£o intensa. Mantenha-se flex√≠vel.",
                voiceAlert: "AF√ÅSTE! Eclipse detectado. Transforma√ß√µes em curso.",
                severity: "critical",
                hasVoice: true,
                color: "#1f2937"
            },
            saturnAspect: {
                name: "Aspecto de Saturno",
                message: "AF√ÅSTE! Saturno em aspecto tenso detectado.",
                shortAlert: "Saturno em aspecto tenso",
                description: "Limita√ß√µes e responsabilidades intensificadas.",
                advice: "Foque em disciplina e estrutura√ß√£o de projetos.",
                voiceAlert: "AF√ÅSTE! Saturno em aspecto tenso. Responsabilidades aumentadas.",
                severity: "warning",
                hasVoice: true,
                color: "#374151"
            }
        };
        
        // ========================================
        // üõ°Ô∏è SISTEMA AF√ÅST! REAL COMPLETO
        // Detec√ß√£o de eventos astrol√≥gicos reais
        // ========================================
        
        let afastRealTimeData = {
            lastUpdate: null,
            currentEvents: [],
            upcomingEvents: [],
            historicalEvents: [],
            userSettings: {
                enabled: true,
                frequency: 'normal', // low, normal, high
                types: {
                    mercury_retrograde: true,
                    full_moon: true,
                    new_moon: true,
                    eclipses: true,
                    planetary_aspects: true,
                    void_moon: true,
                    planetary_hours: false
                },
                notifications: {
                    sound: true,
                    voice: true,
                    popup: true,
                    history: true
                }
            }
        };
        
        // Central de notifica√ß√µes AF√ÅST
        let afastNotificationCenter = {
            notifications: [],
            maxHistory: 100,
            isOpen: false
        };
        
        function initAfastSystem() {
            console.log('üõ°Ô∏è Inicializando Sistema AF√ÅST! Real - Detec√ß√£o Astron√¥mica');
            
            // Carregar configura√ß√µes do usu√°rio
            loadAfastSettings();
            
            // Configurar voz feminina brasileira
            setupAfastVoice();
            
            // Inicializar detec√ß√£o de eventos reais
            initRealTimeAstrologyDetection();
            
            // Criar central de notifica√ß√µes
            createNotificationCenter();
            
            // Verificar eventos atuais
            checkCurrentAstrologicalEvents();
            
            // Configurar verifica√ß√£o peri√≥dica
            setInterval(checkCurrentAstrologicalEvents, 300000); // A cada 5 minutos
            
            // Primeira mensagem do sistema
            setTimeout(() => {
                const welcomeNotification = {
                    id: 'afast_init_' + Date.now(),
                    type: 'system',
                    title: 'AF√ÅST! Sistema Real Ativado',
                    message: "Sistema de detec√ß√£o astrol√≥gica em tempo real iniciado.",
                    description: "Monitoramento ativo de eventos c√≥smicos e prote√ß√µes astrais.",
                    severity: "info",
                    timestamp: new Date(),
                    hasVoice: true,
                        voiceAlert: "AF√ÅSTE! Sistema de prote√ß√£o astrol√≥gica ativado."
                    };
                    showAfastMsnNotification(welcomeNotification);
                    afastFirstTimeToday = false;
                }, 3000);
            }
            
            // Verificar eventos astrol√≥gicos a cada 5 minutos
            setInterval(checkAstrologicalEvents, 300000);
            
            // Primeira verifica√ß√£o ap√≥s 10 segundos
            setTimeout(checkAstrologicalEvents, 10000);
        }
        
        function setupAfastVoice() {
            if ('speechSynthesis' in window) {
                // Aguardar vozes carregarem
                const loadVoices = () => {
                    const voices = speechSynthesis.getVoices();
                    console.log('üéôÔ∏è Vozes dispon√≠veis:', voices.map(v => `${v.name} (${v.lang})`));
                    
                    // Buscar voz feminina em portugu√™s brasileiro - ordem de prioridade
                    const brazilianVoices = voices.filter(voice => 
                        voice.lang.includes('pt-BR') || 
                        voice.lang.includes('pt_BR') ||
                        voice.lang.includes('pt')
                    );
                    
                    // Lista de nomes que indicam vozes femininas (mais abrangente)
                    const femaleIndicators = [
                        'female', 'feminina', 'woman', 'mulher',
                        'maria', 'ana', 'lucia', 'carla', 'paula', 'julia',
                        'fernanda', 'patricia', 'monica', 'sandra', 'rita',
                        'google portugu√™s do brasil', 'microsoft helena',
                        'microsoft maria', 'luciana', 'vitoria', 'beatriz'
                    ];
                    
                    // Buscar voz feminina brasileira
                    let selectedVoice = null;
                    
                    // Primeira tentativa: voz explicitamente feminina brasileira
                    selectedVoice = brazilianVoices.find(voice => 
                        femaleIndicators.some(indicator => 
                            voice.name.toLowerCase().includes(indicator)
                        )
                    );
                    
                    // Segunda tentativa: qualquer voz brasileira
                    if (!selectedVoice && brazilianVoices.length > 0) {
                        selectedVoice = brazilianVoices[0];
                    }
                    
                    // Terceira tentativa: voz feminina em qualquer idioma
                    if (!selectedVoice) {
                        selectedVoice = voices.find(voice => 
                            femaleIndicators.some(indicator => 
                                voice.name.toLowerCase().includes(indicator)
                            )
                        );
                    }
                    
                    // √öltima tentativa: primeira voz dispon√≠vel
                    if (!selectedVoice && voices.length > 0) {
                        selectedVoice = voices[0];
                    }
                    
                    afastVoiceConfig.voice = selectedVoice;
                    
                    console.log('üéôÔ∏è Voz AF√ÅST selecionada:', {
                        name: afastVoiceConfig.voice?.name || 'Nenhuma',
                        lang: afastVoiceConfig.voice?.lang || 'N/A',
                        gender: afastVoiceConfig.voice?.name?.toLowerCase().includes('female') || 
                               afastVoiceConfig.voice?.name?.toLowerCase().includes('maria') ? 'Feminina' : 'Indefinido'
                    });
                };
                
                // Tentar carregar vozes imediatamente
                if (speechSynthesis.getVoices().length > 0) {
                    loadVoices();
                } else {
                    // Aguardar evento de carregamento das vozes
                    speechSynthesis.onvoiceschanged = loadVoices;
                    
                    // Timeout de seguran√ßa para tentar novamente ap√≥s 2 segundos
                    setTimeout(() => {
                        if (!afastVoiceConfig.voice) {
                            loadVoices();
                        }
                    }, 2000);
                }
            } else {
                console.log('üéôÔ∏è S√≠ntese de voz n√£o suportada neste navegador');
            }
        }
        
        function checkFirstTimeToday() {
            const today = new Date().toDateString();
            const lastAfastDay = localStorage.getItem('auroraOS_afastLastDay');
            
            if (lastAfastDay !== today) {
                afastFirstTimeToday = true;
                localStorage.setItem('auroraOS_afastLastDay', today);
            } else {
                afastFirstTimeToday = false;
            }
        }
        
        function showAfastWelcome() {
            const welcomeNotification = {
                id: 'welcome_' + Date.now(),
                type: 'welcome',
                title: 'Sistema AF√ÅST! Ativado',
                message: 'Boas-vindas ao Af√°st! O c√©u est√° sob vigil√¢ncia.',
                severity: 'info',
                timestamp: new Date(),
                hasVoice: true
            };
            
            showAfastMsnNotification(welcomeNotification);
            
            // Falar mensagem de boas-vindas
            if (afastVoiceEnabled) {
                setTimeout(() => {
                    speakAfastMessage('Boas-vindas ao Af√°st! O c√©u est√° sob vigil√¢ncia.');
                }, 1000);
            }
        }
        
        function checkAstrologicalEvents() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();
            const day = now.getDay();
            
            // Evitar spam de notifica√ß√µes (m√≠nimo 5 minutos entre alertas)
            if (Date.now() - afastLastNotificationTime < 300000) return;
            
            // Simula√ß√£o inteligente de eventos astrol√≥gicos
            
            // Merc√∫rio Retr√≥grado (mais comum)
            if ((hour === 9 || hour === 15 || hour === 21) && minute < 5 && Math.random() < 0.4) {
                triggerAfastEvent('mercuryRetrograde');
            }
            
            // Lua Fora de Curso (per√≠odos espec√≠ficos)
            if ((hour === 2 || hour === 14 || hour === 23) && Math.random() < 0.3) {
                triggerAfastEvent('voidMoon');
            }
            
            // Hora de Marte (conflitos)
            if ((hour === 12 || hour === 18) && Math.random() < 0.35) {
                triggerAfastEvent('marsHour');
            }
            
            // Hora de V√™nus (romance)
            if ((hour === 10 || hour === 16 || hour === 20) && Math.random() < 0.25) {
                triggerAfastEvent('venusHour');
            }
            
            // Lua Cheia (emo√ß√µes intensas)
            if (hour === 0 && day === 5 && Math.random() < 0.6) { // Sexta √† meia-noite
                triggerAfastEvent('fullMoon');
            }
            
            // Lua Nova (renova√ß√£o)
            if (hour === 6 && day === 1 && Math.random() < 0.5) { // Segunda de manh√£
                triggerAfastEvent('newMoon');
            }
            
            // Eclipse (raro e cr√≠tico)
            if (hour === 13 && day === 0 && Math.random() < 0.1) { // Domingo √† tarde
                triggerAfastEvent('eclipse');
            }
            
            // J√∫piter Retr√≥grado (expans√µes bloqueadas)
            if (hour === 11 && Math.random() < 0.2) {
                triggerAfastEvent('jupiterRetrograde');
            }
        }
        
        function triggerAfastEvent(eventType) {
            const event = afastEvents[eventType];
            if (!event) return;
            
            // Verificar se j√° existe notifica√ß√£o ativa deste tipo recente
            const recentNotification = afastNotifications.find(n => 
                n.type === eventType && 
                (Date.now() - new Date(n.timestamp).getTime()) < 1800000 // 30 minutos
            );
            if (recentNotification) return;
            
            // Atualizar timestamp da √∫ltima notifica√ß√£o
            afastLastNotificationTime = Date.now();
            
            // Criar nova notifica√ß√£o
            const notification = {
                id: Date.now(),
                type: eventType,
                title: `AF√ÅST! ${event.name}`,
                message: event.message,
                shortAlert: event.shortAlert,
                description: event.description,
                advice: event.advice,
                voiceAlert: event.voiceAlert,
                severity: event.severity,
                timestamp: new Date(),
                hasVoice: event.hasVoice,
                color: event.color,
                event: event
            };
            
            afastNotifications.push(notification);
            saveAfastNotifications();
            
            // Mostrar notifica√ß√£o estilo MSN
            showAfastMsnNotification(notification);
            
            // Reproduzir som e voz se necess√°rio
            if (notification.hasVoice && afastVoiceEnabled) {
                setTimeout(() => {
                    playAfastSyntheticSound();
                    speakAfastMessage(notification.voiceAlert || notification.shortAlert);
                }, 500);
            } else {
                playAfastSyntheticSound();
            }
            
            // Adicionar √† central de notifica√ß√µes
            addToNotificationCenter(notification);
            
            // Notificar Gatomante
            setTimeout(() => {
                gatomanteContextual('afast_alert', { event: event.name });
            }, 3000);
        }
        
        function showAfastMsnNotification(notification) {
            // Remover notifica√ß√£o anterior se existir
            const existingNotif = document.getElementById('afastMSNNotification');
            if (existingNotif) {
                existingNotif.remove();
            }
            
            // Criar elemento de notifica√ß√£o estilo MSN
            const msnNotif = document.createElement('div');
            msnNotif.id = 'afastMSNNotification';
            msnNotif.className = `afast-msn-notification afast-severity-${notification.severity}`;
            
            // Definir √≠cone baseado na severidade
            const severityIcons = {
                critical: 'üö®',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            msnNotif.innerHTML = `
                <div class="afast-msn-header">
                    <div class="afast-msn-title">
                        <span class="afast-msn-logo">üõ°Ô∏è</span>
                        AF√ÅST! Antiv√≠rus Astrol√≥gico
                    </div>
                    <button class="afast-msn-close" onclick="closeAfastMsnNotification()">√ó</button>
                </div>
                <div class="afast-msn-content">
                    <div class="afast-msn-event">
                        ${severityIcons[notification.severity]} ${notification.message}
                    </div>
                    <div class="afast-msn-description">
                        ${notification.description}
                    </div>
                    <div class="afast-msn-time">
                        ${new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}
                    </div>
                </div>
            `;
            
            // Adicionar ao DOM
            document.body.appendChild(msnNotif);
            
            // Animar entrada
            setTimeout(() => {
                msnNotif.classList.add('show', 'slide-in');
            }, 100);
            
            // Auto-fechar baseado na severidade
            const autoCloseTime = {
                critical: 10000, // 10 segundos
                warning: 7000,   // 7 segundos
                info: 5000       // 5 segundos
            };
            
            setTimeout(() => {
                closeAfastMsnNotification();
            }, autoCloseTime[notification.severity]);
        }
        
        function closeAfastMsnNotification() {
            const notification = document.getElementById('afastMSNNotification');
            if (notification) {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 400);
            }
        }
        
        function playAfastSyntheticSound() {
            try {
                // Criar som sint√©tico estilo MSN/Windows mais aut√™ntico
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const masterVolume = (currentUser?.settings?.volumes?.notifications || 0.7) * 0.4;
                
                // Som de notifica√ß√£o MSN cl√°ssico - sequ√™ncia de 3 tons
                const frequencies = [800, 600, 400];
                const durations = [0.15, 0.15, 0.2];
                
                frequencies.forEach((freq, index) => {
                    setTimeout(() => {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        const filterNode = audioContext.createBiquadFilter();
                        
                        // Configurar filtro para som mais suave
                        filterNode.type = 'lowpass';
                        filterNode.frequency.setValueAtTime(1200, audioContext.currentTime);
                        filterNode.Q.setValueAtTime(1, audioContext.currentTime);
                        
                        // Conectar n√≥s
                        oscillator.connect(filterNode);
                        filterNode.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        // Configurar oscilador
                        oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                        oscillator.type = 'sine';
                        
                        // Envelope de volume (attack-decay)
                        gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                        gainNode.gain.linearRampToValueAtTime(masterVolume, audioContext.currentTime + 0.02);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + durations[index]);
                        
                        // Tocar
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + durations[index]);
                        
                    }, index * 120); // Pequeno delay entre os tons
                });
                
                // Som adicional de "ping" para eventos cr√≠ticos
                setTimeout(() => {
                    const pingOsc = audioContext.createOscillator();
                    const pingGain = audioContext.createGain();
                    
                    pingOsc.connect(pingGain);
                    pingGain.connect(audioContext.destination);
                    
                    pingOsc.frequency.setValueAtTime(1200, audioContext.currentTime);
                    pingOsc.type = 'triangle';
                    
                    pingGain.gain.setValueAtTime(0, audioContext.currentTime);
                    pingGain.gain.linearRampToValueAtTime(masterVolume * 0.6, audioContext.currentTime + 0.01);
                    pingGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    
                    pingOsc.start(audioContext.currentTime);
                    pingOsc.stop(audioContext.currentTime + 0.1);
                }, 500);
                
            } catch (error) {
                console.log('üîä Erro ao reproduzir som sint√©tico AF√ÅST:', error);
                
                // Fallback: usar beep simples do sistema
                try {
                    const context = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = context.createOscillator();
                    const gainNode = context.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(context.destination);
                    
                    oscillator.frequency.value = 800;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, context.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.3);
                    
                    oscillator.start(context.currentTime);
                    oscillator.stop(context.currentTime + 0.3);
                } catch (fallbackError) {
                    console.log('üîä Fallback de som tamb√©m falhou:', fallbackError);
                }
            }
        }
        
        function speakAfastMessage(message) {
            if (!afastVoiceEnabled || !('speechSynthesis' in window)) return;
            
            try {
                // Cancelar qualquer fala anterior
                speechSynthesis.cancel();
                
                // Aguardar um pouco para garantir que o cancelamento foi processado
                setTimeout(() => {
                    const utterance = new SpeechSynthesisUtterance(message);
                    
                    // Configurar voz feminina brasileira
                    if (afastVoiceConfig.voice) {
                        utterance.voice = afastVoiceConfig.voice;
                    }
                    
                    // Configura√ß√µes de voz otimizadas para portugu√™s brasileiro
                    utterance.lang = afastVoiceConfig.lang;
                    utterance.rate = afastVoiceConfig.rate; // Velocidade mais lenta para clareza
                    utterance.pitch = afastVoiceConfig.pitch; // Tom feminino
                    utterance.volume = afastVoiceConfig.volume * (currentUser?.settings?.volumes?.notifications || 0.7);
                    
                    // Eventos de voz
                    utterance.onstart = () => {
                        console.log('üéôÔ∏è AF√ÅST falando:', message);
                        console.log('üéôÔ∏è Usando voz:', afastVoiceConfig.voice?.name || 'Padr√£o');
                    };
                    
                    utterance.onend = () => {
                        console.log('üéôÔ∏è AF√ÅST terminou de falar');
                    };
                    
                    utterance.onerror = (event) => {
                        console.log('üéôÔ∏è Erro na s√≠ntese de voz AF√ÅST:', event.error);
                        
                        // Tentar novamente com configura√ß√µes mais simples
                        setTimeout(() => {
                            const fallbackUtterance = new SpeechSynthesisUtterance(message);
                            fallbackUtterance.lang = 'pt-BR';
                            fallbackUtterance.rate = 0.8;
                            fallbackUtterance.pitch = 1.0;
                            fallbackUtterance.volume = 0.7;
                            speechSynthesis.speak(fallbackUtterance);
                        }, 500);
                    };
                    
                    // Falar com pequeno delay para garantir que a voz est√° pronta
                    setTimeout(() => {
                        speechSynthesis.speak(utterance);
                    }, 100);
                    
                }, 100);
                
            } catch (error) {
                console.log('üéôÔ∏è Erro na s√≠ntese de voz AF√ÅST:', error);
                
                // Fallback simples
                try {
                    const simpleUtterance = new SpeechSynthesisUtterance(message);
                    simpleUtterance.lang = 'pt-BR';
                    speechSynthesis.speak(simpleUtterance);
                } catch (fallbackError) {
                    console.log('üéôÔ∏è Fallback de voz tamb√©m falhou:', fallbackError);
                }
            }
        }
                background: linear-gradient(135deg, ${event.color}22 0%, ${event.color}44 100%);
                border: 2px solid ${event.color};
                border-radius: 8px;
                padding: 15px;
                color: white;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                font-size: 13px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 2000;
                transform: translateX(350px);
                transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                cursor: pointer;
            `;
            
            // √çcone de severidade
            const severityIcons = {
                'critical': 'üö®',
                'warning': '‚ö†Ô∏è',
                'info': '‚ÑπÔ∏è'
            };
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; margin-bottom: 8px;">
                    <div style="font-size: 20px; margin-right: 10px;">${severityIcons[event.severity]} ${event.icon}</div>
                    <div style="font-weight: bold; flex: 1;">AF√ÅST!</div>
                    <div style="cursor: pointer; font-size: 16px; opacity: 0.7;" onclick="closeAfastMSNNotification()">√ó</div>
                </div>
                <div style="font-weight: bold; margin-bottom: 5px; font-size: 14px;">${event.shortAlert}</div>
                <div style="opacity: 0.9; font-size: 12px;">${event.description}</div>
                <div style="margin-top: 8px; font-size: 11px; opacity: 0.7; text-align: right;">
                    Clique para fechar
                </div>
            `;
            
            // Adicionar ao DOM
            document.body.appendChild(notification);
            
            // Animar entrada
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Auto-fechar baseado na severidade
            const autoCloseTime = event.severity === 'critical' ? 10000 : 
                                 event.severity === 'warning' ? 7000 : 5000;
            
            setTimeout(() => {
                closeAfastMSNNotification();
            }, autoCloseTime);
            
            // Fechar ao clicar
            notification.onclick = closeAfastMSNNotification;
            
            // Som de notifica√ß√£o (ping/bip)
            playNotificationSound();
        }
        
        function closeAfastMSNNotification() {
            const notification = document.getElementById('afastMSNNotification');
            if (notification) {
                notification.style.transform = 'translateX(350px)';
                setTimeout(() => {
                    notification.remove();
                }, 400);
            }
        }
        
        function playNotificationSound() {
            // Som simples de notifica√ß√£o (bip/ping)
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.3 * (volumes.notifications / 100) * (volumes.master / 100), audioContext.currentTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.2);
        }
            afastActive = true;
            
            // Auto-ocultar ap√≥s 15 segundos se n√£o for cr√≠tico
            if (event.severity !== 'critical') {
                setTimeout(() => {
                    if (afastActive) {
                        closeAfastNotification();
                    }
                }, 15000);
            }
        }
        
        function closeAfastNotification() {
            const afastElement = document.getElementById('afastNotification');
            afastElement.classList.remove('active');
            afastActive = false;
        }
        
        function acknowledgeAfastNotification() {
            // Marcar como reconhecida
            const activeNotification = afastNotifications.find(n => n.active && !n.acknowledged);
            if (activeNotification) {
                activeNotification.acknowledged = true;
                activeNotification.active = false;
                saveAfastNotifications();
            }
            
            closeAfastNotification();
            
            // Adicionar √† central de notifica√ß√µes
            addToNotificationCenter(activeNotification);
        }
        
        function snoozeAfastNotification() {
            closeAfastNotification();
            
            // Reagendar para 1 hora
            setTimeout(() => {
                const activeNotification = afastNotifications.find(n => n.active && !n.acknowledged);
                if (activeNotification) {
                    showAfastNotification(activeNotification);
                }
            }, 3600000); // 1 hora
        }
        
        // ========================================
        // üéôÔ∏è SISTEMA DE VOZ AF√ÅST! - VOZ FEMININA
        // ========================================
        
        let afastVoiceEnabled = true;
        let afastFirstTimeToday = true;
        
        function playAfastAlert(event) {
            if (!afastVoiceEnabled || !('speechSynthesis' in window)) return;
            
            // Primeira vez do dia - mensagem de boas-vindas
            if (afastFirstTimeToday) {
                speakAfastMessage("Boas-vindas ao Af√°st! O c√©u est√° sob vigil√¢ncia.", 'welcome');
                afastFirstTimeToday = false;
                
                // Aguardar 3 segundos antes do alerta principal
                setTimeout(() => {
                    if (event.severity === 'critical' || event.severity === 'warning') {
                        speakAfastMessage(event.voiceAlert, event.severity);
                    }
                }, 3000);
            } else {
                // Apenas eventos cr√≠ticos e avisos t√™m voz
                if (event.severity === 'critical' || event.severity === 'warning') {
                    speakAfastMessage(event.voiceAlert, event.severity);
                }
            }
        }
        
        function speakAfastMessage(message, severity) {
            const utterance = new SpeechSynthesisUtterance(message);
            
            // Configura√ß√µes da voz feminina
            utterance.lang = 'pt-BR';
            utterance.rate = 0.7; // Mais devagar para clareza
            utterance.pitch = 1.1; // Tom feminino
            utterance.volume = (volumes.notifications / 100) * (volumes.master / 100);
            
            // Ajustar tom conforme severidade
            switch(severity) {
                case 'critical':
                    utterance.pitch = 1.3; // Mais agudo para urg√™ncia
                    utterance.rate = 0.6;  // Mais devagar para √™nfase
                    break;
                case 'warning':
                    utterance.pitch = 1.1;
                    utterance.rate = 0.7;
                    break;
                case 'info':
                    utterance.pitch = 1.0;
                    utterance.rate = 0.8;
                    break;
                case 'welcome':
                    utterance.pitch = 1.2;
                    utterance.rate = 0.9;
                    break;
            }
            
            // Tentar usar voz feminina se dispon√≠vel
            const voices = speechSynthesis.getVoices();
            const femaleVoice = voices.find(voice => 
                voice.lang.includes('pt') && 
                (voice.name.toLowerCase().includes('female') || 
                 voice.name.toLowerCase().includes('feminina') ||
                 voice.name.toLowerCase().includes('woman'))
            );
            
            if (femaleVoice) {
                utterance.voice = femaleVoice;
            }
            
            speechSynthesis.speak(utterance);
        }
        
        // Easter eggs - frases raras e engra√ßadas
        function getRandomEasterEgg() {
            const easterEggs = [
                "Af√°st! Marte est√° irritado. Melhor n√£o discutir hoje.",
                "Af√°st. A Lua encerrou seu curso. O v√©u est√° inst√°vel.",
                "Sistema c√≥smico inst√°vel. Recomendo um ch√° de camomila.",
                "Af√°st! Merc√∫rio est√° fazendo das suas novamente.",
                "Energia planet√°ria detectada. Seus cristais est√£o vibrando?"
            ];
            
            return easterEggs[Math.floor(Math.random() * easterEggs.length)];
        }
        
        // Configura√ß√µes de voz do usu√°rio
        function toggleAfastVoice() {
            afastVoiceEnabled = !afastVoiceEnabled;
            const status = afastVoiceEnabled ? 'ativada' : 'desativada';
            
            if (afastVoiceEnabled) {
                speakAfastMessage(`Voz do Af√°st ${status}.`, 'info');
            }
            
            // Salvar prefer√™ncia
            localStorage.setItem('auroraOS_afast_voice', afastVoiceEnabled);
        }
        
        function loadAfastVoiceSettings() {
            const saved = localStorage.getItem('auroraOS_afast_voice');
            if (saved !== null) {
                afastVoiceEnabled = JSON.parse(saved);
            }
            
            // Resetar primeira vez a cada dia
            const lastDate = localStorage.getItem('auroraOS_afast_last_date');
            const today = new Date().toDateString();
            if (lastDate !== today) {
                afastFirstTimeToday = true;
                localStorage.setItem('auroraOS_afast_last_date', today);
            } else {
                afastFirstTimeToday = false;
            }
        }
        
        function addToNotificationCenter(notification) {
            const container = document.getElementById('notificationCenterContent');
            const notificationElement = document.createElement('div');
            notificationElement.className = 'notification-item';
            
            const timeStr = notification.timestamp.toLocaleTimeString('pt-BR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            notificationElement.innerHTML = `
                <div class="notification-item-header">
                    <div class="notification-item-title">${notification.event.icon} ${notification.event.name}</div>
                    <div class="notification-item-time">${timeStr}</div>
                </div>
                <div class="notification-item-content">${notification.event.description}</div>
            `;
            
            container.insertBefore(notificationElement, container.firstChild);
            
            // Limitar a 20 notifica√ß√µes
            while (container.children.length > 20) {
                container.removeChild(container.lastChild);
            }
        }
        
        function toggleNotificationCenter() {
            const center = document.getElementById('notificationCenter');
            center.classList.toggle('active');
            
            // Atualizar estat√≠sticas quando abrir
            if (center.classList.contains('active')) {
                updateAfastStats();
                updateNotificationVisibility();
            }
        }
        
        // ========================================
        // üõ°Ô∏è FUN√á√ïES AVAN√áADAS DA CENTRAL AF√ÅST
        // ========================================
        
        let currentFilter = 'all';
        
        function filterNotifications(type) {
            currentFilter = type;
            
            // Atualizar bot√µes ativos
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`filter${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('active');
            
            updateNotificationVisibility();
        }
        
        function updateNotificationVisibility() {
            const notifications = document.querySelectorAll('.notification-item');
            const noNotificationsMsg = document.getElementById('noNotifications');
            let visibleCount = 0;
            
            notifications.forEach(notification => {
                const severity = notification.dataset.severity || 'info';
                const shouldShow = currentFilter === 'all' || severity === currentFilter;
                
                notification.style.display = shouldShow ? 'block' : 'none';
                if (shouldShow) visibleCount++;
            });
            
            // Mostrar/ocultar mensagem de "sem notifica√ß√µes"
            noNotificationsMsg.style.display = visibleCount === 0 ? 'block' : 'none';
        }
        
        function updateAfastStats() {
            const total = afastNotifications.length;
            const critical = afastNotifications.filter(n => n.event.severity === 'critical').length;
            const today = afastNotifications.filter(n => {
                const notifDate = new Date(n.timestamp);
                const todayDate = new Date();
                return notifDate.toDateString() === todayDate.toDateString();
            }).length;
            
            document.getElementById('totalAlerts').textContent = total;
            document.getElementById('criticalAlerts').textContent = critical;
            document.getElementById('todayAlerts').textContent = today;
        }
        
        function clearAllNotifications() {
            if (confirm('Tem certeza que deseja limpar todas as notifica√ß√µes AF√ÅST?')) {
                afastNotifications = [];
                saveAfastNotifications();
                
                // Limpar interface
                const container = document.getElementById('notificationCenterContent');
                const notifications = container.querySelectorAll('.notification-item');
                notifications.forEach(n => n.remove());
                
                // Atualizar estat√≠sticas
                updateAfastStats();
                updateNotificationVisibility();
                
                // Notificar Gatomante
                setTimeout(() => {
                    gatomanteContextual('personalizacao', { acao: 'notifica√ß√µes limpas' });
                }, 1000);
            }
        }
        
        function exportNotifications() {
            if (afastNotifications.length === 0) {
                alert('N√£o h√° notifica√ß√µes para exportar.');
                return;
            }
            
            const exportData = {
                exportedAt: new Date().toISOString(),
                user: currentUser ? currentUser.name : 'Usu√°rio An√¥nimo',
                totalNotifications: afastNotifications.length,
                notifications: afastNotifications.map(n => ({
                    timestamp: n.timestamp,
                    event: n.event.name,
                    severity: n.event.severity,
                    description: n.event.description,
                    advice: n.event.advice,
                    acknowledged: n.acknowledged
                }))
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `afast-notifications-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            // Notificar Gatomante
            setTimeout(() => {
                gatomanteContextual('personalizacao', { acao: 'notifica√ß√µes exportadas' });
            }, 1000);
        }
        
        function afastSettings() {
            alert('üõ°Ô∏è Configura√ß√µes AF√ÅST\n\n' +
                  '‚Ä¢ Monitoramento: Ativo 24/7\n' +
                  '‚Ä¢ Eventos detectados: Merc√∫rio retr√≥grado, Eclipses, Lua fora de curso\n' +
                  '‚Ä¢ Alertas sonoros: Habilitados\n' +
                  '‚Ä¢ S√≠ntese de voz: "AF√ÅSTI!" ativada\n' +
                  '‚Ä¢ Integra√ß√£o Gatomante: Ativa\n\n' +
                  'O sistema AF√ÅST est√° funcionando perfeitamente!\n' +
                  'Suas energias est√£o protegidas. ‚ú®');
        }
        
        // Melhorar fun√ß√£o addToNotificationCenter para incluir severidade
        function addToNotificationCenter(notification) {
            const container = document.getElementById('notificationCenterContent');
            const notificationElement = document.createElement('div');
            notificationElement.className = 'notification-item';
            notificationElement.dataset.severity = notification.event.severity;
            
            const timeStr = notification.timestamp.toLocaleTimeString('pt-BR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            const severityIcon = {
                'critical': 'üö®',
                'warning': '‚ö†Ô∏è',
                'info': '‚ÑπÔ∏è'
            }[notification.event.severity] || '‚ÑπÔ∏è';
            
            notificationElement.innerHTML = `
                <div class="notification-item-header">
                    <span>${severityIcon} ${notification.event.icon} ${notification.event.name}</span>
                    <div class="notification-item-time">${timeStr}</div>
                </div>
                <div class="notification-item-content">${notification.event.description}</div>
                <div style="font-size: 11px; opacity: 0.8; margin-top: 5px;">${notification.event.advice}</div>
            `;
            
            container.insertBefore(notificationElement, container.firstChild);
            
            // Ocultar mensagem de "sem notifica√ß√µes"
            document.getElementById('noNotifications').style.display = 'none';
            
            // Limitar a 50 notifica√ß√µes
            while (container.children.length > 51) { // +1 por causa da mensagem "no notifications"
                const lastChild = container.lastChild;
                if (lastChild && lastChild.classList.contains('notification-item')) {
                    container.removeChild(lastChild);
                }
            }
        }
        
        function saveAfastNotifications() {
            localStorage.setItem('auroraOS_afast_notifications', JSON.stringify(afastNotifications));
        }
        
        function loadAfastNotifications() {
            const saved = localStorage.getItem('auroraOS_afast_notifications');
            if (saved) {
                afastNotifications = JSON.parse(saved);
                
                // Recriar notifica√ß√µes na central
                afastNotifications.forEach(notification => {
                    if (notification.acknowledged) {
                        addToNotificationCenter(notification);
                    }
                });
            }
        }
        
        // ========================================
        // üîÆ SISTEMA DE MAPA ASTRAL
        // ========================================
        
        function calculateAstrologicalProfile(birthDate, birthTime, birthPlace) {
            // Fun√ß√£o b√°sica de c√°lculo astrol√≥gico
            // Em uma implementa√ß√£o real, isso se conectaria com APIs de astrologia
            // ou bibliotecas especializadas como Swiss Ephemeris
            
            const profile = {
                calculatedAt: new Date().toISOString(),
                birthData: {
                    date: birthDate,
                    time: birthTime,
                    place: birthPlace
                },
                sunSign: calculateSunSign(birthDate),
                moonSign: calculateMoonSign(birthDate, birthTime),
                ascendant: calculateAscendant(birthDate, birthTime, birthPlace),
                elements: {},
                qualities: {},
                houses: {},
                aspects: [],
                personalityTraits: [],
                recommendations: []
            };
            
            // Calcular elementos e qualidades
            profile.elements = calculateElements(profile);
            profile.qualities = calculateQualities(profile);
            
            // Gerar tra√ßos de personalidade baseados no mapa
            profile.personalityTraits = generatePersonalityTraits(profile);
            
            // Gerar recomenda√ß√µes personalizadas
            profile.recommendations = generateAstrologicalRecommendations(profile);
            
            return profile;
        }
        
        function calculateSunSign(birthDate) {
            const date = new Date(birthDate);
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            // C√°lculo simplificado dos signos solares
            const signs = [
                { name: 'Capric√≥rnio', symbol: '‚ôë', element: 'Terra', quality: 'Cardinal', start: [12, 22], end: [1, 19] },
                { name: 'Aqu√°rio', symbol: '‚ôí', element: 'Ar', quality: 'Fixo', start: [1, 20], end: [2, 18] },
                { name: 'Peixes', symbol: '‚ôì', element: '√Ågua', quality: 'Mut√°vel', start: [2, 19], end: [3, 20] },
                { name: '√Åries', symbol: '‚ôà', element: 'Fogo', quality: 'Cardinal', start: [3, 21], end: [4, 19] },
                { name: 'Touro', symbol: '‚ôâ', element: 'Terra', quality: 'Fixo', start: [4, 20], end: [5, 20] },
                { name: 'G√™meos', symbol: '‚ôä', element: 'Ar', quality: 'Mut√°vel', start: [5, 21], end: [6, 20] },
                { name: 'C√¢ncer', symbol: '‚ôã', element: '√Ågua', quality: 'Cardinal', start: [6, 21], end: [7, 22] },
                { name: 'Le√£o', symbol: '‚ôå', element: 'Fogo', quality: 'Fixo', start: [7, 23], end: [8, 22] },
                { name: 'Virgem', symbol: '‚ôç', element: 'Terra', quality: 'Mut√°vel', start: [8, 23], end: [9, 22] },
                { name: 'Libra', symbol: '‚ôé', element: 'Ar', quality: 'Cardinal', start: [9, 23], end: [10, 22] },
                { name: 'Escorpi√£o', symbol: '‚ôè', element: '√Ågua', quality: 'Fixo', start: [10, 23], end: [11, 21] },
                { name: 'Sagit√°rio', symbol: '‚ôê', element: 'Fogo', quality: 'Mut√°vel', start: [11, 22], end: [12, 21] }
            ];
            
            for (const sign of signs) {
                const [startMonth, startDay] = sign.start;
                const [endMonth, endDay] = sign.end;
                
                if ((month === startMonth && day >= startDay) || (month === endMonth && day <= endDay)) {
                    return sign;
                }
            }
            
            return signs[0]; // Fallback para Capric√≥rnio
        }
        
        function calculateMoonSign(birthDate, birthTime) {
            // C√°lculo simplificado do signo lunar
            // Em uma implementa√ß√£o real, seria necess√°rio usar efem√©rides precisas
            const date = new Date(birthDate + 'T' + birthTime);
            const dayOfYear = Math.floor((date - new Date(date.getFullYear(), 0, 0)) / 86400000);
            const moonCycle = (dayOfYear + Math.floor(date.getHours() / 2.5)) % 12;
            
            const moonSigns = [
                { name: '√Åries', symbol: '‚ôà', element: 'Fogo' },
                { name: 'Touro', symbol: '‚ôâ', element: 'Terra' },
                { name: 'G√™meos', symbol: '‚ôä', element: 'Ar' },
                { name: 'C√¢ncer', symbol: '‚ôã', element: '√Ågua' },
                { name: 'Le√£o', symbol: '‚ôå', element: 'Fogo' },
                { name: 'Virgem', symbol: '‚ôç', element: 'Terra' },
                { name: 'Libra', symbol: '‚ôé', element: 'Ar' },
                { name: 'Escorpi√£o', symbol: '‚ôè', element: '√Ågua' },
                { name: 'Sagit√°rio', symbol: '‚ôê', element: 'Fogo' },
                { name: 'Capric√≥rnio', symbol: '‚ôë', element: 'Terra' },
                { name: 'Aqu√°rio', symbol: '‚ôí', element: 'Ar' },
                { name: 'Peixes', symbol: '‚ôì', element: '√Ågua' }
            ];
            
            return moonSigns[moonCycle];
        }
        
        function calculateAscendant(birthDate, birthTime, birthPlace) {
            // C√°lculo simplificado do ascendente
            // Em uma implementa√ß√£o real, seria necess√°rio considerar latitude, longitude e fuso hor√°rio
            const time = new Date(birthDate + 'T' + birthTime);
            const hour = time.getHours();
            const ascendantIndex = Math.floor(hour / 2) % 12;
            
            const ascendants = [
                { name: '√Åries', symbol: '‚ôà' },
                { name: 'Touro', symbol: '‚ôâ' },
                { name: 'G√™meos', symbol: '‚ôä' },
                { name: 'C√¢ncer', symbol: '‚ôã' },
                { name: 'Le√£o', symbol: '‚ôå' },
                { name: 'Virgem', symbol: '‚ôç' },
                { name: 'Libra', symbol: '‚ôé' },
                { name: 'Escorpi√£o', symbol: '‚ôè' },
                { name: 'Sagit√°rio', symbol: '‚ôê' },
                { name: 'Capric√≥rnio', symbol: '‚ôë' },
                { name: 'Aqu√°rio', symbol: '‚ôí' },
                { name: 'Peixes', symbol: '‚ôì' }
            ];
            
            return ascendants[ascendantIndex];
        }
        
        function calculateElements(profile) {
            const elements = { Fogo: 0, Terra: 0, Ar: 0, √Ågua: 0 };
            
            elements[profile.sunSign.element]++;
            elements[profile.moonSign.element]++;
            
            return elements;
        }
        
        function calculateQualities(profile) {
            const qualities = { Cardinal: 0, Fixo: 0, Mut√°vel: 0 };
            
            qualities[profile.sunSign.quality]++;
            
            return qualities;
        }
        
        function generatePersonalityTraits(profile) {
            const traits = [];
            
            // Tra√ßos baseados no signo solar
            const sunTraits = {
                '√Åries': ['Corajoso', 'Impulsivo', 'L√≠der natural'],
                'Touro': ['Determinado', 'Pr√°tico', 'Sensual'],
                'G√™meos': ['Comunicativo', 'Vers√°til', 'Curioso'],
                'C√¢ncer': ['Emotivo', 'Protetor', 'Intuitivo'],
                'Le√£o': ['Criativo', 'Generoso', 'Dram√°tico'],
                'Virgem': ['Anal√≠tico', 'Perfeccionista', 'Prestativo'],
                'Libra': ['Diplom√°tico', 'Harmonioso', 'Est√©tico'],
                'Escorpi√£o': ['Intenso', 'Transformador', 'Misterioso'],
                'Sagit√°rio': ['Aventureiro', 'Filos√≥fico', 'Otimista'],
                'Capric√≥rnio': ['Ambicioso', 'Disciplinado', 'Respons√°vel'],
                'Aqu√°rio': ['Inovador', 'Independente', 'Humanit√°rio'],
                'Peixes': ['Compassivo', 'Art√≠stico', 'Espiritual']
            };
            
            traits.push(...(sunTraits[profile.sunSign.name] || []));
            
            return traits;
        }
        
        function generateAstrologicalRecommendations(profile) {
            const recommendations = [];
            
            // Recomenda√ß√µes baseadas no elemento dominante
            const dominantElement = Object.keys(profile.elements).reduce((a, b) => 
                profile.elements[a] > profile.elements[b] ? a : b
            );
            
            const elementRecommendations = {
                'Fogo': [
                    'Pratique exerc√≠cios f√≠sicos regulares para canalizar sua energia',
                    'Desenvolva projetos criativos que despertem sua paix√£o',
                    'Medite para equilibrar sua impulsividade natural'
                ],
                'Terra': [
                    'Conecte-se com a natureza regularmente',
                    'Estabele√ßa rotinas s√≥lidas e objetivos pr√°ticos',
                    'Cultive plantas ou jardins para nutrir sua ess√™ncia'
                ],
                'Ar': [
                    'Mantenha-se mentalmente estimulado com leituras e estudos',
                    'Pratique comunica√ß√£o consciente e escuta ativa',
                    'Explore diferentes perspectivas e culturas'
                ],
                '√Ågua': [
                    'Honre suas emo√ß√µes e pratique autocompaix√£o',
                    'Desenvolva sua intui√ß√£o atrav√©s da medita√ß√£o',
                    'Crie espa√ßos sagrados para reflex√£o e cura'
                ]
            };
            
            recommendations.push(...(elementRecommendations[dominantElement] || []));
            
            return recommendations;
        }
        
        function getAstrologicalInsights(user) {
            if (!user || !user.astrologicalProfile) {
                return {
                    hasProfile: false,
                    message: "Complete seu perfil astrol√≥gico para receber insights personalizados!"
                };
            }
            
            const profile = user.astrologicalProfile;
            return {
                hasProfile: true,
                sunSign: profile.sunSign,
                moonSign: profile.moonSign,
                ascendant: profile.ascendant,
                dominantElement: Object.keys(profile.elements).reduce((a, b) => 
                    profile.elements[a] > profile.elements[b] ? a : b
                ),
                personalityTraits: profile.personalityTraits,
                recommendations: profile.recommendations
            };
        }
        
        // Inicializa√ß√£o do sistema de boot
        function initBootSystem() {
            // Verificar se deve pular boot (para desenvolvimento)
            const skipBoot = localStorage.getItem('auroraOS_skip_boot') === 'true';
            
            if (skipBoot) {
                // Verificar auto-login
                if (checkAutoLogin()) {
                    // Pular direto para o sistema principal
                    document.getElementById('bootScreen').style.display = 'none';
                    document.getElementById('welcomeScreen').style.display = 'none';
                    document.getElementById('authScreen').style.display = 'none';
                    initMainSystem();
                } else {
                    // Mostrar tela de autentica√ß√£o
                    document.getElementById('bootScreen').style.display = 'none';
                    document.getElementById('welcomeScreen').style.display = 'none';
                    showAuthScreen();
                }
            } else {
                // Iniciar sequ√™ncia de boot
                createMysticalParticles('bootParticles');
                setTimeout(updateBootProgress, 1000);
            }
        }
        
        // ========================================
        // üöÄ INICIALIZA√á√ÉO DO SISTEMA
        // ========================================
        
        // Sistema de inicializa√ß√£o j√° configurado acima
                if (savedUser && !currentUser) {
                    sessionStorage.setItem('auroraOS_currentUser', savedUser);
                }
                
                // Inicializar sistema principal
                initializeMainSystem();
                
                // Mostrar desktop
                document.getElementById('desktop').style.display = 'block';
                document.getElementById('taskbar').style.display = 'flex';
                
                // Sauda√ß√£o r√°pida do Gatomante
                setTimeout(() => {
                    const user = JSON.parse(sessionStorage.getItem('auroraOS_currentUser') || '{}');
                    showGatomante(`Bem-vindo de volta, ${user.name || 'Usu√°rio'}!`, 'normal');
                }, 1000);
                
            } else {
                // Primeiro acesso - iniciar sequ√™ncia de boot
                initBootSystem();
            }
        });
        
        // Inicializar sistema de boot
        function initBootSystem() {
            // Ocultar desktop e taskbar inicialmente
            document.getElementById('desktop').style.display = 'none';
            document.getElementById('taskbar').style.display = 'none';
            
            // Criar part√≠culas do boot
            createBootParticles();
            
            // Iniciar sequ√™ncia de boot ap√≥s 1 segundo
            setTimeout(() => {
                startBootSequence();
            }, 1000);
        }
        
        // ========================================
        // üöÄ SISTEMA DE INICIALIZA√á√ÉO COMPLETO
        // ========================================
        
        // Vari√°veis globais do sistema de inicializa√ß√£o
        let bootProgress = 0;
        let bootMessageIndex = 0;
        let currentRegisterStep = 1;
        
        // Mensagens din√¢micas de carregamento
        const bootMessages = [
            "Invocando energias m√≠sticas...",
            "Alinhando chakras do sistema...",
            "Consultando as estrelas...",
            "Preparando o Gatomante...",
            "Carregando sabedoria ancestral...",
            "Sincronizando com o cosmos...",
            "Ativando prote√ß√µes astrais...",
            "Calibrando cristais de mem√≥ria...",
            "Conectando com o Akasha...",
            "Finalizando rituais de inicializa√ß√£o..."
        ];
        
        // Mensagens do Gatomante na tela de boas-vindas
        const welcomeGatomanteMessages = [
            "Miau! Pronto para explorar os mist√©rios do Aurora OS?",
            "Bem-vindo, humano! Vejo que busca conhecimento m√≠stico...",
            "Ah, mais um mortal adentrando os segredos digitais!",
            "Sauda√ß√µes! Permita-me gui√°-lo pelos caminhos esot√©ricos.",
            "Miau! Este sistema operacional √© mais m√°gico que voc√™ imagina!"
        ];
        
        // Iniciar sequ√™ncia de boot
        function startBootSequence() {
            console.log('üöÄ Iniciando sequ√™ncia de boot...');
            
            // Criar part√≠culas m√≠sticas
            createBootParticles();
            
            // Reproduzir som nost√°lgico se dispon√≠vel
            playBootSound();
            
            // Iniciar progresso de carregamento
            updateBootProgress();
        }
        
        // Criar part√≠culas m√≠sticas no boot
        function createBootParticles() {
            const particlesContainer = document.getElementById('bootParticles');
            if (!particlesContainer) return;
            
            // Limpar part√≠culas existentes
            particlesContainer.innerHTML = '';
            
            // Criar 50 part√≠culas
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'boot-particle';
                
                // Posi√ß√£o aleat√≥ria
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 12 + 's';
                particle.style.animationDuration = (8 + Math.random() * 8) + 's';
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Reproduzir som nost√°lgico de boot
        function playBootSound() {
            try {
                // Tentar reproduzir som de dial-up se dispon√≠vel
                const audio = new Audio();
                audio.volume = 0.3;
                
                // Verificar se h√° arquivos de som dispon√≠veis
                const soundFiles = [
                    'dialup_chiados_dirty_enhanced.wav',
                    'dialup_chiados_vintage.wav'
                ];
                
                const randomSound = soundFiles[Math.floor(Math.random() * soundFiles.length)];
                audio.src = randomSound;
                
                audio.play().catch(e => {
                    console.log('Som de boot n√£o dispon√≠vel:', e);
                });
            } catch (e) {
                console.log('Erro ao reproduzir som de boot:', e);
            }
        }
        
        // Atualizar progresso de boot
        function updateBootProgress() {
            const progressFill = document.getElementById('bootProgressFill');
            const progressText = document.getElementById('bootProgressText');
            const loadingText = document.getElementById('bootLoadingText');
            
            if (!progressFill || !progressText || !loadingText) return;
            
            // Incrementar progresso
            bootProgress += Math.random() * 15 + 5; // 5-20% por vez
            
            if (bootProgress > 100) {
                bootProgress = 100;
            }
            
            // Atualizar barra de progresso
            progressFill.style.width = bootProgress + '%';
            progressText.textContent = Math.floor(bootProgress) + '%';
            
            // Atualizar mensagem
            if (bootMessageIndex < bootMessages.length - 1) {
                loadingText.textContent = bootMessages[bootMessageIndex];
                bootMessageIndex++;
            }
            
            // Continuar carregamento ou finalizar
            if (bootProgress < 100) {
                setTimeout(updateBootProgress, 800 + Math.random() * 1200); // 0.8-2s
            } else {
                setTimeout(finishBootSequence, 1500);
            }
        }
        
        // Finalizar sequ√™ncia de boot
        function finishBootSequence() {
            console.log('‚úÖ Boot sequence finalizada');
            
            const bootScreen = document.getElementById('bootScreen');
            const welcomeScreen = document.getElementById('welcomeScreen');
            
            if (bootScreen && welcomeScreen) {
                // Verificar se usu√°rio j√° est√° logado
                const savedUser = localStorage.getItem('auroraOS_currentUser');
                const rememberMe = localStorage.getItem('auroraOS_rememberMe') === 'true';
                
                if (savedUser && rememberMe) {
                    // Login autom√°tico
                    console.log('üîê Login autom√°tico detectado');
                    setTimeout(() => {
                        hideBootScreen();
                        startMainSystem();
                    }, 1000);
                } else {
                    // Mostrar tela de boas-vindas
                    setTimeout(() => {
                        hideBootScreen();
                        showWelcomeScreen();
                    }, 1000);
                }
            }
        }
        
        // Ocultar tela de boot
        function hideBootScreen() {
            const bootScreen = document.getElementById('bootScreen');
            if (bootScreen) {
                bootScreen.classList.add('hidden');
                setTimeout(() => {
                    bootScreen.style.display = 'none';
                }, 1500);
            }
        }
        
        // Mostrar tela de boas-vindas
        function showWelcomeScreen() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            if (welcomeScreen) {
                welcomeScreen.classList.add('active');
                
                // Iniciar mensagens rotativas do Gatomante
                startWelcomeGatomanteMessages();
            }
        }
        
        // Iniciar mensagens rotativas do Gatomante
        function startWelcomeGatomanteMessages() {
            const gatomanteText = document.getElementById('welcomeGatomanteText');
            if (!gatomanteText) return;
            
            let messageIndex = 0;
            
            setInterval(() => {
                messageIndex = (messageIndex + 1) % welcomeGatomanteMessages.length;
                gatomanteText.textContent = welcomeGatomanteMessages[messageIndex];
            }, 5000); // Trocar mensagem a cada 5 segundos
        }
        
        // Realizar login
        function performLogin() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const rememberMe = document.getElementById('rememberMe').checked;
            
            // Valida√ß√£o b√°sica
            if (!email || !password) {
                showStatusMessage('Por favor, preencha todos os campos.', 'error');
                return;
            }
            
            // Simular valida√ß√£o (demo)
            if (email === 'demo@aurora.com' && password === 'demo123') {
                // Login bem-sucedido
                const userData = {
                    id: 'demo-user',
                    name: 'Usu√°rio Demo',
                    email: email,
                    loginTime: new Date().toISOString(),
                    isDemo: true
                };
                
                // Salvar dados do usu√°rio
                localStorage.setItem('auroraOS_currentUser', JSON.stringify(userData));
                localStorage.setItem('auroraOS_rememberMe', rememberMe.toString());
                
                showStatusMessage('Login realizado com sucesso! Bem-vindo ao Aurora OS.', 'success');
                
                setTimeout(() => {
                    hideWelcomeScreen();
                    startMainSystem();
                }, 2000);
                
            } else {
                showStatusMessage('Email ou senha incorretos. Tente: demo@aurora.com / demo123', 'error');
            }
        }
        
        // Entrar em modo demonstra√ß√£o
        function enterDemoMode() {
            const userData = {
                id: 'demo-guest',
                name: 'Visitante',
                email: 'guest@aurora.com',
                loginTime: new Date().toISOString(),
                isDemo: true,
                isGuest: true
            };
            
            localStorage.setItem('auroraOS_currentUser', JSON.stringify(userData));
            
            showStatusMessage('Entrando em modo demonstra√ß√£o...', 'info');
            
            setTimeout(() => {
                hideWelcomeScreen();
                startMainSystem();
            }, 1500);
        }
        
        // Mostrar formul√°rio de registro
        function showRegisterForm() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            const registerScreen = document.getElementById('registerScreen');
            
            if (welcomeScreen && registerScreen) {
                welcomeScreen.style.display = 'none';
                registerScreen.style.display = 'flex';
                registerScreen.classList.add('active');
            }
        }
        
        // Voltar para tela de boas-vindas
        function showWelcomeScreen() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            const registerScreen = document.getElementById('registerScreen');
            
            if (welcomeScreen && registerScreen) {
                registerScreen.style.display = 'none';
                registerScreen.classList.remove('active');
                welcomeScreen.style.display = 'flex';
                welcomeScreen.classList.add('active');
            }
        }
        
        // Pr√≥xima etapa do registro
        function nextRegisterStep() {
            if (currentRegisterStep === 1) {
                // Validar etapa 1
                const name = document.getElementById('registerName').value.trim();
                const email = document.getElementById('registerEmail').value.trim();
                const password = document.getElementById('registerPassword').value.trim();
                const confirmPassword = document.getElementById('registerPasswordConfirm').value.trim();
                
                if (!name || !email || !password || !confirmPassword) {
                    showRegisterStatusMessage('Por favor, preencha todos os campos obrigat√≥rios.', 'error');
                    return;
                }
                
                if (password !== confirmPassword) {
                    showRegisterStatusMessage('As senhas n√£o coincidem.', 'error');
                    return;
                }
                
                if (password.length < 6) {
                    showRegisterStatusMessage('A senha deve ter pelo menos 6 caracteres.', 'error');
                    return;
                }
                
                // Avan√ßar para etapa 2
                showRegisterStep(2);
                
            } else if (currentRegisterStep === 2) {
                // Avan√ßar para etapa 3
                showRegisterStep(3);
            }
        }
        
        // Etapa anterior do registro
        function previousRegisterStep() {
            if (currentRegisterStep > 1) {
                showRegisterStep(currentRegisterStep - 1);
            }
        }
        
        // Mostrar etapa espec√≠fica do registro
        function showRegisterStep(step) {
            // Ocultar todas as etapas
            for (let i = 1; i <= 3; i++) {
                const stepElement = document.getElementById(`registerStep${i}`);
                const progressElement = document.getElementById(`progressStep${i}`);
                
                if (stepElement) {
                    stepElement.style.display = i === step ? 'block' : 'none';
                }
                
                if (progressElement) {
                    progressElement.classList.toggle('active', i <= step);
                }
            }
            
            // Atualizar bot√µes
            const prevBtn = document.getElementById('registerPrevBtn');
            const nextBtn = document.getElementById('registerNextBtn');
            const submitBtn = document.getElementById('registerSubmitBtn');
            
            if (prevBtn) prevBtn.style.display = step > 1 ? 'inline-block' : 'none';
            if (nextBtn) nextBtn.style.display = step < 3 ? 'inline-block' : 'none';
            if (submitBtn) submitBtn.style.display = step === 3 ? 'inline-block' : 'none';
            
            currentRegisterStep = step;
        }
        
        // Submeter registro
        async function submitRegistration() {
            const acceptTerms = document.getElementById('acceptTerms').checked;
            
            if (!acceptTerms) {
                showRegisterStatusMessage('Voc√™ deve aceitar os Termos de Uso para continuar.', 'error');
                return;
            }
            
            // Coletar dados do formul√°rio
            const userData = {
                id: 'user-' + Date.now(),
                name: document.getElementById('registerName').value.trim(),
                email: document.getElementById('registerEmail').value.trim(),
                password: document.getElementById('registerPassword').value.trim(),
                birthDate: document.getElementById('birthDate').value,
                birthTime: document.getElementById('birthTime').value,
                birthPlace: document.getElementById('birthPlace').value.trim(),
                interests: Array.from(document.querySelectorAll('.interests-grid input:checked')).map(cb => cb.value),
                acceptNotifications: document.getElementById('acceptNotifications').checked,
                registrationTime: new Date().toISOString(),
                isDemo: false
            };
            
            // Simular cria√ß√£o de conta
            showRegisterStatusMessage('Criando sua conta m√≠stica...', 'info');
            
            try {
                // Calcular mapa astral completo se dados fornecidos
                if (userData.birthDate) {
                    showRegisterStatusMessage('Calculando seu mapa astral personalizado...', 'info');
                    userData.astralMap = await calculateCompleteAstralMap(
                        userData.birthDate, 
                        userData.birthTime, 
                        userData.birthPlace
                    );
                    
                    // Gerar resumo astrol√≥gico
                    userData.astrologicalSummary = generateAstrologicalSummary(userData.astralMap);
                }
                
                // Salvar usu√°rio
                localStorage.setItem('auroraOS_currentUser', JSON.stringify(userData));
                localStorage.setItem('auroraOS_rememberMe', 'true');
                
                showRegisterStatusMessage('Conta criada com sucesso! Bem-vindo ao Aurora OS!', 'success');
                
                setTimeout(() => {
                    hideWelcomeScreen();
                    startMainSystem();
                }, 2000);
                
            } catch (error) {
                console.error('Erro ao criar conta:', error);
                showRegisterStatusMessage('Erro ao calcular mapa astral. Conta criada com dados b√°sicos.', 'info');
                
                // Salvar usu√°rio mesmo com erro no mapa astral
                localStorage.setItem('auroraOS_currentUser', JSON.stringify(userData));
                localStorage.setItem('auroraOS_rememberMe', 'true');
                
                setTimeout(() => {
                    hideWelcomeScreen();
                    startMainSystem();
                }, 2000);
            }
        }
        
        // ========================================
        // üîÆ SISTEMA ASTROL√ìGICO INTEGRADO
        // Integra√ß√£o com Aurora Sagrada
        // ========================================
        
        // Calcular mapa astral completo usando Aurora Sagrada
        async function calculateCompleteAstralMap(birthDate, birthTime, birthPlace) {
            try {
                console.log('üîÆ Calculando mapa astral completo...');
                
                // Converter data e hora para formato adequado
                const birthDateTime = new Date(`${birthDate}T${birthTime || '12:00'}:00`);
                
                // Coordenadas padr√£o (S√£o Paulo) se local n√£o especificado
                let coordinates = { lat: -23.5505, lng: -46.6333, timezone: 'America/Sao_Paulo' };
                
                // Tentar geocodificar o local se fornecido
                if (birthPlace) {
                    coordinates = await geocodeLocation(birthPlace) || coordinates;
                }
                
                // Calcular posi√ß√µes planet√°rias
                const planetaryPositions = await calculatePlanetaryPositions(birthDateTime, coordinates);
                
                // Calcular casas astrol√≥gicas
                const houses = await calculateAstrologicalHouses(birthDateTime, coordinates);
                
                // Calcular aspectos
                const aspects = await calculateAspects(planetaryPositions);
                
                // Gerar interpreta√ß√µes
                const interpretations = await generateInterpretations(planetaryPositions, houses, aspects);
                
                return {
                    birthData: {
                        date: birthDate,
                        time: birthTime,
                        place: birthPlace,
                        coordinates: coordinates,
                        julianDay: toJulianDay(birthDateTime)
                    },
                    planets: planetaryPositions,
                    houses: houses,
                    aspects: aspects,
                    interpretations: interpretations,
                    calculatedAt: new Date().toISOString(),
                    version: '2.0.0'
                };
                
            } catch (error) {
                console.error('Erro ao calcular mapa astral:', error);
                return calculateBasicAstralMap(birthDate, birthTime);
            }
        }
        
        // Geocodificar localiza√ß√£o
        async function geocodeLocation(location) {
            try {
                // Usar API de geocodifica√ß√£o (OpenStreetMap Nominatim)
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(location)}&limit=1`
                );
                
                if (response.ok) {
                    const data = await response.json();
                    if (data && data.length > 0) {
                        return {
                            lat: parseFloat(data[0].lat),
                            lng: parseFloat(data[0].lon),
                            timezone: 'UTC', // Simplificado
                            place: data[0].display_name
                        };
                    }
                }
            } catch (error) {
                console.warn('Erro na geocodifica√ß√£o:', error);
            }
            return null;
        }
        
        // Calcular posi√ß√µes planet√°rias
        async function calculatePlanetaryPositions(dateTime, coordinates) {
            const julianDay = toJulianDay(dateTime);
            
            // Usar algoritmos astron√¥micos simplificados
            const positions = {};
            
            // Sol
            positions.sun = calculateSunPosition(julianDay);
            
            // Lua
            positions.moon = calculateMoonPosition(julianDay);
            
            // Planetas (usando aproxima√ß√µes)
            const planets = ['mercury', 'venus', 'mars', 'jupiter', 'saturn', 'uranus', 'neptune', 'pluto'];
            
            for (const planet of planets) {
                positions[planet] = calculatePlanetPosition(planet, julianDay);
            }
            
            return positions;
        }
        
        // Converter data para dia juliano
        function toJulianDay(date) {
            const a = Math.floor((14 - date.getMonth() - 1) / 12);
            const y = date.getFullYear() + 4800 - a;
            const m = date.getMonth() + 1 + 12 * a - 3;
            
            return date.getDate() + Math.floor((153 * m + 2) / 5) + 365 * y + 
                   Math.floor(y / 4) - Math.floor(y / 100) + Math.floor(y / 400) - 32045 +
                   (date.getHours() - 12) / 24 + date.getMinutes() / 1440 + date.getSeconds() / 86400;
        }
        
        // Calcular posi√ß√£o do Sol
        function calculateSunPosition(julianDay) {
            const n = julianDay - 2451545.0;
            const L = (280.460 + 0.9856474 * n) % 360;
            const g = ((357.528 + 0.9856003 * n) % 360) * Math.PI / 180;
            const lambda = (L + 1.915 * Math.sin(g) + 0.020 * Math.sin(2 * g)) % 360;
            
            return {
                longitude: lambda,
                sign: getZodiacSign(lambda),
                degree: Math.floor(lambda % 30),
                minute: Math.floor((lambda % 1) * 60),
                element: getSignElement(getZodiacSign(lambda)),
                quality: getSignQuality(getZodiacSign(lambda))
            };
        }
        
        // Calcular posi√ß√£o da Lua
        function calculateMoonPosition(julianDay) {
            const n = julianDay - 2451545.0;
            const L = (218.316 + 13.176396 * n) % 360;
            const M = ((134.963 + 13.064993 * n) % 360) * Math.PI / 180;
            const F = ((93.272 + 13.229350 * n) % 360) * Math.PI / 180;
            
            const lambda = (L + 6.289 * Math.sin(M) + 1.274 * Math.sin(2 * (L - 279.557) * Math.PI / 180 - M) +
                           0.658 * Math.sin(2 * (L - 279.557) * Math.PI / 180)) % 360;
            
            return {
                longitude: lambda,
                sign: getZodiacSign(lambda),
                degree: Math.floor(lambda % 30),
                minute: Math.floor((lambda % 1) * 60),
                element: getSignElement(getZodiacSign(lambda)),
                quality: getSignQuality(getZodiacSign(lambda)),
                phase: calculateLunarPhase(julianDay)
            };
        }
        
        // Calcular posi√ß√£o de planeta
        function calculatePlanetPosition(planet, julianDay) {
            // Elementos orbitais simplificados
            const elements = {
                mercury: { a: 0.387, e: 0.206, i: 7.0, L: 252.25, w: 77.46, n: 4.092 },
                venus: { a: 0.723, e: 0.007, i: 3.4, L: 181.98, w: 131.77, n: 1.602 },
                mars: { a: 1.524, e: 0.093, i: 1.8, L: 355.43, w: 336.04, n: 0.524 },
                jupiter: { a: 5.203, e: 0.049, i: 1.3, L: 34.35, w: 14.33, n: 0.083 },
                saturn: { a: 9.537, e: 0.057, i: 2.5, L: 50.08, w: 93.06, n: 0.033 },
                uranus: { a: 19.19, e: 0.046, i: 0.8, L: 314.05, w: 173.01, n: 0.012 },
                neptune: { a: 30.07, e: 0.009, i: 1.8, L: 304.35, w: 48.12, n: 0.006 },
                pluto: { a: 39.48, e: 0.249, i: 17.2, L: 238.96, w: 224.07, n: 0.004 }
            };
            
            const elem = elements[planet];
            if (!elem) return null;
            
            const n = julianDay - 2451545.0;
            const M = ((elem.L + elem.n * n) % 360) * Math.PI / 180;
            const E = M + elem.e * Math.sin(M);
            const v = 2 * Math.atan(Math.sqrt((1 + elem.e) / (1 - elem.e)) * Math.tan(E / 2));
            const r = elem.a * (1 - elem.e * Math.cos(E));
            
            let lambda = ((v + elem.w * Math.PI / 180) * 180 / Math.PI) % 360;
            if (lambda < 0) lambda += 360;
            
            return {
                longitude: lambda,
                sign: getZodiacSign(lambda),
                degree: Math.floor(lambda % 30),
                minute: Math.floor((lambda % 1) * 60),
                element: getSignElement(getZodiacSign(lambda)),
                quality: getSignQuality(getZodiacSign(lambda)),
                distance: r
            };
        }
        
        // Obter signo zodiacal
        function getZodiacSign(longitude) {
            const signs = [
                '√Åries', 'Touro', 'G√™meos', 'C√¢ncer', 'Le√£o', 'Virgem',
                'Libra', 'Escorpi√£o', 'Sagit√°rio', 'Capric√≥rnio', 'Aqu√°rio', 'Peixes'
            ];
            return signs[Math.floor(longitude / 30)];
        }
        
        // Obter elemento do signo
        function getSignElement(sign) {
            const elements = {
                '√Åries': 'Fogo', 'Le√£o': 'Fogo', 'Sagit√°rio': 'Fogo',
                'Touro': 'Terra', 'Virgem': 'Terra', 'Capric√≥rnio': 'Terra',
                'G√™meos': 'Ar', 'Libra': 'Ar', 'Aqu√°rio': 'Ar',
                'C√¢ncer': '√Ågua', 'Escorpi√£o': '√Ågua', 'Peixes': '√Ågua'
            };
            return elements[sign] || 'Desconhecido';
        }
        
        // Obter qualidade do signo
        function getSignQuality(sign) {
            const qualities = {
                '√Åries': 'Cardinal', 'C√¢ncer': 'Cardinal', 'Libra': 'Cardinal', 'Capric√≥rnio': 'Cardinal',
                'Touro': 'Fixo', 'Le√£o': 'Fixo', 'Escorpi√£o': 'Fixo', 'Aqu√°rio': 'Fixo',
                'G√™meos': 'Mut√°vel', 'Virgem': 'Mut√°vel', 'Sagit√°rio': 'Mut√°vel', 'Peixes': 'Mut√°vel'
            };
            return qualities[sign] || 'Desconhecido';
        }
        
        // Calcular fase lunar
        function calculateLunarPhase(julianDay) {
            const n = julianDay - 2451545.0;
            const phase = ((n / 29.53) % 1) * 360;
            
            if (phase < 45) return { name: 'Nova', illumination: phase / 45 * 0.5 };
            if (phase < 135) return { name: 'Crescente', illumination: 0.5 + (phase - 45) / 90 * 0.5 };
            if (phase < 225) return { name: 'Cheia', illumination: 1.0 - (phase - 135) / 90 * 0.5 };
            if (phase < 315) return { name: 'Minguante', illumination: 0.5 - (phase - 225) / 90 * 0.5 };
            return { name: 'Nova', illumination: (360 - phase) / 45 * 0.5 };
        }
        
        // Calcular casas astrol√≥gicas
        async function calculateAstrologicalHouses(dateTime, coordinates) {
            // Sistema de casas Placidus simplificado
            const houses = [];
            const ascendant = calculateAscendant(dateTime, coordinates);
            
            for (let i = 1; i <= 12; i++) {
                const cuspLongitude = (ascendant + (i - 1) * 30) % 360;
                houses.push({
                    number: i,
                    cusp: cuspLongitude,
                    sign: getZodiacSign(cuspLongitude),
                    degree: Math.floor(cuspLongitude % 30),
                    ruler: getHouseRuler(i),
                    meaning: getHouseMeaning(i)
                });
            }
            
            return houses;
        }
        
        // Calcular ascendente
        function calculateAscendant(dateTime, coordinates) {
            const julianDay = toJulianDay(dateTime);
            const lst = calculateLocalSiderealTime(julianDay, coordinates.lng);
            const obliquity = 23.44; // Obliquidade da ecl√≠ptica
            
            // Simplifica√ß√£o: ascendente baseado no tempo sideral local
            return (lst * 15) % 360;
        }
        
        // Calcular tempo sideral local
        function calculateLocalSiderealTime(julianDay, longitude) {
            const t = (julianDay - 2451545.0) / 36525;
            const gmst = 280.46061837 + 360.98564736629 * (julianDay - 2451545.0) + 
                        0.000387933 * t * t - t * t * t / 38710000;
            return ((gmst + longitude) % 360) / 15;
        }
        
        // Obter regente da casa
        function getHouseRuler(houseNumber) {
            const rulers = [
                'Marte', 'V√™nus', 'Merc√∫rio', 'Lua', 'Sol', 'Merc√∫rio',
                'V√™nus', 'Plut√£o', 'J√∫piter', 'Saturno', 'Urano', 'Netuno'
            ];
            return rulers[houseNumber - 1];
        }
        
        // Obter significado da casa
        function getHouseMeaning(houseNumber) {
            const meanings = [
                'Personalidade e apar√™ncia',
                'Recursos e valores',
                'Comunica√ß√£o e irm√£os',
                'Lar e fam√≠lia',
                'Criatividade e filhos',
                'Trabalho e sa√∫de',
                'Parcerias e casamento',
                'Transforma√ß√£o e recursos compartilhados',
                'Filosofia e viagens',
                'Carreira e reputa√ß√£o',
                'Amizades e grupos',
                'Espiritualidade e subconsciente'
            ];
            return meanings[houseNumber - 1];
        }
        
        // Calcular aspectos
        async function calculateAspects(planetaryPositions) {
            const aspects = [];
            const planets = Object.keys(planetaryPositions);
            const aspectTypes = [
                { name: 'Conjun√ß√£o', angle: 0, orb: 8, symbol: '‚òå' },
                { name: 'Sextil', angle: 60, orb: 6, symbol: '‚öπ' },
                { name: 'Quadratura', angle: 90, orb: 8, symbol: '‚ñ°' },
                { name: 'Tr√≠gono', angle: 120, orb: 8, symbol: '‚ñ≥' },
                { name: 'Oposi√ß√£o', angle: 180, orb: 8, symbol: '‚òç' }
            ];
            
            for (let i = 0; i < planets.length; i++) {
                for (let j = i + 1; j < planets.length; j++) {
                    const planet1 = planets[i];
                    const planet2 = planets[j];
                    const pos1 = planetaryPositions[planet1];
                    const pos2 = planetaryPositions[planet2];
                    
                    if (!pos1 || !pos2) continue;
                    
                    let diff = Math.abs(pos1.longitude - pos2.longitude);
                    if (diff > 180) diff = 360 - diff;
                    
                    for (const aspectType of aspectTypes) {
                        const orb = Math.abs(diff - aspectType.angle);
                        if (orb <= aspectType.orb) {
                            aspects.push({
                                planet1: planet1,
                                planet2: planet2,
                                type: aspectType.name,
                                symbol: aspectType.symbol,
                                angle: aspectType.angle,
                                orb: orb,
                                exact: orb < 1,
                                energy: getAspectEnergy(aspectType.name),
                                interpretation: getAspectInterpretation(planet1, planet2, aspectType.name)
                            });
                        }
                    }
                }
            }
            
            return aspects;
        }
        
        // Obter energia do aspecto
        function getAspectEnergy(aspectType) {
            const energies = {
                'Conjun√ß√£o': 'neutro',
                'Sextil': 'harmonioso',
                'Quadratura': 'tenso',
                'Tr√≠gono': 'harmonioso',
                'Oposi√ß√£o': 'tenso'
            };
            return energies[aspectType] || 'neutro';
        }
        
        // Obter interpreta√ß√£o do aspecto
        function getAspectInterpretation(planet1, planet2, aspectType) {
            // Interpreta√ß√µes b√°sicas
            const interpretations = {
                'sol-lua': {
                    'Conjun√ß√£o': 'Harmonia entre consci√™ncia e emo√ß√µes',
                    'Sextil': 'Facilidade para expressar sentimentos',
                    'Quadratura': 'Tens√£o entre ego e necessidades emocionais',
                    'Tr√≠gono': 'Fluidez natural entre mente e cora√ß√£o',
                    'Oposi√ß√£o': 'Polariza√ß√£o entre identidade e emo√ß√µes'
                },
                'venus-marte': {
                    'Conjun√ß√£o': 'Fus√£o entre amor e desejo',
                    'Sextil': 'Equil√≠brio entre afeto e paix√£o',
                    'Quadratura': 'Conflito entre amor e impulso',
                    'Tr√≠gono': 'Harmonia entre romance e sexualidade',
                    'Oposi√ß√£o': 'Tens√£o entre necessidades afetivas e sexuais'
                }
            };
            
            const key = `${planet1}-${planet2}`;
            const reverseKey = `${planet2}-${planet1}`;
            
            return interpretations[key]?.[aspectType] || 
                   interpretations[reverseKey]?.[aspectType] || 
                   `Aspecto ${aspectType} entre ${planet1} e ${planet2}`;
        }
        
        // Gerar interpreta√ß√µes
        async function generateInterpretations(planets, houses, aspects) {
            return {
                personality: generatePersonalityInterpretation(planets.sun, planets.moon, houses[0]),
                relationships: generateRelationshipInterpretation(planets.venus, planets.mars, houses[6]),
                career: generateCareerInterpretation(planets.sun, planets.saturn, houses[9]),
                spirituality: generateSpiritualityInterpretation(planets.neptune, planets.pluto, houses[11]),
                challenges: generateChallengesInterpretation(aspects.filter(a => a.energy === 'tenso')),
                talents: generateTalentsInterpretation(aspects.filter(a => a.energy === 'harmonioso'))
            };
        }
        
        // Interpreta√ß√£o de personalidade
        function generatePersonalityInterpretation(sun, moon, ascendant) {
            return {
                title: 'Personalidade e Identidade',
                description: `Com o Sol em ${sun.sign}, voc√™ possui uma natureza ${getSignDescription(sun.sign)}. ` +
                           `Sua Lua em ${moon.sign} revela necessidades emocionais ${getSignDescription(moon.sign)}. ` +
                           `O ascendente em ${ascendant.sign} mostra como voc√™ se apresenta ao mundo.`,
                keywords: [sun.element, moon.element, sun.quality, moon.quality]
            };
        }
        
        // Interpreta√ß√£o de relacionamentos
        function generateRelationshipInterpretation(venus, mars, house7) {
            return {
                title: 'Amor e Relacionamentos',
                description: `V√™nus em ${venus.sign} indica que voc√™ ama de forma ${getSignDescription(venus.sign)}. ` +
                           `Marte em ${mars.sign} mostra como voc√™ expressa desejo e paix√£o. ` +
                           `A Casa 7 em ${house7.sign} revela o tipo de parceiro que voc√™ atrai.`,
                keywords: [venus.element, mars.element, 'relacionamentos', 'amor']
            };
        }
        
        // Interpreta√ß√£o de carreira
        function generateCareerInterpretation(sun, saturn, house10) {
            return {
                title: 'Carreira e Prop√≥sito',
                description: `Seu Sol em ${sun.sign} sugere uma voca√ß√£o relacionada a ${getCareerSuggestion(sun.sign)}. ` +
                           `Saturno em ${saturn.sign} indica disciplina e estrutura em ${getSignDescription(saturn.sign)}. ` +
                           `A Casa 10 em ${house10.sign} mostra sua reputa√ß√£o p√∫blica.`,
                keywords: [sun.element, 'carreira', 'prop√≥sito', 'realiza√ß√£o']
            };
        }
        
        // Interpreta√ß√£o de espiritualidade
        function generateSpiritualityInterpretation(neptune, pluto, house12) {
            return {
                title: 'Espiritualidade e Transforma√ß√£o',
                description: `Netuno em ${neptune.sign} conecta voc√™ com o divino atrav√©s de ${getSignDescription(neptune.sign)}. ` +
                           `Plut√£o em ${pluto.sign} indica transforma√ß√µes profundas. ` +
                           `A Casa 12 em ${house12.sign} revela sua conex√£o com o inconsciente.`,
                keywords: ['espiritualidade', 'transforma√ß√£o', 'intui√ß√£o', 'mist√©rio']
            };
        }
        
        // Interpreta√ß√£o de desafios
        function generateChallengesInterpretation(tenseAspects) {
            const challenges = tenseAspects.slice(0, 3).map(aspect => 
                `${aspect.planet1}-${aspect.planet2} em ${aspect.type}: ${aspect.interpretation}`
            );
            
            return {
                title: 'Desafios e Crescimento',
                description: 'Aspectos tensos indicam √°reas de crescimento e desenvolvimento pessoal.',
                challenges: challenges,
                keywords: ['crescimento', 'desafios', 'evolu√ß√£o', 'supera√ß√£o']
            };
        }
        
        // Interpreta√ß√£o de talentos
        function generateTalentsInterpretation(harmoniousAspects) {
            const talents = harmoniousAspects.slice(0, 3).map(aspect => 
                `${aspect.planet1}-${aspect.planet2} em ${aspect.type}: ${aspect.interpretation}`
            );
            
            return {
                title: 'Talentos e Dons Naturais',
                description: 'Aspectos harmoniosos revelam seus talentos inatos e facilidades naturais.',
                talents: talents,
                keywords: ['talentos', 'dons', 'facilidades', 'potencial']
            };
        }
        
        // Descri√ß√£o do signo
        function getSignDescription(sign) {
            const descriptions = {
                '√Åries': 'pioneira e corajosa',
                'Touro': 'est√°vel e determinada',
                'G√™meos': 'comunicativa e vers√°til',
                'C√¢ncer': 'emotiva e protetora',
                'Le√£o': 'criativa e expressiva',
                'Virgem': 'anal√≠tica e perfeccionista',
                'Libra': 'harmoniosa e diplom√°tica',
                'Escorpi√£o': 'intensa e transformadora',
                'Sagit√°rio': 'aventureira e filos√≥fica',
                'Capric√≥rnio': 'ambiciosa e disciplinada',
                'Aqu√°rio': 'inovadora e independente',
                'Peixes': 'intuitiva e compassiva'
            };
            return descriptions[sign] || '√∫nica';
        }
        
        // Sugest√£o de carreira
        function getCareerSuggestion(sign) {
            const careers = {
                '√Åries': 'lideran√ßa e empreendedorismo',
                'Touro': 'finan√ßas e artes',
                'G√™meos': 'comunica√ß√£o e educa√ß√£o',
                'C√¢ncer': 'cuidado e nutri√ß√£o',
                'Le√£o': 'entretenimento e criatividade',
                'Virgem': 'sa√∫de e organiza√ß√£o',
                'Libra': 'justi√ßa e relacionamentos',
                'Escorpi√£o': 'investiga√ß√£o e transforma√ß√£o',
                'Sagit√°rio': 'ensino e viagens',
                'Capric√≥rnio': 'administra√ß√£o e estrutura',
                'Aqu√°rio': 'tecnologia e humanitarismo',
                'Peixes': 'arte e espiritualidade'
            };
            return careers[sign] || '√°reas diversas';
        }
        
        // Calcular mapa astral b√°sico (fallback)
        function calculateBasicAstralMap(birthDate, birthTime) {
            // Simula√ß√£o b√°sica de c√°lculo astrol√≥gico
            const date = new Date(birthDate);
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            // Signos solares b√°sicos
            const sunSigns = [
                { name: 'Capric√≥rnio', start: [12, 22], end: [1, 19] },
                { name: 'Aqu√°rio', start: [1, 20], end: [2, 18] },
                { name: 'Peixes', start: [2, 19], end: [3, 20] },
                { name: '√Åries', start: [3, 21], end: [4, 19] },
                { name: 'Touro', start: [4, 20], end: [5, 20] },
                { name: 'G√™meos', start: [5, 21], end: [6, 20] },
                { name: 'C√¢ncer', start: [6, 21], end: [7, 22] },
                { name: 'Le√£o', start: [7, 23], end: [8, 22] },
                { name: 'Virgem', start: [8, 23], end: [9, 22] },
                { name: 'Libra', start: [9, 23], end: [10, 22] },
                { name: 'Escorpi√£o', start: [10, 23], end: [11, 21] },
                { name: 'Sagit√°rio', start: [11, 22], end: [12, 21] }
            ];
            
            let sunSign = 'Capric√≥rnio'; // Default
            
            for (const sign of sunSigns) {
                const [startMonth, startDay] = sign.start;
                const [endMonth, endDay] = sign.end;
                
                if ((month === startMonth && day >= startDay) || 
                    (month === endMonth && day <= endDay)) {
                    sunSign = sign.name;
                    break;
                }
            }
            
            return {
                sunSign: sunSign,
                moonSign: ['√Åries', 'Touro', 'G√™meos', 'C√¢ncer'][Math.floor(Math.random() * 4)],
                ascendant: ['Libra', 'Escorpi√£o', 'Sagit√°rio', 'Capric√≥rnio'][Math.floor(Math.random() * 4)],
                calculatedAt: new Date().toISOString(),
                version: 'basic'
            };
        }
        
        // Gerar resumo astrol√≥gico para o usu√°rio
        function generateAstrologicalSummary(astralMap) {
            if (!astralMap) return null;
            
            try {
                if (astralMap.version === '2.0.0' && astralMap.interpretations) {
                    // Mapa astral completo
                    return {
                        mainSigns: {
                            sun: `${astralMap.planets.sun.sign} ${astralMap.planets.sun.degree}¬∞`,
                            moon: `${astralMap.planets.moon.sign} ${astralMap.planets.moon.degree}¬∞`,
                            ascendant: `${astralMap.houses[0].sign} ${astralMap.houses[0].degree}¬∞`
                        },
                        elements: calculateElementBalance(astralMap.planets),
                        qualities: calculateQualityBalance(astralMap.planets),
                        dominantPlanet: findDominantPlanet(astralMap.planets, astralMap.aspects),
                        keyAspects: astralMap.aspects.filter(a => a.exact).slice(0, 3),
                        personalityHighlights: astralMap.interpretations.personality.keywords,
                        spiritualPath: astralMap.interpretations.spirituality.keywords,
                        lifeTheme: generateLifeTheme(astralMap),
                        luckyElements: generateLuckyElements(astralMap),
                        challenges: astralMap.interpretations.challenges.keywords,
                        talents: astralMap.interpretations.talents.keywords
                    };
                } else {
                    // Mapa astral b√°sico
                    return {
                        mainSigns: {
                            sun: astralMap.sunSign,
                            moon: astralMap.moonSign,
                            ascendant: astralMap.ascendant
                        },
                        elements: { [getSignElement(astralMap.sunSign)]: 1 },
                        qualities: { [getSignQuality(astralMap.sunSign)]: 1 },
                        personalityHighlights: [astralMap.sunSign, getSignElement(astralMap.sunSign)],
                        lifeTheme: `Jornada de ${astralMap.sunSign}`,
                        version: 'basic'
                    };
                }
            } catch (error) {
                console.error('Erro ao gerar resumo astrol√≥gico:', error);
                return null;
            }
        }
        
        // Calcular equil√≠brio dos elementos
        function calculateElementBalance(planets) {
            const elements = { Fogo: 0, Terra: 0, Ar: 0, √Ågua: 0 };
            
            Object.values(planets).forEach(planet => {
                if (planet && planet.element) {
                    elements[planet.element]++;
                }
            });
            
            return elements;
        }
        
        // Calcular equil√≠brio das qualidades
        function calculateQualityBalance(planets) {
            const qualities = { Cardinal: 0, Fixo: 0, Mut√°vel: 0 };
            
            Object.values(planets).forEach(planet => {
                if (planet && planet.quality) {
                    qualities[planet.quality]++;
                }
            });
            
            return qualities;
        }
        
        // Encontrar planeta dominante
        function findDominantPlanet(planets, aspects) {
            const planetScores = {};
            
            // Pontuar por aspectos
            aspects.forEach(aspect => {
                planetScores[aspect.planet1] = (planetScores[aspect.planet1] || 0) + 1;
                planetScores[aspect.planet2] = (planetScores[aspect.planet2] || 0) + 1;
            });
            
            // Pontuar por posi√ß√µes especiais
            if (planets.sun) planetScores.sun = (planetScores.sun || 0) + 2;
            if (planets.moon) planetScores.moon = (planetScores.moon || 0) + 2;
            
            // Encontrar o planeta com maior pontua√ß√£o
            let dominantPlanet = 'sun';
            let maxScore = 0;
            
            Object.entries(planetScores).forEach(([planet, score]) => {
                if (score > maxScore) {
                    maxScore = score;
                    dominantPlanet = planet;
                }
            });
            
            return dominantPlanet;
        }
        
        // Gerar tema de vida
        function generateLifeTheme(astralMap) {
            const sunSign = astralMap.planets.sun.sign;
            const moonSign = astralMap.planets.moon.sign;
            
            const themes = {
                '√Åries': 'Pioneirismo e Lideran√ßa',
                'Touro': 'Estabilidade e Beleza',
                'G√™meos': 'Comunica√ß√£o e Versatilidade',
                'C√¢ncer': 'Nutri√ß√£o e Prote√ß√£o',
                'Le√£o': 'Criatividade e Express√£o',
                'Virgem': 'Servi√ßo e Perfei√ß√£o',
                'Libra': 'Harmonia e Relacionamentos',
                'Escorpi√£o': 'Transforma√ß√£o e Mist√©rio',
                'Sagit√°rio': 'Expans√£o e Sabedoria',
                'Capric√≥rnio': 'Estrutura e Realiza√ß√£o',
                'Aqu√°rio': 'Inova√ß√£o e Humanitarismo',
                'Peixes': 'Compaix√£o e Transcend√™ncia'
            };
            
            return `${themes[sunSign]} com influ√™ncia de ${themes[moonSign]}`;
        }
        
        // Gerar elementos de sorte
        function generateLuckyElements(astralMap) {
            const sunSign = astralMap.planets.sun.sign;
            const element = astralMap.planets.sun.element;
            
            const luckyElements = {
                'Fogo': {
                    colors: ['Vermelho', 'Laranja', 'Dourado'],
                    stones: ['Rubi', 'Cornalina', 'Citrino'],
                    metals: ['Ouro', 'Ferro'],
                    numbers: [1, 3, 9]
                },
                'Terra': {
                    colors: ['Verde', 'Marrom', 'Bege'],
                    stones: ['Esmeralda', 'Quartzo Verde', 'Jaspe'],
                    metals: ['Cobre', 'Chumbo'],
                    numbers: [2, 6, 8]
                },
                'Ar': {
                    colors: ['Azul', 'Amarelo', 'Branco'],
                    stones: ['Safira', 'Top√°zio', 'Cristal'],
                    metals: ['Merc√∫rio', 'Prata'],
                    numbers: [3, 5, 7]
                },
                '√Ågua': {
                    colors: ['Azul', 'Violeta', 'Prateado'],
                    stones: ['Ametista', 'P√©rola', 'Moonstone'],
                    metals: ['Prata', 'Platina'],
                    numbers: [2, 4, 7]
                }
            };
            
            return luckyElements[element] || luckyElements['Fogo'];
        }
        
        // Mostrar mensagem de status
        function showStatusMessage(message, type) {
            const statusElement = document.getElementById('statusMessage');
            if (!statusElement) return;
            
            statusElement.textContent = message;
            statusElement.className = `status-message ${type} show`;
            
            setTimeout(() => {
                statusElement.classList.remove('show');
            }, 5000);
        }
        
        // Mostrar mensagem de status do registro
        function showRegisterStatusMessage(message, type) {
            const statusElement = document.getElementById('registerStatusMessage');
            if (!statusElement) return;
            
            statusElement.textContent = message;
            statusElement.className = `status-message ${type} show`;
            
            setTimeout(() => {
                statusElement.classList.remove('show');
            }, 5000);
        }
        
        // Mostrar esqueci a senha
        function showForgotPassword() {
            showStatusMessage('Funcionalidade em desenvolvimento. Use: demo@aurora.com / demo123', 'info');
        }
        
        // Ocultar tela de boas-vindas
        function hideWelcomeScreen() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            const registerScreen = document.getElementById('registerScreen');
            
            if (welcomeScreen) {
                welcomeScreen.classList.add('hidden');
                setTimeout(() => {
                    welcomeScreen.style.display = 'none';
                }, 1000);
            }
            
            if (registerScreen) {
                registerScreen.classList.add('hidden');
                setTimeout(() => {
                    registerScreen.style.display = 'none';
                }, 1000);
            }
        }
        
        // Iniciar sistema principal
        function startMainSystem() {
            console.log('üåü Iniciando sistema principal do Aurora OS...');
            
            // Mostrar desktop
            const desktop = document.getElementById('desktop');
            if (desktop) {
                desktop.style.display = 'block';
                desktop.style.opacity = '0';
                
                setTimeout(() => {
                    desktop.style.transition = 'opacity 1s ease-in-out';
                    desktop.style.opacity = '1';
                }, 100);
            }
            
            // Carregar configura√ß√µes do usu√°rio
            loadUserSettings();
            
            // Inicializar sistemas
            initAfastSystem();
            loadRecentApps();
            loadFavoriteApps();
            
            // Sauda√ß√£o do Gatomante
            setTimeout(() => {
                const currentUser = JSON.parse(localStorage.getItem('auroraOS_currentUser') || '{}');
                const userName = currentUser.name || 'Usu√°rio';
                
                showGatomante(`Miau! Bem-vindo de volta, ${userName}! O Aurora OS est√° pronto para suas aventuras m√≠sticas.`, 'excited');
            }, 2000);
        }
        
        // Carregar configura√ß√µes do usu√°rio
        function loadUserSettings() {
            const currentUser = JSON.parse(localStorage.getItem('auroraOS_currentUser') || '{}');
            
            // Aplicar tema salvo
            const savedTheme = localStorage.getItem('auroraOS_theme');
            if (savedTheme) {
                applyTheme(savedTheme);
            }
            
            // Aplicar wallpaper salvo
            const savedWallpaper = localStorage.getItem('auroraOS_wallpaper');
            if (savedWallpaper) {
                applyWallpaper(savedWallpaper);
            }
            
            // Aplicar cor da taskbar salva
            const savedTaskbarColor = localStorage.getItem('auroraOS_taskbarColor');
            if (savedTaskbarColor) {
                applyTaskbarColor(savedTaskbarColor);
            }
        }
        
        // ==========================================
        // üéÆ FUN√á√ïES DOS JOGOS M√çSTICOS
        // ==========================================
        
        // Abrir Paci√™ncia M√≠stica
        function openSolitaireGame() {
            openMysticalApp('Paci√™ncia M√≠stica', generateSolitaireApp(), 'üÉè');
        }
        
        // Abrir Domin√≥ Astral
        function openDominoGame() {
            openMysticalApp('Domin√≥ Astral', generateDominoApp(), '‚ö´');
        }
        
        // Abrir Or√°culo dos Sonhos
        function openDreamOracle() {
            openMysticalApp('Or√°culo dos Sonhos', generateDreamOracleApp(), 'üåô');
        }
        
        // Abrir Medita√ß√£o Guiada
        function openMeditation() {
            openMysticalApp('Medita√ß√£o Guiada', generateMeditationApp(), 'üßò‚Äç‚ôÄÔ∏è');
        }
        
        // ==========================================
        // üíæ SISTEMA DE BACKUP E RECUPERA√á√ÉO AVAN√áADO
        // ==========================================
        
        // Sistema de backup local
        const backupSystem = {
            backupHistory: [],
            maxBackups: 10,
            autoBackupEnabled: true,
            backupInterval: 300000, // 5 minutos
            lastBackup: null,
            backupTimer: null
        };
        
        // Inicializar sistema de backup
        function initBackupSystem() {
            console.log('üíæ Inicializando Sistema de Backup Avan√ßado');
            
            // Carregar hist√≥rico de backups
            loadBackupHistory();
            
            // Iniciar backup autom√°tico
            if (backupSystem.autoBackupEnabled) {
                startAutoBackup();
            }
            
            // Verificar integridade na inicializa√ß√£o
            verifyDataIntegrity();
        }
        
        // Carregar hist√≥rico de backups
        function loadBackupHistory() {
            const saved = localStorage.getItem('auroraOS_backupHistory');
            if (saved) {
                try {
                    backupSystem.backupHistory = JSON.parse(saved);
                } catch (e) {
                    console.error('Erro ao carregar hist√≥rico de backup:', e);
                    backupSystem.backupHistory = [];
                }
            }
        }
        
        // Salvar hist√≥rico de backups
        function saveBackupHistory() {
            localStorage.setItem('auroraOS_backupHistory', JSON.stringify(backupSystem.backupHistory));
        }
        
        // Criar backup completo
        function createFullBackup(manual = false) {
            try {
                const timestamp = new Date().toISOString();
                const backupData = {
                    id: 'backup_' + Date.now(),
                    timestamp: timestamp,
                    type: manual ? 'manual' : 'auto',
                    version: '1.0.0',
                    data: {
                        // Dados do usu√°rio
                        currentUser: JSON.parse(localStorage.getItem('auroraOS_currentUser') || '{}'),
                        users: JSON.parse(localStorage.getItem('auroraOS_users') || '{}'),
                        
                        // Configura√ß√µes do sistema
                        theme: localStorage.getItem('auroraOS_theme'),
                        wallpaper: localStorage.getItem('auroraOS_wallpaper'),
                        taskbarColor: localStorage.getItem('auroraOS_taskbarColor'),
                        volumes: JSON.parse(localStorage.getItem('auroraOS_volumes') || '{}'),
                        
                        // Dados de aplica√ß√µes
                        recentApps: JSON.parse(localStorage.getItem('auroraOS_recentApps') || '[]'),
                        favoriteApps: JSON.parse(localStorage.getItem('auroraOS_favoriteApps') || '[]'),
                        
                        // Sistema AF√ÅST
                        afastConfig: JSON.parse(localStorage.getItem('auroraOS_afastConfig') || '{}'),
                        afastHistory: JSON.parse(localStorage.getItem('auroraOS_afastHistory') || '[]'),
                        
                        // Sistema de gamifica√ß√£o
                        gamification: JSON.parse(localStorage.getItem('auroraOS_gamification') || '{}'),
                        dailyChallenges: JSON.parse(localStorage.getItem('auroraOS_dailyChallenges') || '{}'),
                        
                        // Dados de jogos
                        crystalsGame: JSON.parse(localStorage.getItem('auroraOS_crystalsGame') || '{}'),
                        herbsGame: JSON.parse(localStorage.getItem('auroraOS_herbsGame') || '{}'),
                        tarotGame: JSON.parse(localStorage.getItem('auroraOS_tarotGame') || '{}'),
                        solitaireGame: JSON.parse(localStorage.getItem('auroraOS_solitaireGame') || '{}'),
                        dominoGame: JSON.parse(localStorage.getItem('auroraOS_dominoGame') || '{}'),
                        
                        // Dados de aplica√ß√µes
                        fileManager: JSON.parse(localStorage.getItem('auroraOS_fileManager') || '{}'),
                        documents: JSON.parse(localStorage.getItem('auroraOS_documents') || '{}'),
                        gallery: JSON.parse(localStorage.getItem('auroraOS_gallery') || '{}'),
                        auroraPlayer: JSON.parse(localStorage.getItem('auroraOS_auroraPlayer') || '{}'),
                        
                        // Configura√ß√µes avan√ßadas
                        windowPositions: JSON.parse(localStorage.getItem('auroraOS_windowPositions') || '{}'),
                        workspaces: JSON.parse(localStorage.getItem('auroraOS_workspaces') || '{}')
                    },
                    size: 0,
                    checksum: ''
                };
                
                // Calcular tamanho e checksum
                const dataString = JSON.stringify(backupData.data);
                backupData.size = new Blob([dataString]).size;
                backupData.checksum = generateChecksum(dataString);
                
                // Adicionar ao hist√≥rico
                backupSystem.backupHistory.unshift(backupData);
                
                // Manter apenas os √∫ltimos backups
                if (backupSystem.backupHistory.length > backupSystem.maxBackups) {
                    backupSystem.backupHistory = backupSystem.backupHistory.slice(0, backupSystem.maxBackups);
                }
                
                // Salvar backup
                localStorage.setItem(`auroraOS_backup_${backupData.id}`, JSON.stringify(backupData));
                saveBackupHistory();
                
                backupSystem.lastBackup = timestamp;
                
                console.log(`üíæ Backup ${manual ? 'manual' : 'autom√°tico'} criado: ${backupData.id}`);
                
                if (manual) {
                    showBackupNotification('Backup criado com sucesso!', 'success');
                }
                
                return backupData;
                
            } catch (error) {
                console.error('Erro ao criar backup:', error);
                if (manual) {
                    showBackupNotification('Erro ao criar backup!', 'error');
                }
                return null;
            }
        }
        
        // Restaurar backup
        function restoreBackup(backupId) {
            try {
                const backupData = localStorage.getItem(`auroraOS_backup_${backupId}`);
                if (!backupData) {
                    throw new Error('Backup n√£o encontrado');
                }
                
                const backup = JSON.parse(backupData);
                
                // Verificar integridade
                const dataString = JSON.stringify(backup.data);
                const currentChecksum = generateChecksum(dataString);
                
                if (currentChecksum !== backup.checksum) {
                    throw new Error('Backup corrompido - checksum inv√°lido');
                }
                
                // Criar backup atual antes de restaurar
                createFullBackup(true);
                
                // Restaurar dados
                const data = backup.data;
                
                // Restaurar dados do usu√°rio
                if (data.currentUser) localStorage.setItem('auroraOS_currentUser', JSON.stringify(data.currentUser));
                if (data.users) localStorage.setItem('auroraOS_users', JSON.stringify(data.users));
                
                // Restaurar configura√ß√µes
                if (data.theme) localStorage.setItem('auroraOS_theme', data.theme);
                if (data.wallpaper) localStorage.setItem('auroraOS_wallpaper', data.wallpaper);
                if (data.taskbarColor) localStorage.setItem('auroraOS_taskbarColor', data.taskbarColor);
                if (data.volumes) localStorage.setItem('auroraOS_volumes', JSON.stringify(data.volumes));
                
                // Restaurar dados de aplica√ß√µes
                if (data.recentApps) localStorage.setItem('auroraOS_recentApps', JSON.stringify(data.recentApps));
                if (data.favoriteApps) localStorage.setItem('auroraOS_favoriteApps', JSON.stringify(data.favoriteApps));
                
                // Restaurar sistema AF√ÅST
                if (data.afastConfig) localStorage.setItem('auroraOS_afastConfig', JSON.stringify(data.afastConfig));
                if (data.afastHistory) localStorage.setItem('auroraOS_afastHistory', JSON.stringify(data.afastHistory));
                
                // Restaurar gamifica√ß√£o
                if (data.gamification) localStorage.setItem('auroraOS_gamification', JSON.stringify(data.gamification));
                if (data.dailyChallenges) localStorage.setItem('auroraOS_dailyChallenges', JSON.stringify(data.dailyChallenges));
                
                // Restaurar dados de jogos
                if (data.crystalsGame) localStorage.setItem('auroraOS_crystalsGame', JSON.stringify(data.crystalsGame));
                if (data.herbsGame) localStorage.setItem('auroraOS_herbsGame', JSON.stringify(data.herbsGame));
                if (data.tarotGame) localStorage.setItem('auroraOS_tarotGame', JSON.stringify(data.tarotGame));
                if (data.solitaireGame) localStorage.setItem('auroraOS_solitaireGame', JSON.stringify(data.solitaireGame));
                if (data.dominoGame) localStorage.setItem('auroraOS_dominoGame', JSON.stringify(data.dominoGame));
                
                // Restaurar dados de aplica√ß√µes
                if (data.fileManager) localStorage.setItem('auroraOS_fileManager', JSON.stringify(data.fileManager));
                if (data.documents) localStorage.setItem('auroraOS_documents', JSON.stringify(data.documents));
                if (data.gallery) localStorage.setItem('auroraOS_gallery', JSON.stringify(data.gallery));
                if (data.auroraPlayer) localStorage.setItem('auroraOS_auroraPlayer', JSON.stringify(data.auroraPlayer));
                
                // Restaurar configura√ß√µes avan√ßadas
                if (data.windowPositions) localStorage.setItem('auroraOS_windowPositions', JSON.stringify(data.windowPositions));
                if (data.workspaces) localStorage.setItem('auroraOS_workspaces', JSON.stringify(data.workspaces));
                
                console.log(`üíæ Backup restaurado: ${backupId}`);
                showBackupNotification('Backup restaurado com sucesso! Recarregue a p√°gina.', 'success');
                
                return true;
                
            } catch (error) {
                console.error('Erro ao restaurar backup:', error);
                showBackupNotification(`Erro ao restaurar backup: ${error.message}`, 'error');
                return false;
            }
        }
        
        // Exportar configura√ß√µes
        function exportSettings() {
            try {
                const exportData = {
                    timestamp: new Date().toISOString(),
                    version: '1.0.0',
                    type: 'settings_export',
                    settings: {
                        theme: localStorage.getItem('auroraOS_theme'),
                        wallpaper: localStorage.getItem('auroraOS_wallpaper'),
                        taskbarColor: localStorage.getItem('auroraOS_taskbarColor'),
                        volumes: JSON.parse(localStorage.getItem('auroraOS_volumes') || '{}'),
                        afastConfig: JSON.parse(localStorage.getItem('auroraOS_afastConfig') || '{}'),
                        recentApps: JSON.parse(localStorage.getItem('auroraOS_recentApps') || '[]'),
                        favoriteApps: JSON.parse(localStorage.getItem('auroraOS_favoriteApps') || '[]')
                    }
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `aurora-os-settings-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                showBackupNotification('Configura√ß√µes exportadas com sucesso!', 'success');
                
            } catch (error) {
                console.error('Erro ao exportar configura√ß√µes:', error);
                showBackupNotification('Erro ao exportar configura√ß√µes!', 'error');
            }
        }
        
        // Importar configura√ß√µes
        function importSettings(file) {
            try {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importData = JSON.parse(e.target.result);
                        
                        if (importData.type !== 'settings_export') {
                            throw new Error('Arquivo inv√°lido');
                        }
                        
                        // Criar backup antes de importar
                        createFullBackup(true);
                        
                        // Importar configura√ß√µes
                        const settings = importData.settings;
                        
                        if (settings.theme) localStorage.setItem('auroraOS_theme', settings.theme);
                        if (settings.wallpaper) localStorage.setItem('auroraOS_wallpaper', settings.wallpaper);
                        if (settings.taskbarColor) localStorage.setItem('auroraOS_taskbarColor', settings.taskbarColor);
                        if (settings.volumes) localStorage.setItem('auroraOS_volumes', JSON.stringify(settings.volumes));
                        if (settings.afastConfig) localStorage.setItem('auroraOS_afastConfig', JSON.stringify(settings.afastConfig));
                        if (settings.recentApps) localStorage.setItem('auroraOS_recentApps', JSON.stringify(settings.recentApps));
                        if (settings.favoriteApps) localStorage.setItem('auroraOS_favoriteApps', JSON.stringify(settings.favoriteApps));
                        
                        showBackupNotification('Configura√ß√µes importadas com sucesso! Recarregue a p√°gina.', 'success');
                        
                    } catch (error) {
                        showBackupNotification('Erro ao processar arquivo de configura√ß√µes!', 'error');
                    }
                };
                reader.readAsText(file);
                
            } catch (error) {
                console.error('Erro ao importar configura√ß√µes:', error);
                showBackupNotification('Erro ao importar configura√ß√µes!', 'error');
            }
        }
        
        // Verificar integridade dos dados
        function verifyDataIntegrity() {
            try {
                const criticalKeys = [
                    'auroraOS_currentUser',
                    'auroraOS_users',
                    'auroraOS_gamification'
                ];
                
                let corruptedData = [];
                
                criticalKeys.forEach(key => {
                    try {
                        const data = localStorage.getItem(key);
                        if (data) {
                            JSON.parse(data);
                        }
                    } catch (e) {
                        corruptedData.push(key);
                    }
                });
                
                if (corruptedData.length > 0) {
                    console.warn('Dados corrompidos detectados:', corruptedData);
                    showBackupNotification(`Dados corrompidos detectados: ${corruptedData.join(', ')}`, 'warning');
                    
                    // Tentar recuperar do backup mais recente
                    if (backupSystem.backupHistory.length > 0) {
                        const latestBackup = backupSystem.backupHistory[0];
                        showBackupNotification('Tentando recuperar do backup mais recente...', 'info');
                        setTimeout(() => restoreBackup(latestBackup.id), 2000);
                    }
                }
                
            } catch (error) {
                console.error('Erro na verifica√ß√£o de integridade:', error);
            }
        }
        
        // Iniciar backup autom√°tico
        function startAutoBackup() {
            if (backupSystem.backupTimer) {
                clearInterval(backupSystem.backupTimer);
            }
            
            backupSystem.backupTimer = setInterval(() => {
                createFullBackup(false);
            }, backupSystem.backupInterval);
            
            console.log('üíæ Backup autom√°tico iniciado (intervalo: 5 minutos)');
        }
        
        // Parar backup autom√°tico
        function stopAutoBackup() {
            if (backupSystem.backupTimer) {
                clearInterval(backupSystem.backupTimer);
                backupSystem.backupTimer = null;
            }
            
            console.log('üíæ Backup autom√°tico parado');
        }
        
        // Gerar checksum simples
        function generateChecksum(str) {
            let hash = 0;
            if (str.length === 0) return hash.toString();
            
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32bit integer
            }
            
            return Math.abs(hash).toString(16);
        }
        
        // Mostrar notifica√ß√£o de backup
        function showBackupNotification(message, type = 'info') {
            const colors = {
                success: '#4CAF50',
                error: '#F44336',
                warning: '#FF9800',
                info: '#2196F3'
            };
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 240px;
                right: 20px;
                background: ${colors[type]};
                color: white;
                padding: 15px 20px;
                border-radius: 12px;
                font-family: 'Alice', serif;
                font-size: 14px;
                box-shadow: 0 8px 25px rgba(0,0,0,0.3);
                z-index: 10001;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.4s ease;
                max-width: 320px;
                border: 2px solid rgba(255,255,255,0.3);
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div style="font-size: 20px;">üíæ</div>
                    <div>${message}</div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 400);
            }, 5000);
        }
        
        // Limpar backups antigos
        function cleanOldBackups() {
            try {
                // Remover backups do localStorage que n√£o est√£o no hist√≥rico
                const validBackupIds = backupSystem.backupHistory.map(b => b.id);
                
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('auroraOS_backup_')) {
                        const backupId = key.replace('auroraOS_backup_', '');
                        if (!validBackupIds.includes(backupId)) {
                            localStorage.removeItem(key);
                            console.log(`üíæ Backup antigo removido: ${backupId}`);
                        }
                    }
                }
                
                showBackupNotification('Backups antigos limpos com sucesso!', 'success');
                
            } catch (error) {
                console.error('Erro ao limpar backups antigos:', error);
                showBackupNotification('Erro ao limpar backups antigos!', 'error');
            }
        }
        
        // Obter estat√≠sticas de backup
        function getBackupStats() {
            const totalBackups = backupSystem.backupHistory.length;
            const totalSize = backupSystem.backupHistory.reduce((sum, backup) => sum + backup.size, 0);
            const lastBackupDate = backupSystem.lastBackup ? new Date(backupSystem.lastBackup) : null;
            
            return {
                totalBackups,
                totalSize: formatBytes(totalSize),
                lastBackup: lastBackupDate ? lastBackupDate.toLocaleString('pt-BR') : 'Nunca',
                autoBackupEnabled: backupSystem.autoBackupEnabled,
                nextBackup: backupSystem.autoBackupEnabled && backupSystem.lastBackup ? 
                    new Date(new Date(backupSystem.lastBackup).getTime() + backupSystem.backupInterval).toLocaleString('pt-BR') : 'N/A'
            };
        }
        
        // Formatar bytes
        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0) return '0 Bytes';
            
            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
        }
        
        // ==========================================
        // ü™ê SISTEMA DE WIDGET PLANET√ÅRIO
        // ==========================================
        
        // Dados planet√°rios
        const planetaryData = {
            'Sol': { symbol: '‚òâ', influence: 'Vitalidade, lideran√ßa, sucesso', color: '#FFD700' },
            'Lua': { symbol: '‚òΩ', influence: 'Intui√ß√£o, emo√ß√µes, receptividade', color: '#C0C0C0' },
            'Marte': { symbol: '‚ôÇ', influence: 'Energia, a√ß√£o, coragem', color: '#FF4500' },
            'Merc√∫rio': { symbol: '‚òø', influence: 'Comunica√ß√£o, intelecto, viagens', color: '#87CEEB' },
            'J√∫piter': { symbol: '‚ôÉ', influence: 'Expans√£o, sabedoria, prosperidade', color: '#FF8C00' },
            'V√™nus': { symbol: '‚ôÄ', influence: 'Amor, beleza, harmonia', color: '#FF69B4' },
            'Saturno': { symbol: '‚ôÑ', influence: 'Disciplina, estrutura, responsabilidade', color: '#8B4513' }
        };
        
        // Ordem planet√°ria tradicional (Caldeu)
        const planetaryOrder = ['Sol', 'V√™nus', 'Merc√∫rio', 'Lua', 'Saturno', 'J√∫piter', 'Marte'];
        
        // Vari√°veis do widget
        let planetaryWidgetTimer = null;
        let isWidgetMinimized = false;
        let currentPlanetaryHour = null;
        
        // Inicializar widget planet√°rio
        function initPlanetaryWidget() {
            // Verificar se o usu√°rio quer mostrar o widget
            const currentUser = getCurrentUser();
            if (!currentUser || !currentUser.settings.showPlanetaryWidget) {
                document.getElementById('planetaryWidget').style.display = 'none';
                return;
            }
            
            updatePlanetaryWidget();
            
            // Atualizar a cada minuto
            if (planetaryWidgetTimer) clearInterval(planetaryWidgetTimer);
            planetaryWidgetTimer = setInterval(updatePlanetaryWidget, 60000);
            
            console.log('ü™ê Widget Planet√°rio inicializado');
        }
        
        // Atualizar widget planet√°rio
        function updatePlanetaryWidget() {
            const now = new Date();
            const currentHour = calculatePlanetaryHour(now);
            
            // Atualizar hora planet√°ria atual
            updateCurrentPlanetaryHour(currentHour);
            
            // Atualizar cronograma do dia
            updatePlanetarySchedule(now);
            
            // Atualizar rel√≥gio
            updatePlanetaryTime(now);
            
            currentPlanetaryHour = currentHour;
        }
        
        // Calcular hora planet√°ria atual
        function calculatePlanetaryHour(date) {
            const dayOfWeek = date.getDay(); // 0 = Domingo, 1 = Segunda, etc.
            const hour = date.getHours();
            
            // Planeta regente do dia (sistema tradicional)
            const dayRulers = ['Sol', 'Lua', 'Marte', 'Merc√∫rio', 'J√∫piter', 'V√™nus', 'Saturno'];
            const dayRuler = dayRulers[dayOfWeek];
            
            // Encontrar √≠ndice do planeta regente do dia
            const dayRulerIndex = planetaryOrder.indexOf(dayRuler);
            
            // Calcular hora planet√°ria (sistema simplificado)
            // Cada hora planet√°ria dura aproximadamente 1 hora
            const hourIndex = (dayRulerIndex + hour) % 7;
            const currentPlanet = planetaryOrder[hourIndex];
            
            return {
                planet: currentPlanet,
                startTime: new Date(date.getFullYear(), date.getMonth(), date.getDate(), hour, 0, 0),
                endTime: new Date(date.getFullYear(), date.getMonth(), date.getDate(), hour + 1, 0, 0),
                dayRuler: dayRuler
            };
        }
        
        // Atualizar hora planet√°ria atual
        function updateCurrentPlanetaryHour(hourData) {
            const symbolEl = document.getElementById('currentPlanetSymbol');
            const nameEl = document.getElementById('currentPlanetName');
            const influenceEl = document.getElementById('currentPlanetInfluence');
            
            if (symbolEl && nameEl && influenceEl) {
                const planetData = planetaryData[hourData.planet];
                
                symbolEl.textContent = planetData.symbol;
                symbolEl.style.color = planetData.color;
                nameEl.textContent = hourData.planet;
                nameEl.style.color = planetData.color;
                influenceEl.textContent = planetData.influence;
            }
        }
        
        // Atualizar cronograma planet√°rio do dia
        function updatePlanetarySchedule(date) {
            const scheduleEl = document.getElementById('planetarySchedule');
            if (!scheduleEl) return;
            
            const dayOfWeek = date.getDay();
            const dayRulers = ['Sol', 'Lua', 'Marte', 'Merc√∫rio', 'J√∫piter', 'V√™nus', 'Saturno'];
            const dayRuler = dayRulers[dayOfWeek];
            const dayRulerIndex = planetaryOrder.indexOf(dayRuler);
            
            let scheduleHTML = '';
            
            for (let hour = 0; hour < 24; hour++) {
                const hourIndex = (dayRulerIndex + hour) % 7;
                const planet = planetaryOrder[hourIndex];
                const planetData = planetaryData[planet];
                const currentHour = date.getHours();
                
                const isCurrentHour = hour === currentHour;
                const timeStr = \`\${hour.toString().padStart(2, '0')}:00\`;
                
                scheduleHTML += \`
                    <div style="
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        padding: 6px 8px;
                        margin-bottom: 4px;
                        background: \${isCurrentHour ? 'rgba(218,165,32,0.2)' : 'rgba(0,0,0,0.1)'};
                        border-radius: 6px;
                        border-left: 3px solid \${planetData.color};
                        font-size: 12px;
                        \${isCurrentHour ? 'box-shadow: 0 0 10px rgba(218,165,32,0.3);' : ''}
                    ">
                        <span style="color: \${isCurrentHour ? 'var(--dourado)' : 'white'}; font-weight: \${isCurrentHour ? 'bold' : 'normal'};">
                            \${timeStr}
                        </span>
                        <span style="color: \${planetData.color}; font-size: 14px;">
                            \${planetData.symbol}
                        </span>
                        <span style="color: \${isCurrentHour ? 'var(--dourado)' : 'rgba(255,255,255,0.8)'}; font-weight: \${isCurrentHour ? 'bold' : 'normal'};">
                            \${planet}
                        </span>
                    </div>
                \`;
            }
            
            scheduleEl.innerHTML = scheduleHTML;
        }
        
        // Atualizar rel√≥gio do widget
        function updatePlanetaryTime(date) {
            const currentTimeEl = document.getElementById('currentTime');
            const nextChangeEl = document.getElementById('nextChange');
            
            if (currentTimeEl) {
                const timeStr = date.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                currentTimeEl.textContent = timeStr;
            }
            
            if (nextChangeEl) {
                const nextHour = new Date(date);
                nextHour.setHours(date.getHours() + 1, 0, 0, 0);
                
                const nextTimeStr = nextHour.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                nextChangeEl.textContent = nextTimeStr;
            }
        }
        
        // Toggle do widget planet√°rio
        function togglePlanetaryWidget() {
            const widget = document.getElementById('planetaryWidget');
            const content = document.getElementById('planetaryWidgetContent');
            const button = widget.querySelector('button');
            
            if (isWidgetMinimized) {
                // Expandir
                content.style.display = 'block';
                widget.style.height = 'auto';
                button.textContent = '‚àí';
                isWidgetMinimized = false;
            } else {
                // Minimizar
                content.style.display = 'none';
                widget.style.height = '60px';
                button.textContent = '+';
                isWidgetMinimized = true;
            }
        }
        
        // Obter usu√°rio atual
        function getCurrentUser() {
            const currentUserEmail = localStorage.getItem('auroraOS_current_user') || sessionStorage.getItem('auroraOS_current_user');
            if (!currentUserEmail) return null;
            
            const userDatabase = JSON.parse(localStorage.getItem('auroraOS_users') || '{}');
            return userDatabase[currentUserEmail] || null;
        }
        
        // ==========================================
        // ‚òÅÔ∏è SISTEMA DE SINCRONIZA√á√ÉO WIX
        // ==========================================
        
        // Configura√ß√µes da API Wix
        const wixConfig = {
            apiKey: 'aurora-os-mysticsoft-api-key', // Chave da API Wix
            siteId: 'aurora-os-mysticsoft-site', // ID do site Wix
            databaseId: 'aurora-users-db', // ID do banco de dados
            baseUrl: 'https://www.wixapis.com/wix-data/v1/items',
            enabled: true // Pode ser desabilitado nas configura√ß√µes
        };
        
        // Estado da sincroniza√ß√£o
        let syncStatus = {
            isOnline: navigator.onLine,
            lastSync: null,
            pendingChanges: [],
            syncInProgress: false,
            autoSyncEnabled: true
        };
        
        // Inicializar sistema de sincroniza√ß√£o Wix
        function initWixSync() {
            console.log('‚òÅÔ∏è Inicializando Sistema de Sincroniza√ß√£o Wix');
            
            // Verificar conectividade
            window.addEventListener('online', () => {
                syncStatus.isOnline = true;
                console.log('üåê Conex√£o restaurada - iniciando sincroniza√ß√£o');
                if (syncStatus.autoSyncEnabled) {
                    syncToWix();
                }
            });
            
            window.addEventListener('offline', () => {
                syncStatus.isOnline = false;
                console.log('üì¥ Conex√£o perdida - modo offline ativado');
            });
            
            // Sincroniza√ß√£o autom√°tica a cada 5 minutos
            if (syncStatus.autoSyncEnabled) {
                setInterval(() => {
                    if (syncStatus.isOnline && !syncStatus.syncInProgress) {
                        syncToWix();
                    }
                }, 300000); // 5 minutos
            }
            
            // Sincroniza√ß√£o inicial
            setTimeout(() => {
                if (syncStatus.isOnline) {
                    syncFromWix(); // Carregar dados da nuvem primeiro
                }
            }, 3000);
        }
        
        // Sincronizar dados para Wix (Upload)
        async function syncToWix() {
            if (!wixConfig.enabled || syncStatus.syncInProgress || !syncStatus.isOnline) {
                return;
            }
            
            syncStatus.syncInProgress = true;
            console.log('‚òÅÔ∏è Iniciando sincroniza√ß√£o para Wix...');
            
            try {
                const currentUser = getCurrentUser();
                if (!currentUser) {
                    console.log('‚ùå Nenhum usu√°rio logado para sincronizar');
                    return;
                }
                
                // Preparar dados para sincroniza√ß√£o
                const syncData = {
                    userId: currentUser.email,
                    userData: {
                        profile: {
                            name: currentUser.name,
                            email: currentUser.email,
                            birthData: currentUser.birthData,
                            astrologicalProfile: currentUser.astrologicalProfile,
                            interests: currentUser.interests,
                            profilePhoto: currentUser.profilePhoto
                        },
                        settings: currentUser.settings,
                        stats: currentUser.stats,
                        gameData: {
                            achievements: JSON.parse(localStorage.getItem('auroraOS_achievements') || '[]'),
                            gameStats: JSON.parse(localStorage.getItem('auroraOS_gameStats') || '{}')
                        },
                        systemData: {
                            afastSettings: JSON.parse(localStorage.getItem('auroraOS_afastSettings') || '{}'),
                            afastHistory: JSON.parse(localStorage.getItem('auroraOS_afastHistory') || '[]'),
                            recentApps: JSON.parse(localStorage.getItem('auroraOS_recentApps') || '[]'),
                            favoriteApps: JSON.parse(localStorage.getItem('auroraOS_favoriteApps') || '[]'),
                            customWallpapers: JSON.parse(localStorage.getItem('auroraOS_customWallpapers') || '[]'),
                            galleryImages: JSON.parse(localStorage.getItem('auroraOS_galleryImages') || '[]')
                        },
                        lastSync: new Date().toISOString(),
                        version: '2.0.0'
                    }
                };
                
                // Simular chamada para API Wix (em implementa√ß√£o real)
                const success = await simulateWixApiCall('POST', 'users', syncData);
                
                if (success) {
                    syncStatus.lastSync = new Date();
                    syncStatus.pendingChanges = [];
                    console.log('‚úÖ Sincroniza√ß√£o para Wix conclu√≠da com sucesso');
                    
                    // Mostrar notifica√ß√£o de sucesso
                    showSyncNotification('Dados sincronizados com a nuvem', 'success');
                } else {
                    throw new Error('Falha na sincroniza√ß√£o');
                }
                
            } catch (error) {
                console.error('‚ùå Erro na sincroniza√ß√£o para Wix:', error);
                showSyncNotification('Erro na sincroniza√ß√£o - tentando novamente', 'error');
                
                // Adicionar √† lista de mudan√ßas pendentes
                syncStatus.pendingChanges.push({
                    timestamp: new Date(),
                    action: 'sync_to_wix',
                    data: 'user_data'
                });
            } finally {
                syncStatus.syncInProgress = false;
            }
        }
        
        // Sincronizar dados do Wix (Download)
        async function syncFromWix() {
            if (!wixConfig.enabled || syncStatus.syncInProgress || !syncStatus.isOnline) {
                return;
            }
            
            syncStatus.syncInProgress = true;
            console.log('‚òÅÔ∏è Carregando dados do Wix...');
            
            try {
                const currentUser = getCurrentUser();
                if (!currentUser) {
                    console.log('‚ùå Nenhum usu√°rio logado para carregar dados');
                    return;
                }
                
                // Simular chamada para API Wix (em implementa√ß√£o real)
                const cloudData = await simulateWixApiCall('GET', `users/${currentUser.email}`);
                
                if (cloudData && cloudData.userData) {
                    // Verificar se dados da nuvem s√£o mais recentes
                    const cloudDate = new Date(cloudData.userData.lastSync);
                    const localDate = syncStatus.lastSync || new Date(0);
                    
                    if (cloudDate > localDate) {
                        console.log('üì• Aplicando dados mais recentes da nuvem...');
                        
                        // Aplicar dados da nuvem
                        await applyCloudData(cloudData.userData);
                        
                        syncStatus.lastSync = cloudDate;
                        console.log('‚úÖ Dados da nuvem aplicados com sucesso');
                        showSyncNotification('Dados atualizados da nuvem', 'info');
                    } else {
                        console.log('üìä Dados locais est√£o atualizados');
                    }
                }
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar dados do Wix:', error);
                showSyncNotification('Erro ao carregar dados da nuvem', 'error');
            } finally {
                syncStatus.syncInProgress = false;
            }
        }
        
        // Aplicar dados da nuvem localmente
        async function applyCloudData(cloudUserData) {
            try {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                // Atualizar dados do usu√°rio
                const userDatabase = JSON.parse(localStorage.getItem('auroraOS_users') || '{}');
                userDatabase[currentUser.email] = {
                    ...userDatabase[currentUser.email],
                    ...cloudUserData.profile,
                    settings: cloudUserData.settings,
                    stats: cloudUserData.stats
                };
                localStorage.setItem('auroraOS_users', JSON.stringify(userDatabase));
                
                // Atualizar dados do sistema
                if (cloudUserData.systemData) {
                    const systemData = cloudUserData.systemData;
                    
                    if (systemData.afastSettings) {
                        localStorage.setItem('auroraOS_afastSettings', JSON.stringify(systemData.afastSettings));
                    }
                    if (systemData.afastHistory) {
                        localStorage.setItem('auroraOS_afastHistory', JSON.stringify(systemData.afastHistory));
                    }
                    if (systemData.recentApps) {
                        localStorage.setItem('auroraOS_recentApps', JSON.stringify(systemData.recentApps));
                    }
                    if (systemData.favoriteApps) {
                        localStorage.setItem('auroraOS_favoriteApps', JSON.stringify(systemData.favoriteApps));
                    }
                    if (systemData.customWallpapers) {
                        localStorage.setItem('auroraOS_customWallpapers', JSON.stringify(systemData.customWallpapers));
                    }
                    if (systemData.galleryImages) {
                        localStorage.setItem('auroraOS_galleryImages', JSON.stringify(systemData.galleryImages));
                    }
                }
                
                // Atualizar dados de jogos
                if (cloudUserData.gameData) {
                    if (cloudUserData.gameData.achievements) {
                        localStorage.setItem('auroraOS_achievements', JSON.stringify(cloudUserData.gameData.achievements));
                    }
                    if (cloudUserData.gameData.gameStats) {
                        localStorage.setItem('auroraOS_gameStats', JSON.stringify(cloudUserData.gameData.gameStats));
                    }
                }
                
                console.log('‚úÖ Dados da nuvem aplicados localmente');
                
            } catch (error) {
                console.error('‚ùå Erro ao aplicar dados da nuvem:', error);
                throw error;
            }
        }
        
        // Simular chamada para API Wix (substituir por implementa√ß√£o real)
        async function simulateWixApiCall(method, endpoint, data = null) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    console.log(`üîÑ Simulando ${method} para ${endpoint}`);
                    
                    if (method === 'POST') {
                        // Simular sucesso no upload
                        resolve(true);
                    } else if (method === 'GET') {
                        // Simular dados da nuvem (em implementa√ß√£o real, viria do Wix)
                        const mockCloudData = {
                            userData: {
                                profile: getCurrentUser(),
                                settings: JSON.parse(localStorage.getItem('auroraOS_userSettings') || '{}'),
                                systemData: {
                                    afastSettings: JSON.parse(localStorage.getItem('auroraOS_afastSettings') || '{}'),
                                    recentApps: JSON.parse(localStorage.getItem('auroraOS_recentApps') || '[]')
                                },
                                lastSync: new Date(Date.now() - 3600000).toISOString() // 1 hora atr√°s
                            }
                        };
                        resolve(mockCloudData);
                    }
                }, 1500); // Simular lat√™ncia de rede
            });
        }
        
        // Mostrar notifica√ß√£o de sincroniza√ß√£o
        function showSyncNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: ${type === 'success' ? 'linear-gradient(135deg, #4CAF50, #45a049)' : 
                           type === 'error' ? 'linear-gradient(135deg, #f44336, #d32f2f)' : 
                           'linear-gradient(135deg, #2196F3, #1976D2)'};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                font-family: 'Alice', serif;
                font-size: 14px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.3s ease;
                max-width: 300px;
                border: 1px solid rgba(255,255,255,0.2);
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 16px;">
                        ${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚òÅÔ∏è'}
                    </span>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animar entrada
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Remover ap√≥s 4 segundos
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }
        
        // For√ßar sincroniza√ß√£o manual
        function forceSyncToWix() {
            if (syncStatus.isOnline) {
                syncToWix();
                showSyncNotification('Sincroniza√ß√£o manual iniciada', 'info');
            } else {
                showSyncNotification('Sem conex√£o com a internet', 'error');
            }
        }
        
        // Obter status da sincroniza√ß√£o
        function getSyncStatus() {
            return {
                ...syncStatus,
                lastSyncFormatted: syncStatus.lastSync ? 
                    syncStatus.lastSync.toLocaleString('pt-BR') : 'Nunca',
                pendingCount: syncStatus.pendingChanges.length
            };
        }
        
        // Configurar sincroniza√ß√£o autom√°tica
        function setAutoSync(enabled) {
            syncStatus.autoSyncEnabled = enabled;
            localStorage.setItem('auroraOS_autoSync', JSON.stringify(enabled));
            
            if (enabled && syncStatus.isOnline) {
                syncToWix();
            }
        }
        
        // Gerar aplica√ß√£o de Paci√™ncia M√≠stica
        function generateSolitaireApp() {
            return `
                <div class="solitaire-game-container" style="padding: 15px; background: linear-gradient(135deg, #8B4513 0%, #2F4F4F 100%); color: white; height: 100%; overflow: hidden; font-family: 'Alice', serif;">
                    <div class="game-header" style="text-align: center; margin-bottom: 15px;">
                        <h2 style="margin: 0; font-size: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">üÉè Paci√™ncia M√≠stica</h2>
                        <div class="game-stats" style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px;">
                            <span>Pontos: <span id="solitaireScore">0</span></span>
                            <span>Movimentos: <span id="solitaireMoves">0</span></span>
                            <span>Tempo: <span id="solitaireTime">00:00</span></span>
                        </div>
                    </div>
                    
                    <div class="solitaire-workspace" style="height: calc(100% - 120px); position: relative;">
                        <!-- √Årea do Baralho e Descarte -->
                        <div class="deck-area" style="
                            position: absolute;
                            top: 10px;
                            left: 10px;
                            display: flex;
                            gap: 15px;
                        ">
                            <div id="stockPile" class="card-pile" style="
                                width: 60px;
                                height: 80px;
                                background: linear-gradient(135deg, #4a4a4a, #2a2a2a);
                                border: 2px solid var(--dourado);
                                border-radius: 8px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                cursor: pointer;
                                font-size: 24px;
                            " onclick="drawFromStock()">üé¥</div>
                            
                            <div id="wastePile" class="card-pile" style="
                                width: 60px;
                                height: 80px;
                                background: rgba(0,0,0,0.3);
                                border: 2px dashed rgba(255,255,255,0.3);
                                border-radius: 8px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                cursor: pointer;
                            "></div>
                        </div>
                        
                        <!-- Funda√ß√µes (Ases) -->
                        <div class="foundations" style="
                            position: absolute;
                            top: 10px;
                            right: 10px;
                            display: grid;
                            grid-template-columns: repeat(4, 1fr);
                            gap: 10px;
                        ">
                            <div id="foundation0" class="foundation" data-suit="0" style="
                                width: 60px;
                                height: 80px;
                                background: rgba(0,0,0,0.3);
                                border: 2px dashed var(--dourado);
                                border-radius: 8px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-size: 20px;
                            " ondrop="dropOnFoundation(event, 0)" ondragover="allowDrop(event)">‚ô†Ô∏è</div>
                            
                            <div id="foundation1" class="foundation" data-suit="1" style="
                                width: 60px;
                                height: 80px;
                                background: rgba(0,0,0,0.3);
                                border: 2px dashed var(--dourado);
                                border-radius: 8px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-size: 20px;
                            " ondrop="dropOnFoundation(event, 1)" ondragover="allowDrop(event)">‚ô•Ô∏è</div>
                            
                            <div id="foundation2" class="foundation" data-suit="2" style="
                                width: 60px;
                                height: 80px;
                                background: rgba(0,0,0,0.3);
                                border: 2px dashed var(--dourado);
                                border-radius: 8px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-size: 20px;
                            " ondrop="dropOnFoundation(event, 2)" ondragover="allowDrop(event)">‚ô¶Ô∏è</div>
                            
                            <div id="foundation3" class="foundation" data-suit="3" style="
                                width: 60px;
                                height: 80px;
                                background: rgba(0,0,0,0.3);
                                border: 2px dashed var(--dourado);
                                border-radius: 8px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-size: 20px;
                            " ondrop="dropOnFoundation(event, 3)" ondragover="allowDrop(event)">‚ô£Ô∏è</div>
                        </div>
                        
                        <!-- Tableau (7 colunas) -->
                        <div class="tableau" style="
                            position: absolute;
                            top: 110px;
                            left: 10px;
                            right: 10px;
                            bottom: 60px;
                            display: grid;
                            grid-template-columns: repeat(7, 1fr);
                            gap: 10px;
                        ">
                            <div id="tableau0" class="tableau-column" data-column="0" style="
                                background: rgba(0,0,0,0.2);
                                border: 1px dashed rgba(255,255,255,0.2);
                                border-radius: 8px;
                                min-height: 100px;
                                position: relative;
                            " ondrop="dropOnTableau(event, 0)" ondragover="allowDrop(event)"></div>
                            
                            <div id="tableau1" class="tableau-column" data-column="1" style="
                                background: rgba(0,0,0,0.2);
                                border: 1px dashed rgba(255,255,255,0.2);
                                border-radius: 8px;
                                min-height: 100px;
                                position: relative;
                            " ondrop="dropOnTableau(event, 1)" ondragover="allowDrop(event)"></div>
                            
                            <div id="tableau2" class="tableau-column" data-column="2" style="
                                background: rgba(0,0,0,0.2);
                                border: 1px dashed rgba(255,255,255,0.2);
                                border-radius: 8px;
                                min-height: 100px;
                                position: relative;
                            " ondrop="dropOnTableau(event, 2)" ondragover="allowDrop(event)"></div>
                            
                            <div id="tableau3" class="tableau-column" data-column="3" style="
                                background: rgba(0,0,0,0.2);
                                border: 1px dashed rgba(255,255,255,0.2);
                                border-radius: 8px;
                                min-height: 100px;
                                position: relative;
                            " ondrop="dropOnTableau(event, 3)" ondragover="allowDrop(event)"></div>
                            
                            <div id="tableau4" class="tableau-column" data-column="4" style="
                                background: rgba(0,0,0,0.2);
                                border: 1px dashed rgba(255,255,255,0.2);
                                border-radius: 8px;
                                min-height: 100px;
                                position: relative;
                            " ondrop="dropOnTableau(event, 4)" ondragover="allowDrop(event)"></div>
                            
                            <div id="tableau5" class="tableau-column" data-column="5" style="
                                background: rgba(0,0,0,0.2);
                                border: 1px dashed rgba(255,255,255,0.2);
                                border-radius: 8px;
                                min-height: 100px;
                                position: relative;
                            " ondrop="dropOnTableau(event, 5)" ondragover="allowDrop(event)"></div>
                            
                            <div id="tableau6" class="tableau-column" data-column="6" style="
                                background: rgba(0,0,0,0.2);
                                border: 1px dashed rgba(255,255,255,0.2);
                                border-radius: 8px;
                                min-height: 100px;
                                position: relative;
                            " ondrop="dropOnTableau(event, 6)" ondragover="allowDrop(event)"></div>
                        </div>
                        
                        <!-- Controles -->
                        <div class="game-controls" style="
                            position: absolute;
                            bottom: 10px;
                            left: 10px;
                            right: 10px;
                            display: flex;
                            gap: 10px;
                            justify-content: center;
                        ">
                            <button onclick="newSolitaireGame()" style="
                                background: linear-gradient(45deg, #667eea, #764ba2);
                                color: white;
                                border: none;
                                padding: 8px 16px;
                                border-radius: 20px;
                                cursor: pointer;
                                font-weight: bold;
                            ">üîÑ Novo Jogo</button>
                            
                            <button onclick="useMagicHint()" style="
                                background: linear-gradient(45deg, #f093fb, #f5576c);
                                color: white;
                                border: none;
                                padding: 8px 16px;
                                border-radius: 20px;
                                cursor: pointer;
                                font-weight: bold;
                            ">‚ú® Dica M√°gica</button>
                            
                            <button onclick="autoComplete()" style="
                                background: linear-gradient(45deg, #4ecdc4, #44a08d);
                                color: white;
                                border: none;
                                padding: 8px 16px;
                                border-radius: 20px;
                                cursor: pointer;
                                font-weight: bold;
                            ">üéØ Auto-Completar</button>
                        </div>
                    </div>
                </div>
                
                <script>
                    // Vari√°veis do jogo de paci√™ncia
                    let solitaireDeck = [];
                    let stockPile = [];
                    let wastePile = [];
                    let foundations = [[], [], [], []]; // 4 naipes
                    let tableau = [[], [], [], [], [], [], []]; // 7 colunas
                    let solitaireScore = 0;
                    let solitaireMoves = 0;
                    let solitaireStartTime = null;
                    let solitaireTimer = null;
                    
                    // Cartas m√≠sticas
                    const mysticalSuits = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô¶Ô∏è', '‚ô£Ô∏è'];
                    const mysticalRanks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
                    const mysticalSymbols = {
                        'A': 'üåü', '2': 'üåô', '3': '‚≠ê', '4': 'üîÆ', '5': 'üíé', 
                        '6': 'üå∏', '7': 'üçÄ', '8': 'ü¶ã', '9': 'üå∫', '10': 'üî•',
                        'J': 'üëë', 'Q': 'üßö‚Äç‚ôÄÔ∏è', 'K': 'üßô‚Äç‚ôÇÔ∏è'
                    };
                    
                    // Criar baralho
                    function createSolitaireDeck() {
                        solitaireDeck = [];
                        for (let suit = 0; suit < 4; suit++) {
                            for (let rank = 0; rank < 13; rank++) {
                                solitaireDeck.push({
                                    suit: suit,
                                    rank: rank,
                                    suitSymbol: mysticalSuits[suit],
                                    rankSymbol: mysticalRanks[rank],
                                    mysticalSymbol: mysticalSymbols[mysticalRanks[rank]],
                                    faceUp: false,
                                    color: (suit === 1 || suit === 2) ? 'red' : 'black'
                                });
                            }
                        }
                        
                        // Embaralhar
                        for (let i = solitaireDeck.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [solitaireDeck[i], solitaireDeck[j]] = [solitaireDeck[j], solitaireDeck[i]];
                        }
                    }
                    
                    // Inicializar novo jogo
                    function newSolitaireGame() {
                        createSolitaireDeck();
                        
                        // Limpar tudo
                        stockPile = [];
                        wastePile = [];
                        foundations = [[], [], [], []];
                        tableau = [[], [], [], [], [], [], []];
                        solitaireScore = 0;
                        solitaireMoves = 0;
                        
                        // Distribuir cartas no tableau
                        let cardIndex = 0;
                        for (let col = 0; col < 7; col++) {
                            for (let row = 0; row <= col; row++) {
                                const card = solitaireDeck[cardIndex++];
                                card.faceUp = (row === col); // √öltima carta virada
                                tableau[col].push(card);
                            }
                        }
                        
                        // Resto vai para o stock
                        stockPile = solitaireDeck.slice(cardIndex);
                        
                        // Iniciar timer
                        solitaireStartTime = Date.now();
                        if (solitaireTimer) clearInterval(solitaireTimer);
                        solitaireTimer = setInterval(updateSolitaireTimer, 1000);
                        
                        renderSolitaireGame();
                        updateSolitaireStats();
                        
                        showGatomante('Nova partida de Paci√™ncia M√≠stica iniciada!', 'excited');
                    }
                    
                    // Renderizar jogo
                    function renderSolitaireGame() {
                        // Renderizar stock pile
                        const stockEl = document.getElementById('stockPile');
                        if (stockEl) {
                            stockEl.innerHTML = stockPile.length > 0 ? 'üé¥' : '';
                            stockEl.style.opacity = stockPile.length > 0 ? '1' : '0.3';
                        }
                        
                        // Renderizar waste pile
                        const wasteEl = document.getElementById('wastePile');
                        if (wasteEl && wastePile.length > 0) {
                            const topCard = wastePile[wastePile.length - 1];
                            wasteEl.innerHTML = createCardHTML(topCard);
                            wasteEl.onclick = () => selectCard(topCard, 'waste');
                        } else if (wasteEl) {
                            wasteEl.innerHTML = '';
                        }
                        
                        // Renderizar foundations
                        for (let i = 0; i < 4; i++) {
                            const foundationEl = document.getElementById(\`foundation\${i}\`);
                            if (foundationEl) {
                                if (foundations[i].length > 0) {
                                    const topCard = foundations[i][foundations[i].length - 1];
                                    foundationEl.innerHTML = createCardHTML(topCard);
                                } else {
                                    foundationEl.innerHTML = mysticalSuits[i];
                                }
                            }
                        }
                        
                        // Renderizar tableau
                        for (let col = 0; col < 7; col++) {
                            const columnEl = document.getElementById(\`tableau\${col}\`);
                            if (columnEl) {
                                columnEl.innerHTML = '';
                                tableau[col].forEach((card, index) => {
                                    const cardEl = document.createElement('div');
                                    cardEl.className = 'solitaire-card';
                                    cardEl.style.cssText = \`
                                        position: absolute;
                                        top: \${index * 20}px;
                                        left: 5px;
                                        right: 5px;
                                        height: 80px;
                                        background: \${card.faceUp ? 'linear-gradient(135deg, #f8f8f8, #e8e8e8)' : 'linear-gradient(135deg, #4a4a4a, #2a2a2a)'};
                                        border: 2px solid \${card.faceUp ? (card.color === 'red' ? '#d32f2f' : '#1976d2') : 'var(--dourado)'};
                                        border-radius: 8px;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        cursor: \${card.faceUp ? 'pointer' : 'default'};
                                        font-size: 12px;
                                        color: \${card.faceUp ? (card.color === 'red' ? '#d32f2f' : '#1976d2') : 'white'};
                                        transition: all 0.3s ease;
                                        z-index: \${index};
                                    \`;
                                    
                                    if (card.faceUp) {
                                        cardEl.innerHTML = createCardHTML(card);
                                        cardEl.onclick = () => selectCard(card, 'tableau', col);
                                        cardEl.draggable = true;
                                        cardEl.ondragstart = (e) => dragStart(e, card, 'tableau', col);
                                    } else {
                                        cardEl.innerHTML = 'üé¥';
                                        cardEl.onclick = () => flipCard(col, index);
                                    }
                                    
                                    columnEl.appendChild(cardEl);
                                });
                            }
                        }
                    }
                    
                    // Criar HTML da carta
                    function createCardHTML(card) {
                        return \`
                            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;">
                                <div style="font-size: 16px;">\${card.mysticalSymbol}</div>
                                <div style="font-size: 10px; font-weight: bold;">\${card.rankSymbol}\${card.suitSymbol}</div>
                            </div>
                        \`;
                    }
                    
                    // Tirar carta do stock
                    function drawFromStock() {
                        if (stockPile.length > 0) {
                            const card = stockPile.pop();
                            card.faceUp = true;
                            wastePile.push(card);
                            solitaireMoves++;
                        } else if (wastePile.length > 0) {
                            // Reciclar waste pile para stock
                            stockPile = wastePile.reverse();
                            wastePile = [];
                            stockPile.forEach(card => card.faceUp = false);
                        }
                        
                        renderSolitaireGame();
                        updateSolitaireStats();
                    }
                    
                    // Virar carta no tableau
                    function flipCard(col, index) {
                        if (index === tableau[col].length - 1) {
                            tableau[col][index].faceUp = true;
                            solitaireMoves++;
                            solitaireScore += 5;
                            renderSolitaireGame();
                            updateSolitaireStats();
                        }
                    }
                    
                    // Selecionar carta
                    function selectCard(card, source, index) {
                        // Implementar l√≥gica de sele√ß√£o
                        console.log('Carta selecionada:', card, 'de', source);
                    }
                    
                    // Drag and drop
                    function allowDrop(ev) {
                        ev.preventDefault();
                    }
                    
                    function dragStart(ev, card, source, index) {
                        ev.dataTransfer.setData('text/plain', JSON.stringify({card, source, index}));
                    }
                    
                    function dropOnFoundation(ev, foundationIndex) {
                        ev.preventDefault();
                        const data = JSON.parse(ev.dataTransfer.getData('text/plain'));
                        
                        // Verificar se pode colocar na foundation
                        if (canPlaceOnFoundation(data.card, foundationIndex)) {
                            moveCardToFoundation(data, foundationIndex);
                        }
                    }
                    
                    function dropOnTableau(ev, columnIndex) {
                        ev.preventDefault();
                        const data = JSON.parse(ev.dataTransfer.getData('text/plain'));
                        
                        // Verificar se pode colocar no tableau
                        if (canPlaceOnTableau(data.card, columnIndex)) {
                            moveCardToTableau(data, columnIndex);
                        }
                    }
                    
                    // Verificar se pode colocar na foundation
                    function canPlaceOnFoundation(card, foundationIndex) {
                        if (card.suit !== foundationIndex) return false;
                        
                        const foundation = foundations[foundationIndex];
                        if (foundation.length === 0) {
                            return card.rank === 0; // √Ås
                        } else {
                            const topCard = foundation[foundation.length - 1];
                            return card.rank === topCard.rank + 1;
                        }
                    }
                    
                    // Verificar se pode colocar no tableau
                    function canPlaceOnTableau(card, columnIndex) {
                        const column = tableau[columnIndex];
                        if (column.length === 0) {
                            return card.rank === 12; // Rei
                        } else {
                            const topCard = column[column.length - 1];
                            return card.rank === topCard.rank - 1 && card.color !== topCard.color;
                        }
                    }
                    
                    // Mover carta para foundation
                    function moveCardToFoundation(data, foundationIndex) {
                        // Remover carta da origem
                        removeCardFromSource(data);
                        
                        // Adicionar √† foundation
                        foundations[foundationIndex].push(data.card);
                        
                        solitaireMoves++;
                        solitaireScore += 10;
                        
                        renderSolitaireGame();
                        updateSolitaireStats();
                        checkWinCondition();
                    }
                    
                    // Mover carta para tableau
                    function moveCardToTableau(data, columnIndex) {
                        // Remover carta da origem
                        removeCardFromSource(data);
                        
                        // Adicionar ao tableau
                        tableau[columnIndex].push(data.card);
                        
                        solitaireMoves++;
                        
                        renderSolitaireGame();
                        updateSolitaireStats();
                    }
                    
                    // Remover carta da origem
                    function removeCardFromSource(data) {
                        if (data.source === 'waste') {
                            wastePile.pop();
                        } else if (data.source === 'tableau') {
                            tableau[data.index].pop();
                        }
                    }
                    
                    // Usar dica m√°gica
                    function useMagicHint() {
                        // Implementar sistema de dicas
                        const hints = [
                            'Procure por Ases para come√ßar as funda√ß√µes!',
                            'Vire cartas viradas para baixo quando poss√≠vel.',
                            'Mova Reis para colunas vazias.',
                            'Construa sequ√™ncias decrescentes alternando cores.',
                            'Foque em liberar cartas enterradas.'
                        ];
                        
                        const randomHint = hints[Math.floor(Math.random() * hints.length)];
                        showGatomante(randomHint, 'thinking');
                    }
                    
                    // Auto-completar
                    function autoComplete() {
                        // Implementar auto-completar quando poss√≠vel
                        let moved = false;
                        
                        // Tentar mover cartas para foundations
                        for (let col = 0; col < 7; col++) {
                            if (tableau[col].length > 0) {
                                const topCard = tableau[col][tableau[col].length - 1];
                                if (topCard.faceUp && canPlaceOnFoundation(topCard, topCard.suit)) {
                                    foundations[topCard.suit].push(tableau[col].pop());
                                    solitaireMoves++;
                                    solitaireScore += 10;
                                    moved = true;
                                    break;
                                }
                            }
                        }
                        
                        // Tentar mover do waste pile
                        if (!moved && wastePile.length > 0) {
                            const topCard = wastePile[wastePile.length - 1];
                            if (canPlaceOnFoundation(topCard, topCard.suit)) {
                                foundations[topCard.suit].push(wastePile.pop());
                                solitaireMoves++;
                                solitaireScore += 10;
                                moved = true;
                            }
                        }
                        
                        if (moved) {
                            renderSolitaireGame();
                            updateSolitaireStats();
                            checkWinCondition();
                        } else {
                            showGatomante('Nenhum movimento autom√°tico dispon√≠vel.', 'thinking');
                        }
                    }
                    
                    // Verificar condi√ß√£o de vit√≥ria
                    function checkWinCondition() {
                        const totalCards = foundations.reduce((sum, foundation) => sum + foundation.length, 0);
                        if (totalCards === 52) {
                            clearInterval(solitaireTimer);
                            solitaireScore += 1000; // B√¥nus de vit√≥ria
                            updateSolitaireStats();
                            showGatomante('Parab√©ns! Voc√™ venceu a Paci√™ncia M√≠stica! ‚ú®', 'excited');
                        }
                    }
                    
                    // Atualizar estat√≠sticas
                    function updateSolitaireStats() {
                        const scoreEl = document.getElementById('solitaireScore');
                        const movesEl = document.getElementById('solitaireMoves');
                        
                        if (scoreEl) scoreEl.textContent = solitaireScore;
                        if (movesEl) movesEl.textContent = solitaireMoves;
                    }
                    
                    // Atualizar timer
                    function updateSolitaireTimer() {
                        if (!solitaireStartTime) return;
                        
                        const elapsed = Math.floor((Date.now() - solitaireStartTime) / 1000);
                        const minutes = Math.floor(elapsed / 60);
                        const seconds = elapsed % 60;
                        
                        const timeEl = document.getElementById('solitaireTime');
                        if (timeEl) {
                            timeEl.textContent = \`\${minutes.toString().padStart(2, '0')}:\${seconds.toString().padStart(2, '0')}\`;
                        }
                    }
                    
                    // Inicializar quando a aplica√ß√£o for carregada
                    setTimeout(newSolitaireGame, 100);
                </script>
            `;
        }
        
        // Gerar aplica√ß√£o de Domin√≥ Astral
        function generateDominoApp() {
            return `
                <div class="domino-game-container" style="padding: 15px; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: white; height: 100%; overflow: hidden; font-family: 'Alice', serif;">
                    <div class="game-header" style="text-align: center; margin-bottom: 15px;">
                        <h2 style="margin: 0; font-size: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">‚ö´ Domin√≥ Astral</h2>
                        <div class="game-stats" style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px;">
                            <span>Suas Pe√ßas: <span id="playerPieces">7</span></span>
                            <span>IA: <span id="aiPieces">7</span></span>
                            <span>Cemit√©rio: <span id="boneyard">14</span></span>
                        </div>
                    </div>
                    
                    <div class="domino-workspace" style="height: calc(100% - 120px); position: relative;">
                        <!-- Mesa de Jogo -->
                        <div class="game-table" style="
                            position: absolute;
                            top: 10px;
                            left: 10px;
                            right: 10px;
                            height: 60%;
                            background: rgba(0,50,0,0.3);
                            border: 2px solid var(--dourado);
                            border-radius: 15px;
                            padding: 15px;
                            overflow: auto;
                        ">
                            <div id="dominoChain" style="
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                min-height: 100%;
                                flex-wrap: wrap;
                                gap: 5px;
                            ">
                                <div class="start-message" style="
                                    text-align: center;
                                    color: rgba(255,255,255,0.5);
                                    font-style: italic;
                                ">
                                    Clique em "Novo Jogo" para come√ßar...
                                </div>
                            </div>
                        </div>
                        
                        <!-- M√£o do Jogador -->
                        <div class="player-hand" style="
                            position: absolute;
                            bottom: 10px;
                            left: 10px;
                            right: 10px;
                            height: 35%;
                            background: rgba(0,0,0,0.3);
                            border: 2px solid var(--dourado);
                            border-radius: 15px;
                            padding: 15px;
                        ">
                            <h3 style="margin: 0 0 10px 0; font-size: 16px; text-align: center;">üé¥ Suas Pe√ßas Astrais</h3>
                            <div id="playerHand" style="
                                display: flex;
                                gap: 10px;
                                justify-content: center;
                                flex-wrap: wrap;
                                height: calc(100% - 40px);
                                align-items: center;
                            ">
                                <!-- Pe√ßas do jogador aparecer√£o aqui -->
                            </div>
                        </div>
                        
                        <!-- Painel de Controle -->
                        <div class="game-controls" style="
                            position: absolute;
                            top: 10px;
                            right: 10px;
                            width: 150px;
                            background: rgba(0,0,0,0.3);
                            border: 2px solid var(--dourado);
                            border-radius: 15px;
                            padding: 15px;
                        ">
                            <button onclick="newDominoGame()" style="
                                background: linear-gradient(45deg, #667eea, #764ba2);
                                color: white;
                                border: none;
                                padding: 10px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                width: 100%;
                                margin-bottom: 10px;
                                font-size: 12px;
                            ">üîÑ Novo Jogo</button>
                            
                            <button onclick="drawFromBoneyard()" id="drawButton" style="
                                background: linear-gradient(45deg, #f093fb, #f5576c);
                                color: white;
                                border: none;
                                padding: 10px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                width: 100%;
                                margin-bottom: 10px;
                                font-size: 12px;
                            ">üé≤ Comprar Pe√ßa</button>
                            
                            <button onclick="passTurn()" id="passButton" style="
                                background: linear-gradient(45deg, #4ecdc4, #44a08d);
                                color: white;
                                border: none;
                                padding: 10px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                width: 100%;
                                margin-bottom: 15px;
                                font-size: 12px;
                            ">‚è≠Ô∏è Passar Vez</button>
                            
                            <div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px;">
                                <div id="gameStatus" style="
                                    font-size: 12px;
                                    text-align: center;
                                    color: var(--dourado);
                                    font-weight: bold;
                                ">Sua vez</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Modal de Vit√≥ria -->
                    <div id="dominoModal" style="
                        display: none;
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0,0,0,0.8);
                        z-index: 10000;
                        backdrop-filter: blur(5px);
                    ">
                        <div style="
                            position: absolute;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                            border: 2px solid var(--dourado);
                            border-radius: 15px;
                            padding: 20px;
                            max-width: 400px;
                            text-align: center;
                            color: white;
                        ">
                            <div id="modalContent">
                                <!-- Conte√∫do ser√° inserido aqui -->
                            </div>
                            <button onclick="closeDominoModal()" style="
                                background: var(--dourado);
                                color: var(--azul-escuro);
                                border: none;
                                padding: 10px 20px;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: bold;
                                margin-top: 15px;
                                width: 100%;
                            ">Fechar</button>
                        </div>
                    </div>
                </div>
                
                <script>
                    // Vari√°veis do jogo de domin√≥
                    let dominoPieces = [];
                    let playerHand = [];
                    let aiHand = [];
                    let boneyard = [];
                    let dominoChain = [];
                    let currentPlayer = 'player'; // 'player' ou 'ai'
                    let gameStarted = false;
                    
                    // S√≠mbolos astrol√≥gicos para as pe√ßas
                    const astralSymbols = [
                        '‚ôà', '‚ôâ', '‚ôä', '‚ôã', '‚ôå', '‚ôç', // Signos 0-5
                        '‚ôé', '‚ôè', '‚ôê', '‚ôë', '‚ôí', '‚ôì', // Signos 6-11
                        '‚òâ', '‚òΩ', '‚òø', '‚ôÄ', '‚ôÇ', '‚ôÉ', // Planetas 12-17
                        '‚ôÑ', '‚ö∑', '‚ôÜ', '‚ôá', 'üåü', 'üîÆ'  // Planetas/Especiais 18-23
                    ];
                    
                    const symbolNames = {
                        '‚ôà': '√Åries', '‚ôâ': 'Touro', '‚ôä': 'G√™meos', '‚ôã': 'C√¢ncer',
                        '‚ôå': 'Le√£o', '‚ôç': 'Virgem', '‚ôé': 'Libra', '‚ôè': 'Escorpi√£o',
                        '‚ôê': 'Sagit√°rio', '‚ôë': 'Capric√≥rnio', '‚ôí': 'Aqu√°rio', '‚ôì': 'Peixes',
                        '‚òâ': 'Sol', '‚òΩ': 'Lua', '‚òø': 'Merc√∫rio', '‚ôÄ': 'V√™nus',
                        '‚ôÇ': 'Marte', '‚ôÉ': 'J√∫piter', '‚ôÑ': 'Saturno', '‚ö∑': 'Urano',
                        '‚ôÜ': 'Netuno', '‚ôá': 'Plut√£o', 'üåü': 'Estrela', 'üîÆ': 'Cristal'
                    };
                    
                    // Criar conjunto de pe√ßas de domin√≥ astral
                    function createAstralDominoPieces() {
                        dominoPieces = [];
                        
                        // Criar pe√ßas com combina√ß√µes √∫nicas (como domin√≥ tradicional)
                        for (let i = 0; i < 7; i++) {
                            for (let j = i; j < 7; j++) {
                                dominoPieces.push({
                                    left: astralSymbols[i],
                                    right: astralSymbols[j],
                                    leftValue: i,
                                    rightValue: j,
                                    id: \`\${i}-\${j}\`,
                                    isDouble: i === j
                                });
                            }
                        }
                        
                        // Embaralhar
                        for (let i = dominoPieces.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [dominoPieces[i], dominoPieces[j]] = [dominoPieces[j], dominoPieces[i]];
                        }
                    }
                    
                    // Inicializar novo jogo
                    function newDominoGame() {
                        createAstralDominoPieces();
                        
                        // Distribuir pe√ßas
                        playerHand = dominoPieces.splice(0, 7);
                        aiHand = dominoPieces.splice(0, 7);
                        boneyard = dominoPieces;
                        dominoChain = [];
                        
                        // Determinar quem come√ßa (quem tem a dupla mais alta)
                        const playerDoubles = playerHand.filter(p => p.isDouble);
                        const aiDoubles = aiHand.filter(p => p.isDouble);
                        
                        if (playerDoubles.length > 0 || aiDoubles.length > 0) {
                            const playerHighest = playerDoubles.length > 0 ? Math.max(...playerDoubles.map(p => p.leftValue)) : -1;
                            const aiHighest = aiDoubles.length > 0 ? Math.max(...aiDoubles.map(p => p.leftValue)) : -1;
                            
                            currentPlayer = playerHighest >= aiHighest ? 'player' : 'ai';
                        } else {
                            currentPlayer = 'player'; // Jogador come√ßa se ningu√©m tem dupla
                        }
                        
                        gameStarted = true;
                        renderDominoGame();
                        updateDominoStats();
                        updateGameStatus();
                        
                        showGatomante('Novo jogo de Domin√≥ Astral iniciado! ‚ú®', 'excited');
                        
                        if (currentPlayer === 'ai') {
                            setTimeout(aiTurn, 1000);
                        }
                    }
                    
                    // Renderizar jogo
                    function renderDominoGame() {
                        renderPlayerHand();
                        renderDominoChain();
                    }
                    
                    // Renderizar m√£o do jogador
                    function renderPlayerHand() {
                        const handEl = document.getElementById('playerHand');
                        if (!handEl) return;
                        
                        handEl.innerHTML = '';
                        playerHand.forEach((piece, index) => {
                            const pieceEl = document.createElement('div');
                            pieceEl.className = 'domino-piece';
                            pieceEl.style.cssText = \`
                                width: 60px;
                                height: 120px;
                                background: linear-gradient(135deg, #f8f8f8, #e8e8e8);
                                border: 2px solid var(--dourado);
                                border-radius: 8px;
                                display: flex;
                                flex-direction: column;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                position: relative;
                            \`;
                            
                            pieceEl.innerHTML = \`
                                <div style="
                                    flex: 1;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 20px;
                                    border-bottom: 1px solid #ccc;
                                ">\${piece.left}</div>
                                <div style="
                                    flex: 1;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 20px;
                                ">\${piece.right}</div>
                            \`;
                            
                            pieceEl.onclick = () => selectPlayerPiece(piece, index);
                            pieceEl.onmouseover = () => {
                                pieceEl.style.transform = 'scale(1.1)';
                                pieceEl.style.boxShadow = '0 0 15px rgba(218,165,32,0.5)';
                            };
                            pieceEl.onmouseout = () => {
                                pieceEl.style.transform = 'scale(1)';
                                pieceEl.style.boxShadow = 'none';
                            };
                            
                            handEl.appendChild(pieceEl);
                        });
                    }
                    
                    // Renderizar cadeia de domin√≥
                    function renderDominoChain() {
                        const chainEl = document.getElementById('dominoChain');
                        if (!chainEl) return;
                        
                        if (dominoChain.length === 0) {
                            chainEl.innerHTML = '<div class="start-message" style="text-align: center; color: rgba(255,255,255,0.5); font-style: italic;">Clique em uma pe√ßa para come√ßar...</div>';
                            return;
                        }
                        
                        chainEl.innerHTML = '';
                        dominoChain.forEach((piece, index) => {
                            const pieceEl = document.createElement('div');
                            pieceEl.className = 'chain-piece';
                            
                            if (piece.isDouble) {
                                // Pe√ßa dupla (vertical)
                                pieceEl.style.cssText = \`
                                    width: 60px;
                                    height: 120px;
                                    background: linear-gradient(135deg, #e8e8e8, #d8d8d8);
                                    border: 2px solid var(--dourado);
                                    border-radius: 8px;
                                    display: flex;
                                    flex-direction: column;
                                    margin: 2px;
                                \`;
                                
                                pieceEl.innerHTML = \`
                                    <div style="flex: 1; display: flex; align-items: center; justify-content: center; font-size: 18px; border-bottom: 1px solid #ccc;">\${piece.left}</div>
                                    <div style="flex: 1; display: flex; align-items: center; justify-content: center; font-size: 18px;">\${piece.right}</div>
                                \`;
                            } else {
                                // Pe√ßa normal (horizontal)
                                pieceEl.style.cssText = \`
                                    width: 120px;
                                    height: 60px;
                                    background: linear-gradient(135deg, #e8e8e8, #d8d8d8);
                                    border: 2px solid var(--dourado);
                                    border-radius: 8px;
                                    display: flex;
                                    margin: 2px;
                                \`;
                                
                                pieceEl.innerHTML = \`
                                    <div style="flex: 1; display: flex; align-items: center; justify-content: center; font-size: 18px; border-right: 1px solid #ccc;">\${piece.left}</div>
                                    <div style="flex: 1; display: flex; align-items: center; justify-content: center; font-size: 18px;">\${piece.right}</div>
                                \`;
                            }
                            
                            chainEl.appendChild(pieceEl);
                        });
                    }
                    
                    // Selecionar pe√ßa do jogador
                    function selectPlayerPiece(piece, index) {
                        if (currentPlayer !== 'player' || !gameStarted) return;
                        
                        if (dominoChain.length === 0) {
                            // Primeira pe√ßa
                            dominoChain.push(piece);
                            playerHand.splice(index, 1);
                            currentPlayer = 'ai';
                        } else {
                            // Verificar se pode jogar
                            const leftEnd = dominoChain[0].left;
                            const rightEnd = dominoChain[dominoChain.length - 1].right;
                            
                            let canPlay = false;
                            let playedPiece = { ...piece };
                            
                            if (piece.left === rightEnd || piece.right === rightEnd) {
                                // Pode jogar na direita
                                if (piece.left === rightEnd) {
                                    // Pe√ßa j√° est√° na orienta√ß√£o correta
                                } else {
                                    // Inverter pe√ßa
                                    playedPiece = {
                                        ...piece,
                                        left: piece.right,
                                        right: piece.left
                                    };
                                }
                                dominoChain.push(playedPiece);
                                canPlay = true;
                            } else if (piece.left === leftEnd || piece.right === leftEnd) {
                                // Pode jogar na esquerda
                                if (piece.right === leftEnd) {
                                    // Pe√ßa j√° est√° na orienta√ß√£o correta
                                } else {
                                    // Inverter pe√ßa
                                    playedPiece = {
                                        ...piece,
                                        left: piece.right,
                                        right: piece.left
                                    };
                                }
                                dominoChain.unshift(playedPiece);
                                canPlay = true;
                            }
                            
                            if (canPlay) {
                                playerHand.splice(index, 1);
                                currentPlayer = 'ai';
                            } else {
                                showGatomante('Esta pe√ßa n√£o pode ser jogada aqui!', 'thinking');
                                return;
                            }
                        }
                        
                        renderDominoGame();
                        updateDominoStats();
                        updateGameStatus();
                        checkWinCondition();
                        
                        if (currentPlayer === 'ai' && gameStarted) {
                            setTimeout(aiTurn, 1000);
                        }
                    }
                    
                    // Turno da IA
                    function aiTurn() {
                        if (currentPlayer !== 'ai' || !gameStarted) return;
                        
                        if (dominoChain.length === 0) {
                            // IA joga primeira pe√ßa (dupla mais alta se tiver)
                            const doubles = aiHand.filter(p => p.isDouble);
                            let pieceToPlay;
                            
                            if (doubles.length > 0) {
                                pieceToPlay = doubles.reduce((max, p) => p.leftValue > max.leftValue ? p : max);
                            } else {
                                pieceToPlay = aiHand[0];
                            }
                            
                            const index = aiHand.indexOf(pieceToPlay);
                            dominoChain.push(pieceToPlay);
                            aiHand.splice(index, 1);
                            currentPlayer = 'player';
                        } else {
                            // IA tenta jogar uma pe√ßa
                            const leftEnd = dominoChain[0].left;
                            const rightEnd = dominoChain[dominoChain.length - 1].right;
                            
                            let playablePiece = null;
                            let playableIndex = -1;
                            let playOnRight = true;
                            
                            // Procurar pe√ßa jog√°vel
                            for (let i = 0; i < aiHand.length; i++) {
                                const piece = aiHand[i];
                                if (piece.left === rightEnd || piece.right === rightEnd) {
                                    playablePiece = piece;
                                    playableIndex = i;
                                    playOnRight = true;
                                    break;
                                } else if (piece.left === leftEnd || piece.right === leftEnd) {
                                    playablePiece = piece;
                                    playableIndex = i;
                                    playOnRight = false;
                                    break;
                                }
                            }
                            
                            if (playablePiece) {
                                let playedPiece = { ...playablePiece };
                                
                                if (playOnRight) {
                                    if (playablePiece.left !== rightEnd) {
                                        playedPiece = {
                                            ...playablePiece,
                                            left: playablePiece.right,
                                            right: playablePiece.left
                                        };
                                    }
                                    dominoChain.push(playedPiece);
                                } else {
                                    if (playablePiece.right !== leftEnd) {
                                        playedPiece = {
                                            ...playablePiece,
                                            left: playablePiece.right,
                                            right: playablePiece.left
                                        };
                                    }
                                    dominoChain.unshift(playedPiece);
                                }
                                
                                aiHand.splice(playableIndex, 1);
                                currentPlayer = 'player';
                                
                                showGatomante('IA jogou uma pe√ßa astral!', 'normal');
                            } else {
                                // IA n√£o pode jogar, compra do cemit√©rio
                                if (boneyard.length > 0) {
                                    const drawnPiece = boneyard.pop();
                                    aiHand.push(drawnPiece);
                                    showGatomante('IA comprou uma pe√ßa do cemit√©rio.', 'thinking');
                                    
                                    // Tentar jogar a pe√ßa comprada
                                    setTimeout(aiTurn, 500);
                                    return;
                                } else {
                                    // Cemit√©rio vazio, IA passa a vez
                                    currentPlayer = 'player';
                                    showGatomante('IA passou a vez.', 'thinking');
                                }
                            }
                        }
                        
                        renderDominoGame();
                        updateDominoStats();
                        updateGameStatus();
                        checkWinCondition();
                    }
                    
                    // Comprar do cemit√©rio
                    function drawFromBoneyard() {
                        if (currentPlayer !== 'player' || boneyard.length === 0) return;
                        
                        const drawnPiece = boneyard.pop();
                        playerHand.push(drawnPiece);
                        
                        renderDominoGame();
                        updateDominoStats();
                        
                        showGatomante('Voc√™ comprou uma pe√ßa do cemit√©rio.', 'normal');
                    }
                    
                    // Passar vez
                    function passTurn() {
                        if (currentPlayer !== 'player') return;
                        
                        currentPlayer = 'ai';
                        updateGameStatus();
                        showGatomante('Voc√™ passou a vez.', 'thinking');
                        
                        setTimeout(aiTurn, 1000);
                    }
                    
                    // Verificar condi√ß√£o de vit√≥ria
                    function checkWinCondition() {
                        if (playerHand.length === 0) {
                            endGame('Parab√©ns! Voc√™ venceu o Domin√≥ Astral! üåü');
                        } else if (aiHand.length === 0) {
                            endGame('A IA venceu desta vez. Tente novamente! ü§ñ');
                        } else if (boneyard.length === 0 && !canAnyonePlay()) {
                            // Jogo travado, contar pontos
                            const playerPoints = playerHand.reduce((sum, p) => sum + p.leftValue + p.rightValue, 0);
                            const aiPoints = aiHand.reduce((sum, p) => sum + p.leftValue + p.rightValue, 0);
                            
                            if (playerPoints < aiPoints) {
                                endGame('Voc√™ venceu por menor pontua√ß√£o! ‚ú®');
                            } else if (aiPoints < playerPoints) {
                                endGame('IA venceu por menor pontua√ß√£o. ü§ñ');
                            } else {
                                endGame('Empate! Jogo travado com pontua√ß√£o igual. ‚öñÔ∏è');
                            }
                        }
                    }
                    
                    // Verificar se algu√©m pode jogar
                    function canAnyonePlay() {
                        if (dominoChain.length === 0) return true;
                        
                        const leftEnd = dominoChain[0].left;
                        const rightEnd = dominoChain[dominoChain.length - 1].right;
                        
                        // Verificar jogador
                        for (const piece of playerHand) {
                            if (piece.left === leftEnd || piece.right === leftEnd || 
                                piece.left === rightEnd || piece.right === rightEnd) {
                                return true;
                            }
                        }
                        
                        // Verificar IA
                        for (const piece of aiHand) {
                            if (piece.left === leftEnd || piece.right === leftEnd || 
                                piece.left === rightEnd || piece.right === rightEnd) {
                                return true;
                            }
                        }
                        
                        return false;
                    }
                    
                    // Finalizar jogo
                    function endGame(message) {
                        gameStarted = false;
                        const modal = document.getElementById('dominoModal');
                        const content = document.getElementById('modalContent');
                        
                        content.innerHTML = \`
                            <div style="text-align: center;">
                                <div style="font-size: 48px; margin-bottom: 15px;">üéØ</div>
                                <h2 style="margin: 0 0 15px 0; color: var(--dourado);">Fim de Jogo</h2>
                                <p style="margin: 0 0 15px 0; font-size: 16px;">\${message}</p>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; margin: 15px 0;">
                                    <h3 style="margin: 0 0 10px 0; color: var(--dourado);">Estat√≠sticas:</h3>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>Suas pe√ßas restantes:</span>
                                        <span>\${playerHand.length}</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                        <span>Pe√ßas da IA:</span>
                                        <span>\${aiHand.length}</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Pe√ßas jogadas:</span>
                                        <span>\${dominoChain.length}</span>
                                    </div>
                                </div>
                            </div>
                        \`;
                        
                        modal.style.display = 'block';
                    }
                    
                    // Fechar modal
                    function closeDominoModal() {
                        document.getElementById('dominoModal').style.display = 'none';
                    }
                    
                    // Atualizar estat√≠sticas
                    function updateDominoStats() {
                        const playerPiecesEl = document.getElementById('playerPieces');
                        const aiPiecesEl = document.getElementById('aiPieces');
                        const boneyardEl = document.getElementById('boneyard');
                        
                        if (playerPiecesEl) playerPiecesEl.textContent = playerHand.length;
                        if (aiPiecesEl) aiPiecesEl.textContent = aiHand.length;
                        if (boneyardEl) boneyardEl.textContent = boneyard.length;
                    }
                    
                    // Atualizar status do jogo
                    function updateGameStatus() {
                        const statusEl = document.getElementById('gameStatus');
                        if (!statusEl) return;
                        
                        if (!gameStarted) {
                            statusEl.textContent = 'Jogo parado';
                            statusEl.style.color = '#ccc';
                        } else if (currentPlayer === 'player') {
                            statusEl.textContent = 'Sua vez';
                            statusEl.style.color = var(--dourado);
                        } else {
                            statusEl.textContent = 'Vez da IA';
                            statusEl.style.color = '#ff6b6b';
                        }
                    }
                    
                    // Inicializar quando a aplica√ß√£o for carregada
                    setTimeout(() => {
                        updateDominoStats();
                        updateGameStatus();
                    }, 100);
                </script>
            `;
        }
        
        // Gerar aplica√ß√£o de Or√°culo dos Sonhos
        function generateDreamOracleApp() {
            return `
                <div style="padding: 20px; text-align: center; background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); color: white; height: 100%; overflow-y: auto;">
                    <h2>üåô Or√°culo dos Sonhos</h2>
                    <p>Interprete seus sonhos e desvende mensagens do subconsciente.</p>
                    
                    <div style="margin: 30px 0;">
                        <div style="display: inline-block; background: var(--dourado); color: var(--azul-escuro); padding: 40px 20px; border-radius: 10px; margin: 10px;">
                            <div style="font-size: 48px;">üí≠</div>
                            <p>S√≠mbolos On√≠ricos</p>
                        </div>
                    </div>
                    
                    <button style="background: var(--dourado); color: var(--azul-escuro); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px;">
                        üîÆ Interpretar Sonho
                    </button>
                    <button style="background: var(--vinho); color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px;">
                        üìñ Dicion√°rio dos Sonhos
                    </button>
                </div>
            `;
        }
        
        // Gerar aplica√ß√£o de Medita√ß√£o Guiada
        function generateMeditationApp() {
            return `
                <div style="padding: 20px; text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; height: 100%; overflow-y: auto;">
                    <h2>üßò‚Äç‚ôÄÔ∏è Medita√ß√£o Guiada</h2>
                    <p>Encontre paz interior com medita√ß√µes m√≠sticas guiadas.</p>
                    
                    <div style="margin: 30px 0;">
                        <div style="display: inline-block; background: var(--dourado); color: var(--azul-escuro); padding: 40px 20px; border-radius: 10px; margin: 10px;">
                            <div style="font-size: 48px;">üïØÔ∏è</div>
                            <p>Energia Zen</p>
                        </div>
                    </div>
                    
                    <button style="background: var(--dourado); color: var(--azul-escuro); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px;">
                        üå∏ Medita√ß√£o B√°sica
                    </button>
                    <button style="background: var(--vinho); color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px;">
                        ‚ú® Medita√ß√£o Avan√ßada
                    </button>
                </div>
            `;
        }
    </script>
</body>
</html>


                    voiceAlert: "AF√ÅSTE! Sistema de prote√ß√£o astrol√≥gica ativado."
                };
                showAfastMsnNotification(welcomeNotification);
            }, 3000);
        }
        
        // Carregar configura√ß√µes do AF√ÅST
        function loadAfastSettings() {
            const saved = localStorage.getItem('auroraOS_afastSettings');
            if (saved) {
                afastRealTimeData.userSettings = { ...afastRealTimeData.userSettings, ...JSON.parse(saved) };
            }
            
            // Carregar hist√≥rico de notifica√ß√µes
            const savedHistory = localStorage.getItem('auroraOS_afastHistory');
            if (savedHistory) {
                afastNotificationCenter.notifications = JSON.parse(savedHistory);
            }
        }
        
        // Salvar configura√ß√µes do AF√ÅST
        function saveAfastSettings() {
            localStorage.setItem('auroraOS_afastSettings', JSON.stringify(afastRealTimeData.userSettings));
            localStorage.setItem('auroraOS_afastHistory', JSON.stringify(afastNotificationCenter.notifications));
        }
        
        // Inicializar detec√ß√£o de eventos astrol√≥gicos reais
        function initRealTimeAstrologyDetection() {
            console.log('üîç Inicializando detec√ß√£o de eventos astrol√≥gicos reais...');
            
            // Simular conex√£o com APIs astron√¥micas
            // Em implementa√ß√£o real, conectaria com:
            // - NASA JPL Horizons API
            // - Swiss Ephemeris
            // - TimeAndDate.com API
            // - AstrologyAPI.com
            
            // Por enquanto, usar dados simulados baseados em datas reais
            loadCurrentAstronomicalData();
        }
        
        // Carregar dados astron√¥micos atuais
        function loadCurrentAstronomicalData() {
            const now = new Date();
            const currentEvents = [];
            
            // Verificar Merc√∫rio Retr√≥grado (datas aproximadas 2024-2025)
            const mercuryRetrogradePeriods = [
                { start: new Date('2024-12-13'), end: new Date('2025-01-01') },
                { start: new Date('2025-03-29'), end: new Date('2025-04-23') },
                { start: new Date('2025-07-26'), end: new Date('2025-08-19') },
                { start: new Date('2025-11-09'), end: new Date('2025-11-29') }
            ];
            
            mercuryRetrogradePeriods.forEach(period => {
                if (now >= period.start && now <= period.end) {
                    currentEvents.push({
                        type: 'mercury_retrograde',
                        title: 'Merc√∫rio Retr√≥grado',
                        description: 'Per√≠odo de reflex√£o e revis√£o. Cuidado com comunica√ß√µes e tecnologia.',
                        severity: 'warning',
                        startDate: period.start,
                        endDate: period.end,
                        advice: 'Evite assinar contratos importantes. Fa√ßa backup de dados.',
                        protection: 'Use cristais de fluorita roxa para clareza mental.'
                    });
                }
            });
            
            // Verificar fases da Lua
            const moonPhase = calculateMoonPhase(now);
            if (moonPhase.phase === 'full' || moonPhase.phase === 'new') {
                currentEvents.push({
                    type: moonPhase.phase + '_moon',
                    title: moonPhase.phase === 'full' ? 'Lua Cheia' : 'Lua Nova',
                    description: moonPhase.phase === 'full' ? 
                        'Energia m√°xima lunar. Ideal para manifesta√ß√µes e rituais.' :
                        'Novo ciclo lunar. Tempo de plantio de inten√ß√µes.',
                    severity: 'info',
                    date: now,
                    advice: moonPhase.phase === 'full' ? 
                        'Carregue cristais na luz lunar. Pratique gratid√£o.' :
                        'Defina novas metas. Plante sementes de inten√ß√£o.',
                    protection: '√Ågua lunar energizada oferece prote√ß√£o.'
                });
            }
            
            // Verificar Lua Fora de Curso (Void of Course)
            if (isVoidOfCourseMoon(now)) {
                currentEvents.push({
                    type: 'void_moon',
                    title: 'Lua Fora de Curso',
                    description: 'A Lua n√£o faz aspectos maiores antes de mudar de signo.',
                    severity: 'caution',
                    date: now,
                    advice: 'Evite decis√µes importantes. Foque em atividades rotineiras.',
                    protection: 'Medita√ß√£o e introspec√ß√£o s√£o favorecidas.'
                });
            }
            
            // Verificar aspectos planet√°rios tensos
            const tensAspects = checkTensePlanetaryAspects(now);
            tensAspects.forEach(aspect => {
                currentEvents.push(aspect);
            });
            
            // Atualizar dados
            afastRealTimeData.currentEvents = currentEvents;
            afastRealTimeData.lastUpdate = now;
            
            console.log(`üìä Detectados ${currentEvents.length} eventos astrol√≥gicos atuais`);
        }
        
        // Calcular fase da Lua (simplificado)
        function calculateMoonPhase(date) {
            const lunarCycle = 29.53058867; // dias
            const knownNewMoon = new Date('2024-01-11'); // Lua Nova conhecida
            
            const daysSinceKnownNewMoon = (date - knownNewMoon) / (1000 * 60 * 60 * 24);
            const currentCycle = daysSinceKnownNewMoon % lunarCycle;
            
            if (currentCycle < 1 || currentCycle > 28) {
                return { phase: 'new', illumination: 0 };
            } else if (currentCycle >= 13 && currentCycle <= 15) {
                return { phase: 'full', illumination: 100 };
            } else if (currentCycle < 13) {
                return { phase: 'waxing', illumination: (currentCycle / 14) * 100 };
            } else {
                return { phase: 'waning', illumination: ((29 - currentCycle) / 14) * 100 };
            }
        }
        
        // Verificar se a Lua est√° fora de curso (simulado)
        function isVoidOfCourseMoon(date) {
            // Simula√ß√£o: Lua fora de curso algumas horas por dia
            const hour = date.getHours();
            const day = date.getDate();
            
            // Padr√£o simulado baseado em c√°lculos astrol√≥gicos
            return (day % 3 === 0 && (hour >= 14 && hour <= 18));
        }
        
        // Verificar aspectos planet√°rios tensos
        function checkTensePlanetaryAspects(date) {
            const aspects = [];
            const day = date.getDate();
            const month = date.getMonth();
            
            // Simula√ß√£o de aspectos tensos baseada em padr√µes reais
            if (day % 7 === 0) {
                aspects.push({
                    type: 'mars_square',
                    title: 'Marte em Quadratura',
                    description: 'Aspecto tenso de Marte pode gerar conflitos e impaci√™ncia.',
                    severity: 'warning',
                    date: date,
                    advice: 'Evite confrontos. Canalize energia em exerc√≠cios f√≠sicos.',
                    protection: 'Hematita oferece prote√ß√£o contra energias agressivas.'
                });
            }
            
            if (month === 9 && day >= 20) { // Temporada de Escorpi√£o
                aspects.push({
                    type: 'scorpio_intensity',
                    title: 'Intensidade Escorpiana',
                    description: 'Energias profundas e transformadoras est√£o ativas.',
                    severity: 'info',
                    date: date,
                    advice: 'Tempo ideal para autoconhecimento e transforma√ß√£o.',
                    protection: 'Obsidiana negra para prote√ß√£o ps√≠quica.'
                });
            }
            
            return aspects;
        }
        
        // Verificar eventos astrol√≥gicos atuais
        function checkCurrentAstrologicalEvents() {
            if (!afastRealTimeData.userSettings.enabled) return;
            
            console.log('üîç Verificando eventos astrol√≥gicos...');
            
            // Recarregar dados astron√¥micos
            loadCurrentAstronomicalData();
            
            // Processar eventos atuais
            afastRealTimeData.currentEvents.forEach(event => {
                // Verificar se j√° foi notificado hoje
                const today = new Date().toDateString();
                const alreadyNotified = afastNotificationCenter.notifications.some(n => 
                    n.eventType === event.type && 
                    new Date(n.timestamp).toDateString() === today
                );
                
                if (!alreadyNotified && afastRealTimeData.userSettings.types[event.type]) {
                    triggerAfastRealEvent(event);
                }
            });
            
            // Salvar dados atualizados
            saveAfastSettings();
        }
        
        // Disparar evento AF√ÅST real
        function triggerAfastRealEvent(event) {
            const notification = {
                id: 'afast_real_' + Date.now(),
                type: 'astrological_event',
                eventType: event.type,
                title: `AF√ÅST! ${event.title}`,
                message: event.description,
                advice: event.advice,
                protection: event.protection,
                severity: event.severity,
                timestamp: new Date(),
                hasVoice: afastRealTimeData.userSettings.notifications.voice,
                voiceAlert: `AF√ÅSTE! ${event.title} detectado. ${event.advice}`,
                duration: event.severity === 'warning' ? 15000 : 10000
            };
            
            // Mostrar notifica√ß√£o MSN
            showAfastMsnNotification(notification);
            
            // Adicionar ao hist√≥rico
            addToNotificationHistory(notification);
            
            // Log para debug
            console.log(`üõ°Ô∏è AF√ÅST! Evento disparado: ${event.title}`);
        }
        
        // Criar central de notifica√ß√µes
        function createNotificationCenter() {
            // Verificar se j√° existe
            if (document.getElementById('afastNotificationCenter')) return;
            
            const centerHTML = `
                <div class="afast-notification-center" id="afastNotificationCenter">
                    <div class="notification-center-header">
                        <div class="center-title">
                            <span class="center-icon">üõ°Ô∏è</span>
                            Central AF√ÅST!
                        </div>
                        <div class="center-controls">
                            <button class="center-btn" onclick="clearNotificationHistory()" title="Limpar hist√≥rico">
                                üóëÔ∏è
                            </button>
                            <button class="center-btn" onclick="openAfastSettings()" title="Configura√ß√µes">
                                ‚öôÔ∏è
                            </button>
                            <button class="center-btn" onclick="closeNotificationCenter()" title="Fechar">
                                ‚úñÔ∏è
                            </button>
                        </div>
                    </div>
                    
                    <div class="notification-center-stats">
                        <div class="stat-item">
                            <span class="stat-label">Eventos Ativos:</span>
                            <span class="stat-value" id="activeEventsCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">√öltima Verifica√ß√£o:</span>
                            <span class="stat-value" id="lastUpdateTime">--:--</span>
                        </div>
                    </div>
                    
                    <div class="notification-center-content" id="notificationCenterContent">
                        <div class="no-notifications">
                            <span class="no-notif-icon">üåü</span>
                            <p>Nenhuma notifica√ß√£o no momento</p>
                            <small>O cosmos est√° em harmonia</small>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', centerHTML);
            
            // Atualizar estat√≠sticas
            updateNotificationCenterStats();
        }
        
        // Mostrar/ocultar central de notifica√ß√µes
        function toggleNotificationCenter() {
            const center = document.getElementById('afastNotificationCenter');
            if (!center) {
                createNotificationCenter();
                return;
            }
            
            if (afastNotificationCenter.isOpen) {
                closeNotificationCenter();
            } else {
                openNotificationCenter();
            }
        }
        
        // Abrir central de notifica√ß√µes
        function openNotificationCenter() {
            const center = document.getElementById('afastNotificationCenter');
            if (center) {
                center.classList.add('active');
                afastNotificationCenter.isOpen = true;
                updateNotificationCenterContent();
                updateNotificationCenterStats();
            }
        }
        
        // Fechar central de notifica√ß√µes
        function closeNotificationCenter() {
            const center = document.getElementById('afastNotificationCenter');
            if (center) {
                center.classList.remove('active');
                afastNotificationCenter.isOpen = false;
            }
        }
        
        // Atualizar conte√∫do da central
        function updateNotificationCenterContent() {
            const content = document.getElementById('notificationCenterContent');
            if (!content) return;
            
            if (afastNotificationCenter.notifications.length === 0) {
                content.innerHTML = `
                    <div class="no-notifications">
                        <span class="no-notif-icon">üåü</span>
                        <p>Nenhuma notifica√ß√£o no momento</p>
                        <small>O cosmos est√° em harmonia</small>
                    </div>
                `;
                return;
            }
            
            // Ordenar por data (mais recente primeiro)
            const sortedNotifications = [...afastNotificationCenter.notifications]
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            const notificationsHTML = sortedNotifications.map(notification => `
                <div class="notification-history-item ${notification.severity}">
                    <div class="notification-header">
                        <span class="notification-title">${notification.title}</span>
                        <span class="notification-time">
                            ${new Date(notification.timestamp).toLocaleString('pt-BR')}
                        </span>
                    </div>
                    <div class="notification-message">${notification.message}</div>
                    ${notification.advice ? `<div class="notification-advice">üí° ${notification.advice}</div>` : ''}
                    ${notification.protection ? `<div class="notification-protection">üõ°Ô∏è ${notification.protection}</div>` : ''}
                </div>
            `).join('');
            
            content.innerHTML = notificationsHTML;
        }
        
        // Atualizar estat√≠sticas da central
        function updateNotificationCenterStats() {
            const activeCount = document.getElementById('activeEventsCount');
            const lastUpdate = document.getElementById('lastUpdateTime');
            
            if (activeCount) {
                activeCount.textContent = afastRealTimeData.currentEvents.length;
            }
            
            if (lastUpdate && afastRealTimeData.lastUpdate) {
                lastUpdate.textContent = afastRealTimeData.lastUpdate.toLocaleTimeString('pt-BR');
            }
        }
        
        // Adicionar ao hist√≥rico de notifica√ß√µes
        function addToNotificationHistory(notification) {
            afastNotificationCenter.notifications.unshift(notification);
            
            // Manter apenas as √∫ltimas notifica√ß√µes
            if (afastNotificationCenter.notifications.length > afastNotificationCenter.maxHistory) {
                afastNotificationCenter.notifications = afastNotificationCenter.notifications.slice(0, afastNotificationCenter.maxHistory);
            }
            
            // Salvar no localStorage
            saveAfastSettings();
            
            // Atualizar central se estiver aberta
            if (afastNotificationCenter.isOpen) {
                updateNotificationCenterContent();
                updateNotificationCenterStats();
            }
        }
        
        // Limpar hist√≥rico de notifica√ß√µes
        function clearNotificationHistory() {
            if (confirm('Deseja realmente limpar todo o hist√≥rico de notifica√ß√µes AF√ÅST?')) {
                afastNotificationCenter.notifications = [];
                saveAfastSettings();
                updateNotificationCenterContent();
                updateNotificationCenterStats();
                
                showGatomante('Hist√≥rico AF√ÅST limpo! O cosmos agradece pela organiza√ß√£o.', 'normal');
            }
        }
        
        // Abrir configura√ß√µes do AF√ÅST
        function openAfastSettings() {
            // Implementar painel de configura√ß√µes avan√ßadas
            showGatomante('Configura√ß√µes AF√ÅST em desenvolvimento! Por enquanto, use o menu de configura√ß√µes.', 'thinking');
        }

        
        // ========================================
        // üéµ AURORA PLAYER - REPRODUTOR COMPLETO
        // ========================================
        
        function openAuroraPlayer() {
            const playerWindow = createWindow('Aurora Player', 'üéµ', 800, 600);
            
            playerWindow.innerHTML = `
                <div class="aurora-player">
                    <!-- Cabe√ßalho do Player -->
                    <div class="player-header">
                        <div class="player-title">üéµ Aurora Player</div>
                        <div class="player-subtitle">Reprodutor M√≠stico de √Åudio</div>
                    </div>
                    
                    <!-- Visualizador de Espectro -->
                    <div class="spectrum-visualizer" id="spectrumViz">
                        <canvas id="spectrumCanvas" width="760" height="120"></canvas>
                    </div>
                    
                    <!-- Informa√ß√µes da M√∫sica -->
                    <div class="track-info">
                        <div class="track-title" id="trackTitle">Nenhuma m√∫sica selecionada</div>
                        <div class="track-artist" id="trackArtist">Selecione um arquivo de √°udio</div>
                        <div class="track-album" id="trackAlbum"></div>
                    </div>
                    
                    <!-- Controles de Reprodu√ß√£o -->
                    <div class="player-controls">
                        <button class="control-btn" onclick="previousTrack()" title="Anterior">‚èÆÔ∏è</button>
                        <button class="control-btn play-pause" onclick="togglePlayPause()" title="Play/Pause" id="playPauseBtn">‚ñ∂Ô∏è</button>
                        <button class="control-btn" onclick="nextTrack()" title="Pr√≥ximo">‚è≠Ô∏è</button>
                        <button class="control-btn" onclick="toggleShuffle()" title="Aleat√≥rio" id="shuffleBtn">üîÄ</button>
                        <button class="control-btn" onclick="toggleRepeat()" title="Repetir" id="repeatBtn">üîÅ</button>
                    </div>
                    
                    <!-- Barra de Progresso -->
                    <div class="progress-container">
                        <span class="time-display" id="currentTime">0:00</span>
                        <div class="progress-bar" onclick="seekTo(event)">
                            <div class="progress-fill" id="progressFill"></div>
                            <div class="progress-thumb" id="progressThumb"></div>
                        </div>
                        <span class="time-display" id="totalTime">0:00</span>
                    </div>
                    
                    <!-- Controles de Volume -->
                    <div class="volume-controls">
                        <button class="control-btn" onclick="toggleMute()" id="muteBtn">üîä</button>
                        <div class="volume-slider" onclick="setPlayerVolume(event)">
                            <div class="volume-fill" id="volumeFill"></div>
                            <div class="volume-thumb" id="volumeThumb"></div>
                        </div>
                    </div>
                    
                    <!-- Upload de Arquivos -->
                    <div class="file-upload-area">
                        <input type="file" id="audioFileInput" accept="audio/*" multiple style="display: none;">
                        <button class="upload-btn" onclick="document.getElementById('audioFileInput').click()">
                            üìÅ Adicionar M√∫sicas
                        </button>
                        <button class="upload-btn" onclick="loadSampleTracks()">
                            üéº Carregar Samples
                        </button>
                    </div>
                    
                    <!-- Playlist -->
                    <div class="playlist-container">
                        <div class="playlist-header">
                            <span>üìã Playlist</span>
                            <button class="playlist-btn" onclick="clearPlaylist()">üóëÔ∏è Limpar</button>
                        </div>
                        <div class="playlist" id="playlist">
                            <div class="playlist-empty">
                                <span class="empty-icon">üéµ</span>
                                <p>Playlist vazia</p>
                                <small>Adicione m√∫sicas para come√ßar</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Equalizador -->
                    <div class="equalizer-container">
                        <div class="eq-header">üéõÔ∏è Equalizador M√≠stico</div>
                        <div class="eq-controls">
                            <div class="eq-band">
                                <label>60Hz</label>
                                <input type="range" min="-12" max="12" value="0" class="eq-slider" data-freq="60">
                            </div>
                            <div class="eq-band">
                                <label>170Hz</label>
                                <input type="range" min="-12" max="12" value="0" class="eq-slider" data-freq="170">
                            </div>
                            <div class="eq-band">
                                <label>310Hz</label>
                                <input type="range" min="-12" max="12" value="0" class="eq-slider" data-freq="310">
                            </div>
                            <div class="eq-band">
                                <label>600Hz</label>
                                <input type="range" min="-12" max="12" value="0" class="eq-slider" data-freq="600">
                            </div>
                            <div class="eq-band">
                                <label>1kHz</label>
                                <input type="range" min="-12" max="12" value="0" class="eq-slider" data-freq="1000">
                            </div>
                            <div class="eq-band">
                                <label>3kHz</label>
                                <input type="range" min="-12" max="12" value="0" class="eq-slider" data-freq="3000">
                            </div>
                            <div class="eq-band">
                                <label>6kHz</label>
                                <input type="range" min="-12" max="12" value="0" class="eq-slider" data-freq="6000">
                            </div>
                            <div class="eq-band">
                                <label>12kHz</label>
                                <input type="range" min="-12" max="12" value="0" class="eq-slider" data-freq="12000">
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Inicializar player
            initAuroraPlayer();
            
            // Adicionar aos recentes
            addToRecents('Aurora Player', 'üéµ');
            
            // Notificar Gatomante
            showGatomante('Aurora Player aberto! Que as melodias m√≠sticas fluam atrav√©s de sua alma.', 'excited');
        }
        
        // Vari√°veis do Aurora Player
        let audioPlayer = null;
        let currentPlaylist = [];
        let currentTrackIndex = 0;
        let isPlaying = false;
        let isShuffle = false;
        let repeatMode = 'none'; // none, one, all
        let playerVolume = 1.0;
        let isMuted = false;
        
        // Inicializar Aurora Player
        function initAuroraPlayer() {
            // Configurar upload de arquivos
            const fileInput = document.getElementById('audioFileInput');
            if (fileInput) {
                fileInput.addEventListener('change', handleAudioFiles);
            }
            
            // Inicializar visualizador de espectro
            initSpectrumVisualizer();
            
            // Carregar playlist salva
            loadSavedPlaylist();
        }
        
        // Manipular arquivos de √°udio
        function handleAudioFiles(event) {
            const files = Array.from(event.target.files);
            
            files.forEach(file => {
                if (file.type.startsWith('audio/')) {
                    const track = {
                        id: Date.now() + Math.random(),
                        name: file.name.replace(/\.[^/.]+$/, ""),
                        file: file,
                        url: URL.createObjectURL(file),
                        duration: 0,
                        artist: 'Artista Desconhecido',
                        album: '√Ålbum Desconhecido'
                    };
                    
                    currentPlaylist.push(track);
                }
            });
            
            updatePlaylistDisplay();
            savePlaylist();
            
            // Se n√£o h√° m√∫sica tocando, tocar a primeira
            if (!audioPlayer && currentPlaylist.length > 0) {
                loadTrack(0);
            }
        }
        
        // Carregar samples de demonstra√ß√£o
        function loadSampleTracks() {
            const sampleTracks = [
                {
                    id: 'sample1',
                    name: 'Medita√ß√£o Lunar',
                    artist: 'Aurora Mystica',
                    album: 'Sounds of the Cosmos',
                    url: 'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT'
                },
                {
                    id: 'sample2',
                    name: 'Cristais Cantantes',
                    artist: 'Ethereal Harmonics',
                    album: 'Crystal Frequencies',
                    url: 'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT'
                }
            ];
            
            sampleTracks.forEach(track => {
                currentPlaylist.push(track);
            });
            
            updatePlaylistDisplay();
            savePlaylist();
            
            showGatomante('Samples m√≠sticos carregados! Experimente essas frequ√™ncias c√≥smicas.', 'excited');
        }
        
        // Atualizar display da playlist
        function updatePlaylistDisplay() {
            const playlistElement = document.getElementById('playlist');
            if (!playlistElement) return;
            
            if (currentPlaylist.length === 0) {
                playlistElement.innerHTML = `
                    <div class="playlist-empty">
                        <span class="empty-icon">üéµ</span>
                        <p>Playlist vazia</p>
                        <small>Adicione m√∫sicas para come√ßar</small>
                    </div>
                `;
                return;
            }
            
            const playlistHTML = currentPlaylist.map((track, index) => `
                <div class="playlist-item ${index === currentTrackIndex ? 'active' : ''}" 
                     onclick="loadTrack(${index})">
                    <div class="track-number">${index + 1}</div>
                    <div class="track-details">
                        <div class="track-name">${track.name}</div>
                        <div class="track-meta">${track.artist} ‚Ä¢ ${track.album}</div>
                    </div>
                    <div class="track-duration">${formatTime(track.duration)}</div>
                    <button class="remove-track" onclick="removeTrack(${index}); event.stopPropagation();">‚úñÔ∏è</button>
                </div>
            `).join('');
            
            playlistElement.innerHTML = playlistHTML;
        }
        
        // Carregar faixa
        function loadTrack(index) {
            if (index < 0 || index >= currentPlaylist.length) return;
            
            currentTrackIndex = index;
            const track = currentPlaylist[index];
            
            // Parar √°udio anterior
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer = null;
            }
            
            // Criar novo player
            audioPlayer = new Audio(track.url);
            audioPlayer.volume = playerVolume;
            
            // Event listeners
            audioPlayer.addEventListener('loadedmetadata', () => {
                track.duration = audioPlayer.duration;
                updateTrackInfo(track);
                updatePlaylistDisplay();
            });
            
            audioPlayer.addEventListener('timeupdate', updateProgress);
            audioPlayer.addEventListener('ended', nextTrack);
            
            updateTrackInfo(track);
            updatePlaylistDisplay();
        }
        
        // Atualizar informa√ß√µes da faixa
        function updateTrackInfo(track) {
            const titleElement = document.getElementById('trackTitle');
            const artistElement = document.getElementById('trackArtist');
            const albumElement = document.getElementById('trackAlbum');
            
            if (titleElement) titleElement.textContent = track.name;
            if (artistElement) artistElement.textContent = track.artist;
            if (albumElement) albumElement.textContent = track.album;
        }
        
        // Toggle play/pause
        function togglePlayPause() {
            if (!audioPlayer) {
                if (currentPlaylist.length > 0) {
                    loadTrack(0);
                } else {
                    showGatomante('Adicione m√∫sicas √† playlist primeiro!', 'thinking');
                    return;
                }
            }
            
            const playPauseBtn = document.getElementById('playPauseBtn');
            
            if (isPlaying) {
                audioPlayer.pause();
                isPlaying = false;
                if (playPauseBtn) playPauseBtn.textContent = '‚ñ∂Ô∏è';
            } else {
                audioPlayer.play();
                isPlaying = true;
                if (playPauseBtn) playPauseBtn.textContent = '‚è∏Ô∏è';
            }
        }
        
        // Pr√≥xima faixa
        function nextTrack() {
            if (currentPlaylist.length === 0) return;
            
            let nextIndex;
            
            if (repeatMode === 'one') {
                nextIndex = currentTrackIndex;
            } else if (isShuffle) {
                nextIndex = Math.floor(Math.random() * currentPlaylist.length);
            } else {
                nextIndex = currentTrackIndex + 1;
                if (nextIndex >= currentPlaylist.length) {
                    if (repeatMode === 'all') {
                        nextIndex = 0;
                    } else {
                        return; // Fim da playlist
                    }
                }
            }
            
            loadTrack(nextIndex);
            if (isPlaying) {
                audioPlayer.play();
            }
        }
        
        // Faixa anterior
        function previousTrack() {
            if (currentPlaylist.length === 0) return;
            
            let prevIndex = currentTrackIndex - 1;
            if (prevIndex < 0) {
                prevIndex = currentPlaylist.length - 1;
            }
            
            loadTrack(prevIndex);
            if (isPlaying) {
                audioPlayer.play();
            }
        }
        
        // Toggle shuffle
        function toggleShuffle() {
            isShuffle = !isShuffle;
            const shuffleBtn = document.getElementById('shuffleBtn');
            if (shuffleBtn) {
                shuffleBtn.style.color = isShuffle ? '#f0aa53' : '';
            }
        }
        
        // Toggle repeat
        function toggleRepeat() {
            const modes = ['none', 'all', 'one'];
            const currentIndex = modes.indexOf(repeatMode);
            repeatMode = modes[(currentIndex + 1) % modes.length];
            
            const repeatBtn = document.getElementById('repeatBtn');
            if (repeatBtn) {
                switch (repeatMode) {
                    case 'none':
                        repeatBtn.textContent = 'üîÅ';
                        repeatBtn.style.color = '';
                        break;
                    case 'all':
                        repeatBtn.textContent = 'üîÅ';
                        repeatBtn.style.color = '#f0aa53';
                        break;
                    case 'one':
                        repeatBtn.textContent = 'üîÇ';
                        repeatBtn.style.color = '#f0aa53';
                        break;
                }
            }
        }
        
        // Atualizar progresso
        function updateProgress() {
            if (!audioPlayer) return;
            
            const currentTime = audioPlayer.currentTime;
            const duration = audioPlayer.duration;
            const progress = (currentTime / duration) * 100;
            
            const progressFill = document.getElementById('progressFill');
            const progressThumb = document.getElementById('progressThumb');
            const currentTimeElement = document.getElementById('currentTime');
            const totalTimeElement = document.getElementById('totalTime');
            
            if (progressFill) progressFill.style.width = progress + '%';
            if (progressThumb) progressThumb.style.left = progress + '%';
            if (currentTimeElement) currentTimeElement.textContent = formatTime(currentTime);
            if (totalTimeElement) totalTimeElement.textContent = formatTime(duration);
        }
        
        // Buscar posi√ß√£o
        function seekTo(event) {
            if (!audioPlayer) return;
            
            const progressBar = event.currentTarget;
            const rect = progressBar.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const percentage = clickX / rect.width;
            const newTime = percentage * audioPlayer.duration;
            
            audioPlayer.currentTime = newTime;
        }
        
        // Definir volume do player
        function setPlayerVolume(event) {
            const volumeSlider = event.currentTarget;
            const rect = volumeSlider.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const percentage = clickX / rect.width;
            
            playerVolume = Math.max(0, Math.min(1, percentage));
            
            if (audioPlayer) {
                audioPlayer.volume = playerVolume;
            }
            
            const volumeFill = document.getElementById('volumeFill');
            const volumeThumb = document.getElementById('volumeThumb');
            
            if (volumeFill) volumeFill.style.width = (playerVolume * 100) + '%';
            if (volumeThumb) volumeThumb.style.left = (playerVolume * 100) + '%';
            
            updateVolumeIcon();
        }
        
        // Toggle mute
        function toggleMute() {
            isMuted = !isMuted;
            
            if (audioPlayer) {
                audioPlayer.volume = isMuted ? 0 : playerVolume;
            }
            
            updateVolumeIcon();
        }
        
        // Atualizar √≠cone de volume
        function updateVolumeIcon() {
            const muteBtn = document.getElementById('muteBtn');
            if (!muteBtn) return;
            
            if (isMuted || playerVolume === 0) {
                muteBtn.textContent = 'üîá';
            } else if (playerVolume < 0.5) {
                muteBtn.textContent = 'üîâ';
            } else {
                muteBtn.textContent = 'üîä';
            }
        }
        
        // Remover faixa
        function removeTrack(index) {
            currentPlaylist.splice(index, 1);
            
            if (index === currentTrackIndex) {
                if (audioPlayer) {
                    audioPlayer.pause();
                    audioPlayer = null;
                }
                isPlaying = false;
                
                if (currentPlaylist.length > 0) {
                    const newIndex = Math.min(index, currentPlaylist.length - 1);
                    loadTrack(newIndex);
                } else {
                    currentTrackIndex = 0;
                    updateTrackInfo({ name: 'Nenhuma m√∫sica selecionada', artist: 'Selecione um arquivo de √°udio', album: '' });
                }
            } else if (index < currentTrackIndex) {
                currentTrackIndex--;
            }
            
            updatePlaylistDisplay();
            savePlaylist();
        }
        
        // Limpar playlist
        function clearPlaylist() {
            if (confirm('Deseja realmente limpar toda a playlist?')) {
                currentPlaylist = [];
                currentTrackIndex = 0;
                
                if (audioPlayer) {
                    audioPlayer.pause();
                    audioPlayer = null;
                }
                
                isPlaying = false;
                updatePlaylistDisplay();
                updateTrackInfo({ name: 'Nenhuma m√∫sica selecionada', artist: 'Selecione um arquivo de √°udio', album: '' });
                savePlaylist();
            }
        }
        
        // Inicializar visualizador de espectro
        function initSpectrumVisualizer() {
            const canvas = document.getElementById('spectrumCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            // Anima√ß√£o simples de espectro (simulada)
            function drawSpectrum() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const barWidth = 8;
                const barCount = Math.floor(canvas.width / (barWidth + 2));
                
                for (let i = 0; i < barCount; i++) {
                    const height = Math.random() * canvas.height * (isPlaying ? 0.8 : 0.1);
                    const x = i * (barWidth + 2);
                    const y = canvas.height - height;
                    
                    // Gradiente m√≠stico
                    const gradient = ctx.createLinearGradient(0, y, 0, canvas.height);
                    gradient.addColorStop(0, '#f0aa53');
                    gradient.addColorStop(0.5, '#3e0a29');
                    gradient.addColorStop(1, '#0b1836');
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x, y, barWidth, height);
                }
                
                requestAnimationFrame(drawSpectrum);
            }
            
            drawSpectrum();
        }
        
        // Salvar playlist
        function savePlaylist() {
            const playlistData = currentPlaylist.map(track => ({
                id: track.id,
                name: track.name,
                artist: track.artist,
                album: track.album,
                duration: track.duration
                // N√£o salvar URL ou File object
            }));
            
            localStorage.setItem('auroraOS_playlist', JSON.stringify(playlistData));
        }
        
        // Carregar playlist salva
        function loadSavedPlaylist() {
            const saved = localStorage.getItem('auroraOS_playlist');
            if (saved) {
                try {
                    const playlistData = JSON.parse(saved);
                    // Playlist ser√° carregada apenas com metadados
                    // Usu√°rio precisar√° adicionar arquivos novamente
                    console.log('Playlist anterior encontrada:', playlistData.length, 'faixas');
                } catch (e) {
                    console.log('Erro ao carregar playlist:', e);
                }
            }
        }
        
        // Formatar tempo
        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
        }
        
        // ========================================
        // üî¢ CALCULADORA M√çSTICA
        // ========================================
        
        function openMysticalCalculator() {
            const calcWindow = createWindow('Calculadora M√≠stica', 'üî¢', 400, 600);
            
            calcWindow.innerHTML = `
                <div class="mystical-calculator">
                    <!-- Display -->
                    <div class="calc-display">
                        <div class="calc-expression" id="calcExpression"></div>
                        <div class="calc-result" id="calcResult">0</div>
                    </div>
                    
                    <!-- Modo da Calculadora -->
                    <div class="calc-mode-selector">
                        <button class="mode-btn active" onclick="setCalcMode('basic')" id="basicMode">B√°sica</button>
                        <button class="mode-btn" onclick="setCalcMode('scientific')" id="scientificMode">Cient√≠fica</button>
                        <button class="mode-btn" onclick="setCalcMode('mystical')" id="mysticalMode">M√≠stica</button>
                    </div>
                    
                    <!-- Calculadora B√°sica -->
                    <div class="calc-basic" id="calcBasic">
                        <div class="calc-buttons">
                            <button class="calc-btn clear" onclick="clearCalc()">C</button>
                            <button class="calc-btn clear" onclick="clearEntry()">CE</button>
                            <button class="calc-btn operator" onclick="addToCalc('‚å´')" title="Backspace">‚å´</button>
                            <button class="calc-btn operator" onclick="addToCalc('/')" title="Dividir">√∑</button>
                            
                            <button class="calc-btn number" onclick="addToCalc('7')">7</button>
                            <button class="calc-btn number" onclick="addToCalc('8')">8</button>
                            <button class="calc-btn number" onclick="addToCalc('9')">9</button>
                            <button class="calc-btn operator" onclick="addToCalc('*')" title="Multiplicar">√ó</button>
                            
                            <button class="calc-btn number" onclick="addToCalc('4')">4</button>
                            <button class="calc-btn number" onclick="addToCalc('5')">5</button>
                            <button class="calc-btn number" onclick="addToCalc('6')">6</button>
                            <button class="calc-btn operator" onclick="addToCalc('-')" title="Subtrair">‚àí</button>
                            
                            <button class="calc-btn number" onclick="addToCalc('1')">1</button>
                            <button class="calc-btn number" onclick="addToCalc('2')">2</button>
                            <button class="calc-btn number" onclick="addToCalc('3')">3</button>
                            <button class="calc-btn operator" onclick="addToCalc('+')" title="Somar">+</button>
                            
                            <button class="calc-btn number zero" onclick="addToCalc('0')">0</button>
                            <button class="calc-btn number" onclick="addToCalc('.')">.</button>
                            <button class="calc-btn equals" onclick="calculateResult()">=</button>
                        </div>
                    </div>
                    
                    <!-- Calculadora Cient√≠fica -->
                    <div class="calc-scientific" id="calcScientific" style="display: none;">
                        <div class="calc-buttons scientific">
                            <button class="calc-btn function" onclick="addFunction('sin')">sin</button>
                            <button class="calc-btn function" onclick="addFunction('cos')">cos</button>
                            <button class="calc-btn function" onclick="addFunction('tan')">tan</button>
                            <button class="calc-btn function" onclick="addFunction('log')">log</button>
                            
                            <button class="calc-btn function" onclick="addFunction('sqrt')">‚àö</button>
                            <button class="calc-btn function" onclick="addToCalc('^')">x¬≤</button>
                            <button class="calc-btn function" onclick="addToCalc('**')">x ∏</button>
                            <button class="calc-btn function" onclick="addConstant('œÄ')">œÄ</button>
                            
                            <button class="calc-btn function" onclick="addConstant('e')">e</button>
                            <button class="calc-btn function" onclick="addFunction('ln')">ln</button>
                            <button class="calc-btn operator" onclick="addToCalc('(')">(</button>
                            <button class="calc-btn operator" onclick="addToCalc(')')">)</button>
                        </div>
                    </div>
                    
                    <!-- Calculadora M√≠stica -->
                    <div class="calc-mystical" id="calcMystical" style="display: none;">
                        <div class="mystical-functions">
                            <div class="mystical-section">
                                <h4>üîÆ Numerologia</h4>
                                <button class="mystical-btn" onclick="calculateLifePath()">Caminho da Vida</button>
                                <button class="mystical-btn" onclick="calculateDestinyNumber()">N√∫mero do Destino</button>
                                <button class="mystical-btn" onclick="calculateSoulNumber()">N√∫mero da Alma</button>
                            </div>
                            
                            <div class="mystical-section">
                                <h4>üåô Astrologia</h4>
                                <button class="mystical-btn" onclick="calculateAgeInDays()">Idade em Dias</button>
                                <button class="mystical-btn" onclick="calculateBiorhythm()">Biorritmo</button>
                                <button class="mystical-btn" onclick="calculateLunarAge()">Idade Lunar</button>
                            </div>
                            
                            <div class="mystical-section">
                                <h4>‚ö° Energia</h4>
                                <button class="mystical-btn" onclick="calculateVibration()">Vibra√ß√£o Num√©rica</button>
                                <button class="mystical-btn" onclick="calculateCompatibility()">Compatibilidade</button>
                                <button class="mystical-btn" onclick="generateLuckyNumbers()">N√∫meros da Sorte</button>
                            </div>
                        </div>
                        
                        <div class="mystical-input">
                            <input type="text" id="mysticalInput" placeholder="Digite seu nome ou data (dd/mm/aaaa)">
                            <input type="text" id="mysticalInput2" placeholder="Nome/data para compara√ß√£o (opcional)" style="display: none;">
                        </div>
                    </div>
                    
                    <!-- Hist√≥rico -->
                    <div class="calc-history">
                        <div class="history-header">
                            <span>üìú Hist√≥rico</span>
                            <button class="history-clear" onclick="clearHistory()">üóëÔ∏è</button>
                        </div>
                        <div class="history-list" id="calcHistory">
                            <div class="history-empty">Nenhum c√°lculo realizado</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Inicializar calculadora
            initMysticalCalculator();
            
            // Adicionar aos recentes
            addToRecents('Calculadora M√≠stica', 'üî¢');
            
            // Notificar Gatomante
            showGatomante('Calculadora M√≠stica ativada! Desvende os mist√©rios dos n√∫meros.', 'excited');
        }
        
        // Vari√°veis da calculadora
        let calcExpression = '';
        let calcResult = '0';
        let calcMode = 'basic';
        let calcHistory = [];
        
        // Inicializar calculadora m√≠stica
        function initMysticalCalculator() {
            loadCalcHistory();
            updateCalcDisplay();
        }
        
        // Definir modo da calculadora
        function setCalcMode(mode) {
            calcMode = mode;
            
            // Atualizar bot√µes de modo
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(mode + 'Mode').classList.add('active');
            
            // Mostrar/ocultar se√ß√µes
            document.getElementById('calcBasic').style.display = mode === 'basic' ? 'block' : 'none';
            document.getElementById('calcScientific').style.display = mode === 'scientific' ? 'block' : 'none';
            document.getElementById('calcMystical').style.display = mode === 'mystical' ? 'block' : 'none';
            
            if (mode === 'mystical') {
                showGatomante('Modo m√≠stico ativado! Agora voc√™ pode explorar numerologia e astrologia.', 'thinking');
            }
        }
        
        // Adicionar √† calculadora
        function addToCalc(value) {
            if (value === '‚å´') {
                calcExpression = calcExpression.slice(0, -1);
            } else {
                calcExpression += value;
            }
            
            updateCalcDisplay();
        }
        
        // Limpar calculadora
        function clearCalc() {
            calcExpression = '';
            calcResult = '0';
            updateCalcDisplay();
        }
        
        // Limpar entrada
        function clearEntry() {
            calcExpression = '';
            updateCalcDisplay();
        }
        
        // Calcular resultado
        function calculateResult() {
            if (!calcExpression) return;
            
            try {
                // Substituir s√≠mbolos para JavaScript
                let expression = calcExpression
                    .replace(/√ó/g, '*')
                    .replace(/√∑/g, '/')
                    .replace(/‚àí/g, '-')
                    .replace(/œÄ/g, Math.PI)
                    .replace(/e/g, Math.E);
                
                // Avaliar express√£o
                const result = eval(expression);
                
                if (isNaN(result) || !isFinite(result)) {
                    calcResult = 'Erro';
                } else {
                    calcResult = result.toString();
                    
                    // Adicionar ao hist√≥rico
                    addToCalcHistory(calcExpression, calcResult);
                }
                
            } catch (error) {
                calcResult = 'Erro';
            }
            
            updateCalcDisplay();
        }
        
        // Atualizar display
        function updateCalcDisplay() {
            const expressionElement = document.getElementById('calcExpression');
            const resultElement = document.getElementById('calcResult');
            
            if (expressionElement) expressionElement.textContent = calcExpression || '';
            if (resultElement) resultElement.textContent = calcResult;
        }
        
        // Adicionar fun√ß√£o cient√≠fica
        function addFunction(func) {
            calcExpression += func + '(';
            updateCalcDisplay();
        }
        
        // Adicionar constante
        function addConstant(constant) {
            calcExpression += constant;
            updateCalcDisplay();
        }
        
        // Fun√ß√µes m√≠sticas
        function calculateLifePath() {
            const input = document.getElementById('mysticalInput').value;
            if (!input) {
                showGatomante('Digite uma data de nascimento no formato dd/mm/aaaa', 'thinking');
                return;
            }
            
            const lifePath = calculateNumerologyNumber(input, 'lifepath');
            calcResult = `Caminho da Vida: ${lifePath}`;
            updateCalcDisplay();
            addToCalcHistory(`Caminho da Vida (${input})`, lifePath.toString());
        }
        
        function calculateDestinyNumber() {
            const input = document.getElementById('mysticalInput').value;
            if (!input) {
                showGatomante('Digite seu nome completo', 'thinking');
                return;
            }
            
            const destiny = calculateNumerologyNumber(input, 'destiny');
            calcResult = `N√∫mero do Destino: ${destiny}`;
            updateCalcDisplay();
            addToCalcHistory(`Destino (${input})`, destiny.toString());
        }
        
        // Calcular n√∫mero numerol√≥gico
        function calculateNumerologyNumber(input, type) {
            if (type === 'lifepath') {
                // Calcular caminho da vida a partir da data
                const numbers = input.replace(/\D/g, '');
                let sum = 0;
                for (let digit of numbers) {
                    sum += parseInt(digit);
                }
                
                // Reduzir a um d√≠gito (exceto n√∫meros mestres)
                while (sum > 9 && sum !== 11 && sum !== 22 && sum !== 33) {
                    sum = sum.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                }
                
                return sum;
            } else if (type === 'destiny') {
                // Calcular n√∫mero do destino a partir do nome
                const letterValues = {
                    'A': 1, 'B': 2, 'C': 3, 'D': 4, 'E': 5, 'F': 6, 'G': 7, 'H': 8, 'I': 9,
                    'J': 1, 'K': 2, 'L': 3, 'M': 4, 'N': 5, 'O': 6, 'P': 7, 'Q': 8, 'R': 9,
                    'S': 1, 'T': 2, 'U': 3, 'V': 4, 'W': 5, 'X': 6, 'Y': 7, 'Z': 8
                };
                
                let sum = 0;
                for (let char of input.toUpperCase()) {
                    if (letterValues[char]) {
                        sum += letterValues[char];
                    }
                }
                
                // Reduzir a um d√≠gito
                while (sum > 9 && sum !== 11 && sum !== 22 && sum !== 33) {
                    sum = sum.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                }
                
                return sum;
            }
            
            return 0;
        }
        
        // Adicionar ao hist√≥rico
        function addToCalcHistory(expression, result) {
            calcHistory.unshift({ expression, result, timestamp: new Date() });
            
            // Manter apenas os √∫ltimos 20 c√°lculos
            if (calcHistory.length > 20) {
                calcHistory = calcHistory.slice(0, 20);
            }
            
            updateHistoryDisplay();
            saveCalcHistory();
        }
        
        // Atualizar display do hist√≥rico
        function updateHistoryDisplay() {
            const historyElement = document.getElementById('calcHistory');
            if (!historyElement) return;
            
            if (calcHistory.length === 0) {
                historyElement.innerHTML = '<div class="history-empty">Nenhum c√°lculo realizado</div>';
                return;
            }
            
            const historyHTML = calcHistory.map(item => `
                <div class="history-item" onclick="useHistoryItem('${item.expression}', '${item.result}')">
                    <div class="history-expression">${item.expression}</div>
                    <div class="history-result">= ${item.result}</div>
                </div>
            `).join('');
            
            historyElement.innerHTML = historyHTML;
        }
        
        // Usar item do hist√≥rico
        function useHistoryItem(expression, result) {
            calcExpression = expression;
            calcResult = result;
            updateCalcDisplay();
        }
        
        // Limpar hist√≥rico
        function clearHistory() {
            if (confirm('Deseja limpar todo o hist√≥rico de c√°lculos?')) {
                calcHistory = [];
                updateHistoryDisplay();
                saveCalcHistory();
            }
        }
        
        // Salvar hist√≥rico
        function saveCalcHistory() {
            localStorage.setItem('auroraOS_calcHistory', JSON.stringify(calcHistory));
        }
        
        // Carregar hist√≥rico
        function loadCalcHistory() {
            const saved = localStorage.getItem('auroraOS_calcHistory');
            if (saved) {
                try {
                    calcHistory = JSON.parse(saved);
                    updateHistoryDisplay();
                } catch (e) {
                    console.log('Erro ao carregar hist√≥rico da calculadora:', e);
                }
            }
        }
        
        // ========================================
        // üìÇ GERENCIADOR DE ARQUIVOS AVAN√áADO
        // ========================================
        
        function openFileManager() {
            const fileWindow = createWindow('Gerenciador de Arquivos', 'üìÇ', 900, 700);
            
            fileWindow.innerHTML = `
                <div class="file-manager">
                    <!-- Toolbar -->
                    <div class="file-toolbar">
                        <div class="toolbar-section">
                            <button class="toolbar-btn" onclick="navigateBack()" title="Voltar">‚¨ÖÔ∏è</button>
                            <button class="toolbar-btn" onclick="navigateForward()" title="Avan√ßar">‚û°Ô∏è</button>
                            <button class="toolbar-btn" onclick="navigateUp()" title="Pasta Pai">‚¨ÜÔ∏è</button>
                            <button class="toolbar-btn" onclick="refreshFileView()" title="Atualizar">üîÑ</button>
                        </div>
                        
                        <div class="toolbar-section">
                            <button class="toolbar-btn" onclick="createNewFolder()" title="Nova Pasta">üìÅ+</button>
                            <button class="toolbar-btn" onclick="uploadFiles()" title="Upload">üì§</button>
                            <button class="toolbar-btn" onclick="downloadSelected()" title="Download">üì•</button>
                            <button class="toolbar-btn" onclick="deleteSelected()" title="Excluir">üóëÔ∏è</button>
                        </div>
                        
                        <div class="toolbar-section">
                            <select class="view-selector" onchange="changeFileView(this.value)">
                                <option value="grid">üî≤ Grade</option>
                                <option value="list">üìã Lista</option>
                                <option value="details">üìä Detalhes</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Barra de Endere√ßo -->
                    <div class="address-bar">
                        <div class="breadcrumb" id="fileBreadcrumb">
                            <span class="breadcrumb-item active" onclick="navigateToPath('/')">üè† In√≠cio</span>
                        </div>
                        <input type="text" class="address-input" id="addressInput" placeholder="Digite o caminho..." 
                               onkeydown="handleAddressInput(event)">
                    </div>
                    
                    <!-- Painel Principal -->
                    <div class="file-main-panel">
                        <!-- Sidebar -->
                        <div class="file-sidebar">
                            <div class="sidebar-section">
                                <h4>üìÅ Locais R√°pidos</h4>
                                <div class="quick-access">
                                    <div class="quick-item" onclick="navigateToPath('/documents')">üìÑ Documentos</div>
                                    <div class="quick-item" onclick="navigateToPath('/images')">üñºÔ∏è Imagens</div>
                                    <div class="quick-item" onclick="navigateToPath('/music')">üéµ M√∫sicas</div>
                                    <div class="quick-item" onclick="navigateToPath('/videos')">üé¨ V√≠deos</div>
                                    <div class="quick-item" onclick="navigateToPath('/downloads')">üì• Downloads</div>
                                    <div class="quick-item" onclick="navigateToPath('/trash')">üóëÔ∏è Lixeira</div>
                                </div>
                            </div>
                            
                            <div class="sidebar-section">
                                <h4>‚òÅÔ∏è Nuvem M√≠stica</h4>
                                <div class="cloud-storage">
                                    <div class="storage-item">
                                        <span class="storage-name">Aurora Drive</span>
                                        <div class="storage-usage">
                                            <div class="usage-bar">
                                                <div class="usage-fill" style="width: 45%"></div>
                                            </div>
                                            <span class="usage-text">4.5GB / 10GB</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="sidebar-section">
                                <h4>üè∑Ô∏è Tags</h4>
                                <div class="tag-list">
                                    <span class="file-tag" onclick="filterByTag('importante')">üî¥ Importante</span>
                                    <span class="file-tag" onclick="filterByTag('trabalho')">üü° Trabalho</span>
                                    <span class="file-tag" onclick="filterByTag('pessoal')">üü¢ Pessoal</span>
                                    <span class="file-tag" onclick="filterByTag('projeto')">üîµ Projeto</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- √Årea de Arquivos -->
                        <div class="file-content">
                            <div class="file-view grid" id="fileView">
                                <!-- Arquivos ser√£o carregados aqui -->
                            </div>
                            
                            <!-- √Årea de Drop -->
                            <div class="drop-zone" id="dropZone" style="display: none;">
                                <div class="drop-content">
                                    <span class="drop-icon">üìÅ</span>
                                    <p>Solte os arquivos aqui</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Barra de Status -->
                    <div class="file-status-bar">
                        <div class="status-info">
                            <span id="fileCount">0 itens</span>
                            <span id="selectedCount"></span>
                        </div>
                        <div class="status-actions">
                            <span id="totalSize">0 bytes</span>
                        </div>
                    </div>
                    
                    <!-- Input oculto para upload -->
                    <input type="file" id="fileUploadInput" multiple style="display: none;">
                </div>
            `;
            
            // Inicializar gerenciador de arquivos
            initFileManager();
            
            // Adicionar aos recentes
            addToRecents('Gerenciador de Arquivos', 'üìÇ');
            
            // Notificar Gatomante
            showGatomante('Gerenciador de Arquivos aberto! Organize seus tesouros digitais com sabedoria.', 'excited');
        }
        
        // Vari√°veis do gerenciador de arquivos
        let currentPath = '/';
        let fileHistory = ['/'];
        let historyIndex = 0;
        let fileView = 'grid';
        let selectedFiles = new Set();
        let virtualFileSystem = {
            '/': {
                type: 'folder',
                name: 'In√≠cio',
                children: {
                    'documents': { type: 'folder', name: 'Documentos', children: {} },
                    'images': { type: 'folder', name: 'Imagens', children: {} },
                    'music': { type: 'folder', name: 'M√∫sicas', children: {} },
                    'videos': { type: 'folder', name: 'V√≠deos', children: {} },
                    'downloads': { type: 'folder', name: 'Downloads', children: {} },
                    'trash': { type: 'folder', name: 'Lixeira', children: {} }
                }
            }
        };
        
        // Inicializar gerenciador de arquivos
        function initFileManager() {
            loadVirtualFileSystem();
            setupFileUpload();
            setupDragAndDrop();
            navigateToPath('/');
        }
        
        // Configurar upload de arquivos
        function setupFileUpload() {
            const fileInput = document.getElementById('fileUploadInput');
            if (fileInput) {
                fileInput.addEventListener('change', handleFileUpload);
            }
        }
        
        // Configurar drag and drop
        function setupDragAndDrop() {
            const fileView = document.getElementById('fileView');
            const dropZone = document.getElementById('dropZone');
            
            if (fileView && dropZone) {
                fileView.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.style.display = 'flex';
                });
                
                dropZone.addEventListener('dragleave', (e) => {
                    if (!dropZone.contains(e.relatedTarget)) {
                        dropZone.style.display = 'none';
                    }
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.style.display = 'none';
                    
                    const files = Array.from(e.dataTransfer.files);
                    handleDroppedFiles(files);
                });
            }
        }
        
        // Navegar para caminho
        function navigateToPath(path) {
            currentPath = path;
            
            // Atualizar hist√≥rico
            if (historyIndex < fileHistory.length - 1) {
                fileHistory = fileHistory.slice(0, historyIndex + 1);
            }
            fileHistory.push(path);
            historyIndex = fileHistory.length - 1;
            
            updateBreadcrumb();
            loadFileView();
        }
        
        // Atualizar breadcrumb
        function updateBreadcrumb() {
            const breadcrumb = document.getElementById('fileBreadcrumb');
            if (!breadcrumb) return;
            
            const pathParts = currentPath.split('/').filter(part => part);
            let breadcrumbHTML = '<span class="breadcrumb-item" onclick="navigateToPath(\'/\')">üè† In√≠cio</span>';
            
            let currentPathBuild = '';
            pathParts.forEach(part => {
                currentPathBuild += '/' + part;
                breadcrumbHTML += ` <span class="breadcrumb-separator">></span> `;
                breadcrumbHTML += `<span class="breadcrumb-item" onclick="navigateToPath('${currentPathBuild}')">${part}</span>`;
            });
            
            breadcrumb.innerHTML = breadcrumbHTML;
        }
        
        // Carregar visualiza√ß√£o de arquivos
        function loadFileView() {
            const fileViewElement = document.getElementById('fileView');
            if (!fileViewElement) return;
            
            const currentFolder = getFolder(currentPath);
            if (!currentFolder || !currentFolder.children) {
                fileViewElement.innerHTML = '<div class="empty-folder">üìÅ Pasta vazia</div>';
                updateStatusBar(0, 0);
                return;
            }
            
            const files = Object.entries(currentFolder.children);
            
            if (files.length === 0) {
                fileViewElement.innerHTML = '<div class="empty-folder">üìÅ Pasta vazia</div>';
                updateStatusBar(0, 0);
                return;
            }
            
            let filesHTML = '';
            let totalSize = 0;
            
            files.forEach(([name, file]) => {
                const isSelected = selectedFiles.has(name);
                const fileIcon = getFileIcon(file);
                const fileSize = file.size || 0;
                totalSize += fileSize;
                
                if (fileView === 'grid') {
                    filesHTML += `
                        <div class="file-item ${isSelected ? 'selected' : ''}" 
                             onclick="selectFile('${name}', event)" 
                             ondblclick="openFile('${name}')">
                            <div class="file-icon">${fileIcon}</div>
                            <div class="file-name" title="${file.name || name}">${file.name || name}</div>
                        </div>
                    `;
                } else if (fileView === 'list') {
                    filesHTML += `
                        <div class="file-row ${isSelected ? 'selected' : ''}" 
                             onclick="selectFile('${name}', event)" 
                             ondblclick="openFile('${name}')">
                            <span class="file-icon">${fileIcon}</span>
                            <span class="file-name">${file.name || name}</span>
                        </div>
                    `;
                } else if (fileView === 'details') {
                    const modifiedDate = file.modified ? new Date(file.modified).toLocaleDateString() : 'Desconhecido';
                    const sizeText = formatFileSize(fileSize);
                    
                    filesHTML += `
                        <div class="file-details-row ${isSelected ? 'selected' : ''}" 
                             onclick="selectFile('${name}', event)" 
                             ondblclick="openFile('${name}')">
                            <span class="file-icon">${fileIcon}</span>
                            <span class="file-name">${file.name || name}</span>
                            <span class="file-size">${sizeText}</span>
                            <span class="file-type">${file.type || 'Pasta'}</span>
                            <span class="file-modified">${modifiedDate}</span>
                        </div>
                    `;
                }
            });
            
            fileViewElement.innerHTML = filesHTML;
            updateStatusBar(files.length, totalSize);
        }
        
        // Obter pasta do sistema virtual
        function getFolder(path) {
            const pathParts = path.split('/').filter(part => part);
            let current = virtualFileSystem['/'];
            
            for (const part of pathParts) {
                if (current.children && current.children[part]) {
                    current = current.children[part];
                } else {
                    return null;
                }
            }
            
            return current;
        }
        
        // Obter √≠cone do arquivo
        function getFileIcon(file) {
            if (file.type === 'folder') return 'üìÅ';
            
            const extension = file.name ? file.name.split('.').pop().toLowerCase() : '';
            
            const iconMap = {
                // Documentos
                'txt': 'üìÑ', 'doc': 'üìÑ', 'docx': 'üìÑ', 'pdf': 'üìï',
                'rtf': 'üìÑ', 'odt': 'üìÑ',
                
                // Planilhas
                'xls': 'üìä', 'xlsx': 'üìä', 'csv': 'üìä', 'ods': 'üìä',
                
                // Apresenta√ß√µes
                'ppt': 'üìΩÔ∏è', 'pptx': 'üìΩÔ∏è', 'odp': 'üìΩÔ∏è',
                
                // Imagens
                'jpg': 'üñºÔ∏è', 'jpeg': 'üñºÔ∏è', 'png': 'üñºÔ∏è', 'gif': 'üñºÔ∏è',
                'bmp': 'üñºÔ∏è', 'svg': 'üñºÔ∏è', 'webp': 'üñºÔ∏è',
                
                // √Åudio
                'mp3': 'üéµ', 'wav': 'üéµ', 'flac': 'üéµ', 'aac': 'üéµ',
                'ogg': 'üéµ', 'm4a': 'üéµ',
                
                // V√≠deo
                'mp4': 'üé¨', 'avi': 'üé¨', 'mkv': 'üé¨', 'mov': 'üé¨',
                'wmv': 'üé¨', 'flv': 'üé¨', 'webm': 'üé¨',
                
                // C√≥digo
                'html': 'üåê', 'css': 'üé®', 'js': '‚ö°', 'json': 'üìã',
                'xml': 'üìã', 'py': 'üêç', 'java': '‚òï', 'cpp': '‚öôÔ∏è',
                
                // Compactados
                'zip': 'üì¶', 'rar': 'üì¶', '7z': 'üì¶', 'tar': 'üì¶',
                'gz': 'üì¶'
            };
            
            return iconMap[extension] || 'üìÑ';
        }
        
        // Selecionar arquivo
        function selectFile(name, event) {
            if (event.ctrlKey || event.metaKey) {
                // Sele√ß√£o m√∫ltipla
                if (selectedFiles.has(name)) {
                    selectedFiles.delete(name);
                } else {
                    selectedFiles.add(name);
                }
            } else {
                // Sele√ß√£o √∫nica
                selectedFiles.clear();
                selectedFiles.add(name);
            }
            
            loadFileView();
            updateSelectedCount();
        }
        
        // Abrir arquivo
        function openFile(name) {
            const currentFolder = getFolder(currentPath);
            const file = currentFolder.children[name];
            
            if (file.type === 'folder') {
                const newPath = currentPath === '/' ? '/' + name : currentPath + '/' + name;
                navigateToPath(newPath);
            } else {
                // Abrir arquivo baseado no tipo
                openFileByType(file);
            }
        }
        
        // Abrir arquivo por tipo
        function openFileByType(file) {
            const extension = file.name ? file.name.split('.').pop().toLowerCase() : '';
            
            if (['jpg', 'jpeg', 'png', 'gif', 'bmp', 'svg', 'webp'].includes(extension)) {
                openImageViewer(file);
            } else if (['mp3', 'wav', 'flac', 'aac', 'ogg', 'm4a'].includes(extension)) {
                openAudioPlayer(file);
            } else if (['mp4', 'avi', 'mkv', 'mov', 'wmv', 'flv', 'webm'].includes(extension)) {
                openVideoPlayer(file);
            } else if (['txt', 'md', 'json', 'xml', 'html', 'css', 'js'].includes(extension)) {
                openTextEditor(file);
            } else {
                showGatomante(`N√£o sei como abrir arquivos do tipo .${extension}. Talvez voc√™ precise de uma aplica√ß√£o espec√≠fica?`, 'thinking');
            }
        }
        
        // Atualizar contador de selecionados
        function updateSelectedCount() {
            const selectedCountElement = document.getElementById('selectedCount');
            if (selectedCountElement) {
                if (selectedFiles.size > 0) {
                    selectedCountElement.textContent = `${selectedFiles.size} selecionado(s)`;
                } else {
                    selectedCountElement.textContent = '';
                }
            }
        }
        
        // Atualizar barra de status
        function updateStatusBar(fileCount, totalSize) {
            const fileCountElement = document.getElementById('fileCount');
            const totalSizeElement = document.getElementById('totalSize');
            
            if (fileCountElement) {
                fileCountElement.textContent = `${fileCount} ${fileCount === 1 ? 'item' : 'itens'}`;
            }
            
            if (totalSizeElement) {
                totalSizeElement.textContent = formatFileSize(totalSize);
            }
        }
        
        // Formatar tamanho do arquivo
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 bytes';
            
            const k = 1024;
            const sizes = ['bytes', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // Navegar para tr√°s
        function navigateBack() {
            if (historyIndex > 0) {
                historyIndex--;
                currentPath = fileHistory[historyIndex];
                updateBreadcrumb();
                loadFileView();
            }
        }
        
        // Navegar para frente
        function navigateForward() {
            if (historyIndex < fileHistory.length - 1) {
                historyIndex++;
                currentPath = fileHistory[historyIndex];
                updateBreadcrumb();
                loadFileView();
            }
        }
        
        // Navegar para pasta pai
        function navigateUp() {
            if (currentPath !== '/') {
                const parentPath = currentPath.substring(0, currentPath.lastIndexOf('/')) || '/';
                navigateToPath(parentPath);
            }
        }
        
        // Atualizar visualiza√ß√£o
        function refreshFileView() {
            loadFileView();
            showGatomante('Visualiza√ß√£o atualizada!', 'normal');
        }
        
        // Alterar visualiza√ß√£o
        function changeFileView(newView) {
            fileView = newView;
            const fileViewElement = document.getElementById('fileView');
            
            if (fileViewElement) {
                fileViewElement.className = `file-view ${newView}`;
                loadFileView();
            }
        }
        
        // Upload de arquivos
        function uploadFiles() {
            document.getElementById('fileUploadInput').click();
        }
        
        // Manipular upload de arquivos
        function handleFileUpload(event) {
            const files = Array.from(event.target.files);
            handleDroppedFiles(files);
        }
        
        // Manipular arquivos soltos
        function handleDroppedFiles(files) {
            const currentFolder = getFolder(currentPath);
            if (!currentFolder) return;
            
            files.forEach(file => {
                const fileObj = {
                    type: 'file',
                    name: file.name,
                    size: file.size,
                    modified: new Date().toISOString(),
                    data: file // Armazenar o objeto File
                };
                
                currentFolder.children[file.name] = fileObj;
            });
            
            loadFileView();
            saveVirtualFileSystem();
            
            showGatomante(`${files.length} arquivo(s) adicionado(s) com sucesso!`, 'excited');
        }
        
        // Criar nova pasta
        function createNewFolder() {
            const folderName = prompt('Nome da nova pasta:');
            if (!folderName) return;
            
            const currentFolder = getFolder(currentPath);
            if (!currentFolder) return;
            
            if (currentFolder.children[folderName]) {
                alert('J√° existe um item com esse nome!');
                return;
            }
            
            currentFolder.children[folderName] = {
                type: 'folder',
                name: folderName,
                children: {},
                created: new Date().toISOString()
            };
            
            loadFileView();
            saveVirtualFileSystem();
            
            showGatomante(`Pasta "${folderName}" criada com sucesso!`, 'excited');
        }
        
        // Excluir selecionados
        function deleteSelected() {
            if (selectedFiles.size === 0) {
                showGatomante('Selecione arquivos para excluir primeiro.', 'thinking');
                return;
            }
            
            const fileNames = Array.from(selectedFiles);
            const confirmMessage = `Deseja excluir ${fileNames.length} item(s)?\n\n${fileNames.join('\n')}`;
            
            if (confirm(confirmMessage)) {
                const currentFolder = getFolder(currentPath);
                
                fileNames.forEach(name => {
                    delete currentFolder.children[name];
                });
                
                selectedFiles.clear();
                loadFileView();
                saveVirtualFileSystem();
                
                showGatomante(`${fileNames.length} item(s) exclu√≠do(s).`, 'normal');
            }
        }
        
        // Salvar sistema de arquivos virtual
        function saveVirtualFileSystem() {
            // Criar vers√£o simplificada sem dados de arquivo para salvar
            const simplifiedFS = JSON.parse(JSON.stringify(virtualFileSystem, (key, value) => {
                if (key === 'data') return undefined; // N√£o salvar dados de arquivo
                return value;
            }));
            
            localStorage.setItem('auroraOS_virtualFS', JSON.stringify(simplifiedFS));
        }
        
        // Carregar sistema de arquivos virtual
        function loadVirtualFileSystem() {
            const saved = localStorage.getItem('auroraOS_virtualFS');
            if (saved) {
                try {
                    const loadedFS = JSON.parse(saved);
                    virtualFileSystem = { ...virtualFileSystem, ...loadedFS };
                } catch (e) {
                    console.log('Erro ao carregar sistema de arquivos:', e);
                }
            }
        }
